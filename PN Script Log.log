2019-06-10 13:25:42,292 - INFO - Report date: 20190610
2019-06-10 13:25:42,292 - INFO - G:\My Drive\AUTOMATED_REPORTS\PN - Comm\PN - User List\presto-jdbc-0.205.jar
2019-06-10 13:25:43,013 - INFO - Connect Google Sheet Successfully...
2019-06-10 13:25:44,015 - INFO - Reading Data From Google Sheet...
2019-06-10 13:25:47,798 - INFO - 'Home & Living'
2019-06-10 13:25:50,921 - INFO - 'Electronics'
2019-06-10 13:25:54,085 - INFO - 'Fashion'
2019-06-10 13:25:56,684 - INFO - Number of category: 3
2019-06-10 13:25:56,686 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-10 13:25:56,687 - INFO - Last Login: 15
2019-06-10 13:25:56,688 - INFO - SQL Option: 1
2019-06-10 13:25:56,690 - INFO - Filename: A15 HL E F Buyers
2019-06-10 13:25:56,710 - INFO - Start Running query A15 HL E F Buyers
2019-06-10 13:29:11,862 - INFO - Running A15 HL E F Buyers Done
2019-06-10 13:29:11,862 - INFO - CSV file path: A15 HL E F Buyers
2019-06-10 13:29:12,450 - INFO - Starting save the query results
2019-06-10 13:29:12,451 - INFO - Total Rows : 6323889
2019-06-10 13:29:12,453 - INFO - Will split into : 7.0 files
2019-06-10 13:29:17,039 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_1.csv
2019-06-10 13:29:17,039 - INFO - , with total : 903413 rows
2019-06-10 13:29:21,397 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_2.csv
2019-06-10 13:29:21,397 - INFO - , with total : 903413 rows
2019-06-10 13:29:26,286 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_3.csv
2019-06-10 13:29:26,286 - INFO - , with total : 903413 rows
2019-06-10 13:29:34,082 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_4.csv
2019-06-10 13:29:34,084 - INFO - , with total : 903413 rows
2019-06-10 13:29:43,536 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_5.csv
2019-06-10 13:29:43,539 - INFO - , with total : 903413 rows
2019-06-10 13:29:59,176 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_6.csv
2019-06-10 13:29:59,177 - INFO - , with total : 903412 rows
2019-06-10 13:30:06,368 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_7.csv
2019-06-10 13:30:06,369 - INFO - , with total : 903412 rows
2019-06-10 13:30:08,055 - INFO - Spreadsheet downloaded
2019-06-10 15:42:25,441 - INFO - Report date: 20190610
2019-06-10 15:42:25,444 - INFO - G:\My Drive\AUTOMATED_REPORTS\PN - Comm\PN - User List\presto-jdbc-0.205.jar
2019-06-10 15:42:26,391 - INFO - Connect Google Sheet Successfully...
2019-06-10 15:42:27,391 - INFO - Reading Data From Google Sheet...
2019-06-10 15:42:32,279 - INFO - 'Home & Living'
2019-06-10 15:42:35,503 - INFO - 'Electronics'
2019-06-10 15:42:39,134 - INFO - 'Fashion'
2019-06-10 15:42:42,717 - INFO - 'Beauty'
2019-06-10 15:42:45,490 - INFO - Number of category: 4
2019-06-10 15:42:45,492 - INFO - All category: 'Home & Living','Electronics','Fashion','Beauty'
2019-06-10 15:42:45,493 - INFO - Last Login: 30
2019-06-10 15:42:45,494 - INFO - SQL Option: 1
2019-06-10 15:42:45,497 - INFO - Filename: A15 HL E F Buyers
2019-06-10 15:42:46,934 - INFO - Spreadsheet downloaded
2019-06-10 15:50:02,786 - INFO - Report date: 20190610
2019-06-10 15:50:02,788 - INFO - G:\My Drive\AUTOMATED_REPORTS\PN - Comm\PN - User List\presto-jdbc-0.205.jar
2019-06-10 15:50:03,684 - INFO - Connect Google Sheet Successfully...
2019-06-10 15:50:04,687 - INFO - Reading Data From Google Sheet...
2019-06-10 15:50:09,187 - INFO - 'Home & Living'
2019-06-10 15:50:12,661 - INFO - 'Electronics'
2019-06-10 15:50:16,351 - INFO - 'Fashion'
2019-06-10 15:50:19,924 - INFO - 'Beauty'
2019-06-10 15:50:22,562 - INFO - Number of category: 4
2019-06-10 15:50:22,563 - INFO - All category: 'Home & Living','Electronics','Fashion','Beauty'
2019-06-10 15:50:22,566 - INFO - Last Login: 30
2019-06-10 15:50:22,569 - INFO - SQL Option: 1
2019-06-10 15:50:22,569 - INFO - Filename: A15 HL E F Buyers
2019-06-10 15:53:59,206 - INFO - Report date: 20190610
2019-06-10 15:53:59,207 - INFO - G:\My Drive\AUTOMATED_REPORTS\PN - Comm\PN - User List\presto-jdbc-0.205.jar
2019-06-10 15:54:00,098 - INFO - Connect Google Sheet Successfully...
2019-06-10 15:54:01,102 - INFO - Reading Data From Google Sheet...
2019-06-10 15:54:05,115 - INFO - 'Home & Living'
2019-06-10 15:54:08,127 - INFO - 'Electronics'
2019-06-10 15:54:11,556 - INFO - 'Fashion'
2019-06-10 15:54:15,036 - INFO - 'Beauty'
2019-06-10 15:54:17,395 - INFO - Number of category: 4
2019-06-10 15:54:17,398 - INFO - All category: 'Home & Living','Electronics','Fashion','Beauty'
2019-06-10 15:54:17,400 - INFO - Last Login: 30
2019-06-10 15:54:17,401 - INFO - SQL Option: 1
2019-06-10 15:54:17,404 - INFO - Filename: A15 HL E F Buyers
2019-06-10 15:54:17,405 - INFO - Start zipping..
2019-06-10 15:54:19,417 - INFO - File list:['A15 HL E F Buyers_1.csv', 'A15 HL E F Buyers_2.csv', 'A15 HL E F Buyers_3.csv', 'A15 HL E F Buyers_4.csv', 'A15 HL E F Buyers_5.csv', 'A15 HL E F Buyers_6.csv', 'A15 HL E F Buyers_7.csv']
2019-06-10 15:54:21,538 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_1.csv
2019-06-10 15:54:24,180 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_2.csv
2019-06-10 15:54:25,818 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_3.csv
2019-06-10 15:54:27,596 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_4.csv
2019-06-10 15:54:29,319 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_5.csv
2019-06-10 15:54:31,335 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_6.csv
2019-06-10 15:54:33,638 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_7.csv
2019-06-10 15:54:33,641 - INFO - Download sheet..
2019-06-10 15:54:34,910 - INFO - Spreadsheet downloaded
2019-06-10 16:07:31,506 - INFO - Report date: 20190610
2019-06-10 16:07:32,477 - INFO - Connect Google Sheet Successfully...
2019-06-10 16:07:33,480 - INFO - Reading Data From Google Sheet...
2019-06-10 16:07:37,953 - INFO - 'Home & Living'
2019-06-10 16:07:41,535 - INFO - 'Electronics'
2019-06-10 16:07:44,767 - INFO - 'Fashion'
2019-06-10 16:07:48,092 - INFO - 'Beauty'
2019-06-10 16:07:50,739 - INFO - Number of category: 4
2019-06-10 16:07:50,739 - INFO - All category: 'Home & Living','Electronics','Fashion','Beauty'
2019-06-10 16:07:50,740 - INFO - Last Login: 30
2019-06-10 16:07:50,740 - INFO - SQL Option: 1
2019-06-10 16:07:50,740 - INFO - Filename: A15 HL E F Buyers
2019-06-10 16:07:50,742 - INFO - Start zipping..
2019-06-10 16:07:52,749 - INFO - File list: ['A15 HL E F Buyers_1.csv', 'A15 HL E F Buyers_2.csv', 'A15 HL E F Buyers_3.csv', 'A15 HL E F Buyers_4.csv', 'A15 HL E F Buyers_5.csv', 'A15 HL E F Buyers_6.csv', 'A15 HL E F Buyers_7.csv']
2019-06-10 16:07:54,351 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_1.csv
2019-06-10 16:07:55,812 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_2.csv
2019-06-10 16:07:57,904 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_3.csv
2019-06-10 16:07:59,648 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_4.csv
2019-06-10 16:08:00,983 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_5.csv
2019-06-10 16:08:02,960 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_6.csv
2019-06-10 16:08:05,086 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_7.csv
2019-06-10 16:11:38,036 - INFO - Report date: 20190610
2019-06-10 16:11:39,049 - INFO - Connect Google Sheet Successfully...
2019-06-10 16:11:40,052 - INFO - Reading Data From Google Sheet...
2019-06-10 16:11:44,404 - INFO - 'Home & Living'
2019-06-10 16:11:47,808 - INFO - 'Electronics'
2019-06-10 16:11:51,378 - INFO - 'Fashion'
2019-06-10 16:11:54,499 - INFO - 'Beauty'
2019-06-10 16:11:57,111 - INFO - Number of category: 4
2019-06-10 16:11:57,112 - INFO - All category: 'Home & Living','Electronics','Fashion','Beauty'
2019-06-10 16:11:57,115 - INFO - Last Login: 30
2019-06-10 16:11:57,117 - INFO - SQL Option: 1
2019-06-10 16:11:57,121 - INFO - Filename: A15 HL E F Buyers
2019-06-10 16:11:57,125 - INFO - Start zipping..
2019-06-10 16:11:59,128 - INFO - File list: ['A15 HL E F Buyers_1.csv', 'A15 HL E F Buyers_2.csv', 'A15 HL E F Buyers_3.csv', 'A15 HL E F Buyers_4.csv', 'A15 HL E F Buyers_5.csv', 'A15 HL E F Buyers_6.csv', 'A15 HL E F Buyers_7.csv']
2019-06-10 16:13:24,654 - INFO - Report date: 20190610
2019-06-10 16:13:25,648 - INFO - Connect Google Sheet Successfully...
2019-06-10 16:13:26,654 - INFO - Reading Data From Google Sheet...
2019-06-10 16:13:30,515 - INFO - 'Home & Living'
2019-06-10 16:13:33,888 - INFO - 'Electronics'
2019-06-10 16:13:37,256 - INFO - 'Fashion'
2019-06-10 16:13:40,762 - INFO - 'Beauty'
2019-06-10 16:13:43,522 - INFO - Number of category: 4
2019-06-10 16:13:43,523 - INFO - All category: 'Home & Living','Electronics','Fashion','Beauty'
2019-06-10 16:13:43,526 - INFO - Last Login: 30
2019-06-10 16:13:43,528 - INFO - SQL Option: 1
2019-06-10 16:13:43,529 - INFO - Filename: A15 HL E F Buyers
2019-06-10 16:13:43,532 - INFO - Start zipping..
2019-06-10 16:13:45,543 - INFO - File list: ['A15 HL E F Buyers_1.csv', 'A15 HL E F Buyers_2.csv', 'A15 HL E F Buyers_3.csv', 'A15 HL E F Buyers_4.csv', 'A15 HL E F Buyers_5.csv', 'A15 HL E F Buyers_6.csv', 'A15 HL E F Buyers_7.csv']
2019-06-10 16:13:47,503 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_1.csv
2019-06-10 16:13:48,861 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_2.csv
2019-06-10 16:13:50,303 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_3.csv
2019-06-10 16:13:51,869 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_4.csv
2019-06-10 16:13:53,220 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_5.csv
2019-06-10 16:13:54,549 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_6.csv
2019-06-10 16:13:56,861 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_7.csv
2019-06-10 16:19:22,367 - INFO - Report date: 20190610
2019-06-10 16:19:23,638 - INFO - Connect Google Sheet Successfully...
2019-06-10 16:19:24,640 - INFO - Reading Data From Google Sheet...
2019-06-10 16:19:28,812 - INFO - 'Home & Living'
2019-06-10 16:19:32,163 - INFO - 'Electronics'
2019-06-10 16:19:35,569 - INFO - 'Fashion'
2019-06-10 16:19:38,848 - INFO - 'Beauty'
2019-06-10 16:19:41,614 - INFO - Number of category: 4
2019-06-10 16:19:41,617 - INFO - All category: 'Home & Living','Electronics','Fashion','Beauty'
2019-06-10 16:19:41,618 - INFO - Last Login: 30
2019-06-10 16:19:41,621 - INFO - SQL Option: 1
2019-06-10 16:19:41,624 - INFO - Filename: A15 HL E F Buyers
2019-06-10 16:19:41,628 - INFO - Start zipping..
2019-06-10 16:21:15,918 - INFO - Report date: 20190610
2019-06-10 16:21:17,009 - INFO - Connect Google Sheet Successfully...
2019-06-10 16:21:18,012 - INFO - Reading Data From Google Sheet...
2019-06-10 16:21:22,025 - INFO - 'Home & Living'
2019-06-10 16:21:25,224 - INFO - 'Electronics'
2019-06-10 16:21:28,687 - INFO - 'Fashion'
2019-06-10 16:21:32,068 - INFO - 'Beauty'
2019-06-10 16:21:34,766 - INFO - Number of category: 4
2019-06-10 16:21:34,769 - INFO - All category: 'Home & Living','Electronics','Fashion','Beauty'
2019-06-10 16:21:34,770 - INFO - Last Login: 30
2019-06-10 16:21:34,773 - INFO - SQL Option: 1
2019-06-10 16:21:34,775 - INFO - Filename: A15 HL E F Buyers
2019-06-10 16:21:34,776 - INFO - Start zipping..
2019-06-10 16:21:36,780 - INFO - File list: ['A15 HL E F Buyers_1.csv', 'A15 HL E F Buyers_2.csv', 'A15 HL E F Buyers_3.csv', 'A15 HL E F Buyers_4.csv', 'A15 HL E F Buyers_5.csv', 'A15 HL E F Buyers_6.csv', 'A15 HL E F Buyers_7.csv']
2019-06-10 16:21:36,792 - INFO - Current path: G:\My Drive\AUTOMATED_REPORTS\PN - Comm\20190610
2019-06-10 16:21:38,108 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_1.csv
2019-06-10 16:21:39,615 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_2.csv
2019-06-10 16:21:42,115 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_3.csv
2019-06-10 16:21:43,983 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_4.csv
2019-06-10 16:21:45,740 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_5.csv
2019-06-10 16:21:47,213 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_6.csv
2019-06-10 16:21:48,608 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_7.csv
2019-06-10 16:21:48,609 - INFO - Download sheet..
2019-06-10 16:31:37,023 - INFO - Report date: 20190610
2019-06-10 16:31:38,191 - INFO - Connect Google Sheet Successfully...
2019-06-10 16:31:39,197 - INFO - Reading Data From Google Sheet...
2019-06-10 16:31:43,664 - INFO - 'Home & Living'
2019-06-10 16:31:46,825 - INFO - 'Electronics'
2019-06-10 16:31:50,098 - INFO - 'Fashion'
2019-06-10 16:31:53,446 - INFO - 'Beauty'
2019-06-10 16:31:56,036 - INFO - Number of category: 4
2019-06-10 16:31:56,038 - INFO - All category: 'Home & Living','Electronics','Fashion','Beauty'
2019-06-10 16:31:56,039 - INFO - Last Login: 30
2019-06-10 16:31:56,042 - INFO - SQL Option: 1
2019-06-10 16:31:56,043 - INFO - Filename: A15 HL E F Buyers
2019-06-10 16:31:56,046 - INFO - Start zipping..
2019-06-10 16:31:56,048 - INFO - Change directory to report path..
2019-06-10 16:31:58,055 - INFO - File list: ['A15 HL E F Buyers_1.csv', 'A15 HL E F Buyers_2.csv', 'A15 HL E F Buyers_3.csv', 'A15 HL E F Buyers_4.csv', 'A15 HL E F Buyers_5.csv', 'A15 HL E F Buyers_6.csv', 'A15 HL E F Buyers_7.csv']
2019-06-10 16:31:58,088 - INFO - Current path: G:\My Drive\AUTOMATED_REPORTS\PN - Comm\20190610
2019-06-10 16:32:00,085 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_1.csv
2019-06-10 16:32:01,555 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_2.csv
2019-06-10 16:32:03,326 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_3.csv
2019-06-10 16:32:04,798 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_4.csv
2019-06-10 16:32:06,273 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_5.csv
2019-06-10 16:32:08,168 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_6.csv
2019-06-10 16:32:10,417 - INFO - G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A15 HL E F Buyers_7.csv
2019-06-10 16:32:10,420 - INFO - Download sheet..
2019-06-10 16:32:10,421 - INFO - Change directory to script path
2019-06-10 16:32:11,752 - INFO - Spreadsheet downloaded
2019-06-10 17:12:28,079 - INFO - Report date: 20190610
2019-06-10 17:12:29,144 - INFO - Connect Google Sheet Successfully...
2019-06-10 17:12:30,147 - INFO - Reading Data From Google Sheet...
2019-06-10 17:12:33,859 - INFO - 'Home & Living'
2019-06-10 17:12:37,155 - INFO - 'Electronics'
2019-06-10 17:12:40,312 - INFO - 'Fashion'
2019-06-10 17:12:43,634 - INFO - 'Beauty'
2019-06-10 17:12:46,221 - INFO - Number of category: 4
2019-06-10 17:12:46,224 - INFO - All category: 'Home & Living','Electronics','Fashion','Beauty'
2019-06-10 17:12:46,226 - INFO - Last Login: 30
2019-06-10 17:12:46,229 - INFO - SQL Option: 1
2019-06-10 17:12:46,230 - INFO - Filename: A15 HL E F Buyers
2019-06-10 17:12:46,234 - INFO - Start zipping..
2019-06-10 17:12:46,236 - INFO - Change directory to report path..
2019-06-10 17:12:48,250 - INFO - File list: ['A15 HL E F Buyers_1.csv', 'A15 HL E F Buyers_2.csv', 'A15 HL E F Buyers_3.csv', 'A15 HL E F Buyers_4.csv', 'A15 HL E F Buyers_5.csv', 'A15 HL E F Buyers_6.csv', 'A15 HL E F Buyers_7.csv']
2019-06-10 17:12:48,270 - INFO - Current path: G:\My Drive\AUTOMATED_REPORTS\PN - Comm\20190610
2019-06-10 17:12:54,285 - INFO - Download sheet..
2019-06-10 17:12:54,286 - INFO - Change directory to script path
2019-06-10 17:12:55,397 - INFO - Spreadsheet downloaded
2019-06-10 17:37:01,283 - INFO - Report date: 20190610
2019-06-10 17:37:02,157 - INFO - Connect Google Sheet Successfully...
2019-06-10 17:37:03,158 - INFO - Reading Data From Google Sheet...
2019-06-10 17:37:06,801 - INFO - 'Home & Living'
2019-06-10 17:37:09,950 - INFO - 'Electronics'
2019-06-10 17:37:12,536 - INFO - Number of category: 2
2019-06-10 17:37:12,538 - INFO - All category: 'Home & Living','Electronics'
2019-06-10 17:37:12,540 - INFO - Last Login: 30
2019-06-10 17:37:12,542 - INFO - SQL Option: 1
2019-06-10 17:37:12,543 - INFO - Filename: A30 HL & HE Buyers
2019-06-10 17:37:12,612 - INFO - Error: G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/ - The process cannot access the file because it is being used by another process.
2019-06-10 17:38:50,467 - INFO - Report date: 20190610
2019-06-10 17:38:51,388 - INFO - Connect Google Sheet Successfully...
2019-06-10 17:38:52,390 - INFO - Reading Data From Google Sheet...
2019-06-10 17:38:56,002 - INFO - 'Home & Living'
2019-06-10 17:38:59,164 - INFO - 'Electronics'
2019-06-10 17:39:01,743 - INFO - Number of category: 2
2019-06-10 17:39:01,746 - INFO - All category: 'Home & Living','Electronics'
2019-06-10 17:39:01,747 - INFO - Last Login: 30
2019-06-10 17:39:01,750 - INFO - SQL Option: 1
2019-06-10 17:39:01,755 - INFO - Filename: A30 HL & HE Buyers
2019-06-10 17:39:01,763 - INFO - Error: G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/ - The process cannot access the file because it is being used by another process.
2019-06-10 17:40:37,015 - INFO - Report date: 20190610
2019-06-10 17:40:37,917 - INFO - Connect Google Sheet Successfully...
2019-06-10 17:40:38,918 - INFO - Reading Data From Google Sheet...
2019-06-10 17:40:42,497 - INFO - 'Home & Living'
2019-06-10 17:40:45,676 - INFO - 'Electronics'
2019-06-10 17:40:48,249 - INFO - Number of category: 2
2019-06-10 17:40:48,250 - INFO - All category: 'Home & Living','Electronics'
2019-06-10 17:40:48,252 - INFO - Last Login: 30
2019-06-10 17:40:48,253 - INFO - SQL Option: 1
2019-06-10 17:40:48,253 - INFO - Filename: A30 HL & HE Buyers
2019-06-10 17:40:48,278 - INFO - Start Running query A30 HL & HE Buyers
2019-06-10 17:44:24,198 - INFO - Running A30 HL & HE Buyers Done
2019-06-10 17:44:24,200 - INFO - CSV file path: A30 HL & HE Buyers
2019-06-10 17:44:24,730 - INFO - Starting save the query results
2019-06-10 17:44:24,730 - INFO - Total Rows : 7043363
2019-06-10 17:44:24,730 - INFO - Will split into : 8.0 files
2019-06-10 17:44:29,062 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A30 HL & HE Buyers_1.csv
2019-06-10 17:44:29,062 - INFO - , with total : 880421 rows
2019-06-10 17:44:33,237 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A30 HL & HE Buyers_2.csv
2019-06-10 17:44:33,239 - INFO - , with total : 880421 rows
2019-06-10 17:44:37,911 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A30 HL & HE Buyers_3.csv
2019-06-10 17:44:37,911 - INFO - , with total : 880421 rows
2019-06-10 17:44:42,911 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A30 HL & HE Buyers_4.csv
2019-06-10 17:44:42,911 - INFO - , with total : 880420 rows
2019-06-10 17:44:48,196 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A30 HL & HE Buyers_5.csv
2019-06-10 17:44:48,196 - INFO - , with total : 880420 rows
2019-06-10 17:44:53,249 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A30 HL & HE Buyers_6.csv
2019-06-10 17:44:53,249 - INFO - , with total : 880420 rows
2019-06-10 17:44:59,434 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A30 HL & HE Buyers_7.csv
2019-06-10 17:44:59,436 - INFO - , with total : 880420 rows
2019-06-10 17:45:08,007 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm/20190610/A30 HL & HE Buyers_8.csv
2019-06-10 17:45:08,010 - INFO - , with total : 880420 rows
2019-06-10 17:45:08,440 - INFO - Start zipping..
2019-06-10 17:45:08,440 - INFO - Change directory to report path..
2019-06-10 17:45:10,443 - INFO - File list: ['A30 HL & HE Buyers_1.csv', 'A30 HL & HE Buyers_2.csv', 'A30 HL & HE Buyers_3.csv', 'A30 HL & HE Buyers_4.csv', 'A30 HL & HE Buyers_5.csv', 'A30 HL & HE Buyers_6.csv', 'A30 HL & HE Buyers_7.csv', 'A30 HL & HE Buyers_8.csv']
2019-06-10 17:45:10,448 - INFO - Current path: G:\My Drive\AUTOMATED_REPORTS\PN - Comm\20190610
2019-06-10 17:45:18,007 - INFO - Download sheet..
2019-06-10 17:45:18,009 - INFO - Change directory to script path
2019-06-10 17:45:19,025 - INFO - Spreadsheet downloaded
2019-06-10 18:23:26,650 - INFO - Report date: 20190610
2019-06-10 18:44:04,256 - INFO - Report date: 20190610 00:00
2019-06-10 18:45:14,158 - INFO - Report date: 20190610 12:00
2019-06-10 18:53:07,680 - INFO - Report date: 20190610 18:53
2019-06-10 19:05:26,704 - INFO - Report date: 20190610 19:05
2019-06-10 19:10:07,721 - INFO - Report date: 20190610 19:10
2019-06-10 19:27:32,711 - INFO - Report date: 20190610 19:27
2019-06-10 19:27:33,642 - INFO - Connect Google Sheet Successfully...
2019-06-10 19:27:34,642 - INFO - Reading Data From Google Sheet...
2019-06-10 19:27:38,378 - INFO - 'Home & Living'
2019-06-10 19:27:41,568 - INFO - 'Electronics'
2019-06-10 19:27:44,721 - INFO - 'Fashion'
2019-06-10 19:27:47,306 - INFO - Number of category: 3
2019-06-10 19:27:47,309 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-10 19:27:47,311 - INFO - Last Login: 30
2019-06-10 19:27:47,312 - INFO - SQL Option: 1
2019-06-10 19:27:47,313 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-10 19:34:18,253 - INFO - Report date: 20190610
2019-06-10 19:34:19,157 - INFO - Connect Google Sheet Successfully...
2019-06-10 19:34:20,158 - INFO - Reading Data From Google Sheet...
2019-06-10 19:34:23,818 - INFO - 'Home & Living'
2019-06-10 19:34:27,085 - INFO - 'Electronics'
2019-06-10 19:34:30,252 - INFO - 'Fashion'
2019-06-10 19:34:32,874 - INFO - Number of category: 3
2019-06-10 19:34:32,875 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-10 19:34:32,878 - INFO - Last Login: 30
2019-06-10 19:34:32,880 - INFO - SQL Option: 1
2019-06-10 19:34:32,881 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-10 19:34:32,897 - INFO - Start Running query A30 HL & HE & F Buyers
2019-06-10 19:35:30,710 - INFO - Report date: 20190610 19:35
2019-06-10 19:35:31,642 - INFO - Connect Google Sheet Successfully...
2019-06-10 19:35:32,644 - INFO - Reading Data From Google Sheet...
2019-06-10 19:35:36,331 - INFO - 'Home & Living'
2019-06-10 19:35:39,486 - INFO - 'Electronics'
2019-06-10 19:35:42,644 - INFO - 'Fashion'
2019-06-10 19:35:45,421 - INFO - Number of category: 3
2019-06-10 19:35:45,424 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-10 19:35:45,426 - INFO - Last Login: 30
2019-06-10 19:35:45,427 - INFO - SQL Option: 1
2019-06-10 19:35:45,430 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-10 19:38:20,842 - INFO - Report date: 20190610 19 38
2019-06-10 19:38:21,717 - INFO - Connect Google Sheet Successfully...
2019-06-10 19:38:22,719 - INFO - Reading Data From Google Sheet...
2019-06-10 19:38:26,302 - INFO - 'Home & Living'
2019-06-10 19:38:29,453 - INFO - 'Electronics'
2019-06-10 19:38:55,900 - INFO - Report date: 20190610 19.38
2019-06-10 19:38:56,914 - INFO - Connect Google Sheet Successfully...
2019-06-10 19:38:57,914 - INFO - Reading Data From Google Sheet...
2019-06-10 19:39:01,720 - INFO - 'Home & Living'
2019-06-10 19:39:04,911 - INFO - 'Electronics'
2019-06-10 19:39:08,092 - INFO - 'Fashion'
2019-06-10 19:39:10,698 - INFO - Number of category: 3
2019-06-10 19:39:10,700 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-10 19:39:10,700 - INFO - Last Login: 30
2019-06-10 19:39:10,700 - INFO - SQL Option: 1
2019-06-10 19:39:10,700 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-10 19:39:10,710 - INFO - Start Running query A30 HL & HE & F Buyers
2019-06-10 19:42:22,822 - INFO - Running A30 HL & HE & F Buyers Done
2019-06-10 19:42:22,822 - INFO - CSV file path: A30 HL & HE & F Buyers
2019-06-10 19:42:23,546 - INFO - Starting save the query results
2019-06-10 19:42:23,546 - INFO - Total Rows : 7043363
2019-06-10 19:42:23,546 - INFO - Will split into : 8.0 files
2019-06-10 19:42:30,374 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190610 19.38/A30 HL & HE & F Buyers_1.csv
2019-06-10 19:42:30,375 - INFO - , with total : 880421 rows
2019-06-10 19:42:38,061 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190610 19.38/A30 HL & HE & F Buyers_2.csv
2019-06-10 19:42:38,062 - INFO - , with total : 880421 rows
2019-06-10 19:42:45,538 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190610 19.38/A30 HL & HE & F Buyers_3.csv
2019-06-10 19:42:45,539 - INFO - , with total : 880421 rows
2019-06-10 19:42:53,582 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190610 19.38/A30 HL & HE & F Buyers_4.csv
2019-06-10 19:42:53,584 - INFO - , with total : 880420 rows
2019-06-10 19:43:04,226 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190610 19.38/A30 HL & HE & F Buyers_5.csv
2019-06-10 19:43:04,226 - INFO - , with total : 880420 rows
2019-06-10 19:43:13,211 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190610 19.38/A30 HL & HE & F Buyers_6.csv
2019-06-10 19:43:13,213 - INFO - , with total : 880420 rows
2019-06-10 19:43:21,841 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190610 19.38/A30 HL & HE & F Buyers_7.csv
2019-06-10 19:43:21,842 - INFO - , with total : 880420 rows
2019-06-10 19:43:30,644 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190610 19.38/A30 HL & HE & F Buyers_8.csv
2019-06-10 19:43:30,644 - INFO - , with total : 880420 rows
2019-06-10 19:43:31,198 - INFO - Download sheet..
2019-06-10 19:43:31,198 - INFO - Change directory to script path
2019-06-11 10:05:14,865 - INFO - Report date: 20190611 10.05
2019-06-11 10:05:15,796 - INFO - Connect Google Sheet Successfully...
2019-06-11 10:05:16,799 - INFO - Reading Data From Google Sheet...
2019-06-11 10:05:21,174 - INFO - 'Home & Living'
2019-06-11 10:05:25,026 - INFO - 'Electronics'
2019-06-11 10:05:28,648 - INFO - 'Fashion'
2019-06-11 10:05:31,420 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-11 10:05:31,421 - INFO - Number of category: 3
2019-06-11 10:05:31,424 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-11 10:05:31,426 - INFO - Last Login: 30
2019-06-11 10:05:31,443 - INFO - Start Running query A30 HL & HE & F Buyers
2019-06-11 10:07:45,266 - INFO - Running A30 HL & HE & F Buyers Done
2019-06-11 10:07:45,269 - INFO - CSV file path: A30 HL & HE & F Buyers
2019-06-11 10:07:45,305 - INFO - Starting save the query results
2019-06-11 10:07:45,309 - INFO - Total Rows : 0
2019-06-11 10:07:45,311 - INFO - Will split into : 0.0 files
2019-06-11 10:07:45,312 - INFO - ERROR -> number sections must be larger than 0.
2019-06-11 10:07:45,315 - INFO - Download sheet..
2019-06-11 10:07:45,315 - INFO - Change directory to script path
2019-06-11 10:14:44,686 - INFO - Report date: 20190611 10.14
2019-06-11 10:14:45,632 - INFO - Connect Google Sheet Successfully...
2019-06-11 10:14:46,635 - INFO - Reading Data From Google Sheet...
2019-06-11 10:14:52,486 - INFO - 'Home & Living'
2019-06-11 10:14:57,463 - INFO - 'Electronics'
2019-06-11 10:15:02,710 - INFO - 'Fashion'
2019-06-11 10:15:05,576 - INFO - Number of category: 3
2019-06-11 10:15:05,579 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-11 10:15:05,582 - INFO - Last Login: 30
2019-06-11 10:15:05,584 - INFO - SQL Option: 1
2019-06-11 10:15:05,586 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-11 10:15:05,609 - INFO - Start Running query A30 HL & HE & F Buyers
2019-06-11 10:28:32,532 - INFO - Running A30 HL & HE & F Buyers Done
2019-06-11 10:28:32,535 - INFO - CSV file path: A30 HL & HE & F Buyers
2019-06-11 10:28:33,421 - INFO - Starting save the query results
2019-06-11 10:28:33,423 - INFO - Total Rows : 7017447
2019-06-11 10:28:33,424 - INFO - Will split into : 8.0 files
2019-06-11 10:28:42,454 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 10.14/A30 HL & HE & F Buyers_1.csv
2019-06-11 10:28:42,457 - INFO - , with total : 877181 rows
2019-06-11 10:28:52,351 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 10.14/A30 HL & HE & F Buyers_2.csv
2019-06-11 10:28:52,352 - INFO - , with total : 877181 rows
2019-06-11 10:29:00,125 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 10.14/A30 HL & HE & F Buyers_3.csv
2019-06-11 10:29:00,128 - INFO - , with total : 877181 rows
2019-06-11 10:29:07,713 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 10.14/A30 HL & HE & F Buyers_4.csv
2019-06-11 10:29:07,713 - INFO - , with total : 877181 rows
2019-06-11 10:29:15,186 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 10.14/A30 HL & HE & F Buyers_5.csv
2019-06-11 10:29:15,186 - INFO - , with total : 877181 rows
2019-06-11 10:29:22,670 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 10.14/A30 HL & HE & F Buyers_6.csv
2019-06-11 10:29:22,674 - INFO - , with total : 877181 rows
2019-06-11 10:29:31,842 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 10.14/A30 HL & HE & F Buyers_7.csv
2019-06-11 10:29:31,844 - INFO - , with total : 877181 rows
2019-06-11 10:29:42,723 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 10.14/A30 HL & HE & F Buyers_8.csv
2019-06-11 10:29:42,723 - INFO - , with total : 877180 rows
2019-06-11 10:29:43,265 - INFO - Download sheet..
2019-06-11 10:29:43,266 - INFO - Change directory to script path
2019-06-11 10:29:44,459 - INFO - Spreadsheet downloaded
2019-06-11 10:40:17,089 - INFO - Report date: 20190611 10.40
2019-06-11 10:40:18,086 - INFO - Connect Google Sheet Successfully...
2019-06-11 10:40:19,091 - INFO - Reading Data From Google Sheet...
2019-06-11 10:40:20,790 - INFO - Download sheet..
2019-06-11 10:40:20,792 - INFO - Change directory to script path
2019-06-11 10:40:22,007 - INFO - Spreadsheet downloaded
2019-06-11 10:40:25,690 - INFO - 'Home & Living'
2019-06-11 10:40:29,812 - INFO - 'Electronics'
2019-06-11 10:40:34,276 - INFO - 'Fashion'
2019-06-11 10:40:37,181 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-11 10:40:37,186 - INFO - Number of category: 3
2019-06-11 10:40:37,188 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-11 10:40:37,194 - INFO - Last Login: 30
2019-06-11 10:40:37,197 - INFO - USING CASE 1
2019-06-11 10:40:37,198 - INFO - ERROR -> cannot concatenate 'str' and 'NoneType' objects
2019-06-11 10:44:32,990 - INFO - Report date: 20190611 10.44
2019-06-11 10:44:34,013 - INFO - Connect Google Sheet Successfully...
2019-06-11 10:44:35,017 - INFO - Reading Data From Google Sheet...
2019-06-11 10:44:35,940 - INFO - Download sheet..
2019-06-11 10:44:35,940 - INFO - Change directory to script path
2019-06-11 10:44:37,674 - INFO - Spreadsheet downloaded
2019-06-11 10:44:37,681 - INFO - Get custom SQL..
2019-06-11 10:44:42,677 - INFO - 'Home & Living'
2019-06-11 10:44:47,736 - INFO - 'Electronics'
2019-06-11 10:44:52,128 - INFO - 'Fashion'
2019-06-11 10:44:55,098 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-11 10:44:55,099 - INFO - Number of category: 3
2019-06-11 10:44:55,101 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-11 10:44:55,104 - INFO - Last Login: 30
2019-06-11 10:44:55,105 - INFO - USING CASE 1
2019-06-11 10:44:55,108 - INFO - ERROR -> cannot concatenate 'str' and 'NoneType' objects
2019-06-11 10:46:00,111 - INFO - Report date: 20190611 10.46
2019-06-11 10:46:01,206 - INFO - Connect Google Sheet Successfully...
2019-06-11 10:46:02,210 - INFO - Reading Data From Google Sheet...
2019-06-11 10:46:03,885 - INFO - Download sheet..
2019-06-11 10:46:03,888 - INFO - Change directory to script path
2019-06-11 10:46:06,096 - INFO - Spreadsheet downloaded
2019-06-11 10:46:06,105 - INFO - Get custom SQL..
2019-06-11 10:46:11,309 - INFO - 'Home & Living'
2019-06-11 10:46:14,878 - INFO - 'Electronics'
2019-06-11 10:46:20,720 - INFO - 'Fashion'
2019-06-11 10:46:24,062 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-11 10:46:24,063 - INFO - Number of category: 3
2019-06-11 10:46:24,065 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-11 10:46:24,066 - INFO - Last Login: 30
2019-06-11 10:46:24,069 - INFO - USING CASE 1
2019-06-11 10:46:24,072 - INFO - ERROR -> cannot concatenate 'str' and 'NoneType' objects
2019-06-11 10:54:20,701 - INFO - Report date: 20190611 10.54
2019-06-11 10:54:21,602 - INFO - Connect Google Sheet Successfully...
2019-06-11 10:54:22,605 - INFO - Reading Data From Google Sheet...
2019-06-11 10:54:23,513 - INFO - Download sheet..
2019-06-11 10:54:23,515 - INFO - Change directory to script path
2019-06-11 10:54:24,461 - INFO - Spreadsheet downloaded
2019-06-11 10:54:24,463 - INFO - Get custom SQL..
2019-06-11 10:54:27,565 - INFO - 'Home & Living'
2019-06-11 10:54:31,109 - INFO - 'Electronics'
2019-06-11 10:54:34,668 - INFO - 'Fashion'
2019-06-11 10:54:37,434 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-11 10:54:37,434 - INFO - Number of category: 3
2019-06-11 10:54:37,437 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-11 10:54:37,437 - INFO - Last Login: 30
2019-06-11 10:54:37,438 - INFO - USING CASE 1
2019-06-11 10:54:37,440 - INFO - Start Running query A30 HL & HE & F Buyers
2019-06-11 10:56:40,243 - INFO - Running A30 HL & HE & F Buyers Done
2019-06-11 10:56:40,246 - INFO - CSV file path: A30 HL & HE & F Buyers
2019-06-11 10:56:40,293 - INFO - Starting save the query results
2019-06-11 10:56:40,296 - INFO - Total Rows : 0
2019-06-11 10:56:40,299 - INFO - Will split into : 0.0 files
2019-06-11 10:56:40,302 - INFO - ERROR -> number sections must be larger than 0.
2019-06-11 11:22:58,331 - INFO - Report date: 20190611 11.22
2019-06-11 11:22:59,209 - INFO - Connect Google Sheet Successfully...
2019-06-11 11:23:00,210 - INFO - Reading Data From Google Sheet...
2019-06-11 11:23:01,187 - INFO - Download sheet..
2019-06-11 11:23:01,187 - INFO - Change directory to script path
2019-06-11 11:23:02,408 - INFO - Spreadsheet downloaded
2019-06-11 11:23:02,411 - INFO - Get custom SQL..
2019-06-11 11:23:02,411 - INFO - USING CASE 2
2019-06-11 11:23:05,515 - INFO - Error in get_custom_sql -> 'NoneType' object has no attribute 'group'
2019-06-11 11:24:39,822 - INFO - Report date: 20190611 11.24
2019-06-11 11:24:40,753 - INFO - Connect Google Sheet Successfully...
2019-06-11 11:24:41,755 - INFO - Reading Data From Google Sheet...
2019-06-11 11:24:42,601 - INFO - Download sheet..
2019-06-11 11:24:42,601 - INFO - Change directory to script path
2019-06-11 11:24:43,470 - INFO - Spreadsheet downloaded
2019-06-11 11:24:43,470 - INFO - Get custom SQL..
2019-06-11 11:24:43,471 - INFO - USING CASE 2
2019-06-11 11:24:46,638 - INFO - Error in get_custom_sql -> 'NoneType' object has no attribute 'group'
2019-06-11 11:25:53,986 - INFO - Report date: 20190611 11.25
2019-06-11 11:25:54,947 - INFO - Connect Google Sheet Successfully...
2019-06-11 11:25:55,950 - INFO - Reading Data From Google Sheet...
2019-06-11 11:25:56,825 - INFO - Download sheet..
2019-06-11 11:25:56,826 - INFO - Change directory to script path
2019-06-11 11:25:57,670 - INFO - Spreadsheet downloaded
2019-06-11 11:25:57,671 - INFO - Get custom SQL..
2019-06-11 11:25:57,671 - INFO - USING CASE 2
2019-06-11 11:26:00,836 - INFO - Filename: A14 W30
2019-06-11 11:26:00,838 - INFO - Last Login: 14
2019-06-11 11:26:00,841 - INFO - Date 1: 2019-06-10
2019-06-11 11:26:00,842 - INFO - Date 2: 2019-05-11
2019-06-11 11:26:00,851 - INFO - Start Running query A14 W30
2019-06-11 11:34:09,967 - INFO - Running A14 W30 Done
2019-06-11 11:34:09,967 - INFO - CSV file path: A14 W30
2019-06-11 11:34:11,348 - INFO - Starting save the query results
2019-06-11 11:34:11,349 - INFO - Total Rows : 17364197
2019-06-11 11:34:11,351 - INFO - Will split into : 18.0 files
2019-06-11 11:34:16,905 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_1.csv
2019-06-11 11:34:16,907 - INFO - , with total : 964678 rows
2019-06-11 11:34:22,335 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_2.csv
2019-06-11 11:34:22,335 - INFO - , with total : 964678 rows
2019-06-11 11:34:28,229 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_3.csv
2019-06-11 11:34:28,230 - INFO - , with total : 964678 rows
2019-06-11 11:34:34,931 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_4.csv
2019-06-11 11:34:34,934 - INFO - , with total : 964678 rows
2019-06-11 11:34:40,924 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_5.csv
2019-06-11 11:34:40,926 - INFO - , with total : 964678 rows
2019-06-11 11:34:46,857 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_6.csv
2019-06-11 11:34:46,858 - INFO - , with total : 964678 rows
2019-06-11 11:34:53,306 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_7.csv
2019-06-11 11:34:53,308 - INFO - , with total : 964678 rows
2019-06-11 11:34:59,809 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_8.csv
2019-06-11 11:34:59,815 - INFO - , with total : 964678 rows
2019-06-11 11:35:06,038 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_9.csv
2019-06-11 11:35:06,039 - INFO - , with total : 964678 rows
2019-06-11 11:35:12,592 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_10.csv
2019-06-11 11:35:12,595 - INFO - , with total : 964678 rows
2019-06-11 11:35:19,263 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_11.csv
2019-06-11 11:35:19,265 - INFO - , with total : 964678 rows
2019-06-11 11:35:25,572 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_12.csv
2019-06-11 11:35:25,572 - INFO - , with total : 964677 rows
2019-06-11 11:35:31,786 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_13.csv
2019-06-11 11:35:31,788 - INFO - , with total : 964677 rows
2019-06-11 11:35:39,467 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_14.csv
2019-06-11 11:35:39,469 - INFO - , with total : 964677 rows
2019-06-11 11:35:45,200 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_15.csv
2019-06-11 11:35:45,201 - INFO - , with total : 964677 rows
2019-06-11 11:35:51,118 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_16.csv
2019-06-11 11:35:51,118 - INFO - , with total : 964677 rows
2019-06-11 11:35:56,769 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_17.csv
2019-06-11 11:35:56,770 - INFO - , with total : 964677 rows
2019-06-11 11:36:02,693 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.25/A14 W30_18.csv
2019-06-11 11:36:02,694 - INFO - , with total : 964677 rows
2019-06-11 11:40:35,339 - INFO - Report date: 20190611 11.40
2019-06-11 11:40:36,417 - INFO - Connect Google Sheet Successfully...
2019-06-11 11:40:37,420 - INFO - Reading Data From Google Sheet...
2019-06-11 11:40:38,319 - INFO - Download sheet..
2019-06-11 11:40:38,319 - INFO - Change directory to script path
2019-06-11 11:40:39,642 - INFO - Spreadsheet downloaded
2019-06-11 11:40:39,644 - INFO - Get custom SQL..
2019-06-11 11:40:39,644 - INFO - USING CASE 3
2019-06-11 11:40:44,250 - INFO - 'Home & Living'
2019-06-11 11:40:47,811 - INFO - 'Fashion'
2019-06-11 11:40:50,585 - INFO - Filename: A30 HL  F Buyers W30
2019-06-11 11:40:50,585 - INFO - Number of category: 2
2019-06-11 11:40:50,588 - INFO - All category: 'Home & Living','Fashion'
2019-06-11 11:40:50,589 - INFO - Last Login: 30
2019-06-11 11:40:50,592 - INFO - Date 1: 2019-06-10
2019-06-11 11:40:50,592 - INFO - Date 2: 2019-05-11
2019-06-11 11:40:50,595 - INFO - 
                    with a as(
                    select distinct
                                u.userid
                                from user_profile as u
                                join order_mart__order_item_profile as p
                                on u.userid = p.userid
                                where
                                p.main_category in ('Home & Living','Fashion')
                                and
                                last_login >= current_date - interval '30' day
                                and
                                u.status = 1
                                and
                                is_buyer = 1
                    ),

                    --shopped for the last 30 days
                    b as
                    (
                    select distinct
                    userid
                    from order_mart__order_item_profile
                    where grass_date between date'2019-06-10' and date'2019-05-11'
                    )

                    --final
                    select distinct
                    concat('user_id=',cast(a.userid as varchar)) list_userid
                    from a
                    left join b
                    on a.userid = b.userid
                    where b.userid is null
                    
2019-06-11 11:40:50,601 - INFO - Start Running query A30 HL  F Buyers W30
2019-06-11 11:44:13,907 - INFO - Running A30 HL  F Buyers W30 Done
2019-06-11 11:44:13,907 - INFO - CSV file path: A30 HL  F Buyers W30
2019-06-11 11:44:14,325 - INFO - Starting save the query results
2019-06-11 11:44:14,326 - INFO - Total Rows : 5671936
2019-06-11 11:44:14,328 - INFO - Will split into : 6.0 files
2019-06-11 11:44:18,871 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.40/A30 HL  F Buyers W30_1.csv
2019-06-11 11:44:18,871 - INFO - , with total : 945323 rows
2019-06-11 11:44:23,345 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.40/A30 HL  F Buyers W30_2.csv
2019-06-11 11:44:23,345 - INFO - , with total : 945323 rows
2019-06-11 11:44:28,178 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.40/A30 HL  F Buyers W30_3.csv
2019-06-11 11:44:28,180 - INFO - , with total : 945323 rows
2019-06-11 11:44:34,229 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.40/A30 HL  F Buyers W30_4.csv
2019-06-11 11:44:34,229 - INFO - , with total : 945323 rows
2019-06-11 11:44:39,920 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.40/A30 HL  F Buyers W30_5.csv
2019-06-11 11:44:39,920 - INFO - , with total : 945322 rows
2019-06-11 11:44:45,325 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.40/A30 HL  F Buyers W30_6.csv
2019-06-11 11:44:45,326 - INFO - , with total : 945322 rows
2019-06-11 11:46:20,795 - INFO - Report date: 20190611 11.46
2019-06-11 11:46:21,740 - INFO - Connect Google Sheet Successfully...
2019-06-11 11:46:22,743 - INFO - Reading Data From Google Sheet...
2019-06-11 11:46:23,713 - INFO - Download sheet..
2019-06-11 11:46:23,713 - INFO - Change directory to script path
2019-06-11 11:46:25,015 - INFO - Spreadsheet downloaded
2019-06-11 11:46:25,016 - INFO - Get custom SQL..
2019-06-11 11:46:25,016 - INFO - USING CASE 1
2019-06-11 11:46:28,121 - INFO - 'Home & Living'
2019-06-11 11:46:31,680 - INFO - 'Electronics'
2019-06-11 11:46:35,460 - INFO - 'Fashion'
2019-06-11 11:46:38,246 - INFO - Filename: A30 HL & HE & F Buyers
2019-06-11 11:46:38,249 - INFO - Number of category: 3
2019-06-11 11:46:38,250 - INFO - All category: 'Home & Living','Electronics','Fashion'
2019-06-11 11:46:38,253 - INFO - Last Login: 30
2019-06-11 11:46:38,257 - INFO - 
                    select distinct
                                concat('user_id=',cast(u.userid as varchar)) list_userid
                                from user_profile as u
                                join order_mart__order_item_profile as p
                                on u.userid = p.userid
                                where
                                p.main_category in ('Home & Living','Electronics','Fashion')
                                and
                                last_login >= current_date - interval '30' day
                                and
                                u.status = 1
                                and
                                u.is_buyer = 1
                    
2019-06-11 11:46:38,265 - INFO - Start Running query A30 HL & HE & F Buyers
2019-06-11 11:50:28,081 - INFO - Running A30 HL & HE & F Buyers Done
2019-06-11 11:50:28,082 - INFO - CSV file path: A30 HL & HE & F Buyers
2019-06-11 11:50:28,608 - INFO - Starting save the query results
2019-06-11 11:50:28,609 - INFO - Total Rows : 7032704
2019-06-11 11:50:28,611 - INFO - Will split into : 8.0 files
2019-06-11 11:50:32,914 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.46/A30 HL & HE & F Buyers_1.csv
2019-06-11 11:50:32,915 - INFO - , with total : 879088 rows
2019-06-11 11:50:37,404 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.46/A30 HL & HE & F Buyers_2.csv
2019-06-11 11:50:37,404 - INFO - , with total : 879088 rows
2019-06-11 11:50:42,226 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.46/A30 HL & HE & F Buyers_3.csv
2019-06-11 11:50:42,226 - INFO - , with total : 879088 rows
2019-06-11 11:50:47,265 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.46/A30 HL & HE & F Buyers_4.csv
2019-06-11 11:50:47,266 - INFO - , with total : 879088 rows
2019-06-11 11:50:52,298 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.46/A30 HL & HE & F Buyers_5.csv
2019-06-11 11:50:52,299 - INFO - , with total : 879088 rows
2019-06-11 11:50:57,322 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.46/A30 HL & HE & F Buyers_6.csv
2019-06-11 11:50:57,329 - INFO - , with total : 879088 rows
2019-06-11 11:51:02,378 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.46/A30 HL & HE & F Buyers_7.csv
2019-06-11 11:51:02,380 - INFO - , with total : 879088 rows
2019-06-11 11:51:07,415 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 11.46/A30 HL & HE & F Buyers_8.csv
2019-06-11 11:51:07,417 - INFO - , with total : 879088 rows
2019-06-11 12:00:57,842 - INFO - Report date: 20190611 12.00
2019-06-11 12:00:57,851 - INFO - Download sheet..
2019-06-11 12:00:57,851 - INFO - Change directory to script path
2019-06-11 12:05:12,970 - INFO - Report date: 20190611 12.05
2019-06-11 12:07:33,496 - INFO - Report date: 20190611 12.07
2019-06-11 12:07:34,503 - INFO - Connect Google Sheet Successfully...
2019-06-11 12:07:34,509 - INFO - Download sheet..
2019-06-11 12:07:34,509 - INFO - Change directory to script path
2019-06-11 12:07:35,688 - INFO - Spreadsheet downloaded
2019-06-11 12:07:38,582 - INFO - [u'Payment Live Check Tools', u'Pasti Ada Reporting Tracker', u'Elhijab Brand Review 2019', u'Shopee Liga 1 Free Ticket Tracker', u'cherrybabykidsshop Brand Review 2018', u'theona.tata Brand Review 2018', u'Fraud Live Check Tools', u'PN - Comm Input', u'Clodistore Brand Review 2018', u'mommynmeshop Brand Review 2018', u'Indoultimate Brand Review 2018', u'CFS - Daily SKU Rule Tracker', u'Intraday BI Working File', u'Ramadhan - Price Competitiveness Report', u'Ramadhan - Collection & Paying Seller Tracker', u'7.7 Hujan Promo Collection & Exclusivity Tracker', u'SBS Actual Order', u'Ramadhan - Shopee Paid: Seller Voucher Report', u'Shopee Liga 1 - Dashboard', u'24 Feb PROSES - Pasti Ada (Not in use)', u'Ramadhan - Done Deal SKU List', u'SBS Flash Sale List', u'[Ingestion] Net Denominator', u'marketing-metrics-6Jun2019', u'List of WHS-IDG OOS Order SN', u'DMM Import Range', u'Pasti Ada UserID Generator', u'Locknlock Brand Review 2019', u'kol performance analytics', u'One Dollar Game', u'dmm try', u'ID BI Auto Email Address Book', u'SPX - Daily Notification', u'Mayora Brand Review 2018', u'Mondemart Brand Review 2018 v2', u'7.7 Sale 2019 Dashboard', u'Seller Management - Weekly Short Tail Managed Sellers Tracking ', u'Shakyla_foodstore Brand Review 2018', u'BRS May 24 Big Ramadhan Sale - L1 Submission Template', u'SPX - COD Fee', u'BRS May 23 May Super Gratis Ongkir Day - L1 Submission Template', u'Nutrifood Brand Review 2018 v2', u'Feed Tracker and Report', u'Garudafood Brand Review v2 2018', u'Garudafood Brand Review 2018', u'Nestle Brand Review v2', u'Snack.mazter Brand Review 2018', u'Kurmaalif Brand Review 2018', u'Alfamart Projection 2019', u'Pickup Sellers - SPX Ops', u'Platformwide - New Users & Male Users Dashboard', u'Naturesmarket.id Brand Review 2018 v2', u'Unilever Performance Dashboard', u"L'Oreal Performance Dashboard", u'SKU Less Review Tracker', u'Collection Performance Report - Data Requirements', u'Kurmaalif Brand Review 2019', u'Ramadhan 2019 - SKU Readiness Tracker', u'Pasti Ada - Daily Performance Report (March-June)', u'Pasti Ada - Daily Performance Report (Apr-May) Calculation - RAW', u'Big Ramadhan Sale Dashboard (BD)', u'April 2019PilihShopee - Collection & Exclusivity Tracker', u'Pasti Ada - BI Master Sheet', u'Fraud Live Check Tools - 2', u'Payment Live Check Tools (Recovered)', u'Payment Live Check Tools (Recovered)', u'Fraud Live Check Tools (Recovered)', u'Shopee LIGA 1 2019 - Voting Page Design & Asset', u'shopee_id_sku_1_dollar_game', u'Big Ramadhan Sale Dashboard', u'SPX Regional Performance - Weekly', u'Loreal Beauty Assistant Report 2', u'BRS June 1-5 Clearance Sale - L1 Submission Template', u'Garudafood Brand Review 2019', u'Nestle Brand Review 2019', u'Mondemart Brand Review 2019', u'1-6 June - L2 Category Submission', u'Nutrimart Brand Review 2019', u'BRS Jun 6 Dobel dobel - L1 Submission Template', u'Mayora Brand Review 2019', u'Gramedia Brand Review 2019', u'Wacoal Brand Review 2019', u'COD Activated Sellers (MS,OS,SBS,CB) x (J&T and CB)', u'The Executive Brand Review 2019', u'Innisfree Brand Review 2019', u'Wacoal Brand Review 2018', u'[Template] Brand Review 2019', u'autoingestion_temp_list', u'BRS May 31 Digital Sale - L1 Submission Template', u'BRS May 30 Shopee 24 Sale - L1 Submission Template', u'Snack.mazter Brand Review 2019', u'Shakyla_foodstore Brand Review 2019', u'30 May - L2 Category Submission', u'The Executive Brand Review 2018', u'Naturesmarket.id Brand Review 2019', u'Nourish Indonesia Brand Review 2019', u'Colorbox Brand Review 2019', u'Asset Homepage v2.0', u'BRS Apr 28 Hobby & Sports Sale - L1 Submission Template', u'sample query map', u'Consolidated RB Brand Review 2019 v2', u'Shopee Serba 10.000 - SM x Voucher Tracker', u'15 Mar 2019 Proses', u'Shopee x Shazam - MKT Master Sheet', u'Male Tracker', u'BRS May 29 Super Flash Sale - L1 Submission Template', u'One Dollar Game - ID TV Show - 23 May 2019', u'Top 25 Tokopedia Sellers', u'Rollover Reaction Brand Review 2019', u'27 May - L2 Category Submission', u'BRS May 27 Fashion Sale - L1 Submission Template', u'[AUTOMATION] Username LIGA 1', u'ShopeePay Daily Performance Report', u'Nature Republic Brand Review 2019', u'Unicharm Brand Review 2019', u'BRS May 26 Electronic Sale - L1 Submission Template', u'BRS May 25 Digital Sale - L1 Submission Template', u'AUTOMATION_TESTING', u'Loreal Brand Review 2019', u'BRS Apr 22 Cashback day - L1 Submission Template', u'IIMS Ticket Performance Tracker', u'24 May - L2 Category Submission', u'BRS May 22 Super Flash Sale - L1 Submission Template', u'Voucher Information Consolidated - Non Rekan Shopee (exclude Pasti Ada, GHT, Seller Absorbed)', u'Banana Boat Brand Review 2019', u'Banana Boat Brand Review 2018', u'Bioderma Brand Review 2019', u'Nivea Brand Review 2019', u'Zoya Brand Review 2019', u'Enchanteur Brand Review 2019', u'The Body Shop Brand Review 2019', u'Erha Brand Review 2019', u'Herbana Brand Review 2019', u'BRS Apr 23 Super Goyang Day - L1 Submission Template', u'BRS May 19 Serba 10RB Day - L1 Submission Template', u'Bosch Home and Living Brand Review 2019', u'Bosch Automotive Brand Review 2019', u'Quaker Brand Review 2019', u'Community Weekly Report - Shop ID Ingestion', u'Indofood Brand Review 2019', u'Pepsi Brand Review 2019', u'BRS May 21 Home & Living Sale - L1 Submission Template', u'All Job in Pricing Center', u'BRS May 20 Voucher Day - L1 Submission Template', u'Colgate Palmolive Brand Review 2019', u'BRS May 18 Supermarket Sale - L1 Submission Template', u'WP Cancellation', u'Wings Brand Review 2019', u'BRS May 5 Dobel dobel - L1 Submission Template', u'Bio Essence Brand Review 2019', u'Make Over Brand Review 2019', u'Safi Brand Review 2019', u'Wardah Brand Review 2019', u'Cetaphil Brand Review 2019', u'Watsons Brand Review 2019', u'Missha Brand Review 2019', u'BRS May 17 Super Gratis Ongkir day - L1 Submission Template', u'25 May - L2 Category Submission', u'NYX Brand Review 2019', u'Garnier Brand Review 2019', u'Maybelline Brand Review 2019', u'Sensatia Botanicals Brand Review 2019', u'BRS May 15 Shopee Mall Sale - L1 Submission Template', u'Philips Brand Review 2019', u'Laneige Brand Review 2019', u'Emina Brand Review 2019', u'25 Feb PROSES - Pasti Ada (not in use)', u'8 -9  Mar 2019 Proses', u'1-11 Feb PROSES - Pasti Ada ', u'BRS May 14 Electronic Sale - L1 Submission Template', u'11 Mar 2019 [Pasti Ada Day] Proses B', u'16 May - L2 Category Submission', u'Bayer Brand Review 2019', u'BRS May 13 Fashion Sale - L1 Submission Template', u'Samsung Brand Review 2019', u'Cotton Combed Brand Review 2019', u'9 May - L2 Category Submission', u'BRS May 6 Cashback Day - L1 Submission Template', u'BRS May 12 Food & Home Sale - L1 Submission Template', u'Ramadhan Leaderboard Script', u'Upload to Backend Tracker - 26th - 27th April', u'Upload to Backend Tracker - 26th - 27th April', u'1-2 April 2019 Proses', u'BRS May 10 Kuis Shopee day - L1 Submission Template', u'20 May - L2 Category Submission', u'10-15Apr 2019 Proses', u'BRS May 11 Home Electronics Sale - L1 Submission Template', u'13 May - L2 Category Submission', u'Babymax Brand Review 2019', u'Baby Ktan Brand Review 2019', u'Huggies Brand Review 2019', u'Hydromama Brand Review 2019', u'BRS May 8 Super Flash Sale Day - L1 Submission Template', u'BRS May 4 Super Men Sale - L1 Submission Template', u'Happy Diapers Brand Review 2019', u'Kao Brand Review 2019', u'Pigeon Brand Review 2019', u'Pasti Ada - Daily Performance Report (March) Calculation', u'BRS May 7 Super Goyang Day - L1 Submission Template', u'BRS May 3 Mom & Kids Sale - L1 Submission Template', u'P&G Brand Review 2019', u'6 - 7 Apr 2019 Proses', u'04-05 Apr 2019 Proses', u'3 Apr 2019 Proses', u'8-9 Apr 2019 Proses', u'Pasti Ada - Daily Performance Report (February)', u'Pasti Ada - Daily Performance Report (January)', u'1 - 2 Mar 2019 Proses', u'3 Mar 2019 Proses', u'Upload to Backend Tracker - 24th - 25th April', u'Upload to Backend Tracker - 23th April', u'Upload to Backend Tracker - 22th April', u'Upload to Backend Tracker - 20th - 21th April', u'Upload to Backend Tracker - 18th - 19th April', u'Upload to Backend Tracker - 16th - 17th April', u'Upload to Backend Tracker - 14th - 15th April', u'Upload to Backend Tracker - 12nd - 13th April', u'Upload to Backend Tracker - 10th - 11th April', u'Upload to Backend Tracker - 8th - 9th April', u'Pasti Ada - Daily Performance Report (March) Calculation v2', u'26 - 28 Feb PROSES - Pasti Ada ', u'18-25 Feb PROSES - Pasti Ada ', u'12 - 17 Feb PROSES - Pasti Ada ', u'6 May - L2 Category Submission', u'Pasti Ada - Daily Performance 1.1', u'11 Mar 2019 [Pasti Ada Day] Proses A', u'30 - 31 Mar 2019 Proses', u'29 Mar 2019 Proses', u'26-28 Mar 2019 Proses', u'25 Mar 2019 Proses ', u'24 Mar 2019 Proses ', u'22 - 23 Mar 2019 Proses ', u'20 - 21 Mar 2019 Proses', u'19 Mar 2019 Proses', u'10 Mar 2019 Proses', u'18 Mar 2019 Proses', u'7 Mar 2019 Proses', u'17 Mar 2019 Proses ', u'16 Mar 2019 Proses', u'6 Mar 2019 Proses', u'5 Mar 2019 Proses', u'14 Mar 2019 Proses', u'4 Mar 2019 Proses', u'13 Mar 2019 Proses', u'12 Mar 2019 Proses', u'Collection Review', u'BRS Apr 27 COD Day - L1 Submission Template', u'Combine Publish Link', u'BRS May 2 Fashion Muslim Sale - L1 Submission Template', u'Unilever Brand Review 2019', u'Softex Indonesia Brand Review 2019', u'22 Apr - L2 Category Submission', u'Category Fair Exclusivity (March-Dec 2019) KPIs Collection Tracker', u'BRS May 1 Super Flash Sale Day - L1 Submission Template', u'BRS April 25 Otomotif Sale - L1 Submission Template', u'BRS Apr 30 Beauty Sale - L1 Submission Template', u'BRS Apr 26 Digital Sale - L1 Submission Template', u'BRS Apr 24 Super Flash Sale Day - L1 Submission Template', u'29 Apr - L2 Category Submission', u'Retail item with Shopee Item Rebate', u'Hot Wheels Brand Review 2019', u'Thomas & Friends Brand Review 2019', u'Nameera Brand Review 2019', u'Lakme Brand Review 2019', u'Fisherprice Brand Review 2019', u'Barbie Brand Review 2019', u'Pasti Ada - Daily Performance Report (February) Calculation', u"Philips Brand Review 2019 (don't use this)", u'RAW - Pasti Ada', u'S-Mart Brand Review 2019', u'Frisian Flag _ Friso Brand Review 2019', u'Tefal Brand Review 2018', u'Frisian Flag Brand Review 2018', u'3M Brand Review 2019', u'Exercise File_ Automation with Input from GS', u'3M Brand Review 2018', u'Item List For Stock Tracker', u'Exercise File_ Automation with Input from GS', u'Exercise File_ Automation with Input from GS', u'Exercise File_ Automation with Input from GS', u'Exercise File_ Automation with Input from GS', u'Exercise File: Automation with Input from GS', u'Exercise File_ Automation with Input from GS', u'Shopee Mall Tracker', u'2 May - L2 Category Submission', u'Nutrilon Brand Review 2019', u'Bebelac Brand Review 2019', u'SGM Brand Review 2019', u'Fitti-Certainty Brand Review 2019', u'Logo Jeans Brand Review 2018', u'29 Apr - L2 Category Submission', u'22 Apr - L2 Category Submission', u'25 Apr - L2 Category Submission', u'Report_Auto_v4 gsheet', u'Microsite & Comm tracker 6-7 Apr', u'Microsite & Comm tracker 30 - 31 Mar', u'nug retention tracking', u'Microsite & Comm tracker 04 - 05 Apr', u'11 Apr 2019 Proses', u'Johnson & Johnson Brand Review 2019', u'Microsite & Comm tracker 03 Apr', u'Microsite & Comm tracker 1 - 2 Apr', u'Microsite & Comm tracker 6  Mar', u'Microsite & Comm tracker 8 Apr', u'Microsite & Comm tracker 26-28 Mar', u'Microsite & Comm tracker 29 Mar', u'HBC - Brand Study Query Generator', u'Microsite & Comm tracker 1 -2 Mar', u'Microsite & Comm tracker 22 - 23 Mar', u'SPX - Delivered and Return Data', u'Microsite & Comm tracker 25 Mar', u'Microsite & Comm tracker 24 Mar', u'Pasti Ada - Daily Performance Report (March) Calculation v2', u'Microsite & Comm tracker 15 Mar', u'Microsite & Comm tracker 17 Mar', u'10 Feb PROSES - Pasti Ada ', u'SBS End to End Process Backlog Monitoring', u'Microsite & Comm tracker 12 Mar', u'Microsite & Comm tracker 20 -21 mar', u'Logitech Brand Review 2019', u'HP Brand Review 2018 v2', u'HP Brand Review 2019', u'Microsite & Comm tracker 18 Mar', u'28 Mar 2019 Proses', u'Microsite & Comm tracker 28 Mar', u'Microsite & Comm tracker 19 mar', u'Microsite & Comm tracker 16 Mar', u'Lenovo Brand Review 2019', u'Lenovo Brand Review v2 2018', u'Nutrifood Brand Review 2019', u'Unilever Food Brand Review 2019', u'Unilever Food Brand Review 2018', u'Logitech Brand Review v2', u'Tempo Store Brand Review 2019', u'Microsite & Comm tracker 10 Mar', u'ShopeeMall - Weekly Top Sellers Report', u'Test Sheet', u'Pasti Ada - Compact', u'Shopee x Slank - MKT Master Sheet', u'Microsite & Comm tracker 14 Mar', u'Microsite & Comm tracker 11 Mar B', u'WD Brand Review 2019', u'WD Brand Review v2 2018', u'Copy of 11 Mar 2019 Proses (Blank)', u'Sandisk Brand Review 2019', u'JBL Brand Review 2019', u'Sandisk Brand Review v2 2018', u'JBL Brand Review 2018 v2', u'Asus Brand Review 2018 v2', u'Samsung Brand Review 2018 v6', u'Asus Brand Review 2019', u'Huggies Brand Review 2018', u'[Template] Brand Review v2', u'Mustika Ratu Brand Review 2018', u'Kangaroo Brand Review 2018', u'Kangaroo Brand Review 2019', u'Microsite & Comm tracker 13 Mar', u'Nourish Indonesia Brand Review 2018', u'House Of Organix Brand Review 2018', u'Namaste Organic Brand Review 2018', u'Pepsi Brand Review 2018', u'Nivea Brand Review 2018 v2', u'Indofood Brand Review 2018', u'Quaker Brand Review 2018', u'Microsite & Comm tracker 11 Mar A', u'20 Mar 2019 Proses', u'Bagusmart Brand Review 2019', u'Brand Review Bagusmart 2018', u'Campina Ice Cream Brand Review 2018', u'SBS - SKU Purchase Type Automate', u'Campina Ice Cream Brand Review 2019', u'Microsite & Comm tracker 8 - 9  Mar', u'Microsite & Comm tracker 7  Mar', u'NYX.id Beauty Assistant Report', u'Bantex Brand Revieww 2017', u'Bantex Brand Revieww 2018', u'Microsite & Comm tracker 5  Mar', u'Bantex Brand Review 2018', u'Bantex Brand Review 2017', u'Bantex Brand Review 2017', u'Bantex Brand Review 2018', u'Campaign Collection Tracking - BI cleaned', u'Microsite & Comm tracker 4 Mar', u'Microsite & Comm tracker  3 Mar', u'Copy of Microsite & Comm tracker (Blank)', u'Make Over Brand Review 2018 v3', u'Emina Brand Review 2018 v2', u'23 Feb PROSES - Pasti Ada (Not in use)', u'Microsite & Comm tracker 23 Feb ', u'22 Feb PROSES - Pasti Ada (not in use)', u'21 Feb PROSES - Pasti Ada (Not in use)', u'10 Mar 2019 Proses (Recovered)', u'Wings Brand Review 2018 v2', u'Microsite & Comm tracker 26 - 28 Feb ', u'Kao Ofiicial Brand Review 2018', u'Microsite & Comm tracker  18-20 Feb', u'Microsite & Comm tracker 21 Feb ', u'Microsite & Comm tracker 25 Feb ', u'This is April Brand Review 2018', u'Vanish Brand Review 2018', u'Vanish Brand Review 2019', u'Microsite & Comm tracker 22 Feb ', u'Microsite & Comm tracker 1 Mar', u'Microsite & Comm tracker 24 Feb ', u'GatsuOne Brand Review 2018', u'Asus Brand Review', u'Arnotts Brand Review 2019', u'Gatsuone Brand Review 2019', u'Trial Pickup Sellers - SPX Ops', u'Watson Brand Review 2018 v2', u'Philips Brand Review 2018 v4', u'Medela Brand Review 2019', u'Medela Brand Review 2018', u'Kotex Indonesia Brand Review 2018', u'Test Male Tracker Automation', u'14 Feb PROSES - Pasti Ada ', u'13 Feb PROSES - Pasti Ada ', u'15 Feb PROSES - Pasti Ada ', u'17 Feb PROSES - Pasti Ada ', u'16 Feb PROSES - Pasti Ada ', u'Arnotts Brand Review 2018', u'Softex Indonesia Brand Review 2018', u'Kintakun Brand Review 2019', u'Kintakun Brand Review 2018 v2', u'Locknlock Brand Review 2018', u'11B Feb PROSES - Pasti Ada ', u'11A Feb PROSES - Pasti Ada ', u'Keds Brand Review 2018', u'Colorbox Brand Review 2018', u'Johnson & Johnson Brand Review 2018 v2', u'Vivo Brand Review 2018', u'9 Feb PROSES - Pasti Ada ', u'8 Feb PROSES - Pasti Ada ', u'7 Feb PROSES - Pasti Ada ', u'6 Feb PROSES - Pasti Ada ', u'Friso Brand Review 2018', u'Pearson Indonesia Brand Review 2018', u'Mall BTM Bogor Brand Review 2018', u'Wakai Brand Review 2018', u'Tempo Store Brand Review 2018', u'm', u'SBS Chat Escalation Monitoring', u'FMCG - Adhoc Brand Report', u'Draft - Pasti Ada - Daily Performance Report (February)', u'The Little Things She Needs Brand Review 2018', u'Urbanco Brand Review 2018', u'Elzatta Brand Review 2018', u'Daily - SBS IDG WH Operational Data', u'Dauky Brand Review 2018', u'Pokana Brand Review 2018', u'Tracking Summary Exception Case & Refund OOS', u'Elzatta & Dauky Brand Review 2018', u'Makarizo Brand Review 2018', u'Erigo Brand Review 2018', u'Dr. Kevin Brand Review 2018 v2', u'Edwin Jeans Brand Review 2018', u'Pasti Ada - Daily Performance Report', u'Mattel Brand Review 2018', u'MacBear.id Brand Review 2018', u'Emart Brand Review 2018 v2', u'Purina Brand Review 2018', u'Coocaa Brand Review 2018', u'ID Local - Group Buy Report', u'Emart Brand Review', u'Wardah Brand Review 2018 v2', u'Pedigree Brand Review 2018', u'Whiskas Brand Review 2018', u'Fonterra Brand Review 2018', u'Zaskia Mecca Brand Review 2018', u'Sensatia Botanicals Brand Review 2018', u'Bayer Brand Review 2018 v2', u'Cetaphil Brand Review 2018', u'Paperone Brand Review 2018', u'Zoya Brand Review 2018', u'Missha Brand Review 2018', u'Curren Brand Review 2018', u'SKMEI Brand Review 2018', u'Innisfree Brand Review 2018', u'Bosch Automotive Brand Review 2018 v2', u'Kappa Brand Review 2018', u'Fila Brand Review 2018', u'Everbest Group Brand Review 2018', u'Berrybenka Brand Review 2018', u'Navy Club Brand Review 2018', u'Nature Republic Brand Review 2018', u'Consolidated RB Store Brand Review 2018 v2', u'IDG FMCG - UPC Management', u'Royal Canin Brand Review 2018', u'Bosch Home & Living Brand Review 2018', u'Seagate Brand Review 2018', u'Panasonic Brand Review 2018', u'Colgate Brand Review 2018', u'SPX - Daily Raw Data', u'Carvil Brand Review 2018 v2', u'Rayban Brand Review 2018', u'Oakley Brand Review 2018', u'Lois Jeans Brand Review 2018', u'Li-Ning Brand Review 2018', u'Wrangler Brand Review 2018', u'Maxim Brand Review 2018', u'Pillow People Brand Review 2018', u'XL Brand Review 2018', u'Megan by Sophie Paris Brand Review 2018', u'Lakme Brand Review 2018 v4', u'Alibi Paris Brand Review 2018', u'Laneige Brand Review 2018 v2', u'Rexus Brand Review 2018', u'RB Brand Review 2018 v2', u'MSI Brand Review 2018', u'Dettol Brand Review 2018 v2', u'MSI Brand Review 2018', u'Aukey Brand Review 2018', u'LG Official Store Brand Review', u'Infinix Brand Review 2018', u'P&G Brand Review 2018 v3', u'COD Activated Sellers', u'Philips Brand Review 2018 v3', u'The Body Shop Brand Review 2018 v2', u'Samsung Brand Review 2018 v5', u'Loreal Brand Review 2018 v3', u'Unilever Brand Review 2018 v3', u'Anker Brand Review', u'Samsung Brand Review 2018 v3', u'Loreal Beauty Assistant Report', u'Platformwide - Daily Cashback Voucher Performance Report', u'Mothercare Brand Review 2018', u'Havaianas Brand Review v2', u'Nuby Brand Review', u'WMS - Daily Inventory History', u'Abbot Brand Review v2', u'WMS - Daily OOS Data', u'Bio Essence Brand Review 2018', u'Safi Brand Review 2018', u'Brodo Brand Review 2018 v2', u"Levi's Brand Review 2018 v2", u'Bebelac Brand Review v2', u'SGM Brand Review', u'Nutrilon Brand Review', u'Fitti-Certainty Brand Review v2', u'Unicharm Brand Review', u'Miniso Brand Review v2', u'Miniso Brand Review', u'Kintakun Brand Review v2', u'Samyangheonz Brand Review', u'Biarfit Brand Review v2', u'Nabati Brand Review', u"L'Oreal Performance Dashboard Testing", u'List of CB Shop', u'Upload data']
2019-06-11 12:07:39,638 - INFO - Reading Data From Google Sheet...
2019-06-11 12:31:39,492 - INFO - Report date: 20190611 12.31
2019-06-11 12:31:40,467 - INFO - Connect Google Sheet Successfully...
2019-06-11 12:31:40,473 - INFO - Download sheet..
2019-06-11 12:31:40,473 - INFO - Change directory to script path
2019-06-11 12:31:41,569 - INFO - Spreadsheet downloaded
2019-06-11 12:31:41,569 - INFO - Checking sheet..
2019-06-11 12:31:57,262 - INFO - Report date: 20190611 12.31
2019-06-11 12:31:58,259 - INFO - Connect Google Sheet Successfully...
2019-06-11 12:31:58,266 - INFO - Error: G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 12.31/ - The directory is not empty.
2019-06-11 12:32:12,687 - INFO - Report date: 20190611 12.32
2019-06-11 12:32:13,634 - INFO - Connect Google Sheet Successfully...
2019-06-11 12:32:13,641 - INFO - Download sheet..
2019-06-11 12:32:13,642 - INFO - Change directory to script path
2019-06-11 12:32:14,637 - INFO - Spreadsheet downloaded
2019-06-11 12:32:14,638 - INFO - Checking sheet..
2019-06-11 12:32:36,589 - INFO - Report date: 20190611 12.32
2019-06-11 12:32:37,618 - INFO - Connect Google Sheet Successfully...
2019-06-11 12:32:37,624 - INFO - Error: G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 12.32/ - The directory is not empty.
2019-06-11 12:34:19,002 - INFO - Report date: 20190611 12.34
2019-06-11 12:34:19,996 - INFO - Connect Google Sheet Successfully...
2019-06-11 12:34:20,003 - INFO - Download sheet..
2019-06-11 12:34:20,003 - INFO - Change directory to script path
2019-06-11 12:34:21,035 - INFO - Spreadsheet downloaded
2019-06-11 12:34:21,036 - INFO - Checking sheet..
2019-06-11 12:34:29,756 - INFO - Reading Data From Google Sheet...
2019-06-11 12:34:30,555 - INFO - Get custom SQL..
2019-06-11 12:34:30,558 - INFO - USING CASE 3
2019-06-11 12:34:35,180 - INFO - 'Home & Living'
2019-06-11 12:34:38,740 - INFO - 'Fashion'
2019-06-11 12:34:41,551 - INFO - Filename: A30 HL F Buyers W30
2019-06-11 12:34:41,552 - INFO - Number of category: 2
2019-06-11 12:34:41,555 - INFO - All category: 'Home & Living','Fashion'
2019-06-11 12:34:41,555 - INFO - Last Login: 30
2019-06-11 12:34:41,556 - INFO - Date 1: 2019-06-10
2019-06-11 12:34:41,558 - INFO - Date 2: 2019-05-11
2019-06-11 12:34:41,563 - INFO - Query:

                    with a as(
                    select distinct
                                u.userid
                                from user_profile as u
                                join order_mart__order_item_profile as p
                                on u.userid = p.userid
                                where
                                p.main_category in ('Home & Living','Fashion')
                                and
                                last_login >= current_date - interval '30' day
                                and
                                u.status = 1
                                and
                                is_buyer = 1
                    ),

                    --shopped for the last 30 days
                    b as
                    (
                    select distinct
                    userid
                    from order_mart__order_item_profile
                    where grass_date between date'2019-06-10' and date'2019-05-11'
                    )

                    --final
                    select distinct
                    concat('user_id=',cast(a.userid as varchar)) list_userid
                    from a
                    left join b
                    on a.userid = b.userid
                    where b.userid is null
                    
2019-06-11 12:34:41,568 - INFO - Start Running query A30 HL F Buyers W30
2019-06-11 13:49:01,051 - INFO - Report date: 20190611 13.49
2019-06-11 13:49:01,973 - INFO - Connect Google Sheet Successfully...
2019-06-11 13:49:01,983 - INFO - Download sheet..
2019-06-11 13:49:01,984 - INFO - Change directory to script path
2019-06-11 13:49:03,414 - INFO - Spreadsheet downloaded
2019-06-11 13:49:03,417 - INFO - Checking sheet..
2019-06-11 13:49:12,207 - INFO - Reading Data From Google Sheet...
2019-06-11 13:50:17,538 - INFO - Report date: 20190611 13.50
2019-06-11 13:50:18,440 - INFO - Connect Google Sheet Successfully...
2019-06-11 13:50:18,447 - INFO - Download sheet..
2019-06-11 13:50:18,447 - INFO - Change directory to script path
2019-06-11 13:50:19,486 - INFO - Spreadsheet downloaded
2019-06-11 13:50:19,486 - INFO - Checking sheet..
2019-06-11 13:50:28,255 - INFO - Reading Data From Google Sheet...
2019-06-11 13:50:29,016 - INFO - Get custom SQL..
2019-06-11 13:50:29,017 - INFO - USING CASE 2
2019-06-11 13:50:32,148 - INFO - Filename: A14 W30
2019-06-11 13:50:32,151 - INFO - Last Login: 14
2019-06-11 13:50:32,153 - INFO - Date 1: 2019-06-10
2019-06-11 13:50:32,154 - INFO - Date 2: 2019-05-11
2019-06-11 13:50:32,157 - INFO - Query:
 
                    with a as(
                    select distinct u.userid
                            from user_profile as u
                            where
                            last_login >= current_date - interval '14' day
                            and
                            u.status = 1
                    ),

                    b as
                    (
                    select distinct
                    userid
                    from order_mart__order_item_profile
                    where grass_date between date'2019-06-10' and date'2019-05-11'
                    )

                    select distinct
                    concat('user_id=',cast(a.userid as varchar)) list_userid
                    from a
                    left join b
                    on a.userid = b.userid
                    where b.userid is null
                    
2019-06-11 13:50:32,165 - INFO - Start Running query A14 W30
2019-06-11 14:00:10,805 - INFO - Running A14 W30 Done
2019-06-11 14:00:10,806 - INFO - CSV file path: A14 W30
2019-06-11 14:00:12,088 - INFO - Starting save the query results
2019-06-11 14:00:12,088 - INFO - Total Rows : 17364197
2019-06-11 14:00:12,089 - INFO - Will split into : 18.0 files
2019-06-11 14:00:16,990 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_1.csv
2019-06-11 14:00:16,990 - INFO - , with total : 964678 rows
2019-06-11 14:00:21,612 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_2.csv
2019-06-11 14:00:21,614 - INFO - , with total : 964678 rows
2019-06-11 14:00:26,506 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_3.csv
2019-06-11 14:00:26,506 - INFO - , with total : 964678 rows
2019-06-11 14:00:31,982 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_4.csv
2019-06-11 14:00:31,983 - INFO - , with total : 964678 rows
2019-06-11 14:00:38,020 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_5.csv
2019-06-11 14:00:38,022 - INFO - , with total : 964678 rows
2019-06-11 14:00:43,443 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_6.csv
2019-06-11 14:00:43,443 - INFO - , with total : 964678 rows
2019-06-11 14:00:48,871 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_7.csv
2019-06-11 14:00:48,872 - INFO - , with total : 964678 rows
2019-06-11 14:00:54,305 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_8.csv
2019-06-11 14:00:54,306 - INFO - , with total : 964678 rows
2019-06-11 14:00:59,818 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_9.csv
2019-06-11 14:00:59,818 - INFO - , with total : 964678 rows
2019-06-11 14:01:05,407 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_10.csv
2019-06-11 14:01:05,407 - INFO - , with total : 964678 rows
2019-06-11 14:01:11,000 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_11.csv
2019-06-11 14:01:11,002 - INFO - , with total : 964678 rows
2019-06-11 14:01:16,543 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_12.csv
2019-06-11 14:01:16,545 - INFO - , with total : 964677 rows
2019-06-11 14:01:22,086 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_13.csv
2019-06-11 14:01:22,088 - INFO - , with total : 964677 rows
2019-06-11 14:01:27,697 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_14.csv
2019-06-11 14:01:27,697 - INFO - , with total : 964677 rows
2019-06-11 14:01:36,247 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_15.csv
2019-06-11 14:01:36,249 - INFO - , with total : 964677 rows
2019-06-11 14:01:42,072 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_16.csv
2019-06-11 14:01:42,072 - INFO - , with total : 964677 rows
2019-06-11 14:01:47,687 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_17.csv
2019-06-11 14:01:47,687 - INFO - , with total : 964677 rows
2019-06-11 14:01:53,191 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 13.50/A14 W30_18.csv
2019-06-11 14:01:53,193 - INFO - , with total : 964677 rows
2019-06-11 14:01:54,316 - INFO - Reset the data in sheet
2019-06-11 14:23:15,898 - INFO - Report date: 20190611 14.23
2019-06-11 14:23:16,773 - INFO - Connect Google Sheet Successfully...
2019-06-11 14:23:16,779 - INFO - Download sheet..
2019-06-11 14:23:16,779 - INFO - Change directory to script path
2019-06-11 14:23:17,806 - INFO - Spreadsheet downloaded
2019-06-11 14:23:17,808 - INFO - Checking sheet..
2019-06-11 14:23:22,839 - INFO - Use sheet: Case 2
2019-06-11 14:23:26,069 - INFO - Reading Data From Google Sheet...
2019-06-11 14:23:26,676 - INFO - Get custom SQL..
2019-06-11 14:23:26,678 - INFO - USING CASE 2
2019-06-11 14:23:29,319 - INFO - Filename: A14 W30
2019-06-11 14:23:29,322 - INFO - Last Login: 14
2019-06-11 14:23:29,323 - INFO - Date 1: 2019-06-10
2019-06-11 14:23:29,325 - INFO - Date 2: 2019-05-11
2019-06-11 14:23:29,328 - INFO - Query: 
                    with a as(
                    select distinct u.userid
                            from user_profile as u
                            where
                            last_login >= current_date - interval '14' day
                            and
                            u.status = 1
                    ),

                    b as
                    (
                    select distinct
                    userid
                    from order_mart__order_item_profile
                    where grass_date between date'2019-06-10' and date'2019-05-11'
                    )

                    select distinct
                    concat('user_id=',cast(a.userid as varchar)) list_userid
                    from a
                    left join b
                    on a.userid = b.userid
                    where b.userid is null
                    
2019-06-11 14:23:29,338 - INFO - Start Running query A14 W30
2019-06-11 14:32:21,826 - INFO - Running A14 W30 Done
2019-06-11 14:32:21,826 - INFO - CSV file path: A14 W30
2019-06-11 14:32:23,203 - INFO - Starting save the query results
2019-06-11 14:32:23,204 - INFO - Total Rows : 17364197
2019-06-11 14:32:23,204 - INFO - Will split into : 18.0 files
2019-06-11 14:32:28,283 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_1.csv
2019-06-11 14:32:28,285 - INFO - , with total : 964678 rows
2019-06-11 14:32:32,911 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_2.csv
2019-06-11 14:32:32,911 - INFO - , with total : 964678 rows
2019-06-11 14:32:38,895 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_3.csv
2019-06-11 14:32:38,897 - INFO - , with total : 964678 rows
2019-06-11 14:32:45,194 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_4.csv
2019-06-11 14:32:45,197 - INFO - , with total : 964678 rows
2019-06-11 14:32:50,845 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_5.csv
2019-06-11 14:32:50,846 - INFO - , with total : 964678 rows
2019-06-11 14:32:56,441 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_6.csv
2019-06-11 14:32:56,443 - INFO - , with total : 964678 rows
2019-06-11 14:33:02,742 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_7.csv
2019-06-11 14:33:02,743 - INFO - , with total : 964678 rows
2019-06-11 14:33:10,836 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_8.csv
2019-06-11 14:33:10,838 - INFO - , with total : 964678 rows
2019-06-11 14:33:17,101 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_9.csv
2019-06-11 14:33:17,102 - INFO - , with total : 964678 rows
2019-06-11 14:33:23,292 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_10.csv
2019-06-11 14:33:23,292 - INFO - , with total : 964678 rows
2019-06-11 14:33:29,124 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_11.csv
2019-06-11 14:33:29,125 - INFO - , with total : 964678 rows
2019-06-11 14:33:35,575 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_12.csv
2019-06-11 14:33:35,576 - INFO - , with total : 964677 rows
2019-06-11 14:33:41,147 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_13.csv
2019-06-11 14:33:41,148 - INFO - , with total : 964677 rows
2019-06-11 14:33:46,838 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_14.csv
2019-06-11 14:33:46,845 - INFO - , with total : 964677 rows
2019-06-11 14:33:52,438 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_15.csv
2019-06-11 14:33:52,440 - INFO - , with total : 964677 rows
2019-06-11 14:33:58,223 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_16.csv
2019-06-11 14:33:58,224 - INFO - , with total : 964677 rows
2019-06-11 14:34:04,099 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_17.csv
2019-06-11 14:34:04,101 - INFO - , with total : 964677 rows
2019-06-11 14:34:09,743 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.23/A14 W30_18.csv
2019-06-11 14:34:09,744 - INFO - , with total : 964677 rows
2019-06-11 14:34:10,888 - INFO - Reset the data in sheet
2019-06-11 14:48:43,183 - INFO - Report date: 20190611 14.48
2019-06-11 14:48:44,062 - INFO - Connect Google Sheet Successfully...
2019-06-11 14:48:44,069 - INFO - Download sheet..
2019-06-11 14:48:44,071 - INFO - Change directory to script path
2019-06-11 14:48:45,085 - INFO - Spreadsheet downloaded
2019-06-11 14:48:45,089 - INFO - Checking sheet..
2019-06-11 14:48:47,513 - INFO - Use sheet: Case 1
2019-06-11 14:48:53,187 - INFO - Reading Data From Google Sheet...
2019-06-11 14:48:53,802 - INFO - Get custom SQL..
2019-06-11 14:48:53,805 - INFO - USING CASE 1
2019-06-11 14:48:56,359 - INFO - 'Home & Living'
2019-06-11 14:48:59,605 - INFO - 'Electronics'
2019-06-11 14:49:02,232 - INFO - Filename: A30 HL & HE buyers
2019-06-11 14:49:02,234 - INFO - Number of category: 2
2019-06-11 14:49:02,236 - INFO - All category: 'Home & Living','Electronics'
2019-06-11 14:49:02,239 - INFO - Last Login: 30
2019-06-11 14:49:02,243 - INFO - Query:
                    select distinct
                                concat('user_id=',cast(u.userid as varchar)) list_userid
                                from user_profile as u
                                join order_mart__order_item_profile as p
                                on u.userid = p.userid
                                where
                                p.main_category in ('Home & Living','Electronics')
                                and
                                last_login >= current_date - interval '30' day
                                and
                                u.status = 1
                                and
                                u.is_buyer = 1
                    
2019-06-11 14:49:02,252 - INFO - Start Running query A30 HL & HE buyers
2019-06-11 14:55:40,295 - INFO - Running A30 HL & HE buyers Done
2019-06-11 14:55:40,296 - INFO - CSV file path: A30 HL & HE buyers
2019-06-11 14:55:40,822 - INFO - Starting save the query results
2019-06-11 14:55:40,823 - INFO - Total Rows : 7051596
2019-06-11 14:55:40,823 - INFO - Will split into : 8.0 files
2019-06-11 14:55:45,651 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.48/A30 HL & HE buyers_1.csv
2019-06-11 14:55:45,651 - INFO - , with total : 881450 rows
2019-06-11 14:55:50,255 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.48/A30 HL & HE buyers_2.csv
2019-06-11 14:55:50,256 - INFO - , with total : 881450 rows
2019-06-11 14:55:59,121 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.48/A30 HL & HE buyers_3.csv
2019-06-11 14:55:59,128 - INFO - , with total : 881450 rows
2019-06-11 14:56:10,676 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.48/A30 HL & HE buyers_4.csv
2019-06-11 14:56:10,677 - INFO - , with total : 881450 rows
2019-06-11 14:56:18,022 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.48/A30 HL & HE buyers_5.csv
2019-06-11 14:56:18,026 - INFO - , with total : 881449 rows
2019-06-11 14:56:24,131 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.48/A30 HL & HE buyers_6.csv
2019-06-11 14:56:24,132 - INFO - , with total : 881449 rows
2019-06-11 14:56:29,848 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.48/A30 HL & HE buyers_7.csv
2019-06-11 14:56:29,848 - INFO - , with total : 881449 rows
2019-06-11 14:56:38,885 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 14.48/A30 HL & HE buyers_8.csv
2019-06-11 14:56:38,887 - INFO - , with total : 881449 rows
2019-06-11 14:56:39,296 - INFO - Reset the data in sheet
2019-06-11 15:29:12,907 - INFO - Report date: 20190611 15.29
2019-06-11 15:29:13,877 - INFO - Connect Google Sheet Successfully...
2019-06-11 15:29:13,888 - INFO - Download sheet..
2019-06-11 15:29:13,888 - INFO - Change directory to script path
2019-06-11 15:29:15,082 - INFO - Spreadsheet downloaded
2019-06-11 15:29:15,082 - INFO - Checking sheet..
2019-06-11 15:29:17,467 - INFO - Use sheet: Case 1
2019-06-11 15:29:23,247 - INFO - Reading Data From Google Sheet...
2019-06-11 15:29:23,986 - INFO - Get custom SQL..
2019-06-11 15:29:23,986 - INFO - USING CASE 1
2019-06-11 15:29:26,219 - INFO - Filename: A30 HL & E
2019-06-11 15:29:26,226 - INFO - Number of category: 0
2019-06-11 15:29:26,226 - INFO - Category: 'Home & Living',' Electronics'
2019-06-11 15:29:26,227 - INFO - Last Login: 30
2019-06-11 15:29:26,230 - INFO - USING CASE 1
2019-06-11 15:29:28,236 - INFO - Filename: A40 E
2019-06-11 15:29:28,237 - INFO - Number of category: 0
2019-06-11 15:29:28,239 - INFO - Category: 'Electronics'
2019-06-11 15:29:28,239 - INFO - Last Login: 40
2019-06-11 15:29:28,240 - INFO - USING CASE 1
2019-06-11 15:29:30,644 - INFO - Filename: 
2019-06-11 15:29:30,645 - INFO - Number of category: 0
2019-06-11 15:29:30,648 - INFO - Category: ''
2019-06-11 15:29:30,650 - INFO - Last Login: 
2019-06-11 15:29:30,651 - INFO - USING CASE 1
2019-06-11 15:29:33,000 - INFO - Filename: 
2019-06-11 15:29:33,005 - INFO - Number of category: 0
2019-06-11 15:29:33,009 - INFO - Category: ''
2019-06-11 15:29:33,015 - INFO - Last Login: 
2019-06-11 15:29:33,019 - INFO - USING CASE 1
2019-06-11 15:29:34,944 - INFO - Filename: 
2019-06-11 15:29:34,944 - INFO - Number of category: 0
2019-06-11 15:29:34,946 - INFO - Category: ''
2019-06-11 15:29:34,947 - INFO - Last Login: 
2019-06-11 15:29:34,947 - INFO - USING CASE 1
2019-06-11 15:29:36,852 - INFO - Filename: 
2019-06-11 15:29:36,854 - INFO - Number of category: 0
2019-06-11 15:29:36,855 - INFO - Category: ''
2019-06-11 15:29:36,855 - INFO - Last Login: 
2019-06-11 15:29:36,857 - INFO - USING CASE 1
2019-06-11 15:29:39,046 - INFO - Filename: 
2019-06-11 15:29:39,049 - INFO - Number of category: 0
2019-06-11 15:29:39,053 - INFO - Category: ''
2019-06-11 15:29:39,056 - INFO - Last Login: 
2019-06-11 15:29:39,059 - INFO - USING CASE 1
2019-06-11 15:34:53,854 - INFO - Report date: 20190611 15.34
2019-06-11 15:34:54,759 - INFO - Connect Google Sheet Successfully...
2019-06-11 15:34:54,769 - INFO - Download sheet..
2019-06-11 15:34:54,769 - INFO - Change directory to script path
2019-06-11 15:34:55,878 - INFO - Spreadsheet downloaded
2019-06-11 15:34:55,881 - INFO - Checking sheet..
2019-06-11 15:34:58,532 - INFO - Use sheet: Case 1
2019-06-11 15:35:04,224 - INFO - Reading Data From Google Sheet...
2019-06-11 15:35:04,828 - INFO - Get custom SQL..
2019-06-11 15:35:04,831 - INFO - USING CASE 1
2019-06-11 15:35:07,336 - INFO - Filename: A30 HL & E
2019-06-11 15:35:07,338 - INFO - Number of category: 0
2019-06-11 15:35:07,341 - INFO - Category: 'Home & Living','Electronics'
2019-06-11 15:35:07,342 - INFO - Last Login: 30
2019-06-11 15:35:07,344 - INFO - Query:
                        select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living','Electronics')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                        
2019-06-11 15:35:07,352 - INFO - Start Running query A30 HL & E
2019-06-11 15:42:51,447 - INFO - Running A30 HL & E Done
2019-06-11 15:47:26,315 - INFO - CSV file path: A30 HL & E
2019-06-11 15:47:26,894 - INFO - Starting save the query results
2019-06-11 15:47:26,894 - INFO - Total Rows : 7051596
2019-06-11 15:47:26,894 - INFO - Will split into : 8.0 files
2019-06-11 15:47:31,240 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A30 HL & E_1.csv
2019-06-11 15:47:31,242 - INFO - , with total : 881450 rows
2019-06-11 15:47:35,772 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A30 HL & E_2.csv
2019-06-11 15:47:35,773 - INFO - , with total : 881450 rows
2019-06-11 15:47:40,246 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A30 HL & E_3.csv
2019-06-11 15:47:40,247 - INFO - , with total : 881450 rows
2019-06-11 15:47:44,914 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A30 HL & E_4.csv
2019-06-11 15:47:44,914 - INFO - , with total : 881450 rows
2019-06-11 15:47:49,499 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A30 HL & E_5.csv
2019-06-11 15:47:49,500 - INFO - , with total : 881449 rows
2019-06-11 15:47:54,140 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A30 HL & E_6.csv
2019-06-11 15:47:54,140 - INFO - , with total : 881449 rows
2019-06-11 15:47:58,868 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A30 HL & E_7.csv
2019-06-11 15:47:58,868 - INFO - , with total : 881449 rows
2019-06-11 15:48:03,556 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A30 HL & E_8.csv
2019-06-11 15:48:03,556 - INFO - , with total : 881449 rows
2019-06-11 15:48:05,062 - INFO - USING CASE 1
2019-06-11 15:48:07,107 - INFO - Filename: A40 E
2019-06-11 15:48:07,108 - INFO - Number of category: 0
2019-06-11 15:48:07,109 - INFO - Category: 'Electronics'
2019-06-11 15:48:07,112 - INFO - Last Login: 40
2019-06-11 15:48:07,114 - INFO - Query:
                        select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics')
                                    and
                                    last_login >= current_date - interval '40' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                        
2019-06-11 15:48:07,119 - INFO - Start Running query A40 E
2019-06-11 15:53:56,864 - INFO - Running A40 E Done
2019-06-11 15:53:56,865 - INFO - CSV file path: A40 E
2019-06-11 15:53:57,186 - INFO - Starting save the query results
2019-06-11 15:53:57,187 - INFO - Total Rows : 4350196
2019-06-11 15:53:57,187 - INFO - Will split into : 5.0 files
2019-06-11 15:54:01,509 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A40 E_1.csv
2019-06-11 15:54:01,509 - INFO - , with total : 870040 rows
2019-06-11 15:54:07,065 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A40 E_2.csv
2019-06-11 15:54:07,065 - INFO - , with total : 870039 rows
2019-06-11 15:54:15,961 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A40 E_3.csv
2019-06-11 15:54:15,963 - INFO - , with total : 870039 rows
2019-06-11 15:54:21,127 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A40 E_4.csv
2019-06-11 15:54:21,128 - INFO - , with total : 870039 rows
2019-06-11 15:54:26,470 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 15.34/A40 E_5.csv
2019-06-11 15:54:26,470 - INFO - , with total : 870039 rows
2019-06-11 15:54:27,480 - INFO - Reset the data in sheet
2019-06-11 16:08:28,832 - INFO - Report date: 20190611 16.08
2019-06-11 16:08:29,734 - INFO - Connect Google Sheet Successfully...
2019-06-11 16:08:29,743 - INFO - Download sheet..
2019-06-11 16:08:29,746 - INFO - Change directory to script path
2019-06-11 16:08:30,892 - INFO - Spreadsheet downloaded
2019-06-11 16:08:30,892 - INFO - Checking sheet..
2019-06-11 16:08:33,351 - INFO - Use sheet: Case 1
2019-06-11 16:08:35,576 - INFO - Use sheet: Case 2
2019-06-11 16:08:38,812 - INFO - Reading Data From Google Sheet...
2019-06-11 16:08:39,471 - INFO - Get custom SQL..
2019-06-11 16:08:39,473 - INFO - USING CASE 2
2019-06-11 16:08:50,565 - INFO - Report date: 20190611 16.08
2019-06-11 16:08:51,789 - INFO - Connect Google Sheet Successfully...
2019-06-11 16:08:51,796 - INFO - Error: G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.08/ - The directory is not empty.
2019-06-11 16:10:11,622 - INFO - Report date: 20190611 16.10
2019-06-11 16:10:12,526 - INFO - Connect Google Sheet Successfully...
2019-06-11 16:10:12,532 - INFO - Download sheet..
2019-06-11 16:10:12,533 - INFO - Change directory to script path
2019-06-11 16:10:13,394 - INFO - Spreadsheet downloaded
2019-06-11 16:10:13,394 - INFO - Checking sheet..
2019-06-11 16:10:17,960 - INFO - Use sheet: Case 2
2019-06-11 16:10:21,186 - INFO - Reading Data From Google Sheet...
2019-06-11 16:10:21,788 - INFO - Get custom SQL..
2019-06-11 16:10:21,790 - INFO - USING CASE 2
2019-06-11 16:10:24,303 - INFO - Filename: A15 S30
2019-06-11 16:10:24,305 - INFO - Last Login: 15
2019-06-11 16:10:24,308 - INFO - Date 1: 2019-06-10
2019-06-11 16:10:24,309 - INFO - Date 2: 2019-05-11
2019-06-11 16:10:24,312 - INFO - Query: 
                        with a as(
                        select distinct u.userid
                                from user_profile as u
                                where
                                last_login >= current_date - interval '15' day
                                and
                                u.status = 1
                        ),

                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-10' and date'2019-05-11'
                        )

                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-11 16:10:24,322 - INFO - Start Running query A15 S30
2019-06-11 16:20:39,213 - INFO - Running A15 S30 Done
2019-06-11 16:20:39,213 - INFO - CSV file path: A15 S30
2019-06-11 16:20:40,523 - INFO - Starting save the query results
2019-06-11 16:20:40,523 - INFO - Total Rows : 17842877
2019-06-11 16:20:40,525 - INFO - Will split into : 18.0 files
2019-06-11 16:20:45,772 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_1.csv
2019-06-11 16:20:45,773 - INFO - , with total : 991271 rows
2019-06-11 16:20:50,627 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_2.csv
2019-06-11 16:20:50,628 - INFO - , with total : 991271 rows
2019-06-11 16:20:56,111 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_3.csv
2019-06-11 16:20:56,112 - INFO - , with total : 991271 rows
2019-06-11 16:21:03,520 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_4.csv
2019-06-11 16:21:03,525 - INFO - , with total : 991271 rows
2019-06-11 16:21:11,036 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_5.csv
2019-06-11 16:21:11,036 - INFO - , with total : 991271 rows
2019-06-11 16:21:17,308 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_6.csv
2019-06-11 16:21:17,309 - INFO - , with total : 991271 rows
2019-06-11 16:21:23,144 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_7.csv
2019-06-11 16:21:23,144 - INFO - , with total : 991271 rows
2019-06-11 16:21:29,536 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_8.csv
2019-06-11 16:21:29,538 - INFO - , with total : 991271 rows
2019-06-11 16:21:38,355 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_9.csv
2019-06-11 16:21:38,357 - INFO - , with total : 991271 rows
2019-06-11 16:21:43,821 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_10.csv
2019-06-11 16:21:43,822 - INFO - , with total : 991271 rows
2019-06-11 16:21:49,484 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_11.csv
2019-06-11 16:21:49,486 - INFO - , with total : 991271 rows
2019-06-11 16:21:55,265 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_12.csv
2019-06-11 16:21:55,265 - INFO - , with total : 991271 rows
2019-06-11 16:22:01,081 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_13.csv
2019-06-11 16:22:01,082 - INFO - , with total : 991271 rows
2019-06-11 16:22:06,950 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_14.csv
2019-06-11 16:22:06,950 - INFO - , with total : 991271 rows
2019-06-11 16:22:12,996 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_15.csv
2019-06-11 16:22:12,996 - INFO - , with total : 991271 rows
2019-06-11 16:22:19,253 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_16.csv
2019-06-11 16:22:19,253 - INFO - , with total : 991271 rows
2019-06-11 16:22:25,407 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_17.csv
2019-06-11 16:22:25,407 - INFO - , with total : 991271 rows
2019-06-11 16:22:31,635 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_18.csv
2019-06-11 16:22:31,637 - INFO - , with total : 991270 rows
2019-06-11 16:22:36,471 - INFO - Filename: A15 S30
2019-06-11 16:22:36,473 - INFO - Last Login: 15
2019-06-11 16:22:36,476 - INFO - Date 1: 2019-06-10
2019-06-11 16:22:36,476 - INFO - Date 2: 2019-05-11
2019-06-11 16:22:36,483 - INFO - Query: 
                        with a as(
                        select distinct u.userid
                                from user_profile as u
                                where
                                last_login >= current_date - interval '15' day
                                and
                                u.status = 1
                        ),

                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-10' and date'2019-05-11'
                        )

                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-11 16:22:36,489 - INFO - Start Running query A15 S30
2019-06-11 16:33:25,470 - INFO - Running A15 S30 Done
2019-06-11 16:33:25,470 - INFO - CSV file path: A15 S30
2019-06-11 16:33:27,220 - INFO - Starting save the query results
2019-06-11 16:33:27,220 - INFO - Total Rows : 17842877
2019-06-11 16:33:27,221 - INFO - Will split into : 18.0 files
2019-06-11 16:33:35,868 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_1.csv
2019-06-11 16:33:35,871 - INFO - , with total : 991271 rows
2019-06-11 16:33:44,055 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_2.csv
2019-06-11 16:33:44,058 - INFO - , with total : 991271 rows
2019-06-11 16:33:52,907 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_3.csv
2019-06-11 16:33:52,908 - INFO - , with total : 991271 rows
2019-06-11 16:34:02,374 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_4.csv
2019-06-11 16:34:02,378 - INFO - , with total : 991271 rows
2019-06-11 16:34:12,131 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_5.csv
2019-06-11 16:34:12,137 - INFO - , with total : 991271 rows
2019-06-11 16:34:21,296 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_6.csv
2019-06-11 16:34:21,298 - INFO - , with total : 991271 rows
2019-06-11 16:34:30,563 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_7.csv
2019-06-11 16:34:30,565 - INFO - , with total : 991271 rows
2019-06-11 16:34:41,214 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_8.csv
2019-06-11 16:34:41,217 - INFO - , with total : 991271 rows
2019-06-11 16:34:50,971 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_9.csv
2019-06-11 16:34:50,974 - INFO - , with total : 991271 rows
2019-06-11 16:34:59,957 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_10.csv
2019-06-11 16:34:59,963 - INFO - , with total : 991271 rows
2019-06-11 16:35:09,239 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_11.csv
2019-06-11 16:35:09,240 - INFO - , with total : 991271 rows
2019-06-11 16:35:17,815 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_12.csv
2019-06-11 16:35:17,816 - INFO - , with total : 991271 rows
2019-06-11 16:35:27,292 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_13.csv
2019-06-11 16:35:27,292 - INFO - , with total : 991271 rows
2019-06-11 16:35:37,657 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_14.csv
2019-06-11 16:35:37,657 - INFO - , with total : 991271 rows
2019-06-11 16:35:47,210 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_15.csv
2019-06-11 16:35:47,210 - INFO - , with total : 991271 rows
2019-06-11 16:35:56,707 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_16.csv
2019-06-11 16:35:56,709 - INFO - , with total : 991271 rows
2019-06-11 16:36:05,819 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_17.csv
2019-06-11 16:36:05,819 - INFO - , with total : 991271 rows
2019-06-11 16:36:15,221 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 16.10/A15 S30_18.csv
2019-06-11 16:36:15,223 - INFO - , with total : 991270 rows
2019-06-11 16:36:17,858 - INFO - Reset the data in sheet
2019-06-11 17:13:13,296 - INFO - Report date: 20190611 17.13
2019-06-11 17:13:14,177 - INFO - Connect Google Sheet Successfully...
2019-06-11 17:13:14,180 - INFO - Download sheet..
2019-06-11 17:13:14,181 - INFO - Change directory to script path
2019-06-11 17:13:15,477 - INFO - Spreadsheet downloaded
2019-06-11 17:13:15,479 - INFO - Checking sheet..
2019-06-11 17:13:20,430 - INFO - Use sheet: Case 2
2019-06-11 17:13:23,730 - INFO - Reading Data From Google Sheet...
2019-06-11 17:13:24,357 - INFO - Get custom SQL..
2019-06-11 17:13:24,358 - INFO - USING CASE 2
2019-06-11 17:13:27,038 - INFO - Filename: A30 S30
2019-06-11 17:13:27,038 - INFO - Last Login: 30
2019-06-11 17:13:27,038 - INFO - Date 1: 2019-06-10
2019-06-11 17:13:27,039 - INFO - Date 2: 2019-05-11
2019-06-11 17:13:27,042 - INFO - Query: 
                        with a as(
                        select distinct u.userid
                                from user_profile as u
                                where
                                last_login >= current_date - interval '30' day
                                and
                                u.status = 1
                        ),

                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-10' and date'2019-05-11'
                        )

                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-11 17:13:27,043 - INFO - Start Running query A30 S30
2019-06-11 17:25:09,747 - INFO - Running A30 S30 Done
2019-06-11 17:25:09,749 - INFO - CSV file path: A30 S30
2019-06-11 17:25:12,542 - INFO - Starting save the query results
2019-06-11 17:25:12,543 - INFO - Total Rows : 22664957
2019-06-11 17:25:12,546 - INFO - Will split into : 23.0 files
2019-06-11 17:25:21,135 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_1.csv
2019-06-11 17:25:21,137 - INFO - , with total : 985433 rows
2019-06-11 17:25:27,375 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_2.csv
2019-06-11 17:25:27,377 - INFO - , with total : 985433 rows
2019-06-11 17:25:34,381 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_3.csv
2019-06-11 17:25:34,384 - INFO - , with total : 985433 rows
2019-06-11 17:25:46,165 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_4.csv
2019-06-11 17:25:46,168 - INFO - , with total : 985433 rows
2019-06-11 17:26:04,062 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_5.csv
2019-06-11 17:26:04,063 - INFO - , with total : 985433 rows
2019-06-11 17:26:12,266 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_6.csv
2019-06-11 17:26:12,266 - INFO - , with total : 985433 rows
2019-06-11 17:26:18,697 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_7.csv
2019-06-11 17:26:18,697 - INFO - , with total : 985433 rows
2019-06-11 17:26:25,779 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_8.csv
2019-06-11 17:26:25,780 - INFO - , with total : 985433 rows
2019-06-11 17:26:35,288 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_9.csv
2019-06-11 17:26:35,292 - INFO - , with total : 985433 rows
2019-06-11 17:26:42,598 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_10.csv
2019-06-11 17:26:42,598 - INFO - , with total : 985433 rows
2019-06-11 17:26:49,914 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_11.csv
2019-06-11 17:26:49,917 - INFO - , with total : 985433 rows
2019-06-11 17:26:57,121 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_12.csv
2019-06-11 17:26:57,122 - INFO - , with total : 985433 rows
2019-06-11 17:27:04,697 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_13.csv
2019-06-11 17:27:04,701 - INFO - , with total : 985433 rows
2019-06-11 17:27:12,066 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_14.csv
2019-06-11 17:27:12,072 - INFO - , with total : 985433 rows
2019-06-11 17:27:18,661 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_15.csv
2019-06-11 17:27:18,663 - INFO - , with total : 985433 rows
2019-06-11 17:27:25,303 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_16.csv
2019-06-11 17:27:25,305 - INFO - , with total : 985433 rows
2019-06-11 17:27:33,951 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_17.csv
2019-06-11 17:27:33,953 - INFO - , with total : 985433 rows
2019-06-11 17:27:42,674 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_18.csv
2019-06-11 17:27:42,677 - INFO - , with total : 985433 rows
2019-06-11 17:27:49,375 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_19.csv
2019-06-11 17:27:49,377 - INFO - , with total : 985433 rows
2019-06-11 17:27:55,894 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_20.csv
2019-06-11 17:27:55,894 - INFO - , with total : 985433 rows
2019-06-11 17:28:04,197 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_21.csv
2019-06-11 17:28:04,198 - INFO - , with total : 985433 rows
2019-06-11 17:28:10,644 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_22.csv
2019-06-11 17:28:10,644 - INFO - , with total : 985432 rows
2019-06-11 17:28:18,711 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.13/A30 S30_23.csv
2019-06-11 17:28:18,717 - INFO - , with total : 985432 rows
2019-06-11 17:28:25,119 - INFO - Filename: A15 S10
2019-06-11 17:28:25,121 - INFO - Last Login: 15
2019-06-11 17:28:25,121 - INFO - Date 1: 2019-06-11
2019-06-11 17:28:25,121 - INFO - Date 2: 2019-06-01
2019-06-11 17:28:25,124 - INFO - Query: 
                        with a as(
                        select distinct u.userid
                                from user_profile as u
                                where
                                last_login >= current_date - interval '15' day
                                and
                                u.status = 1
                        ),

                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-11' and date'2019-06-01'
                        )

                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-11 17:28:25,125 - INFO - Start Running query A15 S10
2019-06-11 17:35:17,459 - INFO - ERROR -> java.sql.SQLException: Error fetching results
2019-06-11 17:35:18,937 - INFO - Reset the data in sheet
2019-06-11 17:52:12,007 - INFO - Report date: 20190611 17.52
2019-06-11 17:52:12,983 - INFO - Connect Google Sheet Successfully...
2019-06-11 17:52:12,990 - INFO - Download sheet..
2019-06-11 17:52:12,992 - INFO - Change directory to script path
2019-06-11 17:52:14,127 - INFO - Spreadsheet downloaded
2019-06-11 17:52:14,127 - INFO - Checking sheet..
2019-06-11 17:52:19,017 - INFO - Use sheet: Case 2
2019-06-11 17:52:22,280 - INFO - Reading Data From Google Sheet...
2019-06-11 17:52:22,894 - INFO - Get custom SQL..
2019-06-11 17:52:22,895 - INFO - USING CASE 2
2019-06-11 17:52:25,391 - INFO - Filename: A30 S30
2019-06-11 17:52:25,392 - INFO - Last Login: 30
2019-06-11 17:52:25,394 - INFO - Date 1: 2019-06-10
2019-06-11 17:52:25,395 - INFO - Date 2: 2019-05-11
2019-06-11 17:52:25,397 - INFO - Query: 
                        with a as(
                        select distinct u.userid
                                from user_profile as u
                                where
                                last_login >= current_date - interval '30' day
                                and
                                u.status = 1
                        ),

                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-10' and date'2019-05-11'
                        )

                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-11 17:52:25,407 - INFO - Start Running query A30 S30
2019-06-11 18:06:04,990 - INFO - Running A30 S30 Done
2019-06-11 18:06:04,992 - INFO - CSV file path: A30 S30
2019-06-11 18:06:07,108 - INFO - Starting save the query results
2019-06-11 18:06:07,108 - INFO - Total Rows : 22664957
2019-06-11 18:06:07,108 - INFO - Will split into : 23.0 files
2019-06-11 18:06:13,500 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_1.csv
2019-06-11 18:06:13,500 - INFO - , with total : 985433 rows
2019-06-11 18:06:19,766 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_2.csv
2019-06-11 18:06:19,767 - INFO - , with total : 985433 rows
2019-06-11 18:06:26,803 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_3.csv
2019-06-11 18:06:26,805 - INFO - , with total : 985433 rows
2019-06-11 18:06:38,848 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_4.csv
2019-06-11 18:06:38,849 - INFO - , with total : 985433 rows
2019-06-11 18:06:45,986 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_5.csv
2019-06-11 18:06:45,986 - INFO - , with total : 985433 rows
2019-06-11 18:06:53,092 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_6.csv
2019-06-11 18:06:53,092 - INFO - , with total : 985433 rows
2019-06-11 18:07:00,075 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_7.csv
2019-06-11 18:07:00,075 - INFO - , with total : 985433 rows
2019-06-11 18:07:07,365 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_8.csv
2019-06-11 18:07:07,365 - INFO - , with total : 985433 rows
2019-06-11 18:07:14,207 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_9.csv
2019-06-11 18:07:14,209 - INFO - , with total : 985433 rows
2019-06-11 18:07:21,694 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_10.csv
2019-06-11 18:07:21,696 - INFO - , with total : 985433 rows
2019-06-11 18:07:29,272 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_11.csv
2019-06-11 18:07:29,273 - INFO - , with total : 985433 rows
2019-06-11 18:07:37,369 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_12.csv
2019-06-11 18:07:37,371 - INFO - , with total : 985433 rows
2019-06-11 18:07:44,811 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_13.csv
2019-06-11 18:07:44,811 - INFO - , with total : 985433 rows
2019-06-11 18:07:52,240 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_14.csv
2019-06-11 18:07:52,240 - INFO - , with total : 985433 rows
2019-06-11 18:07:59,744 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_15.csv
2019-06-11 18:07:59,746 - INFO - , with total : 985433 rows
2019-06-11 18:08:07,079 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_16.csv
2019-06-11 18:08:07,081 - INFO - , with total : 985433 rows
2019-06-11 18:08:14,743 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_17.csv
2019-06-11 18:08:14,743 - INFO - , with total : 985433 rows
2019-06-11 18:08:22,131 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_18.csv
2019-06-11 18:08:22,131 - INFO - , with total : 985433 rows
2019-06-11 18:08:29,746 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_19.csv
2019-06-11 18:08:29,746 - INFO - , with total : 985433 rows
2019-06-11 18:08:37,681 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_20.csv
2019-06-11 18:08:37,683 - INFO - , with total : 985433 rows
2019-06-11 18:08:44,752 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_21.csv
2019-06-11 18:08:44,753 - INFO - , with total : 985433 rows
2019-06-11 18:08:51,732 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_22.csv
2019-06-11 18:08:51,732 - INFO - , with total : 985432 rows
2019-06-11 18:08:59,137 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A30 S30_23.csv
2019-06-11 18:08:59,138 - INFO - , with total : 985432 rows
2019-06-11 18:09:04,934 - INFO - Filename: A15 S10
2019-06-11 18:09:04,936 - INFO - Last Login: 15
2019-06-11 18:09:04,944 - INFO - Date 1: 2019-06-11
2019-06-11 18:09:04,947 - INFO - Date 2: 2019-06-01
2019-06-11 18:09:04,948 - INFO - Query: 
                        with a as(
                        select distinct u.userid
                                from user_profile as u
                                where
                                last_login >= current_date - interval '15' day
                                and
                                u.status = 1
                        ),

                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-11' and date'2019-06-01'
                        )

                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-11 18:09:04,953 - INFO - Start Running query A15 S10
2019-06-11 18:17:51,733 - INFO - Running A15 S10 Done
2019-06-11 18:17:51,733 - INFO - CSV file path: A15 S10
2019-06-11 18:17:53,230 - INFO - Starting save the query results
2019-06-11 18:17:53,232 - INFO - Total Rows : 17842877
2019-06-11 18:17:53,232 - INFO - Will split into : 18.0 files
2019-06-11 18:17:59,549 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_1.csv
2019-06-11 18:17:59,551 - INFO - , with total : 991271 rows
2019-06-11 18:18:05,670 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_2.csv
2019-06-11 18:18:05,671 - INFO - , with total : 991271 rows
2019-06-11 18:18:12,571 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_3.csv
2019-06-11 18:18:12,572 - INFO - , with total : 991271 rows
2019-06-11 18:18:19,385 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_4.csv
2019-06-11 18:18:19,387 - INFO - , with total : 991271 rows
2019-06-11 18:18:26,726 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_5.csv
2019-06-11 18:18:26,727 - INFO - , with total : 991271 rows
2019-06-11 18:18:34,005 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_6.csv
2019-06-11 18:18:34,006 - INFO - , with total : 991271 rows
2019-06-11 18:18:41,497 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_7.csv
2019-06-11 18:18:41,499 - INFO - , with total : 991271 rows
2019-06-11 18:18:48,677 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_8.csv
2019-06-11 18:18:48,678 - INFO - , with total : 991271 rows
2019-06-11 18:18:55,710 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_9.csv
2019-06-11 18:18:55,711 - INFO - , with total : 991271 rows
2019-06-11 18:19:03,157 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_10.csv
2019-06-11 18:19:03,157 - INFO - , with total : 991271 rows
2019-06-11 18:19:10,529 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_11.csv
2019-06-11 18:19:10,529 - INFO - , with total : 991271 rows
2019-06-11 18:19:17,767 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_12.csv
2019-06-11 18:19:17,769 - INFO - , with total : 991271 rows
2019-06-11 18:19:25,395 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_13.csv
2019-06-11 18:19:25,397 - INFO - , with total : 991271 rows
2019-06-11 18:19:32,819 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_14.csv
2019-06-11 18:19:32,821 - INFO - , with total : 991271 rows
2019-06-11 18:19:41,584 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_15.csv
2019-06-11 18:19:41,585 - INFO - , with total : 991271 rows
2019-06-11 18:19:49,075 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_16.csv
2019-06-11 18:19:49,075 - INFO - , with total : 991271 rows
2019-06-11 18:19:56,335 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_17.csv
2019-06-11 18:19:56,336 - INFO - , with total : 991271 rows
2019-06-11 18:20:03,892 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190611 17.52/A15 S10_18.csv
2019-06-11 18:20:03,894 - INFO - , with total : 991270 rows
2019-06-11 18:20:06,128 - INFO - Reset the data in sheet
2019-06-14 13:44:07,798 - INFO - Report date: 20190614 13.44
2019-06-14 13:44:08,694 - INFO - Connect Google Sheet Successfully...
2019-06-14 13:44:08,703 - INFO - Download sheet..
2019-06-14 13:44:08,703 - INFO - Change directory to script path
2019-06-14 13:44:10,128 - INFO - Spreadsheet downloaded
2019-06-14 13:44:10,130 - INFO - Checking sheet..
2019-06-14 13:44:12,938 - INFO - Use sheet: Case 1
2019-06-14 13:44:18,151 - INFO - Reading Data From Google Sheet...
2019-06-14 13:44:18,782 - INFO - Get custom SQL..
2019-06-14 13:44:18,786 - INFO - USING CASE 1
2019-06-14 13:44:20,459 - INFO - Row 2
2019-06-14 13:44:20,460 - INFO - Filename: A30 HL Buyers
2019-06-14 13:44:20,461 - INFO - Category: 'Home & Living'
2019-06-14 13:44:20,463 - INFO - Last Login: 30
2019-06-14 13:44:20,464 - INFO - Query:
                        select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                        
2019-06-14 13:44:20,474 - INFO - Start Running query A30 HL Buyers
2019-06-14 13:49:40,427 - INFO - Running A30 HL Buyers Done
2019-06-14 13:49:40,427 - INFO - CSV file path: A30 HL Buyers
2019-06-14 13:49:40,901 - INFO - Starting save the query results
2019-06-14 13:49:40,901 - INFO - Total Rows : 5713058
2019-06-14 13:49:40,901 - INFO - Will split into : 6.0 files
2019-06-14 13:49:46,354 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 13.44/A30 HL Buyers_1.csv
2019-06-14 13:49:46,355 - INFO - , with total : 952177 rows
2019-06-14 13:49:51,454 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 13.44/A30 HL Buyers_2.csv
2019-06-14 13:49:51,456 - INFO - , with total : 952177 rows
2019-06-14 13:49:56,579 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 13.44/A30 HL Buyers_3.csv
2019-06-14 13:49:56,581 - INFO - , with total : 952176 rows
2019-06-14 13:50:01,963 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 13.44/A30 HL Buyers_4.csv
2019-06-14 13:50:01,964 - INFO - , with total : 952176 rows
2019-06-14 13:50:07,681 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 13.44/A30 HL Buyers_5.csv
2019-06-14 13:50:07,683 - INFO - , with total : 952176 rows
2019-06-14 13:50:13,555 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 13.44/A30 HL Buyers_6.csv
2019-06-14 13:50:13,555 - INFO - , with total : 952176 rows
2019-06-14 13:50:14,773 - INFO - Reset the data in sheet
2019-06-14 14:05:31,460 - INFO - Report date: 20190614 14.05
2019-06-14 14:05:32,802 - INFO - Connect Google Sheet Successfully...
2019-06-14 14:05:32,815 - INFO - Download sheet..
2019-06-14 14:05:32,815 - INFO - Change directory to script path
2019-06-14 14:05:33,904 - INFO - Spreadsheet downloaded
2019-06-14 14:05:33,904 - INFO - Checking sheet..
2019-06-14 14:05:38,437 - INFO - Use sheet: Case 2
2019-06-14 14:05:41,532 - INFO - Reading Data From Google Sheet...
2019-06-14 14:05:42,082 - INFO - Get custom SQL..
2019-06-14 14:05:42,084 - INFO - USING CASE 2
2019-06-14 14:05:44,378 - INFO - Filename: A20 W30
2019-06-14 14:05:44,378 - INFO - Last Login: 20
2019-06-14 14:05:44,380 - INFO - Date 1: 2019-06-13
2019-06-14 14:05:44,380 - INFO - Date 2: 2019-05-14
2019-06-14 14:05:44,381 - INFO - Query: 
                        with a as(
                        select distinct u.userid
                                from user_profile as u
                                where
                                last_login >= current_date - interval '20' day
                                and
                                u.status = 1
                        ),

                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-13' and date'2019-05-14'
                        )

                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-14 14:05:44,381 - INFO - Start Running query A20 W30
2019-06-14 14:20:10,443 - INFO - Running A20 W30 Done
2019-06-14 14:20:10,444 - INFO - CSV file path: A20 W30
2019-06-14 14:20:12,441 - INFO - Starting save the query results
2019-06-14 14:20:12,443 - INFO - Total Rows : 19612628
2019-06-14 14:20:12,444 - INFO - Will split into : 20.0 files
2019-06-14 14:20:20,086 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_1.csv
2019-06-14 14:20:20,088 - INFO - , with total : 980632 rows
2019-06-14 14:20:28,075 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_2.csv
2019-06-14 14:20:28,078 - INFO - , with total : 980632 rows
2019-06-14 14:20:35,313 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_3.csv
2019-06-14 14:20:35,313 - INFO - , with total : 980632 rows
2019-06-14 14:20:44,260 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_4.csv
2019-06-14 14:20:44,262 - INFO - , with total : 980632 rows
2019-06-14 14:20:52,803 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_5.csv
2019-06-14 14:20:52,805 - INFO - , with total : 980632 rows
2019-06-14 14:21:01,430 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_6.csv
2019-06-14 14:21:01,431 - INFO - , with total : 980632 rows
2019-06-14 14:21:10,348 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_7.csv
2019-06-14 14:21:10,348 - INFO - , with total : 980632 rows
2019-06-14 14:21:22,947 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_8.csv
2019-06-14 14:21:22,948 - INFO - , with total : 980632 rows
2019-06-14 14:21:43,696 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_9.csv
2019-06-14 14:21:43,698 - INFO - , with total : 980631 rows
2019-06-14 14:22:03,703 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_10.csv
2019-06-14 14:22:03,707 - INFO - , with total : 980631 rows
2019-06-14 14:22:23,378 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_11.csv
2019-06-14 14:22:23,384 - INFO - , with total : 980631 rows
2019-06-14 14:22:41,618 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_12.csv
2019-06-14 14:22:41,618 - INFO - , with total : 980631 rows
2019-06-14 14:22:51,963 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_13.csv
2019-06-14 14:22:51,964 - INFO - , with total : 980631 rows
2019-06-14 14:23:05,427 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_14.csv
2019-06-14 14:23:05,430 - INFO - , with total : 980631 rows
2019-06-14 14:23:20,828 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_15.csv
2019-06-14 14:23:20,829 - INFO - , with total : 980631 rows
2019-06-14 14:23:36,459 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_16.csv
2019-06-14 14:23:36,460 - INFO - , with total : 980631 rows
2019-06-14 14:23:55,503 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_17.csv
2019-06-14 14:23:55,509 - INFO - , with total : 980631 rows
2019-06-14 14:24:16,993 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_18.csv
2019-06-14 14:24:16,999 - INFO - , with total : 980631 rows
2019-06-14 14:24:43,742 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_19.csv
2019-06-14 14:24:43,744 - INFO - , with total : 980631 rows
2019-06-14 14:25:04,660 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A20 W30_20.csv
2019-06-14 14:25:04,661 - INFO - , with total : 980631 rows
2019-06-14 14:25:11,727 - INFO - Filename: A30 W30
2019-06-14 14:25:11,733 - INFO - Last Login: 30
2019-06-14 14:25:11,737 - INFO - Date 1: 2019-06-13
2019-06-14 14:25:11,740 - INFO - Date 2: 2019-05-14
2019-06-14 14:25:11,749 - INFO - Query: 
                        with a as(
                        select distinct u.userid
                                from user_profile as u
                                where
                                last_login >= current_date - interval '30' day
                                and
                                u.status = 1
                        ),

                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-13' and date'2019-05-14'
                        )

                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-14 14:25:11,753 - INFO - Start Running query A30 W30
2019-06-14 14:40:04,569 - INFO - Running A30 W30 Done
2019-06-14 14:40:04,572 - INFO - CSV file path: A30 W30
2019-06-14 14:40:07,474 - INFO - Starting save the query results
2019-06-14 14:40:07,476 - INFO - Total Rows : 22604014
2019-06-14 14:40:07,476 - INFO - Will split into : 23.0 files
2019-06-14 14:40:15,219 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_1.csv
2019-06-14 14:40:15,220 - INFO - , with total : 982784 rows
2019-06-14 14:40:22,053 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_2.csv
2019-06-14 14:40:22,055 - INFO - , with total : 982784 rows
2019-06-14 14:40:28,398 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_3.csv
2019-06-14 14:40:28,398 - INFO - , with total : 982784 rows
2019-06-14 14:40:34,891 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_4.csv
2019-06-14 14:40:34,892 - INFO - , with total : 982784 rows
2019-06-14 14:40:43,392 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_5.csv
2019-06-14 14:40:43,395 - INFO - , with total : 982784 rows
2019-06-14 14:40:49,971 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_6.csv
2019-06-14 14:40:49,973 - INFO - , with total : 982783 rows
2019-06-14 14:40:56,500 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_7.csv
2019-06-14 14:40:56,502 - INFO - , with total : 982783 rows
2019-06-14 14:41:03,467 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_8.csv
2019-06-14 14:41:03,469 - INFO - , with total : 982783 rows
2019-06-14 14:41:10,415 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_9.csv
2019-06-14 14:41:10,417 - INFO - , with total : 982783 rows
2019-06-14 14:41:17,473 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_10.csv
2019-06-14 14:41:17,474 - INFO - , with total : 982783 rows
2019-06-14 14:41:26,734 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_11.csv
2019-06-14 14:41:26,734 - INFO - , with total : 982783 rows
2019-06-14 14:41:41,986 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_12.csv
2019-06-14 14:41:41,986 - INFO - , with total : 982783 rows
2019-06-14 14:41:49,447 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_13.csv
2019-06-14 14:41:49,448 - INFO - , with total : 982783 rows
2019-06-14 14:41:56,253 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_14.csv
2019-06-14 14:41:56,253 - INFO - , with total : 982783 rows
2019-06-14 14:42:03,158 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_15.csv
2019-06-14 14:42:03,160 - INFO - , with total : 982783 rows
2019-06-14 14:42:16,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_16.csv
2019-06-14 14:42:16,970 - INFO - , with total : 982783 rows
2019-06-14 14:42:26,099 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_17.csv
2019-06-14 14:42:26,111 - INFO - , with total : 982783 rows
2019-06-14 14:42:33,578 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_18.csv
2019-06-14 14:42:33,578 - INFO - , with total : 982783 rows
2019-06-14 14:42:41,395 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_19.csv
2019-06-14 14:42:41,397 - INFO - , with total : 982783 rows
2019-06-14 14:42:48,230 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_20.csv
2019-06-14 14:42:48,232 - INFO - , with total : 982783 rows
2019-06-14 14:42:55,247 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_21.csv
2019-06-14 14:42:55,249 - INFO - , with total : 982783 rows
2019-06-14 14:43:02,585 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_22.csv
2019-06-14 14:43:02,585 - INFO - , with total : 982783 rows
2019-06-14 14:43:09,503 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.05/A30 W30_23.csv
2019-06-14 14:43:09,503 - INFO - , with total : 982783 rows
2019-06-14 14:43:12,249 - INFO - Reset the data in sheet
2019-06-14 14:50:12,414 - INFO - Report date: 20190614 14.50
2019-06-14 14:50:13,713 - INFO - Connect Google Sheet Successfully...
2019-06-14 14:50:13,720 - INFO - Download sheet..
2019-06-14 14:50:13,720 - INFO - Change directory to script path
2019-06-14 14:50:15,361 - INFO - Spreadsheet downloaded
2019-06-14 14:50:15,364 - INFO - Checking sheet..
2019-06-14 14:50:22,234 - INFO - Use sheet: Case 3
2019-06-14 14:50:23,236 - INFO - Reading Data From Google Sheet...
2019-06-14 14:50:23,846 - INFO - Get custom SQL..
2019-06-14 14:50:23,848 - INFO - USING CASE 3
2019-06-14 14:50:26,719 - INFO - Row 2
2019-06-14 14:50:26,719 - INFO - Filename: A30 HL Buyers W30
2019-06-14 14:50:26,720 - INFO - Category: 'Home & Living'
2019-06-14 14:50:26,720 - INFO - Last Login: 30
2019-06-14 14:50:26,721 - INFO - Date 1: 2019-06-13
2019-06-14 14:50:26,723 - INFO - Date 2: 2019-05-14
2019-06-14 14:50:26,723 - INFO - Query:
                        with a as(
                        select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                        ),

                        --shopped for the last 30 days
                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-13' and date'2019-05-14'
                        )

                        --final
                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-14 14:50:26,726 - INFO - Start Running query A30 HL Buyers W30
2019-06-14 14:57:33,858 - INFO - Running A30 HL Buyers W30 Done
2019-06-14 14:57:33,858 - INFO - CSV file path: A30 HL Buyers W30
2019-06-14 14:57:34,486 - INFO - Starting save the query results
2019-06-14 14:57:34,486 - INFO - Total Rows : 5713058
2019-06-14 14:57:34,486 - INFO - Will split into : 6.0 files
2019-06-14 14:57:44,516 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A30 HL Buyers W30_1.csv
2019-06-14 14:57:44,517 - INFO - , with total : 952177 rows
2019-06-14 14:57:52,549 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A30 HL Buyers W30_2.csv
2019-06-14 14:57:52,551 - INFO - , with total : 952177 rows
2019-06-14 14:58:01,114 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A30 HL Buyers W30_3.csv
2019-06-14 14:58:01,115 - INFO - , with total : 952176 rows
2019-06-14 14:58:11,914 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A30 HL Buyers W30_4.csv
2019-06-14 14:58:11,920 - INFO - , with total : 952176 rows
2019-06-14 14:58:21,693 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A30 HL Buyers W30_5.csv
2019-06-14 14:58:21,694 - INFO - , with total : 952176 rows
2019-06-14 14:58:31,108 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A30 HL Buyers W30_6.csv
2019-06-14 14:58:31,109 - INFO - , with total : 952176 rows
2019-06-14 14:58:35,874 - INFO - Row 3
2019-06-14 14:58:35,875 - INFO - Filename: A10 HL & Fashion W30
2019-06-14 14:58:35,875 - INFO - Category: 'Home & Living','Fashion'
2019-06-14 14:58:35,877 - INFO - Last Login: 10
2019-06-14 14:58:35,878 - INFO - Date 1: 2019-06-13
2019-06-14 14:58:35,881 - INFO - Date 2: 2019-05-14
2019-06-14 14:58:35,882 - INFO - Query:
                        with a as(
                        select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living','Fashion')
                                    and
                                    last_login >= current_date - interval '10' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                        ),

                        --shopped for the last 30 days
                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-13' and date'2019-05-14'
                        )

                        --final
                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-14 14:58:35,887 - INFO - Start Running query A10 HL & Fashion W30
2019-06-14 15:03:40,348 - INFO - Running A10 HL & Fashion W30 Done
2019-06-14 15:03:40,348 - INFO - CSV file path: A10 HL & Fashion W30
2019-06-14 15:03:40,819 - INFO - Starting save the query results
2019-06-14 15:03:40,819 - INFO - Total Rows : 4759690
2019-06-14 15:03:40,822 - INFO - Will split into : 5.0 files
2019-06-14 15:03:47,469 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A10 HL & Fashion W30_1.csv
2019-06-14 15:03:47,473 - INFO - , with total : 951938 rows
2019-06-14 15:03:55,573 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A10 HL & Fashion W30_2.csv
2019-06-14 15:03:55,575 - INFO - , with total : 951938 rows
2019-06-14 15:04:07,190 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A10 HL & Fashion W30_3.csv
2019-06-14 15:04:07,191 - INFO - , with total : 951938 rows
2019-06-14 15:04:19,641 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A10 HL & Fashion W30_4.csv
2019-06-14 15:04:19,641 - INFO - , with total : 951938 rows
2019-06-14 15:04:26,946 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A10 HL & Fashion W30_5.csv
2019-06-14 15:04:26,947 - INFO - , with total : 951938 rows
2019-06-14 15:04:31,493 - INFO - Row 4
2019-06-14 15:04:31,494 - INFO - Filename: A20 HL & F & H W30
2019-06-14 15:04:31,496 - INFO - Category: 'Home & Living','Fashion','Health'
2019-06-14 15:04:31,496 - INFO - Last Login: 20
2019-06-14 15:04:31,497 - INFO - Date 1: 2019-06-13
2019-06-14 15:04:31,499 - INFO - Date 2: 2019-05-14
2019-06-14 15:04:31,500 - INFO - Query:
                        with a as(
                        select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living','Fashion','Health')
                                    and
                                    last_login >= current_date - interval '20' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                        ),

                        --shopped for the last 30 days
                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-13' and date'2019-05-14'
                        )

                        --final
                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-14 15:04:31,502 - INFO - Start Running query A20 HL & F & H W30
2019-06-14 15:11:16,739 - INFO - Running A20 HL & F & H W30 Done
2019-06-14 15:11:16,740 - INFO - CSV file path: A20 HL & F & H W30
2019-06-14 15:11:17,309 - INFO - Starting save the query results
2019-06-14 15:11:17,311 - INFO - Total Rows : 6272313
2019-06-14 15:11:17,312 - INFO - Will split into : 7.0 files
2019-06-14 15:11:23,276 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A20 HL & F & H W30_1.csv
2019-06-14 15:11:23,276 - INFO - , with total : 896045 rows
2019-06-14 15:11:29,808 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A20 HL & F & H W30_2.csv
2019-06-14 15:11:29,809 - INFO - , with total : 896045 rows
2019-06-14 15:11:41,628 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A20 HL & F & H W30_3.csv
2019-06-14 15:11:41,628 - INFO - , with total : 896045 rows
2019-06-14 15:11:47,915 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A20 HL & F & H W30_4.csv
2019-06-14 15:11:47,917 - INFO - , with total : 896045 rows
2019-06-14 15:11:54,114 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A20 HL & F & H W30_5.csv
2019-06-14 15:11:54,115 - INFO - , with total : 896045 rows
2019-06-14 15:12:00,996 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A20 HL & F & H W30_6.csv
2019-06-14 15:12:00,997 - INFO - , with total : 896044 rows
2019-06-14 15:12:09,009 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190614 14.50/A20 HL & F & H W30_7.csv
2019-06-14 15:12:09,010 - INFO - , with total : 896044 rows
2019-06-14 15:12:10,953 - INFO - Reset the data in sheet
2019-06-17 18:15:32,644 - INFO - Report date: 20190617 18.15
2019-06-17 18:15:35,332 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:15:35,346 - INFO - Download sheet..
2019-06-17 18:15:35,346 - INFO - Change directory to script path
2019-06-17 18:18:59,765 - INFO - Report date: 20190617 18.18
2019-06-17 18:19:00,871 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:19:00,881 - INFO - Download sheet..
2019-06-17 18:19:00,882 - INFO - Change directory to script path
2019-06-17 18:24:17,566 - INFO - Report date: 20190617 18.24
2019-06-17 18:24:18,635 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:24:18,645 - INFO - Download sheet..
2019-06-17 18:24:18,645 - INFO - Change directory to script path
2019-06-17 18:28:45,733 - INFO - Report date: 20190617 18.28
2019-06-17 18:28:46,782 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:28:46,790 - INFO - Download sheet..
2019-06-17 18:28:46,790 - INFO - Change directory to script path
2019-06-17 18:28:47,288 - INFO - Error in downloading sheet -> <HttpError 404 when requesting https://www.googleapis.com/drive/v2/files/1oh0mz3xgmaK4bLzbTwXaIYMSdt2PFaGQ6y3zlIZi7AI/export?mimeType=application%2Fvnd.openxmlformats-officedocument.spreadsheetml.sheet&alt=media returned "File not found: 1oh0mz3xgmaK4bLzbTwXaIYMSdt2PFaGQ6y3zlIZi7AI">
2019-06-17 18:28:47,290 - INFO - Checking sheet..
2019-06-17 18:30:10,740 - INFO - Report date: 20190617 18.30
2019-06-17 18:30:11,694 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:30:11,703 - INFO - Download sheet..
2019-06-17 18:30:11,703 - INFO - Change directory to script path
2019-06-17 18:30:13,078 - INFO - Spreadsheet downloaded
2019-06-17 18:30:13,078 - INFO - Checking sheet..
2019-06-17 18:31:08,032 - INFO - Report date: 20190617 18.31
2019-06-17 18:31:08,936 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:31:08,953 - INFO - Download sheet..
2019-06-17 18:31:08,954 - INFO - Change directory to script path
2019-06-17 18:31:10,509 - INFO - Spreadsheet downloaded
2019-06-17 18:31:10,510 - INFO - Checking sheet..
2019-06-17 18:31:13,051 - INFO - Use sheet: Case 1
2019-06-17 18:31:15,719 - INFO - Use sheet: Case 2
2019-06-17 18:31:17,966 - INFO - Use sheet: Case 3
2019-06-17 18:31:18,971 - INFO - Reading Data From Google Sheet...
2019-06-17 18:31:19,880 - INFO - Get custom SQL..
2019-06-17 18:31:19,884 - INFO - USING CASE 3
2019-06-17 18:31:26,687 - INFO - Row 2
2019-06-17 18:31:26,690 - INFO - Filename: AAAAAAAA
2019-06-17 18:31:26,693 - INFO - Category: 'Home & Living','Hobby & Toys'
2019-06-17 18:31:26,697 - INFO - Last Login: 3
2019-06-17 18:31:26,700 - INFO - Date 1: 2019-06-14
2019-06-17 18:31:26,703 - INFO - Date 2: 2019-06-16
2019-06-17 18:31:26,707 - INFO - Query:
                        with a as(
                        select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living','Hobby & Toys')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                        ),

                        --shopped for the last 30 days
                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-14' and date'2019-06-16'
                        )

                        --final
                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-17 18:31:26,716 - INFO - Start Running query AAAAAAAA
2019-06-17 18:35:01,746 - INFO - Report date: 20190617 18.35
2019-06-17 18:35:03,055 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:35:03,065 - INFO - Download sheet..
2019-06-17 18:35:03,065 - INFO - Change directory to script path
2019-06-17 18:35:04,482 - INFO - Spreadsheet downloaded
2019-06-17 18:35:04,490 - INFO - Checking sheet..
2019-06-17 18:35:11,144 - INFO - Reading Data From Google Sheet...
2019-06-17 18:36:10,726 - INFO - Report date: 20190617 18.36
2019-06-17 18:36:11,709 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:36:11,720 - INFO - Download sheet..
2019-06-17 18:36:11,720 - INFO - Change directory to script path
2019-06-17 18:36:13,076 - INFO - Spreadsheet downloaded
2019-06-17 18:36:13,078 - INFO - Checking sheet..
2019-06-17 18:36:17,063 - INFO - Reading Data From Google Sheet...
2019-06-17 18:36:31,427 - INFO - Report date: 20190617 18.36
2019-06-17 18:36:32,437 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:36:32,444 - INFO - Error: G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.36/ - The directory is not empty.
2019-06-17 18:36:32,447 - INFO - Error in downloading sheet -> [Error 183] Cannot create a file when that file already exists: 'G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.36/'
2019-06-17 18:36:32,448 - INFO - Checking sheet..
2019-06-17 18:36:40,025 - INFO - Reading Data From Google Sheet...
2019-06-17 18:36:40,654 - INFO - Get custom SQL..
2019-06-17 18:36:40,658 - INFO - USING CASE 3
2019-06-17 18:36:51,586 - INFO - Report date: 20190617 18.36
2019-06-17 18:36:52,604 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:36:52,619 - INFO - Download sheet..
2019-06-17 18:36:52,621 - INFO - Change directory to script path
2019-06-17 18:36:54,059 - INFO - Spreadsheet downloaded
2019-06-17 18:36:54,061 - INFO - Checking sheet..
2019-06-17 18:37:00,374 - INFO - Reading Data From Google Sheet...
2019-06-17 18:37:01,035 - INFO - Get custom SQL..
2019-06-17 18:37:01,036 - INFO - USING CASE 3
2019-06-17 18:37:04,476 - INFO - Row 2
2019-06-17 18:37:04,480 - INFO - Filename: AAAAAAAA
2019-06-17 18:37:04,482 - INFO - Category: 'Home & Living','Hobby & Toys'
2019-06-17 18:37:04,483 - INFO - Last Login: 3
2019-06-17 18:37:04,486 - INFO - Date 1: 2019-06-14
2019-06-17 18:37:04,486 - INFO - Date 2: 2019-06-16
2019-06-17 18:37:04,493 - INFO - Query:
                        with a as(
                        select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living','Hobby & Toys')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                        ),

                        --shopped for the last 30 days
                        b as
                        (
                        select distinct
                        userid
                        from order_mart__order_item_profile
                        where grass_date between date'2019-06-14' and date'2019-06-16'
                        )

                        --final
                        select distinct
                        concat('user_id=',cast(a.userid as varchar)) list_userid
                        from a
                        left join b
                        on a.userid = b.userid
                        where b.userid is null
                        
2019-06-17 18:37:04,503 - INFO - Start Running query AAAAAAAA
2019-06-17 18:40:05,566 - INFO - Report date: 20190617 18.40
2019-06-17 18:40:06,848 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:40:06,861 - INFO - Download sheet..
2019-06-17 18:40:06,861 - INFO - Change directory to script path
2019-06-17 18:40:08,043 - INFO - Spreadsheet downloaded
2019-06-17 18:40:08,046 - INFO - Checking sheet..
2019-06-17 18:40:09,051 - INFO - Reading Data From Google Sheet...
2019-06-17 18:40:11,045 - INFO - Get custom SQL..
2019-06-17 18:40:11,046 - INFO - USING CASE 1
2019-06-17 18:40:13,819 - INFO - Row 2
2019-06-17 18:40:13,819 - INFO - Filename: A30 Home & Living and Hobby & Toys
2019-06-17 18:40:13,822 - INFO - Category: 'Home & Living','Hobby & Toys'
2019-06-17 18:40:13,822 - INFO - Last Login: 3
2019-06-17 18:40:13,823 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys')
                                            and
                                            last_login >= current_date - interval '3' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-17 18:40:13,825 - INFO - Start Running query A30 Home & Living and Hobby & Toys
2019-06-17 18:42:24,063 - INFO - Report date: 20190617 18.42
2019-06-17 18:42:25,062 - INFO - Connect Google Sheet Successfully...
2019-06-17 18:42:25,068 - INFO - Download sheet..
2019-06-17 18:42:25,069 - INFO - Change directory to script path
2019-06-17 18:42:26,022 - INFO - Spreadsheet downloaded
2019-06-17 18:42:26,022 - INFO - Checking sheet..
2019-06-17 18:42:27,025 - INFO - Reading Data From Google Sheet...
2019-06-17 18:42:28,030 - INFO - Get custom SQL..
2019-06-17 18:42:28,032 - INFO - USING CASE 1
2019-06-17 18:42:31,171 - INFO - Row 2
2019-06-17 18:42:31,176 - INFO - Filename: A30 Home & Living and Hobby & Toys
2019-06-17 18:42:31,177 - INFO - Category: 'Home & Living','Hobby & Toys','Electronics','Computer & Accessories'
2019-06-17 18:42:31,178 - INFO - Last Login: 3
2019-06-17 18:42:31,180 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys','Electronics','Computer & Accessories')
                                            and
                                            last_login >= current_date - interval '3' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-17 18:42:31,190 - INFO - Start Running query A30 Home & Living and Hobby & Toys
2019-06-17 18:48:51,805 - INFO - Running A30 Home & Living and Hobby & Toys Done
2019-06-17 18:48:51,809 - INFO - CSV file path: A30 Home & Living and Hobby & Toys
2019-06-17 18:48:52,424 - INFO - Starting save the query results
2019-06-17 18:48:52,427 - INFO - Total Rows : 5024743
2019-06-17 18:48:52,427 - INFO - Will split into : 6.0 files
2019-06-17 18:48:58,056 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.42/A30 Home & Living and Hobby & Toys_1.csv
2019-06-17 18:48:58,061 - INFO - , with total : 837458 rows
2019-06-17 18:49:03,522 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.42/A30 Home & Living and Hobby & Toys_2.csv
2019-06-17 18:49:03,523 - INFO - , with total : 837457 rows
2019-06-17 18:49:09,038 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.42/A30 Home & Living and Hobby & Toys_3.csv
2019-06-17 18:49:09,040 - INFO - , with total : 837457 rows
2019-06-17 18:49:13,581 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.42/A30 Home & Living and Hobby & Toys_4.csv
2019-06-17 18:49:13,584 - INFO - , with total : 837457 rows
2019-06-17 18:49:18,272 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.42/A30 Home & Living and Hobby & Toys_5.csv
2019-06-17 18:49:18,273 - INFO - , with total : 837457 rows
2019-06-17 18:49:22,719 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.42/A30 Home & Living and Hobby & Toys_6.csv
2019-06-17 18:49:22,720 - INFO - , with total : 837457 rows
2019-06-17 18:49:23,773 - INFO - Reset the data in sheet
2019-06-17 18:49:25,355 - INFO - Reading Data From Google Sheet...
2019-06-17 18:49:25,990 - INFO - Get custom SQL..
2019-06-17 18:49:25,994 - INFO - USING CASE 2
2019-06-17 18:49:28,490 - INFO - Row 2
2019-06-17 18:49:28,492 - INFO - Filename: 
2019-06-17 18:49:28,493 - INFO - Last Login: 
2019-06-17 18:49:28,494 - INFO - Date 1: 
2019-06-17 18:49:28,496 - INFO - Date 2: 
2019-06-17 18:49:28,497 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                        from user_profile as u
                                        where
                                        last_login >= current_date - interval '' day
                                        and
                                        u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-17 18:49:28,507 - INFO - Start Running query 
2019-06-17 18:49:28,901 - INFO - java.sql.SQLException: Query failed (#20190617_115042_12295_gwsaa): Value cannot be cast to date: 
2019-06-17 18:49:29,063 - INFO - java.sql.SQLException: Query failed (#20190617_115043_12296_gwsaa): Value cannot be cast to date: 
2019-06-17 18:49:29,233 - INFO - java.sql.SQLException: Query failed (#20190617_115043_12297_gwsaa): Value cannot be cast to date: 
2019-06-17 18:49:29,404 - INFO - java.sql.SQLException: Query failed (#20190617_115043_12298_gwsaa): Value cannot be cast to date: 
2019-06-17 18:49:29,565 - INFO - java.sql.SQLException: Query failed (#20190617_115043_12299_gwsaa): Value cannot be cast to date: 
2019-06-17 18:49:29,565 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-17 18:49:29,997 - INFO - Reset the data in sheet
2019-06-17 18:50:39,388 - INFO - Reading Data From Google Sheet...
2019-06-17 18:50:40,676 - INFO - Get custom SQL..
2019-06-17 18:50:40,677 - INFO - USING CASE 3
2019-06-17 18:50:44,914 - INFO - Row 2
2019-06-17 18:50:44,914 - INFO - Filename: AAAAAAAA
2019-06-17 18:50:44,915 - INFO - Category: 'Home & Living','Hobby & Toys'
2019-06-17 18:50:44,917 - INFO - Last Login: 3
2019-06-17 18:50:44,917 - INFO - Date 1: 2019-06-14
2019-06-17 18:50:44,918 - INFO - Date 2: 2019-06-16
2019-06-17 18:50:44,920 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys')
                                            and
                                            last_login >= current_date - interval '3' day
                                            and
                                            u.status = 1
                                            and
                                            is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-14' and date'2019-06-16'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-17 18:50:44,921 - INFO - Start Running query AAAAAAAA
2019-06-17 18:55:50,530 - INFO - Running AAAAAAAA Done
2019-06-17 18:55:50,533 - INFO - CSV file path: AAAAAAAA
2019-06-17 18:55:51,154 - INFO - Starting save the query results
2019-06-17 18:55:51,158 - INFO - Total Rows : 2959112
2019-06-17 18:55:51,158 - INFO - Will split into : 3.0 files
2019-06-17 18:56:04,510 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.42/AAAAAAAA_1.csv
2019-06-17 18:56:04,515 - INFO - , with total : 986371 rows
2019-06-17 18:56:16,460 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.42/AAAAAAAA_2.csv
2019-06-17 18:56:16,461 - INFO - , with total : 986371 rows
2019-06-17 18:56:25,759 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 18.42/AAAAAAAA_3.csv
2019-06-17 18:56:25,760 - INFO - , with total : 986370 rows
2019-06-17 18:56:26,778 - INFO - Reset the data in sheet
2019-06-17 19:09:36,977 - INFO - Report date: 20190617 19.09
2019-06-17 19:09:38,760 - INFO - Connect Google Sheet Successfully...
2019-06-17 19:09:38,770 - INFO - Download sheet..
2019-06-17 19:09:38,772 - INFO - Change directory to script path
2019-06-17 19:09:39,769 - INFO - Spreadsheet downloaded
2019-06-17 19:09:39,770 - INFO - Checking sheet..
2019-06-17 19:09:40,773 - INFO - Reading Data From Google Sheet...
2019-06-17 19:09:41,530 - INFO - Get custom SQL..
2019-06-17 19:09:41,530 - INFO - USING CASE 1
2019-06-17 19:09:43,426 - INFO - Row 1
2019-06-17 19:09:43,426 - INFO - Filename: A30 Home & Living and Hobby & Toys
2019-06-17 19:09:43,427 - INFO - Category: 'Home & Living','Hobby & Toys','Electronics','Computer & Accessories'
2019-06-17 19:09:43,427 - INFO - Last Login: 3
2019-06-17 19:09:43,427 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys','Electronics','Computer & Accessories')
                                            and
                                            last_login >= current_date - interval '3' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-17 19:09:43,428 - INFO - Start Running query A30 Home & Living and Hobby & Toys
2019-06-17 19:14:23,407 - INFO - Running A30 Home & Living and Hobby & Toys Done
2019-06-17 19:14:23,408 - INFO - CSV file path: A30 Home & Living and Hobby & Toys
2019-06-17 19:14:23,615 - INFO - Starting save the query results
2019-06-17 19:14:23,617 - INFO - Total Rows : 5024743
2019-06-17 19:14:23,617 - INFO - Will split into : 6.0 files
2019-06-17 19:14:27,904 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/A30 Home & Living and Hobby & Toys_1.csv
2019-06-17 19:14:27,904 - INFO - , with total : 837458 rows
2019-06-17 19:14:32,236 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/A30 Home & Living and Hobby & Toys_2.csv
2019-06-17 19:14:32,237 - INFO - , with total : 837457 rows
2019-06-17 19:14:36,694 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/A30 Home & Living and Hobby & Toys_3.csv
2019-06-17 19:14:36,694 - INFO - , with total : 837457 rows
2019-06-17 19:14:41,798 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/A30 Home & Living and Hobby & Toys_4.csv
2019-06-17 19:14:41,799 - INFO - , with total : 837457 rows
2019-06-17 19:14:46,717 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/A30 Home & Living and Hobby & Toys_5.csv
2019-06-17 19:14:46,717 - INFO - , with total : 837457 rows
2019-06-17 19:14:51,571 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/A30 Home & Living and Hobby & Toys_6.csv
2019-06-17 19:14:51,572 - INFO - , with total : 837457 rows
2019-06-17 19:14:52,910 - INFO - Reset the data in sheet
2019-06-17 19:15:52,915 - INFO - Reading Data From Google Sheet...
2019-06-17 19:15:53,437 - INFO - Get custom SQL..
2019-06-17 19:15:53,438 - INFO - USING CASE 2
2019-06-17 19:15:55,194 - INFO - Row 1
2019-06-17 19:15:55,194 - INFO - Filename: BBBBBB
2019-06-17 19:15:55,194 - INFO - Last Login: 10
2019-06-17 19:15:55,196 - INFO - Date 1: 2019-06-16
2019-06-17 19:15:55,197 - INFO - Date 2: 2019-06-25
2019-06-17 19:15:55,197 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                        from user_profile as u
                                        where
                                        last_login >= current_date - interval '10' day
                                        and
                                        u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-16' and date'2019-06-25'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-17 19:15:55,200 - INFO - Start Running query BBBBBB
2019-06-17 19:23:26,615 - INFO - Running BBBBBB Done
2019-06-17 19:23:26,617 - INFO - CSV file path: BBBBBB
2019-06-17 19:23:27,201 - INFO - Starting save the query results
2019-06-17 19:23:27,203 - INFO - Total Rows : 14900157
2019-06-17 19:23:27,203 - INFO - Will split into : 15.0 files
2019-06-17 19:23:32,135 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_1.csv
2019-06-17 19:23:32,138 - INFO - , with total : 993344 rows
2019-06-17 19:23:36,845 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_2.csv
2019-06-17 19:23:36,846 - INFO - , with total : 993344 rows
2019-06-17 19:23:42,107 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_3.csv
2019-06-17 19:23:42,108 - INFO - , with total : 993344 rows
2019-06-17 19:23:47,157 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_4.csv
2019-06-17 19:23:47,158 - INFO - , with total : 993344 rows
2019-06-17 19:23:52,262 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_5.csv
2019-06-17 19:23:52,263 - INFO - , with total : 993344 rows
2019-06-17 19:23:57,266 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_6.csv
2019-06-17 19:23:57,266 - INFO - , with total : 993344 rows
2019-06-17 19:24:02,253 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_7.csv
2019-06-17 19:24:02,253 - INFO - , with total : 993344 rows
2019-06-17 19:24:07,848 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_8.csv
2019-06-17 19:24:07,849 - INFO - , with total : 993344 rows
2019-06-17 19:24:13,003 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_9.csv
2019-06-17 19:24:13,005 - INFO - , with total : 993344 rows
2019-06-17 19:24:18,125 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_10.csv
2019-06-17 19:24:18,125 - INFO - , with total : 993344 rows
2019-06-17 19:24:24,509 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_11.csv
2019-06-17 19:24:24,510 - INFO - , with total : 993344 rows
2019-06-17 19:24:29,729 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_12.csv
2019-06-17 19:24:29,730 - INFO - , with total : 993344 rows
2019-06-17 19:24:34,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_13.csv
2019-06-17 19:24:34,967 - INFO - , with total : 993343 rows
2019-06-17 19:24:40,355 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_14.csv
2019-06-17 19:24:40,355 - INFO - , with total : 993343 rows
2019-06-17 19:24:45,714 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190617 19.09/BBBBBB_15.csv
2019-06-17 19:24:45,714 - INFO - , with total : 993343 rows
2019-06-17 19:24:48,072 - INFO - Reset the data in sheet
2019-06-17 19:24:49,747 - INFO - Reading Data From Google Sheet...
2019-06-17 19:24:50,515 - INFO - Get custom SQL..
2019-06-17 19:24:50,516 - INFO - USING CASE 3
2019-06-17 19:24:54,278 - INFO - Row 1
2019-06-17 19:24:54,279 - INFO - Filename: 
2019-06-17 19:24:54,279 - INFO - Category: ''
2019-06-17 19:24:54,279 - INFO - Last Login: 
2019-06-17 19:24:54,280 - INFO - Date 1: 
2019-06-17 19:24:54,282 - INFO - Date 2: 
2019-06-17 19:24:54,282 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-17 19:24:54,282 - INFO - Start Running query 
2019-06-17 19:24:54,825 - INFO - java.sql.SQLException: Query failed (#20190617_122608_12807_gwsaa): Value cannot be cast to date: 
2019-06-17 19:24:55,048 - INFO - java.sql.SQLException: Query failed (#20190617_122608_12810_gwsaa): Value cannot be cast to date: 
2019-06-17 19:24:55,548 - INFO - java.sql.SQLException: Query failed (#20190617_122609_12811_gwsaa): Value cannot be cast to date: 
2019-06-17 19:24:56,036 - INFO - java.sql.SQLException: Query failed (#20190617_122609_12812_gwsaa): Value cannot be cast to date: 
2019-06-17 19:24:57,596 - INFO - java.sql.SQLException: Query failed (#20190617_122610_12814_gwsaa): Value cannot be cast to date: 
2019-06-17 19:24:57,598 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-17 19:24:58,323 - INFO - Reset the data in sheet
2019-06-18 10:15:29,732 - INFO - Report date: 20190618 10.15
2019-06-18 10:15:30,924 - INFO - Connect Google Sheet Successfully...
2019-06-18 10:15:30,931 - INFO - Download sheet..
2019-06-18 10:15:30,931 - INFO - Change directory to script path
2019-06-18 10:15:32,111 - INFO - Spreadsheet downloaded
2019-06-18 10:15:32,112 - INFO - Checking sheet..
2019-06-18 10:15:33,115 - INFO - Reading Data From Google Sheet...
2019-06-18 10:15:33,900 - INFO - Get custom SQL..
2019-06-18 10:15:33,901 - INFO - USING CASE 1
2019-06-18 10:15:35,625 - INFO - Row 1
2019-06-18 10:15:35,625 - INFO - Filename: A30 Home & Living and Hobby & Toys
2019-06-18 10:15:35,625 - INFO - Category: 'Home & Living','Hobby & Toys','Electronics','Computer & Accessories'
2019-06-18 10:15:35,627 - INFO - Last Login: 3
2019-06-18 10:15:35,628 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys','Electronics','Computer & Accessories')
                                            and
                                            last_login >= current_date - interval '3' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 10:15:35,630 - INFO - Start Running query A30 Home & Living and Hobby & Toys
2019-06-18 10:26:18,342 - INFO - Running A30 Home & Living and Hobby & Toys Done
2019-06-18 10:29:00,313 - INFO - CSV file path: A30 Home & Living and Hobby & Toys
2019-06-18 10:29:00,733 - INFO - Starting save the query results
2019-06-18 10:29:00,734 - INFO - Total Rows : 5067525
2019-06-18 10:29:00,736 - INFO - Will split into : 6.0 files
2019-06-18 10:29:04,776 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.15/A30 Home & Living and Hobby & Toys_1.csv
2019-06-18 10:29:04,778 - INFO - , with total : 844588 rows
2019-06-18 10:29:08,757 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.15/A30 Home & Living and Hobby & Toys_2.csv
2019-06-18 10:29:08,760 - INFO - , with total : 844588 rows
2019-06-18 10:29:12,961 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.15/A30 Home & Living and Hobby & Toys_3.csv
2019-06-18 10:29:12,963 - INFO - , with total : 844588 rows
2019-06-18 10:29:17,351 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.15/A30 Home & Living and Hobby & Toys_4.csv
2019-06-18 10:29:17,354 - INFO - , with total : 844587 rows
2019-06-18 10:29:21,811 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.15/A30 Home & Living and Hobby & Toys_5.csv
2019-06-18 10:33:40,551 - INFO - , with total : 844587 rows
2019-06-18 10:33:45,046 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.15/A30 Home & Living and Hobby & Toys_6.csv
2019-06-18 10:33:45,046 - INFO - , with total : 844587 rows
2019-06-18 10:33:46,125 - INFO - Delete all data in the sheet
2019-06-18 10:41:58,209 - INFO - Report date: 20190618 10.41
2019-06-18 10:41:59,111 - INFO - Connect Google Sheet Successfully...
2019-06-18 10:41:59,117 - INFO - Download sheet..
2019-06-18 10:41:59,118 - INFO - Change directory to script path
2019-06-18 10:42:00,167 - INFO - Spreadsheet downloaded
2019-06-18 10:42:00,167 - INFO - Checking sheet..
2019-06-18 10:42:01,170 - INFO - Reading Data From Google Sheet...
2019-06-18 10:42:01,948 - INFO - Get custom SQL..
2019-06-18 10:42:01,950 - INFO - USING CASE 1
2019-06-18 10:42:03,691 - INFO - Row 1
2019-06-18 10:42:03,694 - INFO - Filename: A1 Home & Living and Hobby & Toys
2019-06-18 10:42:03,697 - INFO - Category: 'Home & Living'',''Hobby & Toys'',''Electronics'',''Computer & Accessories'',''Fashion'
2019-06-18 10:42:03,698 - INFO - Last Login: 1
2019-06-18 10:42:03,703 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living'',''Hobby & Toys'',''Electronics'',''Computer & Accessories'',''Fashion')
                                            and
                                            last_login >= current_date - interval '1' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 10:42:03,707 - INFO - Start Running query A1 Home & Living and Hobby & Toys
2019-06-18 10:42:37,207 - INFO - Report date: 20190618 10.42
2019-06-18 10:42:38,223 - INFO - Connect Google Sheet Successfully...
2019-06-18 10:42:38,230 - INFO - Download sheet..
2019-06-18 10:42:38,230 - INFO - Change directory to script path
2019-06-18 10:42:39,257 - INFO - Spreadsheet downloaded
2019-06-18 10:42:39,257 - INFO - Checking sheet..
2019-06-18 10:42:40,259 - INFO - Reading Data From Google Sheet...
2019-06-18 10:42:40,953 - INFO - Get custom SQL..
2019-06-18 10:42:40,953 - INFO - USING CASE 1
2019-06-18 10:42:42,664 - INFO - Row 1
2019-06-18 10:42:42,667 - INFO - Filename: A1 Home & Living and Hobby & Toys
2019-06-18 10:42:42,668 - INFO - Category: 'Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion'
2019-06-18 10:42:42,671 - INFO - Last Login: 1
2019-06-18 10:42:42,673 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion')
                                            and
                                            last_login >= current_date - interval '1' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 10:42:42,683 - INFO - Start Running query A1 Home & Living and Hobby & Toys
2019-06-18 10:42:45,079 - INFO - java.sql.SQLException: Query failed (#20190618_034359_07978_gwsaa): Too many queued queries for "global.jdbc"
2019-06-18 10:42:45,180 - INFO - java.sql.SQLException: Query failed (#20190618_034359_07981_gwsaa): Too many queued queries for "global.jdbc"
2019-06-18 10:42:45,273 - INFO - java.sql.SQLException: Query failed (#20190618_034359_07982_gwsaa): Too many queued queries for "global.jdbc"
2019-06-18 10:42:45,358 - INFO - java.sql.SQLException: Query failed (#20190618_034359_07983_gwsaa): Too many queued queries for "global.jdbc"
2019-06-18 10:42:45,444 - INFO - java.sql.SQLException: Query failed (#20190618_034400_07987_gwsaa): Too many queued queries for "global.jdbc"
2019-06-18 10:42:45,447 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 10:42:46,006 - INFO - Delete all data in the sheet
2019-06-18 10:42:46,546 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 10:42:47,549 - INFO - Reading Data From Google Sheet...
2019-06-18 10:42:48,115 - INFO - Get custom SQL..
2019-06-18 10:42:48,118 - INFO - USING CASE 2
2019-06-18 10:48:07,237 - INFO - Row 1
2019-06-18 10:48:07,240 - INFO - Filename: BBBBBB
2019-06-18 10:48:07,250 - INFO - Last Login: 10
2019-06-18 10:48:07,260 - INFO - Date 1: 2019-06-16
2019-06-18 10:48:07,272 - INFO - Date 2: 2019-06-25
2019-06-18 10:48:07,275 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                        from user_profile as u
                                        where
                                        last_login >= current_date - interval '10' day
                                        and
                                        u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-16' and date'2019-06-25'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 10:48:07,289 - INFO - Start Running query BBBBBB
2019-06-18 11:09:08,993 - INFO - Running BBBBBB Done
2019-06-18 11:09:08,994 - INFO - CSV file path: BBBBBB
2019-06-18 11:09:10,088 - INFO - Starting save the query results
2019-06-18 11:09:10,089 - INFO - Total Rows : 14309889
2019-06-18 11:09:10,089 - INFO - Will split into : 15.0 files
2019-06-18 11:09:14,934 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_1.csv
2019-06-18 11:09:14,934 - INFO - , with total : 953993 rows
2019-06-18 11:09:19,602 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_2.csv
2019-06-18 11:09:19,604 - INFO - , with total : 953993 rows
2019-06-18 11:09:24,318 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_3.csv
2019-06-18 11:09:24,319 - INFO - , with total : 953993 rows
2019-06-18 11:09:29,607 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_4.csv
2019-06-18 11:09:29,608 - INFO - , with total : 953993 rows
2019-06-18 11:09:35,153 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_5.csv
2019-06-18 11:09:35,153 - INFO - , with total : 953993 rows
2019-06-18 11:09:41,125 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_6.csv
2019-06-18 11:09:41,127 - INFO - , with total : 953993 rows
2019-06-18 11:09:46,757 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_7.csv
2019-06-18 11:09:46,759 - INFO - , with total : 953993 rows
2019-06-18 11:09:52,421 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_8.csv
2019-06-18 11:09:52,423 - INFO - , with total : 953993 rows
2019-06-18 11:09:58,719 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_9.csv
2019-06-18 11:09:58,732 - INFO - , with total : 953993 rows
2019-06-18 11:10:04,474 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_10.csv
2019-06-18 11:10:04,474 - INFO - , with total : 953992 rows
2019-06-18 11:10:10,065 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_11.csv
2019-06-18 11:10:10,071 - INFO - , with total : 953992 rows
2019-06-18 11:10:15,492 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_12.csv
2019-06-18 11:10:15,493 - INFO - , with total : 953992 rows
2019-06-18 11:10:21,089 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_13.csv
2019-06-18 11:10:21,091 - INFO - , with total : 953992 rows
2019-06-18 11:10:26,644 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_14.csv
2019-06-18 11:10:26,645 - INFO - , with total : 953992 rows
2019-06-18 11:10:31,993 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 10.42/BBBBBB_15.csv
2019-06-18 11:10:31,994 - INFO - , with total : 953992 rows
2019-06-18 11:10:33,806 - INFO - Delete all data in the sheet
2019-06-18 11:11:21,292 - INFO - Reading Data From Google Sheet...
2019-06-18 11:11:21,641 - INFO - Get custom SQL..
2019-06-18 11:11:21,641 - INFO - USING CASE 3
2019-06-18 11:11:23,480 - INFO - Row 1
2019-06-18 11:11:23,482 - INFO - Filename: 
2019-06-18 11:11:23,483 - INFO - Category: ''
2019-06-18 11:11:23,483 - INFO - Last Login: 
2019-06-18 11:11:23,483 - INFO - Date 1: 
2019-06-18 11:11:23,486 - INFO - Date 2: 
2019-06-18 11:11:23,496 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 11:11:23,507 - INFO - Start Running query 
2019-06-18 11:16:22,421 - INFO - java.sql.SQLException: Query failed (#20190618_041238_09638_gwsaa): Value cannot be cast to date: 
2019-06-18 11:23:45,329 - INFO - java.sql.SQLException: Query failed (#20190618_041737_09833_gwsaa): Value cannot be cast to date: 
2019-06-18 11:26:00,582 - INFO - java.sql.SQLException: Query failed (#20190618_042500_10054_gwsaa): Value cannot be cast to date: 
2019-06-18 11:27:43,436 - INFO - java.sql.SQLException: Query failed (#20190618_042715_10136_gwsaa): Value cannot be cast to date: 
2019-06-18 11:30:32,118 - INFO - Report date: 20190618 11.30
2019-06-18 11:30:34,221 - INFO - Connect Google Sheet Successfully...
2019-06-18 11:30:34,233 - INFO - Download sheet..
2019-06-18 11:30:34,234 - INFO - Change directory to script path
2019-06-18 11:30:35,969 - INFO - Spreadsheet downloaded
2019-06-18 11:30:36,094 - INFO - Checking sheet..
2019-06-18 11:30:37,144 - INFO - Reading Data From Google Sheet...
2019-06-18 11:30:38,013 - INFO - Get custom SQL..
2019-06-18 11:30:38,013 - INFO - USING CASE 1
2019-06-18 11:30:39,891 - INFO - Row 1
2019-06-18 11:30:39,892 - INFO - Filename: A1 Home & Living and Hobby & Toys
2019-06-18 11:30:39,898 - INFO - Category: 'Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion'
2019-06-18 11:30:39,898 - INFO - Last Login: 1
2019-06-18 11:30:39,901 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion')
                                            and
                                            last_login >= current_date - interval '1' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 11:30:39,903 - INFO - Start Running query A1 Home & Living and Hobby & Toys
2019-06-18 11:39:39,332 - INFO - Running A1 Home & Living and Hobby & Toys Done
2019-06-18 11:39:39,334 - INFO - CSV file path: A1 Home & Living and Hobby & Toys
2019-06-18 11:39:39,538 - INFO - Starting save the query results
2019-06-18 11:39:39,538 - INFO - Total Rows : 3727032
2019-06-18 11:39:39,539 - INFO - Will split into : 4.0 files
2019-06-18 11:39:44,516 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 11.30/A1 Home & Living and Hobby & Toys_1.csv
2019-06-18 11:39:44,516 - INFO - , with total : 931758 rows
2019-06-18 11:39:49,556 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 11.30/A1 Home & Living and Hobby & Toys_2.csv
2019-06-18 11:39:49,558 - INFO - , with total : 931758 rows
2019-06-18 11:39:56,440 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 11.30/A1 Home & Living and Hobby & Toys_3.csv
2019-06-18 11:39:56,441 - INFO - , with total : 931758 rows
2019-06-18 11:40:01,976 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 11.30/A1 Home & Living and Hobby & Toys_4.csv
2019-06-18 11:40:01,976 - INFO - , with total : 931758 rows
2019-06-18 11:40:03,757 - INFO - Delete all data in the sheet
2019-06-18 11:40:47,249 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 11:40:48,250 - INFO - Reading Data From Google Sheet...
2019-06-18 11:40:48,599 - INFO - Get custom SQL..
2019-06-18 11:40:48,601 - INFO - USING CASE 2
2019-06-18 11:40:49,953 - INFO - Row 1
2019-06-18 11:40:49,954 - INFO - Filename: 
2019-06-18 11:40:49,956 - INFO - Last Login: 
2019-06-18 11:40:49,957 - INFO - Date 1: 
2019-06-18 11:40:49,957 - INFO - Date 2: 
2019-06-18 11:40:49,957 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                        from user_profile as u
                                        where
                                        last_login >= current_date - interval '' day
                                        and
                                        u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 11:40:49,959 - INFO - Start Running query 
2019-06-18 11:41:35,571 - INFO - java.sql.SQLException: Query failed (#20190618_044204_10618_gwsaa): Value cannot be cast to date: 
2019-06-18 11:41:51,285 - INFO - java.sql.SQLException: Query failed (#20190618_044250_10644_gwsaa): Value cannot be cast to date: 
2019-06-18 11:42:41,562 - INFO - java.sql.SQLException: Query failed (#20190618_044305_10670_gwsaa): Value cannot be cast to date: 
2019-06-18 11:42:59,582 - INFO - java.sql.SQLException: Query failed (#20190618_044356_10681_gwsaa): Value cannot be cast to date: 
2019-06-18 11:43:23,808 - INFO - java.sql.SQLException: Query failed (#20190618_044414_10701_gwsaa): Value cannot be cast to date: 
2019-06-18 11:43:23,809 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 11:43:24,201 - INFO - Delete all data in the sheet
2019-06-18 11:43:24,503 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 11:43:25,503 - INFO - Reading Data From Google Sheet...
2019-06-18 11:43:25,905 - INFO - Get custom SQL..
2019-06-18 11:43:25,907 - INFO - USING CASE 3
2019-06-18 11:43:27,650 - INFO - Row 1
2019-06-18 11:43:27,651 - INFO - Filename: 
2019-06-18 11:43:27,651 - INFO - Category: ''
2019-06-18 11:43:27,653 - INFO - Last Login: 
2019-06-18 11:43:27,654 - INFO - Date 1: 
2019-06-18 11:43:27,654 - INFO - Date 2: 
2019-06-18 11:43:27,655 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 11:43:27,657 - INFO - Start Running query 
2019-06-18 11:43:45,434 - INFO - java.sql.SQLException: Query failed (#20190618_044442_10715_gwsaa): Value cannot be cast to date: 
2019-06-18 11:43:55,197 - INFO - java.sql.SQLException: Query failed (#20190618_044500_10720_gwsaa): Value cannot be cast to date: 
2019-06-18 11:44:01,013 - INFO - java.sql.SQLException: Query failed (#20190618_044509_10726_gwsaa): Value cannot be cast to date: 
2019-06-18 11:44:16,380 - INFO - java.sql.SQLException: Query failed (#20190618_044515_10730_gwsaa): Value cannot be cast to date: 
2019-06-18 11:44:29,871 - INFO - java.sql.SQLException: Query failed (#20190618_044531_10741_gwsaa): Value cannot be cast to date: 
2019-06-18 11:44:29,872 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 11:44:30,292 - INFO - Delete all data in the sheet
2019-06-18 16:05:13,911 - INFO - Report date: 20190618 16.05
2019-06-18 16:05:15,394 - INFO - Connect Google Sheet Successfully...
2019-06-18 16:05:15,401 - INFO - Download sheet..
2019-06-18 16:05:15,403 - INFO - Change directory to script path
2019-06-18 16:05:17,091 - INFO - Spreadsheet downloaded
2019-06-18 16:05:17,092 - INFO - Checking sheet..
2019-06-18 16:05:18,092 - INFO - Reading Data From Google Sheet...
2019-06-18 16:05:18,937 - INFO - Get custom SQL..
2019-06-18 16:05:18,938 - INFO - USING CASE 1
2019-06-18 16:05:21,002 - INFO - Row 1
2019-06-18 16:05:21,003 - INFO - Filename: A1 Home & Living and Hobby & Toys
2019-06-18 16:05:21,006 - INFO - Category: 'Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion'
2019-06-18 16:05:21,007 - INFO - Last Login: 1
2019-06-18 16:05:21,019 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion')
                                            and
                                            last_login >= current_date - interval '1' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 16:05:21,033 - INFO - Start Running query A1 Home & Living and Hobby & Toys
2019-06-18 16:07:44,006 - INFO - Running A1 Home & Living and Hobby & Toys Done
2019-06-18 16:07:44,006 - INFO - CSV file path: A1 Home & Living and Hobby & Toys
2019-06-18 16:07:44,520 - INFO - Starting save the query results
2019-06-18 16:07:44,522 - INFO - Total Rows : 3727032
2019-06-18 16:07:44,522 - INFO - Will split into : 4.0 files
2019-06-18 16:07:54,256 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 16.05/A1 Home & Living and Hobby & Toys_1.csv
2019-06-18 16:07:54,259 - INFO - , with total : 931758 rows
2019-06-18 16:08:04,184 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 16.05/A1 Home & Living and Hobby & Toys_2.csv
2019-06-18 16:08:04,184 - INFO - , with total : 931758 rows
2019-06-18 16:08:14,586 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 16.05/A1 Home & Living and Hobby & Toys_3.csv
2019-06-18 16:08:14,588 - INFO - , with total : 931758 rows
2019-06-18 16:08:24,680 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 16.05/A1 Home & Living and Hobby & Toys_4.csv
2019-06-18 16:08:24,743 - INFO - , with total : 931758 rows
2019-06-18 16:08:25,690 - INFO - Delete all data in the sheet
2019-06-18 16:09:20,084 - INFO - Reading Data From Google Sheet...
2019-06-18 16:09:20,505 - INFO - Get custom SQL..
2019-06-18 16:09:20,506 - INFO - USING CASE 2
2019-06-18 16:09:22,453 - INFO - Row 1
2019-06-18 16:09:22,456 - INFO - Filename: 
2019-06-18 16:09:22,457 - INFO - Last Login: 
2019-06-18 16:09:22,459 - INFO - Date 1: 
2019-06-18 16:09:22,463 - INFO - Date 2: 
2019-06-18 16:09:22,467 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                        from user_profile as u
                                        where
                                        last_login >= current_date - interval '' day
                                        and
                                        u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 16:09:22,480 - INFO - Start Running query 
2019-06-18 16:09:22,822 - INFO - java.sql.SQLException: Query failed (#20190618_091037_20190_gwsaa): Value cannot be cast to date: 
2019-06-18 16:09:22,951 - INFO - java.sql.SQLException: Query failed (#20190618_091037_20191_gwsaa): Value cannot be cast to date: 
2019-06-18 16:09:23,099 - INFO - java.sql.SQLException: Query failed (#20190618_091037_20192_gwsaa): Value cannot be cast to date: 
2019-06-18 16:09:23,226 - INFO - java.sql.SQLException: Query failed (#20190618_091037_20193_gwsaa): Value cannot be cast to date: 
2019-06-18 16:09:23,403 - INFO - java.sql.SQLException: Query failed (#20190618_091038_20194_gwsaa): Value cannot be cast to date: 
2019-06-18 16:09:23,407 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 16:09:23,773 - INFO - Delete all data in the sheet
2019-06-18 16:09:29,042 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 16:09:30,046 - INFO - Reading Data From Google Sheet...
2019-06-18 16:09:30,427 - INFO - Get custom SQL..
2019-06-18 16:09:30,430 - INFO - USING CASE 3
2019-06-18 16:09:32,348 - INFO - Row 1
2019-06-18 16:09:32,349 - INFO - Filename: 
2019-06-18 16:09:32,351 - INFO - Category: ''
2019-06-18 16:09:32,354 - INFO - Last Login: 
2019-06-18 16:09:32,358 - INFO - Date 1: 
2019-06-18 16:09:32,361 - INFO - Date 2: 
2019-06-18 16:09:32,365 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 16:09:32,381 - INFO - Start Running query 
2019-06-18 16:09:34,098 - INFO - java.sql.SQLException: Query failed (#20190618_091047_20197_gwsaa): Value cannot be cast to date: 
2019-06-18 16:09:34,303 - INFO - java.sql.SQLException: Query failed (#20190618_091048_20198_gwsaa): Value cannot be cast to date: 
2019-06-18 16:09:34,516 - INFO - java.sql.SQLException: Query failed (#20190618_091049_20199_gwsaa): Value cannot be cast to date: 
2019-06-18 16:09:34,973 - INFO - java.sql.SQLException: Query failed (#20190618_091049_20200_gwsaa): Value cannot be cast to date: 
2019-06-18 16:09:35,142 - INFO - java.sql.SQLException: Query failed (#20190618_091049_20201_gwsaa): Value cannot be cast to date: 
2019-06-18 16:09:35,144 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 16:09:35,499 - INFO - Delete all data in the sheet
2019-06-18 16:09:35,796 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 19:07:03,721 - INFO - Report date: 20190618 19.07
2019-06-18 19:07:04,621 - INFO - Connect Google Sheet Successfully...
2019-06-18 19:07:04,628 - INFO - Download sheet..
2019-06-18 19:07:04,628 - INFO - Change directory to script path
2019-06-18 19:07:05,844 - INFO - Spreadsheet downloaded
2019-06-18 19:07:05,845 - INFO - Checking sheet..
2019-06-18 19:07:06,845 - INFO - Reading Data From Google Sheet...
2019-06-18 19:07:07,598 - INFO - Get custom SQL..
2019-06-18 19:07:07,599 - INFO - USING CASE 1
2019-06-18 19:07:09,325 - INFO - Row 1
2019-06-18 19:07:09,325 - INFO - Filename: A1 Home & Living and Hobby & Toys
2019-06-18 19:07:09,326 - INFO - Category: 'Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion'
2019-06-18 19:07:09,326 - INFO - Last Login: 1
2019-06-18 19:07:09,328 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion')
                                            and
                                            last_login >= current_date - interval '1' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 19:07:09,329 - INFO - Start Running query A1 Home & Living and Hobby & Toys
2019-06-18 19:09:03,707 - INFO - Running A1 Home & Living and Hobby & Toys Done
2019-06-18 19:09:03,709 - INFO - CSV file path: A1 Home & Living and Hobby & Toys
2019-06-18 19:09:03,990 - INFO - Starting save the query results
2019-06-18 19:09:03,990 - INFO - Total Rows : 3727032
2019-06-18 19:09:03,990 - INFO - Will split into : 4.0 files
2019-06-18 19:09:09,200 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.07/A1 Home & Living and Hobby & Toys_1.csv
2019-06-18 19:09:09,200 - INFO - , with total : 931758 rows
2019-06-18 19:09:14,016 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.07/A1 Home & Living and Hobby & Toys_2.csv
2019-06-18 19:09:14,019 - INFO - , with total : 931758 rows
2019-06-18 19:09:19,257 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.07/A1 Home & Living and Hobby & Toys_3.csv
2019-06-18 19:09:19,259 - INFO - , with total : 931758 rows
2019-06-18 19:09:25,170 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.07/A1 Home & Living and Hobby & Toys_4.csv
2019-06-18 19:09:25,171 - INFO - , with total : 931758 rows
2019-06-18 19:09:27,778 - INFO - Row 2
2019-06-18 19:09:27,778 - INFO - Filename: A1 Hobby & Toys CA F buyers
2019-06-18 19:09:27,779 - INFO - Category: 'Hobby & Toys','Electronics','Computer & Accessories','Fashion'
2019-06-18 19:09:27,779 - INFO - Last Login: 1
2019-06-18 19:09:27,779 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Hobby & Toys','Electronics','Computer & Accessories','Fashion')
                                            and
                                            last_login >= current_date - interval '1' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 19:09:27,782 - INFO - Start Running query A1 Hobby & Toys CA F buyers
2019-06-18 19:11:00,727 - INFO - Running A1 Hobby & Toys CA F buyers Done
2019-06-18 19:11:00,732 - INFO - CSV file path: A1 Hobby & Toys CA F buyers
2019-06-18 19:11:00,937 - INFO - Starting save the query results
2019-06-18 19:11:00,938 - INFO - Total Rows : 2734725
2019-06-18 19:11:00,938 - INFO - Will split into : 3.0 files
2019-06-18 19:11:05,444 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.07/A1 Hobby & Toys CA F buyers_1.csv
2019-06-18 19:11:05,447 - INFO - , with total : 911575 rows
2019-06-18 19:11:09,905 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.07/A1 Hobby & Toys CA F buyers_2.csv
2019-06-18 19:11:09,907 - INFO - , with total : 911575 rows
2019-06-18 19:11:14,917 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.07/A1 Hobby & Toys CA F buyers_3.csv
2019-06-18 19:11:14,917 - INFO - , with total : 911575 rows
2019-06-18 19:11:15,693 - INFO - Delete all data in the sheet
2019-06-18 19:12:05,029 - INFO - Reading Data From Google Sheet...
2019-06-18 19:12:05,595 - INFO - Get custom SQL..
2019-06-18 19:12:05,596 - INFO - USING CASE 2
2019-06-18 19:12:07,017 - INFO - Row 1
2019-06-18 19:12:07,020 - INFO - Filename: 
2019-06-18 19:12:07,023 - INFO - Last Login: 
2019-06-18 19:12:07,025 - INFO - Date 1: 
2019-06-18 19:12:07,026 - INFO - Date 2: 
2019-06-18 19:12:07,032 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                        from user_profile as u
                                        where
                                        last_login >= current_date - interval '' day
                                        and
                                        u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 19:12:07,048 - INFO - Start Running query 
2019-06-18 19:12:07,336 - INFO - java.sql.SQLException: Query failed (#20190618_121322_25307_gwsaa): Value cannot be cast to date: 
2019-06-18 19:12:07,480 - INFO - java.sql.SQLException: Query failed (#20190618_121322_25308_gwsaa): Value cannot be cast to date: 
2019-06-18 19:12:07,609 - INFO - java.sql.SQLException: Query failed (#20190618_121322_25309_gwsaa): Value cannot be cast to date: 
2019-06-18 19:12:07,756 - INFO - java.sql.SQLException: Query failed (#20190618_121322_25310_gwsaa): Value cannot be cast to date: 
2019-06-18 19:12:07,882 - INFO - java.sql.SQLException: Query failed (#20190618_121322_25311_gwsaa): Value cannot be cast to date: 
2019-06-18 19:12:07,885 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 19:12:08,365 - INFO - Delete all data in the sheet
2019-06-18 19:12:14,246 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 19:12:15,252 - INFO - Reading Data From Google Sheet...
2019-06-18 19:12:15,588 - INFO - Get custom SQL..
2019-06-18 19:12:15,591 - INFO - USING CASE 3
2019-06-18 19:12:17,365 - INFO - Row 1
2019-06-18 19:12:17,368 - INFO - Filename: 
2019-06-18 19:12:17,369 - INFO - Category: ''
2019-06-18 19:12:17,371 - INFO - Last Login: 
2019-06-18 19:12:17,377 - INFO - Date 1: 
2019-06-18 19:12:17,381 - INFO - Date 2: 
2019-06-18 19:12:17,384 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 19:12:17,403 - INFO - Start Running query 
2019-06-18 19:12:17,555 - INFO - java.sql.SQLException: Query failed (#20190618_121332_25313_gwsaa): Value cannot be cast to date: 
2019-06-18 19:12:17,743 - INFO - java.sql.SQLException: Query failed (#20190618_121332_25314_gwsaa): Value cannot be cast to date: 
2019-06-18 19:12:17,891 - INFO - java.sql.SQLException: Query failed (#20190618_121332_25315_gwsaa): Value cannot be cast to date: 
2019-06-18 19:12:18,042 - INFO - java.sql.SQLException: Query failed (#20190618_121332_25316_gwsaa): Value cannot be cast to date: 
2019-06-18 19:12:18,206 - INFO - java.sql.SQLException: Query failed (#20190618_121332_25317_gwsaa): Value cannot be cast to date: 
2019-06-18 19:12:18,207 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 19:12:18,558 - INFO - Delete all data in the sheet
2019-06-18 19:12:18,858 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 19:14:39,829 - INFO - Report date: 20190618 19.14
2019-06-18 19:14:40,786 - INFO - Connect Google Sheet Successfully...
2019-06-18 19:14:40,795 - INFO - Download sheet..
2019-06-18 19:14:40,795 - INFO - Change directory to script path
2019-06-18 19:14:41,887 - INFO - Spreadsheet downloaded
2019-06-18 19:14:41,888 - INFO - Checking sheet..
2019-06-18 19:14:42,890 - INFO - Reading Data From Google Sheet...
2019-06-18 19:14:43,555 - INFO - Get custom SQL..
2019-06-18 19:14:43,555 - INFO - USING CASE 1
2019-06-18 19:14:45,599 - INFO - Row 1
2019-06-18 19:14:45,604 - INFO - Filename: A1 Home & Living and Hobby & Toys
2019-06-18 19:14:45,605 - INFO - Category: 'Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion'
2019-06-18 19:14:45,608 - INFO - Last Login: 1
2019-06-18 19:14:45,611 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion')
                                            and
                                            last_login >= current_date - interval '1' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 19:14:45,627 - INFO - Start Running query A1 Home & Living and Hobby & Toys
2019-06-18 19:16:30,303 - INFO - Running A1 Home & Living and Hobby & Toys Done
2019-06-18 19:16:30,305 - INFO - CSV file path: A1 Home & Living and Hobby & Toys
2019-06-18 19:16:30,618 - INFO - Starting save the query results
2019-06-18 19:16:30,619 - INFO - Total Rows : 3727032
2019-06-18 19:16:30,621 - INFO - Will split into : 4.0 files
2019-06-18 19:16:39,660 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.14/A1 Home & Living and Hobby & Toys_1.csv
2019-06-18 19:16:39,661 - INFO - , with total : 931758 rows
2019-06-18 19:16:46,348 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.14/A1 Home & Living and Hobby & Toys_2.csv
2019-06-18 19:16:46,348 - INFO - , with total : 931758 rows
2019-06-18 19:16:54,457 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.14/A1 Home & Living and Hobby & Toys_3.csv
2019-06-18 19:16:54,457 - INFO - , with total : 931758 rows
2019-06-18 19:17:00,063 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.14/A1 Home & Living and Hobby & Toys_4.csv
2019-06-18 19:17:00,065 - INFO - , with total : 931758 rows
2019-06-18 19:17:02,417 - INFO - Row 2
2019-06-18 19:17:02,418 - INFO - Filename: A1 Hobby & Toys CA F buyers
2019-06-18 19:17:02,420 - INFO - Category: 'Hobby & Toys','Electronics','Computer & Accessories','Fashion'
2019-06-18 19:17:02,421 - INFO - Last Login: 1
2019-06-18 19:17:02,421 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Hobby & Toys','Electronics','Computer & Accessories','Fashion')
                                            and
                                            last_login >= current_date - interval '1' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 19:17:02,424 - INFO - Start Running query A1 Hobby & Toys CA F buyers
2019-06-18 19:18:28,319 - INFO - Running A1 Hobby & Toys CA F buyers Done
2019-06-18 19:18:28,321 - INFO - CSV file path: A1 Hobby & Toys CA F buyers
2019-06-18 19:18:28,519 - INFO - Starting save the query results
2019-06-18 19:18:28,520 - INFO - Total Rows : 2734725
2019-06-18 19:18:28,522 - INFO - Will split into : 3.0 files
2019-06-18 19:18:33,529 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.14/A1 Hobby & Toys CA F buyers_1.csv
2019-06-18 19:18:33,532 - INFO - , with total : 911575 rows
2019-06-18 19:18:39,361 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.14/A1 Hobby & Toys CA F buyers_2.csv
2019-06-18 19:18:39,364 - INFO - , with total : 911575 rows
2019-06-18 19:18:44,657 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.14/A1 Hobby & Toys CA F buyers_3.csv
2019-06-18 19:18:44,660 - INFO - , with total : 911575 rows
2019-06-18 19:18:45,515 - INFO - Delete all data in the sheet
2019-06-18 19:18:46,148 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 19:18:47,158 - INFO - Reading Data From Google Sheet...
2019-06-18 19:18:47,723 - INFO - Get custom SQL..
2019-06-18 19:18:47,724 - INFO - USING CASE 2
2019-06-18 19:18:50,069 - INFO - Row 1
2019-06-18 19:18:50,071 - INFO - Filename: 
2019-06-18 19:18:50,072 - INFO - Last Login: 
2019-06-18 19:18:50,073 - INFO - Date 1: 
2019-06-18 19:18:50,075 - INFO - Date 2: 
2019-06-18 19:18:50,076 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                        from user_profile as u
                                        where
                                        last_login >= current_date - interval '' day
                                        and
                                        u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 19:18:50,085 - INFO - Start Running query 
2019-06-18 19:18:52,049 - INFO - java.sql.SQLException: Query failed (#20190618_122005_25425_gwsaa): Value cannot be cast to date: 
2019-06-18 19:18:52,426 - INFO - java.sql.SQLException: Query failed (#20190618_122006_25427_gwsaa): Value cannot be cast to date: 
2019-06-18 19:18:52,687 - INFO - java.sql.SQLException: Query failed (#20190618_122007_25428_gwsaa): Value cannot be cast to date: 
2019-06-18 19:18:52,904 - INFO - java.sql.SQLException: Query failed (#20190618_122007_25429_gwsaa): Value cannot be cast to date: 
2019-06-18 19:18:53,104 - INFO - java.sql.SQLException: Query failed (#20190618_122007_25430_gwsaa): Value cannot be cast to date: 
2019-06-18 19:18:53,105 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 19:18:53,710 - INFO - Delete all data in the sheet
2019-06-18 19:19:41,694 - INFO - Reading Data From Google Sheet...
2019-06-18 19:19:42,040 - INFO - Get custom SQL..
2019-06-18 19:19:42,042 - INFO - USING CASE 3
2019-06-18 19:19:43,796 - INFO - Row 1
2019-06-18 19:19:43,796 - INFO - Filename: 
2019-06-18 19:19:43,798 - INFO - Category: ''
2019-06-18 19:19:43,798 - INFO - Last Login: 
2019-06-18 19:19:43,799 - INFO - Date 1: 
2019-06-18 19:19:43,799 - INFO - Date 2: 
2019-06-18 19:19:43,802 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 19:19:43,809 - INFO - Start Running query 
2019-06-18 19:19:44,069 - INFO - java.sql.SQLException: Query failed (#20190618_122058_25448_gwsaa): Value cannot be cast to date: 
2019-06-18 19:19:44,188 - INFO - java.sql.SQLException: Query failed (#20190618_122058_25449_gwsaa): Value cannot be cast to date: 
2019-06-18 19:19:44,326 - INFO - java.sql.SQLException: Query failed (#20190618_122059_25450_gwsaa): Value cannot be cast to date: 
2019-06-18 19:19:44,434 - INFO - java.sql.SQLException: Query failed (#20190618_122059_25451_gwsaa): Value cannot be cast to date: 
2019-06-18 19:19:44,553 - INFO - java.sql.SQLException: Query failed (#20190618_122059_25452_gwsaa): Value cannot be cast to date: 
2019-06-18 19:19:44,555 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 19:19:45,052 - INFO - Delete all data in the sheet
2019-06-18 19:20:22,017 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 19:20:23,026 - INFO - Reading Data From Google Sheet...
2019-06-18 19:20:23,375 - INFO - Get custom SQL..
2019-06-18 19:20:23,378 - INFO - USING CASE 4
2019-06-18 19:20:25,654 - INFO - Row 1
2019-06-18 19:20:25,655 - INFO - Filename: A10 female HBC buyers W30
2019-06-18 19:20:25,657 - INFO - Category: 'Health','Beauty','Health & Beauty','Cosmetics'
2019-06-18 19:20:25,658 - INFO - Last Login: 10
2019-06-18 19:20:25,660 - INFO - Error in get_custom_sql -> local variable 'str_gender' referenced before assignment
2019-06-18 19:24:13,305 - INFO - Report date: 20190618 19.24
2019-06-18 19:24:14,415 - INFO - Connect Google Sheet Successfully...
2019-06-18 19:24:14,430 - INFO - Download sheet..
2019-06-18 19:24:14,430 - INFO - Change directory to script path
2019-06-18 19:24:15,266 - INFO - Spreadsheet downloaded
2019-06-18 19:24:15,266 - INFO - Checking sheet..
2019-06-18 19:24:16,267 - INFO - Reading Data From Google Sheet...
2019-06-18 19:24:17,016 - INFO - Get custom SQL..
2019-06-18 19:24:17,016 - INFO - USING CASE 1
2019-06-18 19:24:18,545 - INFO - Row 1
2019-06-18 19:24:18,545 - INFO - Filename: A1 Home & Living and Hobby & Toys
2019-06-18 19:24:18,546 - INFO - Category: 'Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion'
2019-06-18 19:24:18,546 - INFO - Last Login: 1
2019-06-18 19:24:18,546 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Home & Living','Hobby & Toys','Electronics','Computer & Accessories','Fashion')
                                            and
                                            last_login >= current_date - interval '1' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 19:24:18,549 - INFO - Start Running query A1 Home & Living and Hobby & Toys
2019-06-18 19:26:41,059 - INFO - Running A1 Home & Living and Hobby & Toys Done
2019-06-18 19:26:41,059 - INFO - CSV file path: A1 Home & Living and Hobby & Toys
2019-06-18 19:26:41,352 - INFO - Starting save the query results
2019-06-18 19:26:41,354 - INFO - Total Rows : 3727032
2019-06-18 19:26:41,354 - INFO - Will split into : 4.0 files
2019-06-18 19:26:46,443 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.24/A1 Home & Living and Hobby & Toys_1.csv
2019-06-18 19:26:46,444 - INFO - , with total : 931758 rows
2019-06-18 19:26:51,532 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.24/A1 Home & Living and Hobby & Toys_2.csv
2019-06-18 19:26:51,533 - INFO - , with total : 931758 rows
2019-06-18 19:26:57,233 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.24/A1 Home & Living and Hobby & Toys_3.csv
2019-06-18 19:26:57,236 - INFO - , with total : 931758 rows
2019-06-18 19:27:03,194 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.24/A1 Home & Living and Hobby & Toys_4.csv
2019-06-18 19:27:03,194 - INFO - , with total : 931758 rows
2019-06-18 19:27:05,559 - INFO - Row 2
2019-06-18 19:27:05,561 - INFO - Filename: A1 Hobby & Toys CA F buyers
2019-06-18 19:27:05,562 - INFO - Category: 'Hobby & Toys','Electronics','Computer & Accessories','Fashion'
2019-06-18 19:27:05,562 - INFO - Last Login: 1
2019-06-18 19:27:05,562 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Hobby & Toys','Electronics','Computer & Accessories','Fashion')
                                            and
                                            last_login >= current_date - interval '1' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 19:27:05,565 - INFO - Start Running query A1 Hobby & Toys CA F buyers
2019-06-18 19:28:27,207 - INFO - Running A1 Hobby & Toys CA F buyers Done
2019-06-18 19:28:27,210 - INFO - CSV file path: A1 Hobby & Toys CA F buyers
2019-06-18 19:28:27,469 - INFO - Starting save the query results
2019-06-18 19:28:27,470 - INFO - Total Rows : 2734725
2019-06-18 19:28:27,471 - INFO - Will split into : 3.0 files
2019-06-18 19:28:33,546 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.24/A1 Hobby & Toys CA F buyers_1.csv
2019-06-18 19:28:33,552 - INFO - , with total : 911575 rows
2019-06-18 19:28:40,029 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.24/A1 Hobby & Toys CA F buyers_2.csv
2019-06-18 19:28:40,030 - INFO - , with total : 911575 rows
2019-06-18 19:28:47,651 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.24/A1 Hobby & Toys CA F buyers_3.csv
2019-06-18 19:28:47,654 - INFO - , with total : 911575 rows
2019-06-18 19:28:48,588 - INFO - Delete all data in the sheet
2019-06-18 19:28:49,125 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 19:28:50,127 - INFO - Reading Data From Google Sheet...
2019-06-18 19:28:50,721 - INFO - Get custom SQL..
2019-06-18 19:28:50,723 - INFO - USING CASE 2
2019-06-18 19:28:52,588 - INFO - Row 1
2019-06-18 19:28:52,589 - INFO - Filename: 
2019-06-18 19:28:52,591 - INFO - Last Login: 
2019-06-18 19:28:52,591 - INFO - Date 1: 
2019-06-18 19:28:52,592 - INFO - Date 2: 
2019-06-18 19:28:52,599 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                        from user_profile as u
                                        where
                                        last_login >= current_date - interval '' day
                                        and
                                        u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 19:28:52,605 - INFO - Start Running query 
2019-06-18 19:28:53,043 - INFO - java.sql.SQLException: Query failed (#20190618_123007_25571_gwsaa): Value cannot be cast to date: 
2019-06-18 19:28:53,213 - INFO - java.sql.SQLException: Query failed (#20190618_123007_25572_gwsaa): Value cannot be cast to date: 
2019-06-18 19:28:53,470 - INFO - java.sql.SQLException: Query failed (#20190618_123008_25573_gwsaa): Value cannot be cast to date: 
2019-06-18 19:28:54,302 - INFO - java.sql.SQLException: Query failed (#20190618_123008_25574_gwsaa): Value cannot be cast to date: 
2019-06-18 19:28:54,480 - INFO - java.sql.SQLException: Query failed (#20190618_123009_25575_gwsaa): Value cannot be cast to date: 
2019-06-18 19:28:54,483 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 19:28:55,058 - INFO - Delete all data in the sheet
2019-06-18 19:29:43,197 - INFO - Reading Data From Google Sheet...
2019-06-18 19:29:43,750 - INFO - Get custom SQL..
2019-06-18 19:29:43,750 - INFO - USING CASE 3
2019-06-18 19:29:45,463 - INFO - Row 1
2019-06-18 19:29:45,463 - INFO - Filename: 
2019-06-18 19:29:45,464 - INFO - Category: ''
2019-06-18 19:29:45,466 - INFO - Last Login: 
2019-06-18 19:29:45,467 - INFO - Date 1: 
2019-06-18 19:29:45,469 - INFO - Date 2: 
2019-06-18 19:29:45,469 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 19:29:45,474 - INFO - Start Running query 
2019-06-18 19:29:45,816 - INFO - java.sql.SQLException: Query failed (#20190618_123100_25579_gwsaa): Value cannot be cast to date: 
2019-06-18 19:29:45,953 - INFO - java.sql.SQLException: Query failed (#20190618_123100_25580_gwsaa): Value cannot be cast to date: 
2019-06-18 19:29:46,073 - INFO - java.sql.SQLException: Query failed (#20190618_123100_25581_gwsaa): Value cannot be cast to date: 
2019-06-18 19:29:46,196 - INFO - java.sql.SQLException: Query failed (#20190618_123100_25582_gwsaa): Value cannot be cast to date: 
2019-06-18 19:29:46,316 - INFO - java.sql.SQLException: Query failed (#20190618_123101_25583_gwsaa): Value cannot be cast to date: 
2019-06-18 19:29:46,318 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 19:29:46,663 - INFO - Delete all data in the sheet
2019-06-18 19:29:49,418 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 19:29:50,423 - INFO - Reading Data From Google Sheet...
2019-06-18 19:29:50,766 - INFO - Get custom SQL..
2019-06-18 19:29:50,770 - INFO - USING CASE 4
2019-06-18 19:29:52,970 - INFO - Row 1
2019-06-18 19:29:52,971 - INFO - Filename: A10 female HBC buyers W30
2019-06-18 19:29:52,974 - INFO - Category: 'Health','Beauty','Health & Beauty','Cosmetics'
2019-06-18 19:29:52,983 - INFO - Last Login: 10
2019-06-18 19:29:52,986 - INFO - Error in get_custom_sql -> cannot concatenate 'str' and 'NoneType' objects
2019-06-18 19:31:57,726 - INFO - Report date: 20190618 19.31
2019-06-18 19:31:59,118 - INFO - Connect Google Sheet Successfully...
2019-06-18 19:31:59,131 - INFO - Download sheet..
2019-06-18 19:31:59,135 - INFO - Change directory to script path
2019-06-18 19:32:00,329 - INFO - Spreadsheet downloaded
2019-06-18 19:32:00,331 - INFO - Checking sheet..
2019-06-18 19:32:01,332 - INFO - Reading Data From Google Sheet...
2019-06-18 19:32:02,005 - INFO - Get custom SQL..
2019-06-18 19:32:02,006 - INFO - USING CASE 1
2019-06-18 19:32:03,716 - INFO - Row 1
2019-06-18 19:32:03,717 - INFO - Filename: 
2019-06-18 19:32:03,717 - INFO - Category: ''
2019-06-18 19:32:03,717 - INFO - Last Login: 
2019-06-18 19:32:03,717 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 19:32:03,720 - INFO - Start Running query 
2019-06-18 19:32:11,825 - INFO - Running  Done
2019-06-18 19:32:11,825 - INFO - CSV file path: 
2019-06-18 19:32:11,828 - INFO - Starting save the query results
2019-06-18 19:32:11,828 - INFO - Total Rows : 8
2019-06-18 19:32:11,829 - INFO - Will split into : 1.0 files
2019-06-18 19:32:11,855 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.31/_1.csv
2019-06-18 19:32:11,855 - INFO - , with total : 8 rows
2019-06-18 19:32:12,444 - INFO - Delete all data in the sheet
2019-06-18 19:32:12,977 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 19:32:13,982 - INFO - Reading Data From Google Sheet...
2019-06-18 19:32:14,561 - INFO - Get custom SQL..
2019-06-18 19:32:14,562 - INFO - USING CASE 2
2019-06-18 19:32:16,875 - INFO - Row 1
2019-06-18 19:32:16,878 - INFO - Filename: 
2019-06-18 19:32:16,881 - INFO - Last Login: 
2019-06-18 19:32:16,884 - INFO - Date 1: 
2019-06-18 19:32:16,888 - INFO - Date 2: 
2019-06-18 19:32:16,892 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                        from user_profile as u
                                        where
                                        last_login >= current_date - interval '' day
                                        and
                                        u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 19:32:16,904 - INFO - Start Running query 
2019-06-18 19:32:17,289 - INFO - java.sql.SQLException: Query failed (#20190618_123331_25614_gwsaa): Value cannot be cast to date: 
2019-06-18 19:32:17,608 - INFO - java.sql.SQLException: Query failed (#20190618_123332_25615_gwsaa): Value cannot be cast to date: 
2019-06-18 19:32:17,927 - INFO - java.sql.SQLException: Query failed (#20190618_123332_25616_gwsaa): Value cannot be cast to date: 
2019-06-18 19:32:18,236 - INFO - java.sql.SQLException: Query failed (#20190618_123332_25617_gwsaa): Value cannot be cast to date: 
2019-06-18 19:32:18,367 - INFO - java.sql.SQLException: Query failed (#20190618_123333_25618_gwsaa): Value cannot be cast to date: 
2019-06-18 19:32:18,368 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 19:32:18,951 - INFO - Delete all data in the sheet
2019-06-18 19:32:19,586 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 400,
    "message": "Invalid requests[0].deleteDimension: Cannot delete a row that doesn't exist. Tried to delete row index 98 but there are only 97 rows.",
    "status": "INVALID_ARGUMENT"
  }
}

2019-06-18 19:32:20,595 - INFO - Reading Data From Google Sheet...
2019-06-18 19:32:21,176 - INFO - Get custom SQL..
2019-06-18 19:32:21,177 - INFO - USING CASE 3
2019-06-18 19:32:23,762 - INFO - Row 1
2019-06-18 19:32:23,763 - INFO - Filename: 
2019-06-18 19:32:23,765 - INFO - Category: ''
2019-06-18 19:32:23,766 - INFO - Last Login: 
2019-06-18 19:32:23,766 - INFO - Date 1: 
2019-06-18 19:32:23,769 - INFO - Date 2: 
2019-06-18 19:32:23,776 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 19:32:23,789 - INFO - Start Running query 
2019-06-18 19:32:23,895 - INFO - java.sql.SQLException: Query failed (#20190618_123338_25620_gwsaa): Value cannot be cast to date: 
2019-06-18 19:32:23,999 - INFO - java.sql.SQLException: Query failed (#20190618_123338_25621_gwsaa): Value cannot be cast to date: 
2019-06-18 19:32:24,101 - INFO - java.sql.SQLException: Query failed (#20190618_123338_25622_gwsaa): Value cannot be cast to date: 
2019-06-18 19:32:24,203 - INFO - java.sql.SQLException: Query failed (#20190618_123339_25623_gwsaa): Value cannot be cast to date: 
2019-06-18 19:32:24,305 - INFO - java.sql.SQLException: Query failed (#20190618_123339_25624_gwsaa): Value cannot be cast to date: 
2019-06-18 19:32:24,305 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 19:32:24,894 - INFO - Delete all data in the sheet
2019-06-18 19:33:12,002 - INFO - Reading Data From Google Sheet...
2019-06-18 19:33:12,345 - INFO - Get custom SQL..
2019-06-18 19:33:12,345 - INFO - USING CASE 4
2019-06-18 19:33:14,566 - INFO - Row 1
2019-06-18 19:33:14,568 - INFO - Filename: A10 female HBC buyers W30
2019-06-18 19:33:14,568 - INFO - Category: 'Health','Beauty','Health & Beauty','Cosmetics'
2019-06-18 19:33:14,569 - INFO - Last Login: 10
2019-06-18 19:33:14,569 - INFO - Error in get_custom_sql -> cannot concatenate 'str' and 'NoneType' objects
2019-06-18 19:34:12,500 - INFO - Report date: 20190618 19.34
2019-06-18 19:34:13,546 - INFO - Connect Google Sheet Successfully...
2019-06-18 19:34:13,552 - INFO - Download sheet..
2019-06-18 19:34:13,552 - INFO - Change directory to script path
2019-06-18 19:34:14,609 - INFO - Spreadsheet downloaded
2019-06-18 19:34:14,611 - INFO - Checking sheet..
2019-06-18 19:34:15,611 - INFO - Reading Data From Google Sheet...
2019-06-18 19:34:16,351 - INFO - Get custom SQL..
2019-06-18 19:34:16,352 - INFO - USING CASE 1
2019-06-18 19:34:18,084 - INFO - Row 1
2019-06-18 19:34:18,084 - INFO - Filename: 
2019-06-18 19:34:18,084 - INFO - Category: ''
2019-06-18 19:34:18,085 - INFO - Last Login: 
2019-06-18 19:34:18,085 - INFO - Query:
                                select distinct
                                            concat('user_id=',cast(u.userid as varchar)) list_userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            u.is_buyer = 1
                                
2019-06-18 19:34:18,086 - INFO - Start Running query 
2019-06-18 19:34:25,446 - INFO - Running  Done
2019-06-18 19:34:25,447 - INFO - CSV file path: 
2019-06-18 19:34:25,450 - INFO - Starting save the query results
2019-06-18 19:34:25,450 - INFO - Total Rows : 8
2019-06-18 19:34:25,451 - INFO - Will split into : 1.0 files
2019-06-18 19:34:25,476 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190618 19.34/_1.csv
2019-06-18 19:34:25,476 - INFO - , with total : 8 rows
2019-06-18 19:34:26,144 - INFO - Delete all data in the sheet
2019-06-18 19:35:15,898 - INFO - Reading Data From Google Sheet...
2019-06-18 19:35:16,233 - INFO - Get custom SQL..
2019-06-18 19:35:16,234 - INFO - USING CASE 2
2019-06-18 19:35:17,844 - INFO - Row 1
2019-06-18 19:35:17,845 - INFO - Filename: 
2019-06-18 19:35:17,845 - INFO - Last Login: 
2019-06-18 19:35:17,846 - INFO - Date 1: 
2019-06-18 19:35:17,848 - INFO - Date 2: 
2019-06-18 19:35:17,849 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                        from user_profile as u
                                        where
                                        last_login >= current_date - interval '' day
                                        and
                                        u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 19:35:17,857 - INFO - Start Running query 
2019-06-18 19:35:18,220 - INFO - java.sql.SQLException: Query failed (#20190618_123632_25678_gwsaa): Value cannot be cast to date: 
2019-06-18 19:35:18,441 - INFO - java.sql.SQLException: Query failed (#20190618_123633_25679_gwsaa): Value cannot be cast to date: 
2019-06-18 19:35:18,586 - INFO - java.sql.SQLException: Query failed (#20190618_123633_25680_gwsaa): Value cannot be cast to date: 
2019-06-18 19:35:18,737 - INFO - java.sql.SQLException: Query failed (#20190618_123633_25681_gwsaa): Value cannot be cast to date: 
2019-06-18 19:35:18,878 - INFO - java.sql.SQLException: Query failed (#20190618_123633_25682_gwsaa): Value cannot be cast to date: 
2019-06-18 19:35:18,878 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 19:35:19,213 - INFO - Delete all data in the sheet
2019-06-18 19:35:19,604 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 400,
    "message": "Invalid requests[0].deleteDimension: Cannot delete a row that doesn't exist. Tried to delete row index 98 but there are only 97 rows.",
    "status": "INVALID_ARGUMENT"
  }
}

2019-06-18 19:35:20,607 - INFO - Reading Data From Google Sheet...
2019-06-18 19:35:20,927 - INFO - Get custom SQL..
2019-06-18 19:35:20,928 - INFO - USING CASE 3
2019-06-18 19:35:23,168 - INFO - Row 1
2019-06-18 19:35:23,170 - INFO - Filename: 
2019-06-18 19:35:23,171 - INFO - Category: ''
2019-06-18 19:35:23,173 - INFO - Last Login: 
2019-06-18 19:35:23,174 - INFO - Date 1: 
2019-06-18 19:35:23,176 - INFO - Date 2: 
2019-06-18 19:35:23,177 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('')
                                            and
                                            last_login >= current_date - interval '' day
                                            and
                                            u.status = 1
                                            and
                                            is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'' and date''
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-18 19:35:23,183 - INFO - Start Running query 
2019-06-18 19:35:23,306 - INFO - java.sql.SQLException: Query failed (#20190618_123638_25686_gwsaa): Value cannot be cast to date: 
2019-06-18 19:35:23,444 - INFO - java.sql.SQLException: Query failed (#20190618_123638_25688_gwsaa): Value cannot be cast to date: 
2019-06-18 19:35:23,553 - INFO - java.sql.SQLException: Query failed (#20190618_123638_25689_gwsaa): Value cannot be cast to date: 
2019-06-18 19:35:23,680 - INFO - java.sql.SQLException: Query failed (#20190618_123638_25691_gwsaa): Value cannot be cast to date: 
2019-06-18 19:35:24,729 - INFO - java.sql.SQLException: Query failed (#20190618_123638_25692_gwsaa): Value cannot be cast to date: 
2019-06-18 19:35:24,832 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-18 19:35:25,362 - INFO - Delete all data in the sheet
2019-06-18 19:35:28,532 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'WriteGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-18 19:35:29,743 - INFO - Reading Data From Google Sheet...
2019-06-18 19:35:30,382 - INFO - Get custom SQL..
2019-06-18 19:35:30,423 - INFO - USING CASE 4
2019-06-18 19:35:32,987 - INFO - Row 1
2019-06-18 19:35:33,002 - INFO - Filename: A10 female HBC buyers W30
2019-06-18 19:35:33,007 - INFO - Category: 'Health','Beauty','Health & Beauty','Cosmetics'
2019-06-18 19:35:33,020 - INFO - Last Login: 10
2019-06-18 19:35:33,036 - INFO - Error in get_custom_sql -> cannot concatenate 'str' and 'NoneType' objects
2019-06-19 10:11:46,864 - INFO - Report date: 20190619 10.11
2019-06-19 10:11:48,009 - INFO - Connect Google Sheet Successfully...
2019-06-19 10:11:48,023 - INFO - Download sheet..
2019-06-19 10:11:48,025 - INFO - Change directory to script path
2019-06-19 10:11:49,355 - INFO - Spreadsheet downloaded
2019-06-19 10:11:49,355 - INFO - Checking sheet..
2019-06-19 10:11:51,927 - INFO - No value detected on sheet: Case 1
2019-06-19 10:11:54,278 - INFO - No value detected on sheet: Case 2
2019-06-19 10:11:56,726 - INFO - No value detected on sheet: Case 3
2019-06-19 10:12:21,793 - INFO - Report date: 20190619 10.12
2019-06-19 10:12:22,704 - INFO - Connect Google Sheet Successfully...
2019-06-19 10:12:22,713 - INFO - Download sheet..
2019-06-19 10:12:22,714 - INFO - Change directory to script path
2019-06-19 10:12:23,759 - INFO - Spreadsheet downloaded
2019-06-19 10:12:23,759 - INFO - Checking sheet..
2019-06-19 10:12:26,522 - INFO - No value detected on sheet: Case 1
2019-06-19 10:12:29,079 - INFO - No value detected on sheet: Case 2
2019-06-19 10:12:31,293 - INFO - No value detected on sheet: Case 3
2019-06-19 10:12:33,700 - INFO - Use sheet: Case 4
2019-06-19 10:12:34,707 - INFO - Reading Data From Google Sheet...
2019-06-19 10:12:35,313 - INFO - Get custom SQL..
2019-06-19 10:12:35,315 - INFO - USING CASE 4
2019-06-19 10:12:39,476 - INFO - Row 1
2019-06-19 10:12:39,476 - INFO - Filename: A10 female HBC buyers W30
2019-06-19 10:12:39,476 - INFO - Category: 'Health','Beauty','Health & Beauty','Cosmetics'
2019-06-19 10:12:39,477 - INFO - Last Login: 10
2019-06-19 10:12:39,477 - INFO - Error in get_custom_sql -> cannot concatenate 'str' and 'NoneType' objects
2019-06-19 10:13:25,605 - INFO - Report date: 20190619 10.13
2019-06-19 10:13:26,641 - INFO - Connect Google Sheet Successfully...
2019-06-19 10:13:26,651 - INFO - Download sheet..
2019-06-19 10:13:26,651 - INFO - Change directory to script path
2019-06-19 10:13:27,526 - INFO - Spreadsheet downloaded
2019-06-19 10:13:27,526 - INFO - Checking sheet..
2019-06-19 10:13:29,907 - INFO - No value detected on sheet: Case 1
2019-06-19 10:13:32,365 - INFO - No value detected on sheet: Case 2
2019-06-19 10:13:34,717 - INFO - No value detected on sheet: Case 3
2019-06-19 10:13:37,078 - INFO - Use sheet: Case 4
2019-06-19 10:13:38,081 - INFO - Reading Data From Google Sheet...
2019-06-19 10:13:38,924 - INFO - Get custom SQL..
2019-06-19 10:13:38,928 - INFO - USING CASE 4
2019-06-19 10:13:43,119 - INFO - Row 1
2019-06-19 10:13:43,122 - INFO - Filename: A10 female HBC buyers W30
2019-06-19 10:13:43,125 - INFO - Category: 'Health','Beauty','Health & Beauty','Cosmetics'
2019-06-19 10:13:43,128 - INFO - Last Login: 10
2019-06-19 10:13:43,132 - INFO - Error in get_custom_sql -> cannot concatenate 'str' and 'NoneType' objects
2019-06-19 10:14:10,371 - INFO - Report date: 20190619 10.14
2019-06-19 10:14:11,394 - INFO - Connect Google Sheet Successfully...
2019-06-19 10:14:11,410 - INFO - Download sheet..
2019-06-19 10:14:11,411 - INFO - Change directory to script path
2019-06-19 10:14:12,451 - INFO - Spreadsheet downloaded
2019-06-19 10:14:12,453 - INFO - Checking sheet..
2019-06-19 10:14:15,065 - INFO - No value detected on sheet: Case 1
2019-06-19 10:14:17,437 - INFO - No value detected on sheet: Case 2
2019-06-19 10:14:19,660 - INFO - No value detected on sheet: Case 3
2019-06-19 10:14:21,884 - INFO - Use sheet: Case 4
2019-06-19 10:14:22,890 - INFO - Reading Data From Google Sheet...
2019-06-19 10:14:23,671 - INFO - Get custom SQL..
2019-06-19 10:14:23,674 - INFO - USING CASE 4
2019-06-19 10:14:28,173 - INFO - Error in get_custom_sql -> cannot concatenate 'str' and 'bool' objects
2019-06-19 10:14:50,101 - INFO - Report date: 20190619 10.14
2019-06-19 10:14:51,105 - INFO - Connect Google Sheet Successfully...
2019-06-19 10:14:51,117 - INFO - Error: G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.14/ - The directory is not empty.
2019-06-19 10:14:51,119 - INFO - Error in downloading sheet -> [Error 183] Cannot create a file when that file already exists: 'G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.14/'
2019-06-19 10:14:51,121 - INFO - Checking sheet..
2019-06-19 10:14:53,628 - INFO - No value detected on sheet: Case 1
2019-06-19 10:14:55,914 - INFO - No value detected on sheet: Case 2
2019-06-19 10:14:58,200 - INFO - No value detected on sheet: Case 3
2019-06-19 10:15:00,611 - INFO - Use sheet: Case 4
2019-06-19 10:15:01,615 - INFO - Reading Data From Google Sheet...
2019-06-19 10:15:02,296 - INFO - Get custom SQL..
2019-06-19 10:15:02,298 - INFO - USING CASE 4
2019-06-19 10:15:06,167 - INFO - Row 1
2019-06-19 10:15:06,168 - INFO - Filename: A10 female HBC buyers W30
2019-06-19 10:15:06,171 - INFO - Category: 'Health','Beauty','Health & Beauty','Cosmetics'
2019-06-19 10:15:06,171 - INFO - Last Login: 10
2019-06-19 10:15:06,171 - INFO - Error in get_custom_sql -> cannot concatenate 'str' and 'NoneType' objects
2019-06-19 10:16:11,834 - INFO - Report date: 20190619 10.16
2019-06-19 10:16:13,019 - INFO - Connect Google Sheet Successfully...
2019-06-19 10:16:13,029 - INFO - Download sheet..
2019-06-19 10:16:13,029 - INFO - Change directory to script path
2019-06-19 10:16:13,852 - INFO - Spreadsheet downloaded
2019-06-19 10:16:13,854 - INFO - Checking sheet..
2019-06-19 10:16:16,415 - INFO - No value detected on sheet: Case 1
2019-06-19 10:16:18,667 - INFO - No value detected on sheet: Case 2
2019-06-19 10:16:20,880 - INFO - No value detected on sheet: Case 3
2019-06-19 10:16:23,181 - INFO - Use sheet: Case 4
2019-06-19 10:16:24,187 - INFO - Reading Data From Google Sheet...
2019-06-19 10:16:24,813 - INFO - Get custom SQL..
2019-06-19 10:16:24,816 - INFO - USING CASE 4
2019-06-19 10:16:29,210 - INFO - Row 1
2019-06-19 10:16:29,211 - INFO - Filename: A10 female HBC buyers W30
2019-06-19 10:16:29,214 - INFO - Category: 'Health','Beauty','Health & Beauty','Cosmetics'
2019-06-19 10:16:29,217 - INFO - Last Login: 10
2019-06-19 10:16:29,220 - INFO - Gender: 1,3
2019-06-19 10:16:29,223 - INFO - Date 1: 2019-05-18
2019-06-19 10:16:29,226 - INFO - Date 2: 2019-05-08
2019-06-19 10:16:29,230 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Health','Beauty','Health & Beauty','Cosmetics')
                                            and
                                            last_login >= current_date - interval '10' day
                                            and
                                            u.status = 1
                                            and 
                                            gender in (Male)
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-05-18' and date'2019-05-08'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-19 10:16:29,239 - INFO - Start Running query A10 female HBC buyers W30
2019-06-19 10:16:35,331 - INFO - java.sql.SQLException: Query failed (#20190619_031747_05173_gwsaa): line 15:56: Column 'male' cannot be resolved
2019-06-19 10:16:35,617 - INFO - java.sql.SQLException: Query failed (#20190619_031750_05181_gwsaa): line 15:56: Column 'male' cannot be resolved
2019-06-19 10:16:35,941 - INFO - java.sql.SQLException: Query failed (#20190619_031750_05182_gwsaa): line 15:56: Column 'male' cannot be resolved
2019-06-19 10:16:36,348 - INFO - java.sql.SQLException: Query failed (#20190619_031751_05183_gwsaa): line 15:56: Column 'male' cannot be resolved
2019-06-19 10:16:36,790 - INFO - java.sql.SQLException: Query failed (#20190619_031751_05184_gwsaa): line 15:56: Column 'male' cannot be resolved
2019-06-19 10:16:36,795 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-06-19 10:16:37,453 - INFO - Delete all data in the sheet
2019-06-19 10:17:34,687 - INFO - Report date: 20190619 10.17
2019-06-19 10:17:35,986 - INFO - Connect Google Sheet Successfully...
2019-06-19 10:17:36,000 - INFO - Download sheet..
2019-06-19 10:17:36,000 - INFO - Change directory to script path
2019-06-19 10:17:37,088 - INFO - Spreadsheet downloaded
2019-06-19 10:17:37,089 - INFO - Checking sheet..
2019-06-19 10:17:39,625 - INFO - No value detected on sheet: Case 1
2019-06-19 10:17:41,911 - INFO - No value detected on sheet: Case 2
2019-06-19 10:17:43,947 - INFO - No value detected on sheet: Case 3
2019-06-19 10:17:46,319 - INFO - Use sheet: Case 4
2019-06-19 10:17:47,332 - INFO - Reading Data From Google Sheet...
2019-06-19 10:17:48,059 - INFO - Get custom SQL..
2019-06-19 10:17:48,059 - INFO - USING CASE 4
2019-06-19 10:17:51,789 - INFO - Row 1
2019-06-19 10:17:51,789 - INFO - Filename: A10 female HBC buyers W30
2019-06-19 10:17:51,790 - INFO - Category: 'Health','Beauty','Health & Beauty','Cosmetics'
2019-06-19 10:17:51,790 - INFO - Last Login: 10
2019-06-19 10:17:51,792 - INFO - Gender: 1,3
2019-06-19 10:17:51,792 - INFO - Date 1: 2019-05-18
2019-06-19 10:17:51,793 - INFO - Date 2: 2019-05-08
2019-06-19 10:17:51,795 - INFO - Query:
                                with a as(
                                select distinct
                                            u.userid
                                            from user_profile as u
                                            join order_mart__order_item_profile as p
                                            on u.userid = p.userid
                                            where
                                            p.main_category in ('Health','Beauty','Health & Beauty','Cosmetics')
                                            and
                                            last_login >= current_date - interval '10' day
                                            and
                                            u.status = 1
                                            and 
                                            gender in (1,3)
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-05-18' and date'2019-05-08'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-19 10:17:51,799 - INFO - Start Running query A10 female HBC buyers W30
2019-06-19 10:25:15,596 - INFO - Running A10 female HBC buyers W30 Done
2019-06-19 10:25:15,598 - INFO - CSV file path: A10 female HBC buyers W30
2019-06-19 10:25:15,756 - INFO - Starting save the query results
2019-06-19 10:25:15,759 - INFO - Total Rows : 1080570
2019-06-19 10:25:15,760 - INFO - Will split into : 2.0 files
2019-06-19 10:25:23,352 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.17/A10 female HBC buyers W30_1.csv
2019-06-19 10:25:23,357 - INFO - , with total : 540285 rows
2019-06-19 10:25:29,993 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.17/A10 female HBC buyers W30_2.csv
2019-06-19 10:25:30,000 - INFO - , with total : 540285 rows
2019-06-19 10:25:30,844 - INFO - Delete all data in the sheet
2019-06-19 10:41:40,118 - INFO - Report date: 20190619 10.41
2019-06-19 10:41:41,178 - INFO - Connect Google Sheet Successfully...
2019-06-19 10:41:41,191 - INFO - Download sheet..
2019-06-19 10:41:41,193 - INFO - Change directory to script path
2019-06-19 10:41:42,243 - INFO - Spreadsheet downloaded
2019-06-19 10:41:42,243 - INFO - Checking sheet..
2019-06-19 10:41:44,680 - INFO - No value detected on sheet: Case 1
2019-06-19 10:41:46,892 - INFO - Use sheet: Case 2
2019-06-19 10:41:47,897 - INFO - Reading Data From Google Sheet...
2019-06-19 10:41:48,492 - INFO - Get custom SQL..
2019-06-19 10:41:48,493 - INFO - USING CASE 2
2019-06-19 10:41:51,180 - INFO - Row 1
2019-06-19 10:41:51,190 - INFO - Filename: A10 W10
2019-06-19 10:41:51,191 - INFO - Last Login: 10
2019-06-19 10:41:51,194 - INFO - Date 1: 2019-06-08
2019-06-19 10:41:51,200 - INFO - Date 2: 2019-06-18
2019-06-19 10:41:51,203 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '10' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-08' and date'2019-06-18'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-19 10:41:51,217 - INFO - Start Running query A10 W10
2019-06-19 10:53:25,207 - INFO - Running A10 W10 Done
2019-06-19 10:53:25,209 - INFO - CSV file path: A10 W10
2019-06-19 10:53:26,173 - INFO - Starting save the query results
2019-06-19 10:53:26,174 - INFO - Total Rows : 11449506
2019-06-19 10:53:26,174 - INFO - Will split into : 12.0 files
2019-06-19 10:53:31,713 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_1.csv
2019-06-19 10:53:31,713 - INFO - , with total : 954126 rows
2019-06-19 10:53:37,371 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_2.csv
2019-06-19 10:53:37,371 - INFO - , with total : 954126 rows
2019-06-19 10:53:45,151 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_3.csv
2019-06-19 10:53:45,153 - INFO - , with total : 954126 rows
2019-06-19 10:53:52,157 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_4.csv
2019-06-19 10:53:52,160 - INFO - , with total : 954126 rows
2019-06-19 10:53:58,812 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_5.csv
2019-06-19 10:53:58,812 - INFO - , with total : 954126 rows
2019-06-19 10:54:05,411 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_6.csv
2019-06-19 10:54:05,414 - INFO - , with total : 954126 rows
2019-06-19 10:54:12,040 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_7.csv
2019-06-19 10:54:12,042 - INFO - , with total : 954125 rows
2019-06-19 10:54:18,641 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_8.csv
2019-06-19 10:54:18,642 - INFO - , with total : 954125 rows
2019-06-19 10:54:25,042 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_9.csv
2019-06-19 10:54:25,042 - INFO - , with total : 954125 rows
2019-06-19 10:54:31,594 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_10.csv
2019-06-19 10:54:31,594 - INFO - , with total : 954125 rows
2019-06-19 10:54:38,174 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_11.csv
2019-06-19 10:54:38,174 - INFO - , with total : 954125 rows
2019-06-19 10:54:44,517 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A10 W10_12.csv
2019-06-19 10:54:44,519 - INFO - , with total : 954125 rows
2019-06-19 10:54:48,944 - INFO - Row 2
2019-06-19 10:54:48,944 - INFO - Filename: A5 W5
2019-06-19 10:54:48,947 - INFO - Last Login: 5
2019-06-19 10:54:48,948 - INFO - Date 1: 2019-06-13
2019-06-19 10:54:48,950 - INFO - Date 2: 2019-06-18
2019-06-19 10:54:48,953 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '5' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-13' and date'2019-06-18'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-19 10:54:48,960 - INFO - Start Running query A5 W5
2019-06-19 11:07:32,269 - INFO - Running A5 W5 Done
2019-06-19 11:07:32,315 - INFO - CSV file path: A5 W5
2019-06-19 11:07:33,114 - INFO - Starting save the query results
2019-06-19 11:07:33,115 - INFO - Total Rows : 9740577
2019-06-19 11:07:33,115 - INFO - Will split into : 10.0 files
2019-06-19 11:07:39,437 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A5 W5_1.csv
2019-06-19 11:07:39,437 - INFO - , with total : 974058 rows
2019-06-19 11:07:47,426 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A5 W5_2.csv
2019-06-19 11:07:47,427 - INFO - , with total : 974058 rows
2019-06-19 11:07:56,315 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A5 W5_3.csv
2019-06-19 11:07:56,368 - INFO - , with total : 974058 rows
2019-06-19 11:08:05,604 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A5 W5_4.csv
2019-06-19 11:08:05,604 - INFO - , with total : 974058 rows
2019-06-19 11:08:13,381 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A5 W5_5.csv
2019-06-19 11:08:13,381 - INFO - , with total : 974058 rows
2019-06-19 11:08:22,520 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A5 W5_6.csv
2019-06-19 11:08:22,523 - INFO - , with total : 974058 rows
2019-06-19 11:08:31,361 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A5 W5_7.csv
2019-06-19 11:08:31,364 - INFO - , with total : 974058 rows
2019-06-19 11:08:42,089 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A5 W5_8.csv
2019-06-19 11:08:42,096 - INFO - , with total : 974057 rows
2019-06-19 11:08:56,811 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A5 W5_9.csv
2019-06-19 11:08:56,812 - INFO - , with total : 974057 rows
2019-06-19 11:09:04,178 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190619 10.41/A5 W5_10.csv
2019-06-19 11:09:04,180 - INFO - , with total : 974057 rows
2019-06-19 11:09:05,595 - INFO - Delete all data in the sheet
2019-06-19 11:09:06,272 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 400,
    "message": "Invalid requests[0].deleteDimension: Cannot delete a row that doesn't exist. Tried to delete row index 98 but there are only 97 rows.",
    "status": "INVALID_ARGUMENT"
  }
}

2019-06-19 11:09:08,497 - INFO - No value detected on sheet: Case 3
2019-06-19 11:09:10,696 - INFO - Use sheet: Case 4
2019-06-19 11:09:11,697 - INFO - Reading Data From Google Sheet...
2019-06-19 11:09:12,290 - INFO - Get custom SQL..
2019-06-19 11:09:12,292 - INFO - USING CASE 4
2019-06-19 11:09:14,717 - INFO - Row 1
2019-06-19 11:09:14,717 - INFO - Filename: A1 female F HL buyers
2019-06-19 11:09:14,720 - INFO - Category: 'Fashion','Home & Living'
2019-06-19 11:09:14,721 - INFO - Last Login: 1
2019-06-19 11:09:14,729 - INFO - Gender: 2,4
2019-06-19 11:09:14,730 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Home & Living')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-06-19 11:09:14,736 - INFO - Start Running query A1 female F HL buyers
2019-06-24 13:35:19,104 - INFO - Report date: 20190624 13.35
2019-06-24 13:35:20,073 - INFO - Connect Google Sheet Successfully...
2019-06-24 13:35:20,098 - INFO - Download sheet..
2019-06-24 13:35:20,098 - INFO - Change directory to script path
2019-06-24 13:35:21,474 - INFO - Spreadsheet downloaded
2019-06-24 13:35:21,480 - INFO - Checking sheet..
2019-06-24 13:35:24,223 - INFO - No value detected on sheet: Case 1
2019-06-24 13:35:26,627 - INFO - Use sheet: Case 2
2019-06-24 13:35:27,631 - INFO - Reading Data From Google Sheet...
2019-06-24 13:35:28,392 - INFO - Get custom SQL..
2019-06-24 13:35:28,395 - INFO - USING CASE 2
2019-06-24 13:35:31,500 - INFO - Row 1
2019-06-24 13:35:31,502 - INFO - Filename: A10 W10
2019-06-24 13:35:31,503 - INFO - Last Login: 10
2019-06-24 13:35:31,503 - INFO - Date 1: 2019-06-08
2019-06-24 13:35:31,505 - INFO - Date 2: 2019-06-18
2019-06-24 13:35:31,505 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '10' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-08' and date'2019-06-18'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-24 13:35:31,506 - INFO - Start Running query A10 W10
2019-06-24 13:46:13,160 - INFO - Running A10 W10 Done
2019-06-24 13:46:13,161 - INFO - CSV file path: A10 W10
2019-06-24 13:46:15,197 - INFO - Starting save the query results
2019-06-24 13:46:15,197 - INFO - Total Rows : 11632485
2019-06-24 13:46:15,198 - INFO - Will split into : 12.0 files
2019-06-24 13:46:28,480 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_1.csv
2019-06-24 13:46:28,484 - INFO - , with total : 969374 rows
2019-06-24 13:46:41,180 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_2.csv
2019-06-24 13:46:41,183 - INFO - , with total : 969374 rows
2019-06-24 13:46:51,052 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_3.csv
2019-06-24 13:46:51,052 - INFO - , with total : 969374 rows
2019-06-24 13:47:00,844 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_4.csv
2019-06-24 13:47:00,845 - INFO - , with total : 969374 rows
2019-06-24 13:47:09,023 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_5.csv
2019-06-24 13:47:09,023 - INFO - , with total : 969374 rows
2019-06-24 13:47:17,239 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_6.csv
2019-06-24 13:47:17,240 - INFO - , with total : 969374 rows
2019-06-24 13:47:25,803 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_7.csv
2019-06-24 13:47:25,805 - INFO - , with total : 969374 rows
2019-06-24 13:47:35,586 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_8.csv
2019-06-24 13:47:35,588 - INFO - , with total : 969374 rows
2019-06-24 13:47:44,822 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_9.csv
2019-06-24 13:47:44,822 - INFO - , with total : 969374 rows
2019-06-24 13:47:54,990 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_10.csv
2019-06-24 13:47:54,990 - INFO - , with total : 969373 rows
2019-06-24 13:48:03,670 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_11.csv
2019-06-24 13:48:03,671 - INFO - , with total : 969373 rows
2019-06-24 13:48:11,532 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A10 W10_12.csv
2019-06-24 13:48:11,533 - INFO - , with total : 969373 rows
2019-06-24 13:48:16,381 - INFO - Row 2
2019-06-24 13:48:16,384 - INFO - Filename: A5 W5
2019-06-24 13:48:16,384 - INFO - Last Login: 5
2019-06-24 13:48:16,387 - INFO - Date 1: 2019-06-13
2019-06-24 13:48:16,388 - INFO - Date 2: 2019-06-18
2019-06-24 13:48:16,390 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '5' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-13' and date'2019-06-18'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-24 13:48:16,403 - INFO - Start Running query A5 W5
2019-06-24 13:58:34,917 - INFO - Running A5 W5 Done
2019-06-24 13:58:34,918 - INFO - CSV file path: A5 W5
2019-06-24 13:58:36,434 - INFO - Starting save the query results
2019-06-24 13:58:36,436 - INFO - Total Rows : 10032093
2019-06-24 13:58:36,437 - INFO - Will split into : 11.0 files
2019-06-24 13:58:48,421 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_1.csv
2019-06-24 13:58:48,423 - INFO - , with total : 912009 rows
2019-06-24 13:58:58,098 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_2.csv
2019-06-24 13:58:58,101 - INFO - , with total : 912009 rows
2019-06-24 13:59:06,403 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_3.csv
2019-06-24 13:59:06,404 - INFO - , with total : 912009 rows
2019-06-24 13:59:14,331 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_4.csv
2019-06-24 13:59:14,332 - INFO - , with total : 912009 rows
2019-06-24 13:59:22,352 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_5.csv
2019-06-24 13:59:22,355 - INFO - , with total : 912009 rows
2019-06-24 13:59:30,538 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_6.csv
2019-06-24 13:59:30,539 - INFO - , with total : 912008 rows
2019-06-24 13:59:38,523 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_7.csv
2019-06-24 13:59:38,525 - INFO - , with total : 912008 rows
2019-06-24 13:59:46,482 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_8.csv
2019-06-24 13:59:46,483 - INFO - , with total : 912008 rows
2019-06-24 13:59:54,934 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_9.csv
2019-06-24 13:59:54,936 - INFO - , with total : 912008 rows
2019-06-24 14:00:03,091 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_10.csv
2019-06-24 14:00:03,092 - INFO - , with total : 912008 rows
2019-06-24 14:00:10,013 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 13.35/A5 W5_11.csv
2019-06-24 14:00:10,016 - INFO - , with total : 912008 rows
2019-06-24 14:00:11,911 - INFO - Delete all data in the sheet
2019-06-24 14:00:39,460 - INFO - No value detected on sheet: Case 3
2019-06-24 14:00:41,650 - INFO - Use sheet: Case 4
2019-06-24 14:00:42,653 - INFO - Reading Data From Google Sheet...
2019-06-24 14:00:43,960 - INFO - {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-06-24 16:50:58,155 - INFO - Report date: 20190624 16.50
2019-06-24 16:50:59,046 - INFO - Connect Google Sheet Successfully...
2019-06-24 16:50:59,058 - INFO - Download sheet..
2019-06-24 16:50:59,059 - INFO - Change directory to script path
2019-06-24 16:51:00,125 - INFO - Spreadsheet downloaded
2019-06-24 16:51:00,128 - INFO - Checking sheet..
2019-06-24 16:51:04,076 - INFO - Use sheet: Case 1
2019-06-24 16:51:05,091 - INFO - Reading Data From Google Sheet...
2019-06-24 16:51:06,025 - INFO - Get custom SQL..
2019-06-24 16:51:06,026 - INFO - USING CASE 1
2019-06-24 16:51:10,155 - INFO - Row 1
2019-06-24 16:51:10,161 - INFO - Filename: A5 HL & E Buyers
2019-06-24 16:51:10,167 - INFO - Category: 'Home & Living','Electronics'
2019-06-24 16:51:10,170 - INFO - Last Login: 5
2019-06-24 16:51:10,174 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living','Electronics')
                                    and
                                    last_login >= current_date - interval '5' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-06-24 16:51:10,184 - INFO - Start Running query A5 HL & E Buyers
2019-06-24 16:54:21,743 - INFO - Running A5 HL & E Buyers Done
2019-06-24 16:54:21,744 - INFO - CSV file path: A5 HL & E Buyers
2019-06-24 16:54:22,171 - INFO - Starting save the query results
2019-06-24 16:54:22,173 - INFO - Total Rows : 5421260
2019-06-24 16:54:22,174 - INFO - Will split into : 6.0 files
2019-06-24 16:54:26,901 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 HL & E Buyers_1.csv
2019-06-24 16:54:26,901 - INFO - , with total : 903544 rows
2019-06-24 16:54:31,612 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 HL & E Buyers_2.csv
2019-06-24 16:54:31,612 - INFO - , with total : 903544 rows
2019-06-24 16:54:36,528 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 HL & E Buyers_3.csv
2019-06-24 16:54:36,529 - INFO - , with total : 903543 rows
2019-06-24 16:54:41,207 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 HL & E Buyers_4.csv
2019-06-24 16:54:41,210 - INFO - , with total : 903543 rows
2019-06-24 16:54:45,884 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 HL & E Buyers_5.csv
2019-06-24 16:54:45,884 - INFO - , with total : 903543 rows
2019-06-24 16:54:50,582 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 HL & E Buyers_6.csv
2019-06-24 16:54:50,584 - INFO - , with total : 903543 rows
2019-06-24 16:54:51,628 - INFO - Delete all data in the sheet
2019-06-24 16:56:44,785 - INFO - Use sheet: Case 2
2019-06-24 16:56:45,788 - INFO - Reading Data From Google Sheet...
2019-06-24 16:56:47,635 - INFO - Get custom SQL..
2019-06-24 16:56:47,638 - INFO - USING CASE 2
2019-06-24 16:56:50,966 - INFO - Row 1
2019-06-24 16:56:50,967 - INFO - Filename: A5 W5
2019-06-24 16:56:50,970 - INFO - Last Login: 5
2019-06-24 16:56:50,971 - INFO - Date 1: 2019-06-18
2019-06-24 16:56:50,974 - INFO - Date 2: 2019-06-23
2019-06-24 16:56:50,979 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '5' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-18' and date'2019-06-23'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-24 16:56:50,984 - INFO - Start Running query A5 W5
2019-06-24 17:02:16,844 - INFO - Running A5 W5 Done
2019-06-24 17:02:16,848 - INFO - CSV file path: A5 W5
2019-06-24 17:02:17,569 - INFO - Starting save the query results
2019-06-24 17:02:17,571 - INFO - Total Rows : 9900869
2019-06-24 17:02:17,572 - INFO - Will split into : 10.0 files
2019-06-24 17:02:22,572 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 W5_1.csv
2019-06-24 17:02:22,575 - INFO - , with total : 990087 rows
2019-06-24 17:02:27,528 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 W5_2.csv
2019-06-24 17:02:27,529 - INFO - , with total : 990087 rows
2019-06-24 17:02:33,144 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 W5_3.csv
2019-06-24 17:02:33,148 - INFO - , with total : 990087 rows
2019-06-24 17:02:38,232 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 W5_4.csv
2019-06-24 17:02:38,236 - INFO - , with total : 990087 rows
2019-06-24 17:02:43,342 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 W5_5.csv
2019-06-24 17:02:43,342 - INFO - , with total : 990087 rows
2019-06-24 17:02:48,436 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 W5_6.csv
2019-06-24 17:02:48,437 - INFO - , with total : 990087 rows
2019-06-24 17:02:53,709 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 W5_7.csv
2019-06-24 17:02:53,710 - INFO - , with total : 990087 rows
2019-06-24 17:02:59,371 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 W5_8.csv
2019-06-24 17:02:59,372 - INFO - , with total : 990087 rows
2019-06-24 17:03:04,910 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 W5_9.csv
2019-06-24 17:03:04,911 - INFO - , with total : 990087 rows
2019-06-24 17:03:10,267 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A5 W5_10.csv
2019-06-24 17:03:10,269 - INFO - , with total : 990086 rows
2019-06-24 17:03:14,700 - INFO - Row 2
2019-06-24 17:03:14,701 - INFO - Filename: A10 W10
2019-06-24 17:03:14,703 - INFO - Last Login: 10
2019-06-24 17:03:14,706 - INFO - Date 1: 2019-06-13
2019-06-24 17:03:14,707 - INFO - Date 2: 2019-06-23
2019-06-24 17:03:14,709 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '10' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-13' and date'2019-06-23'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-06-24 17:03:14,717 - INFO - Start Running query A10 W10
2019-06-24 17:08:58,700 - INFO - Running A10 W10 Done
2019-06-24 17:08:58,703 - INFO - CSV file path: A10 W10
2019-06-24 17:08:59,568 - INFO - Starting save the query results
2019-06-24 17:08:59,571 - INFO - Total Rows : 11394543
2019-06-24 17:08:59,572 - INFO - Will split into : 12.0 files
2019-06-24 17:09:04,496 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_1.csv
2019-06-24 17:09:04,503 - INFO - , with total : 949546 rows
2019-06-24 17:09:09,348 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_2.csv
2019-06-24 17:09:09,357 - INFO - , with total : 949546 rows
2019-06-24 17:09:14,007 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_3.csv
2019-06-24 17:09:14,009 - INFO - , with total : 949546 rows
2019-06-24 17:09:18,947 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_4.csv
2019-06-24 17:09:18,950 - INFO - , with total : 949545 rows
2019-06-24 17:09:23,798 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_5.csv
2019-06-24 17:09:23,799 - INFO - , with total : 949545 rows
2019-06-24 17:09:28,756 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_6.csv
2019-06-24 17:09:28,756 - INFO - , with total : 949545 rows
2019-06-24 17:09:34,358 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_7.csv
2019-06-24 17:09:34,359 - INFO - , with total : 949545 rows
2019-06-24 17:09:39,653 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_8.csv
2019-06-24 17:09:39,653 - INFO - , with total : 949545 rows
2019-06-24 17:09:44,828 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_9.csv
2019-06-24 17:09:44,832 - INFO - , with total : 949545 rows
2019-06-24 17:09:50,131 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_10.csv
2019-06-24 17:09:50,131 - INFO - , with total : 949545 rows
2019-06-24 17:09:55,480 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_11.csv
2019-06-24 17:09:55,482 - INFO - , with total : 949545 rows
2019-06-24 17:10:03,388 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A10 W10_12.csv
2019-06-24 17:10:03,390 - INFO - , with total : 949545 rows
2019-06-24 17:10:05,038 - INFO - Delete all data in the sheet
2019-06-24 17:11:50,351 - INFO - No value detected on sheet: Case 3
2019-06-24 17:11:52,582 - INFO - Use sheet: Case 4
2019-06-24 17:11:53,588 - INFO - Reading Data From Google Sheet...
2019-06-24 17:11:54,592 - INFO - Get custom SQL..
2019-06-24 17:11:54,595 - INFO - USING CASE 4
2019-06-24 17:11:57,532 - INFO - Row 1
2019-06-24 17:11:57,535 - INFO - Filename: A1 female F HL buyers
2019-06-24 17:11:57,536 - INFO - Category: 'Fashion','Home & Living'
2019-06-24 17:11:57,539 - INFO - Last Login: 1
2019-06-24 17:11:57,539 - INFO - Gender: 2,4
2019-06-24 17:11:57,542 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Home & Living')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-06-24 17:11:57,549 - INFO - Start Running query A1 female F HL buyers
2019-06-24 17:13:33,926 - INFO - Running A1 female F HL buyers Done
2019-06-24 17:13:33,927 - INFO - CSV file path: A1 female F HL buyers
2019-06-24 17:13:34,132 - INFO - Starting save the query results
2019-06-24 17:13:34,132 - INFO - Total Rows : 2273331
2019-06-24 17:13:34,134 - INFO - Will split into : 3.0 files
2019-06-24 17:13:37,874 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A1 female F HL buyers_1.csv
2019-06-24 17:13:37,874 - INFO - , with total : 757777 rows
2019-06-24 17:13:41,648 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A1 female F HL buyers_2.csv
2019-06-24 17:13:41,650 - INFO - , with total : 757777 rows
2019-06-24 17:13:45,470 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A1 female F HL buyers_3.csv
2019-06-24 17:13:45,473 - INFO - , with total : 757777 rows
2019-06-24 17:13:47,878 - INFO - Row 2
2019-06-24 17:13:47,881 - INFO - Filename: A1 male F HL E buyers
2019-06-24 17:13:47,884 - INFO - Category: 'Fashion','Home & Living','Electronics'
2019-06-24 17:13:47,887 - INFO - Last Login: 1
2019-06-24 17:13:47,892 - INFO - Gender: 1,3
2019-06-24 17:13:47,897 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Home & Living','Electronics')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-06-24 17:13:47,911 - INFO - Start Running query A1 male F HL E buyers
2019-06-24 17:14:36,664 - INFO - Running A1 male F HL E buyers Done
2019-06-24 17:14:36,667 - INFO - CSV file path: A1 male F HL E buyers
2019-06-24 17:14:36,736 - INFO - Starting save the query results
2019-06-24 17:14:36,736 - INFO - Total Rows : 757941
2019-06-24 17:14:36,739 - INFO - Will split into : 1.0 files
2019-06-24 17:14:40,401 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190624 16.50/A1 male F HL E buyers_1.csv
2019-06-24 17:14:40,407 - INFO - , with total : 757941 rows
2019-06-24 17:14:40,892 - INFO - Delete all data in the sheet
2019-07-02 17:07:28,315 - INFO - Report date: 20190702 17.07
2019-07-02 17:07:29,400 - INFO - Connect Google Sheet Successfully...
2019-07-02 17:07:29,408 - INFO - Download sheet..
2019-07-02 17:07:29,410 - INFO - Change directory to script path
2019-07-02 17:07:30,552 - INFO - Spreadsheet downloaded
2019-07-02 17:07:30,553 - INFO - Checking sheet..
2019-07-02 17:07:34,927 - INFO - Use sheet: Case 1
2019-07-02 17:07:37,931 - INFO - Reading Data From Google Sheet...
2019-07-02 17:07:38,523 - INFO - Get custom SQL..
2019-07-02 17:07:38,525 - INFO - USING CASE 1
2019-07-02 17:07:40,246 - INFO - Row 1
2019-07-02 17:07:40,246 - INFO - Filename: A1 FMCG Buyers
2019-07-02 17:07:40,247 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-07-02 17:07:40,249 - INFO - Last Login: 1
2019-07-02 17:07:40,249 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 17:07:40,253 - INFO - Start Running query A1 FMCG Buyers
2019-07-02 17:10:01,052 - INFO - Running A1 FMCG Buyers Done
2019-07-02 17:10:01,052 - INFO - CSV file path: A1 FMCG Buyers
2019-07-02 17:10:01,259 - INFO - Starting save the query results
2019-07-02 17:10:01,259 - INFO - Total Rows : 4494848
2019-07-02 17:10:01,260 - INFO - Will split into : 5.0 files
2019-07-02 17:10:05,884 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 FMCG Buyers_1.csv
2019-07-02 17:10:05,884 - INFO - , with total : 898970 rows
2019-07-02 17:10:10,413 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 FMCG Buyers_2.csv
2019-07-02 17:10:10,415 - INFO - , with total : 898970 rows
2019-07-02 17:10:15,510 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 FMCG Buyers_3.csv
2019-07-02 17:10:15,512 - INFO - , with total : 898970 rows
2019-07-02 17:10:20,903 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 FMCG Buyers_4.csv
2019-07-02 17:10:20,904 - INFO - , with total : 898969 rows
2019-07-02 17:10:26,540 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 FMCG Buyers_5.csv
2019-07-02 17:10:26,542 - INFO - , with total : 898969 rows
2019-07-02 17:10:29,229 - INFO - Row 2
2019-07-02 17:10:29,230 - INFO - Filename: A3 EL Buyers
2019-07-02 17:10:29,230 - INFO - Category: 'Electronics','Mobile & Accessories','Computer & Accessories','Photography'
2019-07-02 17:10:29,230 - INFO - Last Login: 3
2019-07-02 17:10:29,232 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 17:10:29,233 - INFO - Start Running query A3 EL Buyers
2019-07-02 17:13:19,588 - INFO - Running A3 EL Buyers Done
2019-07-02 17:13:19,588 - INFO - CSV file path: A3 EL Buyers
2019-07-02 17:13:19,828 - INFO - Starting save the query results
2019-07-02 17:13:19,829 - INFO - Total Rows : 5679905
2019-07-02 17:13:19,831 - INFO - Will split into : 6.0 files
2019-07-02 17:13:24,944 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 EL Buyers_1.csv
2019-07-02 17:13:24,944 - INFO - , with total : 946651 rows
2019-07-02 17:13:29,898 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 EL Buyers_2.csv
2019-07-02 17:13:29,901 - INFO - , with total : 946651 rows
2019-07-02 17:13:35,700 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 EL Buyers_3.csv
2019-07-02 17:13:35,700 - INFO - , with total : 946651 rows
2019-07-02 17:13:42,160 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 EL Buyers_4.csv
2019-07-02 17:13:42,163 - INFO - , with total : 946651 rows
2019-07-02 17:13:48,862 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 EL Buyers_5.csv
2019-07-02 17:13:48,864 - INFO - , with total : 946651 rows
2019-07-02 17:13:55,605 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 EL Buyers_6.csv
2019-07-02 17:13:55,608 - INFO - , with total : 946650 rows
2019-07-02 17:13:56,730 - INFO - Delete all data in the sheet
2019-07-02 17:13:57,326 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 400,
    "message": "Invalid requests[0].deleteDimension: Cannot delete a row that doesn't exist. Tried to delete row index 18 but there are only 6 rows.",
    "status": "INVALID_ARGUMENT"
  }
}

2019-07-02 17:14:01,279 - INFO - Use sheet: Case 2
2019-07-02 17:14:04,279 - INFO - Reading Data From Google Sheet...
2019-07-02 17:14:04,868 - INFO - Get custom SQL..
2019-07-02 17:14:04,871 - INFO - USING CASE 2
2019-07-02 17:14:07,240 - INFO - Row 1
2019-07-02 17:14:07,242 - INFO - Filename: A3 Havent Purchase in Past 30 days
2019-07-02 17:14:07,243 - INFO - Last Login: 3
2019-07-02 17:14:07,243 - INFO - Date 1: 2019-06-30
2019-07-02 17:14:07,244 - INFO - Date 2: 2019-07-02
2019-07-02 17:14:07,244 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-30' and date'2019-07-02'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-02 17:14:07,246 - INFO - Start Running query A3 Havent Purchase in Past 30 days
2019-07-02 17:18:25,930 - INFO - Running A3 Havent Purchase in Past 30 days Done
2019-07-02 17:18:25,931 - INFO - CSV file path: A3 Havent Purchase in Past 30 days
2019-07-02 17:18:26,332 - INFO - Starting save the query results
2019-07-02 17:18:26,332 - INFO - Total Rows : 9724312
2019-07-02 17:18:26,334 - INFO - Will split into : 10.0 files
2019-07-02 17:18:31,792 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 Havent Purchase in Past 30 days_1.csv
2019-07-02 17:18:31,793 - INFO - , with total : 972432 rows
2019-07-02 17:18:37,078 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 Havent Purchase in Past 30 days_2.csv
2019-07-02 17:18:37,079 - INFO - , with total : 972432 rows
2019-07-02 17:18:44,132 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 Havent Purchase in Past 30 days_3.csv
2019-07-02 17:18:44,138 - INFO - , with total : 972431 rows
2019-07-02 17:18:50,559 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 Havent Purchase in Past 30 days_4.csv
2019-07-02 17:18:50,565 - INFO - , with total : 972431 rows
2019-07-02 17:18:56,785 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 Havent Purchase in Past 30 days_5.csv
2019-07-02 17:18:56,788 - INFO - , with total : 972431 rows
2019-07-02 17:19:03,663 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 Havent Purchase in Past 30 days_6.csv
2019-07-02 17:19:03,665 - INFO - , with total : 972431 rows
2019-07-02 17:19:09,960 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 Havent Purchase in Past 30 days_7.csv
2019-07-02 17:19:09,967 - INFO - , with total : 972431 rows
2019-07-02 17:19:15,719 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 Havent Purchase in Past 30 days_8.csv
2019-07-02 17:19:15,720 - INFO - , with total : 972431 rows
2019-07-02 17:19:21,563 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 Havent Purchase in Past 30 days_9.csv
2019-07-02 17:19:21,565 - INFO - , with total : 972431 rows
2019-07-02 17:19:28,007 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 Havent Purchase in Past 30 days_10.csv
2019-07-02 17:19:28,009 - INFO - , with total : 972431 rows
2019-07-02 17:19:32,456 - INFO - Row 2
2019-07-02 17:19:32,457 - INFO - Filename: A1 Havent Purchase in Past 90 days
2019-07-02 17:19:32,457 - INFO - Last Login: 1
2019-07-02 17:19:32,459 - INFO - Date 1: 2019-07-02
2019-07-02 17:19:32,460 - INFO - Date 2: 2019-07-02
2019-07-02 17:19:32,460 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-02' and date'2019-07-02'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-02 17:19:32,461 - INFO - Start Running query A1 Havent Purchase in Past 90 days
2019-07-02 17:23:44,055 - INFO - Running A1 Havent Purchase in Past 90 days Done
2019-07-02 17:23:44,055 - INFO - CSV file path: A1 Havent Purchase in Past 90 days
2019-07-02 17:23:44,404 - INFO - Starting save the query results
2019-07-02 17:23:44,405 - INFO - Total Rows : 7823011
2019-07-02 17:23:44,405 - INFO - Will split into : 8.0 files
2019-07-02 17:23:49,565 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 Havent Purchase in Past 90 days_1.csv
2019-07-02 17:23:49,566 - INFO - , with total : 977877 rows
2019-07-02 17:23:55,296 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 Havent Purchase in Past 90 days_2.csv
2019-07-02 17:23:55,299 - INFO - , with total : 977877 rows
2019-07-02 17:24:05,266 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 Havent Purchase in Past 90 days_3.csv
2019-07-02 17:24:05,267 - INFO - , with total : 977877 rows
2019-07-02 17:24:16,997 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 Havent Purchase in Past 90 days_4.csv
2019-07-02 17:24:17,000 - INFO - , with total : 977876 rows
2019-07-02 17:24:30,237 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 Havent Purchase in Past 90 days_5.csv
2019-07-02 17:24:30,239 - INFO - , with total : 977876 rows
2019-07-02 17:24:36,216 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 Havent Purchase in Past 90 days_6.csv
2019-07-02 17:24:36,217 - INFO - , with total : 977876 rows
2019-07-02 17:24:44,157 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 Havent Purchase in Past 90 days_7.csv
2019-07-02 17:24:44,160 - INFO - , with total : 977876 rows
2019-07-02 17:24:51,921 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 Havent Purchase in Past 90 days_8.csv
2019-07-02 17:24:51,921 - INFO - , with total : 977876 rows
2019-07-02 17:24:53,430 - INFO - Delete all data in the sheet
2019-07-02 17:24:54,181 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 400,
    "message": "Invalid requests[0].deleteDimension: Cannot delete a row that doesn't exist. Tried to delete row index 18 but there are only 6 rows.",
    "status": "INVALID_ARGUMENT"
  }
}

2019-07-02 17:24:58,358 - INFO - Use sheet: Case 3
2019-07-02 17:25:01,369 - INFO - Reading Data From Google Sheet...
2019-07-02 17:25:01,927 - INFO - Get custom SQL..
2019-07-02 17:25:01,927 - INFO - USING CASE 3
2019-07-02 17:25:04,914 - INFO - Row 1
2019-07-02 17:25:04,914 - INFO - Filename: A3 FMCG Buyer Havent Purchase in Past 30 days
2019-07-02 17:25:04,914 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-07-02 17:25:04,915 - INFO - Last Login: 3
2019-07-02 17:25:04,915 - INFO - Date 1: 2019-06-30
2019-07-02 17:25:04,917 - INFO - Date 2: 2019-07-02
2019-07-02 17:25:04,917 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-30' and date'2019-07-02'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-02 17:25:04,917 - INFO - Start Running query A3 FMCG Buyer Havent Purchase in Past 30 days
2019-07-02 17:27:31,522 - INFO - Running A3 FMCG Buyer Havent Purchase in Past 30 days Done
2019-07-02 17:27:31,523 - INFO - CSV file path: A3 FMCG Buyer Havent Purchase in Past 30 days
2019-07-02 17:27:31,710 - INFO - Starting save the query results
2019-07-02 17:27:31,711 - INFO - Total Rows : 4779011
2019-07-02 17:27:31,711 - INFO - Will split into : 5.0 files
2019-07-02 17:27:37,062 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 FMCG Buyer Havent Purchase in Past 30 days_1.csv
2019-07-02 17:27:37,062 - INFO - , with total : 955803 rows
2019-07-02 17:27:43,502 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 FMCG Buyer Havent Purchase in Past 30 days_2.csv
2019-07-02 17:27:43,513 - INFO - , with total : 955802 rows
2019-07-02 17:27:50,420 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 FMCG Buyer Havent Purchase in Past 30 days_3.csv
2019-07-02 17:27:50,421 - INFO - , with total : 955802 rows
2019-07-02 17:27:59,647 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 FMCG Buyer Havent Purchase in Past 30 days_4.csv
2019-07-02 17:27:59,648 - INFO - , with total : 955802 rows
2019-07-02 17:28:05,877 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A3 FMCG Buyer Havent Purchase in Past 30 days_5.csv
2019-07-02 17:28:05,878 - INFO - , with total : 955802 rows
2019-07-02 17:28:09,421 - INFO - Row 2
2019-07-02 17:28:09,423 - INFO - Filename: A1 EL Havent Purchase in Past 90 days
2019-07-02 17:28:09,423 - INFO - Category: 'Electronics','Mobile & Accessories','Computer & Accessories','Photography'
2019-07-02 17:28:09,424 - INFO - Last Login: 1
2019-07-02 17:28:09,424 - INFO - Date 1: 2019-07-02
2019-07-02 17:28:09,426 - INFO - Date 2: 2019-07-02
2019-07-02 17:28:09,427 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-02' and date'2019-07-02'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-02 17:28:09,427 - INFO - Start Running query A1 EL Havent Purchase in Past 90 days
2019-07-02 17:30:16,207 - INFO - Running A1 EL Havent Purchase in Past 90 days Done
2019-07-02 17:30:16,209 - INFO - CSV file path: A1 EL Havent Purchase in Past 90 days
2019-07-02 17:30:16,378 - INFO - Starting save the query results
2019-07-02 17:30:16,380 - INFO - Total Rows : 4208189
2019-07-02 17:30:16,381 - INFO - Will split into : 5.0 files
2019-07-02 17:30:20,694 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 EL Havent Purchase in Past 90 days_1.csv
2019-07-02 17:30:20,694 - INFO - , with total : 841638 rows
2019-07-02 17:30:25,290 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 EL Havent Purchase in Past 90 days_2.csv
2019-07-02 17:30:25,292 - INFO - , with total : 841638 rows
2019-07-02 17:30:30,490 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 EL Havent Purchase in Past 90 days_3.csv
2019-07-02 17:30:30,490 - INFO - , with total : 841638 rows
2019-07-02 17:30:36,380 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 EL Havent Purchase in Past 90 days_4.csv
2019-07-02 17:30:36,381 - INFO - , with total : 841638 rows
2019-07-02 17:30:43,727 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.07/A1 EL Havent Purchase in Past 90 days_5.csv
2019-07-02 17:30:43,730 - INFO - , with total : 841637 rows
2019-07-02 17:30:44,918 - INFO - Delete all data in the sheet
2019-07-02 17:30:45,563 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 400,
    "message": "Invalid requests[0].deleteDimension: Cannot delete a row that doesn't exist. Tried to delete row index 18 but there are only 6 rows.",
    "status": "INVALID_ARGUMENT"
  }
}

2019-07-02 17:30:49,694 - INFO - Use sheet: Case 4
2019-07-02 17:30:52,694 - INFO - Reading Data From Google Sheet...
2019-07-02 17:30:53,230 - INFO - Get custom SQL..
2019-07-02 17:30:53,232 - INFO - USING CASE 4
2019-07-02 17:30:53,750 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-07-02 17:45:54,197 - INFO - Report date: 20190702 17.45
2019-07-02 17:45:55,328 - INFO - Connect Google Sheet Successfully...
2019-07-02 17:45:55,342 - INFO - Download sheet..
2019-07-02 17:45:55,342 - INFO - Change directory to script path
2019-07-02 17:45:56,469 - INFO - Spreadsheet downloaded
2019-07-02 17:45:56,470 - INFO - Checking sheet..
2019-07-02 17:46:19,907 - INFO - Report date: 20190702 17.46
2019-07-02 17:46:20,948 - INFO - Connect Google Sheet Successfully...
2019-07-02 17:46:20,957 - INFO - Download sheet..
2019-07-02 17:46:20,957 - INFO - Change directory to script path
2019-07-02 17:46:22,163 - INFO - Spreadsheet downloaded
2019-07-02 17:46:22,164 - INFO - Checking sheet..
2019-07-02 17:46:33,654 - INFO - Use sheet: Case 1
2019-07-02 17:46:43,655 - INFO - Reading Data From Google Sheet...
2019-07-02 17:46:44,266 - INFO - Get custom SQL..
2019-07-02 17:46:44,266 - INFO - USING CASE 1
2019-07-02 17:46:46,035 - INFO - Row 1
2019-07-02 17:46:46,036 - INFO - Filename: A1 FMCG Buyers
2019-07-02 17:46:46,036 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-07-02 17:46:46,038 - INFO - Last Login: 1
2019-07-02 17:46:46,038 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 17:46:46,039 - INFO - Start Running query A1 FMCG Buyers
2019-07-02 17:49:05,588 - INFO - Running A1 FMCG Buyers Done
2019-07-02 17:49:05,588 - INFO - CSV file path: A1 FMCG Buyers
2019-07-02 17:49:05,779 - INFO - Starting save the query results
2019-07-02 17:49:05,779 - INFO - Total Rows : 4494848
2019-07-02 17:49:05,780 - INFO - Will split into : 5.0 files
2019-07-02 17:49:12,086 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A1 FMCG Buyers_1.csv
2019-07-02 17:49:12,088 - INFO - , with total : 898970 rows
2019-07-02 17:49:23,532 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A1 FMCG Buyers_2.csv
2019-07-02 17:49:23,536 - INFO - , with total : 898970 rows
2019-07-02 17:49:35,398 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A1 FMCG Buyers_3.csv
2019-07-02 17:49:35,403 - INFO - , with total : 898970 rows
2019-07-02 17:49:45,617 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A1 FMCG Buyers_4.csv
2019-07-02 17:49:45,618 - INFO - , with total : 898969 rows
2019-07-02 17:49:53,719 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A1 FMCG Buyers_5.csv
2019-07-02 17:49:53,720 - INFO - , with total : 898969 rows
2019-07-02 17:49:56,338 - INFO - Row 2
2019-07-02 17:49:56,339 - INFO - Filename: A3 EL Buyers
2019-07-02 17:49:56,341 - INFO - Category: 'Electronics','Mobile & Accessories','Computer & Accessories','Photography'
2019-07-02 17:49:56,341 - INFO - Last Login: 3
2019-07-02 17:49:56,342 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 17:49:56,342 - INFO - Start Running query A3 EL Buyers
2019-07-02 17:54:17,049 - INFO - Running A3 EL Buyers Done
2019-07-02 17:54:17,049 - INFO - CSV file path: A3 EL Buyers
2019-07-02 17:54:17,279 - INFO - Starting save the query results
2019-07-02 17:54:17,279 - INFO - Total Rows : 5679905
2019-07-02 17:54:17,280 - INFO - Will split into : 6.0 files
2019-07-02 17:54:22,099 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 EL Buyers_1.csv
2019-07-02 17:54:22,099 - INFO - , with total : 946651 rows
2019-07-02 17:54:26,878 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 EL Buyers_2.csv
2019-07-02 17:54:26,878 - INFO - , with total : 946651 rows
2019-07-02 17:54:33,354 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 EL Buyers_3.csv
2019-07-02 17:54:33,355 - INFO - , with total : 946651 rows
2019-07-02 17:54:39,736 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 EL Buyers_4.csv
2019-07-02 17:54:39,736 - INFO - , with total : 946651 rows
2019-07-02 17:54:47,302 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 EL Buyers_5.csv
2019-07-02 17:54:47,302 - INFO - , with total : 946651 rows
2019-07-02 17:54:53,727 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 EL Buyers_6.csv
2019-07-02 17:54:53,727 - INFO - , with total : 946650 rows
2019-07-02 17:54:54,832 - INFO - Delete all data in the sheet
2019-07-02 17:54:55,446 - INFO - {
  "error": {
    "code": 400,
    "message": "Invalid requests[0].deleteDimension: Cannot delete a row that doesn't exist. Tried to delete row index 18 but there are only 6 rows.",
    "status": "INVALID_ARGUMENT"
  }
}

2019-07-02 17:55:06,641 - INFO - Use sheet: Case 2
2019-07-02 17:55:16,642 - INFO - Reading Data From Google Sheet...
2019-07-02 17:55:17,230 - INFO - Get custom SQL..
2019-07-02 17:55:17,233 - INFO - USING CASE 2
2019-07-02 17:55:19,579 - INFO - Row 1
2019-07-02 17:55:19,581 - INFO - Filename: A3 Havent Purchase in Past 30 days
2019-07-02 17:55:19,582 - INFO - Last Login: 3
2019-07-02 17:55:19,582 - INFO - Date 1: 2019-06-30
2019-07-02 17:55:19,582 - INFO - Date 2: 2019-07-02
2019-07-02 17:55:19,584 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-30' and date'2019-07-02'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-02 17:55:19,585 - INFO - Start Running query A3 Havent Purchase in Past 30 days
2019-07-02 17:59:52,346 - INFO - Running A3 Havent Purchase in Past 30 days Done
2019-07-02 17:59:52,348 - INFO - CSV file path: A3 Havent Purchase in Past 30 days
2019-07-02 17:59:52,779 - INFO - Starting save the query results
2019-07-02 17:59:52,780 - INFO - Total Rows : 9724312
2019-07-02 17:59:52,780 - INFO - Will split into : 10.0 files
2019-07-02 17:59:58,538 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 Havent Purchase in Past 30 days_1.csv
2019-07-02 17:59:58,539 - INFO - , with total : 972432 rows
2019-07-02 18:00:04,444 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 Havent Purchase in Past 30 days_2.csv
2019-07-02 18:00:04,446 - INFO - , with total : 972432 rows
2019-07-02 18:00:10,535 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 Havent Purchase in Past 30 days_3.csv
2019-07-02 18:00:10,535 - INFO - , with total : 972431 rows
2019-07-02 18:00:16,716 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 Havent Purchase in Past 30 days_4.csv
2019-07-02 18:00:16,717 - INFO - , with total : 972431 rows
2019-07-02 18:00:22,775 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 Havent Purchase in Past 30 days_5.csv
2019-07-02 18:00:22,778 - INFO - , with total : 972431 rows
2019-07-02 18:00:28,579 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 Havent Purchase in Past 30 days_6.csv
2019-07-02 18:00:28,581 - INFO - , with total : 972431 rows
2019-07-02 18:00:35,082 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 Havent Purchase in Past 30 days_7.csv
2019-07-02 18:00:35,084 - INFO - , with total : 972431 rows
2019-07-02 18:00:41,523 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 Havent Purchase in Past 30 days_8.csv
2019-07-02 18:00:41,525 - INFO - , with total : 972431 rows
2019-07-02 18:00:48,644 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 Havent Purchase in Past 30 days_9.csv
2019-07-02 18:00:48,644 - INFO - , with total : 972431 rows
2019-07-02 18:00:54,948 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 17.46/A3 Havent Purchase in Past 30 days_10.csv
2019-07-02 18:00:54,950 - INFO - , with total : 972431 rows
2019-07-02 18:00:56,921 - INFO - Error in get_custom_sql -> {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-07-02 18:00:57,517 - INFO - {
  "error": {
    "code": 400,
    "message": "Invalid requests[0].deleteDimension: Cannot delete a row that doesn't exist. Tried to delete row index 18 but there are only 6 rows.",
    "status": "INVALID_ARGUMENT"
  }
}

2019-07-02 18:01:08,645 - INFO - {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-07-02 18:01:19,173 - INFO - {
  "error": {
    "code": 429,
    "message": "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Google developer console API key",
            "url": "https://console.developers.google.com/project/362380369340/apiui/credential"
          }
        ]
      }
    ]
  }
}

2019-07-02 18:37:58,115 - INFO - Report date: 20190702 18.37
2019-07-02 18:37:59,325 - INFO - Connect Google Sheet Successfully...
2019-07-02 18:37:59,332 - INFO - Download sheet..
2019-07-02 18:37:59,332 - INFO - Change directory to script path
2019-07-02 18:38:00,523 - INFO - Spreadsheet downloaded
2019-07-02 18:38:00,523 - INFO - Checking sheet..
2019-07-02 18:38:11,884 - INFO - Use sheet: Case 1
2019-07-02 18:38:21,884 - INFO - Reading Data From Google Sheet...
2019-07-02 18:38:22,454 - INFO - Get custom SQL..
2019-07-02 18:38:22,456 - INFO - USING CASE 1
2019-07-02 18:38:24,154 - INFO - Row 1
2019-07-02 18:38:24,155 - INFO - Filename: A30 FMCG Buyers
2019-07-02 18:38:24,155 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-07-02 18:38:24,157 - INFO - Last Login: 30
2019-07-02 18:38:24,157 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 18:38:24,158 - INFO - Start Running query A30 FMCG Buyers
2019-07-02 18:43:03,696 - INFO - Running A30 FMCG Buyers Done
2019-07-02 18:43:03,696 - INFO - CSV file path: A30 FMCG Buyers
2019-07-02 18:43:04,104 - INFO - Starting save the query results
2019-07-02 18:43:04,104 - INFO - Total Rows : 8791224
2019-07-02 18:43:04,105 - INFO - Will split into : 9.0 files
2019-07-02 18:43:10,849 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A30 FMCG Buyers_1.csv
2019-07-02 18:43:10,851 - INFO - , with total : 976803 rows
2019-07-02 18:43:16,423 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A30 FMCG Buyers_2.csv
2019-07-02 18:43:16,424 - INFO - , with total : 976803 rows
2019-07-02 18:43:21,923 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A30 FMCG Buyers_3.csv
2019-07-02 18:43:21,924 - INFO - , with total : 976803 rows
2019-07-02 18:43:36,486 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A30 FMCG Buyers_4.csv
2019-07-02 18:43:36,490 - INFO - , with total : 976803 rows
2019-07-02 18:43:48,890 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A30 FMCG Buyers_5.csv
2019-07-02 18:43:48,891 - INFO - , with total : 976803 rows
2019-07-02 18:43:54,257 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A30 FMCG Buyers_6.csv
2019-07-02 18:43:54,257 - INFO - , with total : 976803 rows
2019-07-02 18:44:00,447 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A30 FMCG Buyers_7.csv
2019-07-02 18:44:00,448 - INFO - , with total : 976802 rows
2019-07-02 18:44:06,371 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A30 FMCG Buyers_8.csv
2019-07-02 18:44:06,372 - INFO - , with total : 976802 rows
2019-07-02 18:44:13,260 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A30 FMCG Buyers_9.csv
2019-07-02 18:44:13,262 - INFO - , with total : 976802 rows
2019-07-02 18:44:16,377 - INFO - Row 2
2019-07-02 18:44:16,378 - INFO - Filename: A3 EL Buyers
2019-07-02 18:44:16,378 - INFO - Category: 'Electronics','Mobile & Accessories','Computer & Accessories','Photography'
2019-07-02 18:44:16,380 - INFO - Last Login: 3
2019-07-02 18:44:16,380 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 18:44:16,381 - INFO - Start Running query A3 EL Buyers
2019-07-02 18:47:19,556 - INFO - Running A3 EL Buyers Done
2019-07-02 18:47:19,558 - INFO - CSV file path: A3 EL Buyers
2019-07-02 18:47:19,795 - INFO - Starting save the query results
2019-07-02 18:47:19,796 - INFO - Total Rows : 5679905
2019-07-02 18:47:19,796 - INFO - Will split into : 6.0 files
2019-07-02 18:47:24,920 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A3 EL Buyers_1.csv
2019-07-02 18:47:24,921 - INFO - , with total : 946651 rows
2019-07-02 18:47:30,059 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A3 EL Buyers_2.csv
2019-07-02 18:47:30,061 - INFO - , with total : 946651 rows
2019-07-02 18:47:35,299 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A3 EL Buyers_3.csv
2019-07-02 18:47:35,301 - INFO - , with total : 946651 rows
2019-07-02 18:47:40,892 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A3 EL Buyers_4.csv
2019-07-02 18:47:40,892 - INFO - , with total : 946651 rows
2019-07-02 18:47:48,459 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A3 EL Buyers_5.csv
2019-07-02 18:47:48,459 - INFO - , with total : 946651 rows
2019-07-02 18:47:54,818 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.37/A3 EL Buyers_6.csv
2019-07-02 18:47:54,819 - INFO - , with total : 946650 rows
2019-07-02 18:47:55,868 - INFO - Delete all data in the sheet
2019-07-02 18:47:56,483 - INFO - {
  "error": {
    "code": 400,
    "message": "Invalid requests[0].deleteDimension: Cannot delete a row that doesn't exist. Tried to delete row index 18 but there are only 6 rows.",
    "status": "INVALID_ARGUMENT"
  }
}

2019-07-02 18:48:07,628 - INFO - Use sheet: Case 2
2019-07-02 18:48:17,630 - INFO - Reading Data From Google Sheet...
2019-07-02 18:48:18,190 - INFO - Get custom SQL..
2019-07-02 18:48:18,190 - INFO - USING CASE 2
2019-07-02 18:48:20,457 - INFO - Row 1
2019-07-02 18:48:20,459 - INFO - Filename: A7 Havent Purchase in Past 30 days
2019-07-02 18:48:20,460 - INFO - Last Login: 7
2019-07-02 18:48:20,460 - INFO - Date 1: 2019-06-30
2019-07-02 18:48:20,569 - INFO - Date 2: 2019-07-02
2019-07-02 18:48:20,571 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-30' and date'2019-07-02'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-02 18:48:20,572 - INFO - Start Running query A7 Havent Purchase in Past 30 days
2019-07-02 18:50:00,607 - INFO - Report date: 20190702 18.50
2019-07-02 18:50:01,808 - INFO - Connect Google Sheet Successfully...
2019-07-02 18:50:01,829 - INFO - Download sheet..
2019-07-02 18:50:01,829 - INFO - Change directory to script path
2019-07-02 18:50:03,029 - INFO - Spreadsheet downloaded
2019-07-02 18:50:03,029 - INFO - Checking sheet..
2019-07-02 18:50:14,345 - INFO - Use sheet: Case 1
2019-07-02 18:50:24,348 - INFO - Reading Data From Google Sheet...
2019-07-02 18:50:24,914 - INFO - Get custom SQL..
2019-07-02 18:50:24,915 - INFO - USING CASE 1
2019-07-02 18:50:26,686 - INFO - Row 1
2019-07-02 18:50:26,687 - INFO - Filename: A30 FMCG Buyers
2019-07-02 18:50:26,687 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-07-02 18:50:26,687 - INFO - Last Login: 30
2019-07-02 18:50:26,687 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 18:50:26,688 - INFO - Start Running query A30 FMCG Buyers
2019-07-02 18:54:51,240 - INFO - Running A30 FMCG Buyers Done
2019-07-02 18:54:51,242 - INFO - CSV file path: A30 FMCG Buyers
2019-07-02 18:54:51,604 - INFO - Starting save the query results
2019-07-02 18:54:51,605 - INFO - Total Rows : 8791224
2019-07-02 18:54:51,605 - INFO - Will split into : 9.0 files
2019-07-02 18:54:56,796 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 FMCG Buyers_1.csv
2019-07-02 18:54:56,798 - INFO - , with total : 976803 rows
2019-07-02 18:55:01,960 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 FMCG Buyers_2.csv
2019-07-02 18:55:01,960 - INFO - , with total : 976803 rows
2019-07-02 18:55:07,111 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 FMCG Buyers_3.csv
2019-07-02 18:55:07,111 - INFO - , with total : 976803 rows
2019-07-02 18:55:12,871 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 FMCG Buyers_4.csv
2019-07-02 18:55:12,872 - INFO - , with total : 976803 rows
2019-07-02 18:55:19,200 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 FMCG Buyers_5.csv
2019-07-02 18:55:19,200 - INFO - , with total : 976803 rows
2019-07-02 18:55:25,507 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 FMCG Buyers_6.csv
2019-07-02 18:55:25,509 - INFO - , with total : 976803 rows
2019-07-02 18:55:32,302 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 FMCG Buyers_7.csv
2019-07-02 18:55:32,302 - INFO - , with total : 976802 rows
2019-07-02 18:55:38,612 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 FMCG Buyers_8.csv
2019-07-02 18:55:38,614 - INFO - , with total : 976802 rows
2019-07-02 18:55:46,894 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 FMCG Buyers_9.csv
2019-07-02 18:55:46,894 - INFO - , with total : 976802 rows
2019-07-02 18:55:50,141 - INFO - Row 2
2019-07-02 18:55:50,142 - INFO - Filename: A3 EL Buyers
2019-07-02 18:55:50,144 - INFO - Category: 'Electronics','Mobile & Accessories','Computer & Accessories','Photography'
2019-07-02 18:55:50,144 - INFO - Last Login: 3
2019-07-02 18:55:50,145 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 18:55:50,147 - INFO - Start Running query A3 EL Buyers
2019-07-02 18:59:13,592 - INFO - Running A3 EL Buyers Done
2019-07-02 18:59:13,594 - INFO - CSV file path: A3 EL Buyers
2019-07-02 18:59:13,822 - INFO - Starting save the query results
2019-07-02 18:59:13,823 - INFO - Total Rows : 5679905
2019-07-02 18:59:13,825 - INFO - Will split into : 6.0 files
2019-07-02 18:59:18,703 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A3 EL Buyers_1.csv
2019-07-02 18:59:18,704 - INFO - , with total : 946651 rows
2019-07-02 18:59:23,556 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A3 EL Buyers_2.csv
2019-07-02 18:59:23,558 - INFO - , with total : 946651 rows
2019-07-02 18:59:28,937 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A3 EL Buyers_3.csv
2019-07-02 18:59:28,938 - INFO - , with total : 946651 rows
2019-07-02 18:59:34,855 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A3 EL Buyers_4.csv
2019-07-02 18:59:34,857 - INFO - , with total : 946651 rows
2019-07-02 18:59:42,351 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A3 EL Buyers_5.csv
2019-07-02 18:59:42,351 - INFO - , with total : 946651 rows
2019-07-02 18:59:49,388 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A3 EL Buyers_6.csv
2019-07-02 18:59:49,388 - INFO - , with total : 946650 rows
2019-07-02 18:59:50,516 - INFO - Delete all data in the sheet
2019-07-02 18:59:50,516 - INFO - cannot concatenate 'str' and 'int' objects
2019-07-02 19:00:02,059 - INFO - Use sheet: Case 2
2019-07-02 19:00:12,061 - INFO - Reading Data From Google Sheet...
2019-07-02 19:00:12,644 - INFO - Get custom SQL..
2019-07-02 19:00:12,645 - INFO - USING CASE 2
2019-07-02 19:00:15,157 - INFO - Row 1
2019-07-02 19:00:15,161 - INFO - Filename: A7 Havent Purchase in Past 30 days
2019-07-02 19:00:15,163 - INFO - Last Login: 7
2019-07-02 19:00:15,165 - INFO - Date 1: 2019-06-30
2019-07-02 19:00:15,167 - INFO - Date 2: 2019-07-02
2019-07-02 19:00:15,167 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-30' and date'2019-07-02'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-02 19:00:15,168 - INFO - Start Running query A7 Havent Purchase in Past 30 days
2019-07-02 19:07:35,996 - INFO - Running A7 Havent Purchase in Past 30 days Done
2019-07-02 19:07:35,997 - INFO - CSV file path: A7 Havent Purchase in Past 30 days
2019-07-02 19:07:36,569 - INFO - Starting save the query results
2019-07-02 19:07:36,569 - INFO - Total Rows : 13194621
2019-07-02 19:07:36,571 - INFO - Will split into : 14.0 files
2019-07-02 19:07:42,013 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_1.csv
2019-07-02 19:07:42,015 - INFO - , with total : 942473 rows
2019-07-02 19:07:47,848 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_2.csv
2019-07-02 19:07:47,848 - INFO - , with total : 942473 rows
2019-07-02 19:07:53,436 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_3.csv
2019-07-02 19:07:53,437 - INFO - , with total : 942473 rows
2019-07-02 19:07:59,153 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_4.csv
2019-07-02 19:07:59,153 - INFO - , with total : 942473 rows
2019-07-02 19:08:05,150 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_5.csv
2019-07-02 19:08:05,151 - INFO - , with total : 942473 rows
2019-07-02 19:08:11,359 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_6.csv
2019-07-02 19:08:11,361 - INFO - , with total : 942473 rows
2019-07-02 19:08:18,177 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_7.csv
2019-07-02 19:08:18,178 - INFO - , with total : 942473 rows
2019-07-02 19:08:24,134 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_8.csv
2019-07-02 19:08:24,134 - INFO - , with total : 942473 rows
2019-07-02 19:08:30,372 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_9.csv
2019-07-02 19:08:30,374 - INFO - , with total : 942473 rows
2019-07-02 19:08:36,674 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_10.csv
2019-07-02 19:08:36,676 - INFO - , with total : 942473 rows
2019-07-02 19:08:44,437 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_11.csv
2019-07-02 19:08:44,437 - INFO - , with total : 942473 rows
2019-07-02 19:08:50,858 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_12.csv
2019-07-02 19:08:50,862 - INFO - , with total : 942473 rows
2019-07-02 19:08:57,262 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_13.csv
2019-07-02 19:08:57,262 - INFO - , with total : 942473 rows
2019-07-02 19:09:03,290 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A7 Havent Purchase in Past 30 days_14.csv
2019-07-02 19:09:03,292 - INFO - , with total : 942472 rows
2019-07-02 19:09:04,957 - INFO - Delete all data in the sheet
2019-07-02 19:09:04,957 - INFO - cannot concatenate 'str' and 'int' objects
2019-07-02 19:09:16,118 - INFO - Use sheet: Case 3
2019-07-02 19:09:26,121 - INFO - Reading Data From Google Sheet...
2019-07-02 19:09:26,678 - INFO - Get custom SQL..
2019-07-02 19:09:26,678 - INFO - USING CASE 3
2019-07-02 19:09:29,844 - INFO - Row 1
2019-07-02 19:09:29,845 - INFO - Filename: A30 EL Havent Purchase in Past 90 days
2019-07-02 19:09:29,845 - INFO - Category: 'Electronics','Mobile & Accessories','Computer & Accessories','Photography'
2019-07-02 19:09:29,845 - INFO - Last Login: 30
2019-07-02 19:09:29,846 - INFO - Date 1: 2019-07-02
2019-07-02 19:09:29,846 - INFO - Date 2: 2019-07-02
2019-07-02 19:09:29,848 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-02' and date'2019-07-02'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-02 19:09:29,848 - INFO - Start Running query A30 EL Havent Purchase in Past 90 days
2019-07-02 19:13:14,805 - INFO - Running A30 EL Havent Purchase in Past 90 days Done
2019-07-02 19:13:14,806 - INFO - CSV file path: A30 EL Havent Purchase in Past 90 days
2019-07-02 19:13:15,153 - INFO - Starting save the query results
2019-07-02 19:13:15,154 - INFO - Total Rows : 8475904
2019-07-02 19:13:15,155 - INFO - Will split into : 9.0 files
2019-07-02 19:13:20,171 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 EL Havent Purchase in Past 90 days_1.csv
2019-07-02 19:13:20,171 - INFO - , with total : 941768 rows
2019-07-02 19:13:25,055 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 EL Havent Purchase in Past 90 days_2.csv
2019-07-02 19:13:25,055 - INFO - , with total : 941767 rows
2019-07-02 19:13:30,539 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 EL Havent Purchase in Past 90 days_3.csv
2019-07-02 19:13:30,540 - INFO - , with total : 941767 rows
2019-07-02 19:13:36,667 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 EL Havent Purchase in Past 90 days_4.csv
2019-07-02 19:13:36,667 - INFO - , with total : 941767 rows
2019-07-02 19:13:43,161 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 EL Havent Purchase in Past 90 days_5.csv
2019-07-02 19:13:43,164 - INFO - , with total : 941767 rows
2019-07-02 19:13:49,700 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 EL Havent Purchase in Past 90 days_6.csv
2019-07-02 19:13:49,701 - INFO - , with total : 941767 rows
2019-07-02 19:13:56,052 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 EL Havent Purchase in Past 90 days_7.csv
2019-07-02 19:13:56,053 - INFO - , with total : 941767 rows
2019-07-02 19:14:02,440 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 EL Havent Purchase in Past 90 days_8.csv
2019-07-02 19:14:02,440 - INFO - , with total : 941767 rows
2019-07-02 19:14:08,523 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 EL Havent Purchase in Past 90 days_9.csv
2019-07-02 19:14:08,525 - INFO - , with total : 941767 rows
2019-07-02 19:14:09,934 - INFO - Delete all data in the sheet
2019-07-02 19:14:09,934 - INFO - cannot concatenate 'str' and 'int' objects
2019-07-02 19:14:21,056 - INFO - Use sheet: Case 4
2019-07-02 19:14:31,059 - INFO - Reading Data From Google Sheet...
2019-07-02 19:14:31,618 - INFO - Get custom SQL..
2019-07-02 19:14:31,618 - INFO - USING CASE 4
2019-07-02 19:14:33,832 - INFO - Row 1
2019-07-02 19:14:33,834 - INFO - Filename: A30 Male FMCG Buyers
2019-07-02 19:14:33,834 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-07-02 19:14:33,835 - INFO - Last Login: 30
2019-07-02 19:14:33,835 - INFO - Gender: 1,3
2019-07-02 19:14:33,836 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-02 19:14:33,838 - INFO - Start Running query A30 Male FMCG Buyers
2019-07-02 19:15:40,890 - INFO - Running A30 Male FMCG Buyers Done
2019-07-02 19:15:40,891 - INFO - CSV file path: A30 Male FMCG Buyers
2019-07-02 19:15:40,966 - INFO - Starting save the query results
2019-07-02 19:15:40,967 - INFO - Total Rows : 1651493
2019-07-02 19:15:40,967 - INFO - Will split into : 2.0 files
2019-07-02 19:15:46,461 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 Male FMCG Buyers_1.csv
2019-07-02 19:15:46,463 - INFO - , with total : 825747 rows
2019-07-02 19:15:51,473 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 18.50/A30 Male FMCG Buyers_2.csv
2019-07-02 19:15:51,474 - INFO - , with total : 825746 rows
2019-07-02 19:15:52,180 - INFO - Delete all data in the sheet
2019-07-02 19:15:52,180 - INFO - cannot concatenate 'str' and 'int' objects
2019-07-02 19:24:40,621 - INFO - Report date: 20190702 19.24
2019-07-02 19:24:41,859 - INFO - Connect Google Sheet Successfully...
2019-07-02 19:24:41,871 - INFO - Download sheet..
2019-07-02 19:24:41,872 - INFO - Change directory to script path
2019-07-02 19:24:43,003 - INFO - Spreadsheet downloaded
2019-07-02 19:24:43,003 - INFO - Checking sheet..
2019-07-02 19:24:54,298 - INFO - Use sheet: Case 1
2019-07-02 19:25:04,299 - INFO - Reading Data From Google Sheet...
2019-07-02 19:25:04,884 - INFO - Get custom SQL..
2019-07-02 19:25:04,884 - INFO - USING CASE 1
2019-07-02 19:25:06,588 - INFO - Row 1
2019-07-02 19:25:06,589 - INFO - Filename: A30 FMCG Buyers
2019-07-02 19:25:06,589 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-07-02 19:25:06,591 - INFO - Last Login: 30
2019-07-02 19:25:06,591 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 19:25:06,592 - INFO - Start Running query A30 FMCG Buyers
2019-07-02 19:30:16,342 - INFO - Running A30 FMCG Buyers Done
2019-07-02 19:30:16,344 - INFO - CSV file path: A30 FMCG Buyers
2019-07-02 19:30:16,834 - INFO - Starting save the query results
2019-07-02 19:30:16,835 - INFO - Total Rows : 8791224
2019-07-02 19:30:16,836 - INFO - Will split into : 9.0 files
2019-07-02 19:30:24,607 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 FMCG Buyers_1.csv
2019-07-02 19:30:24,608 - INFO - , with total : 976803 rows
2019-07-02 19:30:30,086 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 FMCG Buyers_2.csv
2019-07-02 19:30:30,088 - INFO - , with total : 976803 rows
2019-07-02 19:30:38,382 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 FMCG Buyers_3.csv
2019-07-02 19:30:38,385 - INFO - , with total : 976803 rows
2019-07-02 19:30:48,914 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 FMCG Buyers_4.csv
2019-07-02 19:30:48,917 - INFO - , with total : 976803 rows
2019-07-02 19:30:56,148 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 FMCG Buyers_5.csv
2019-07-02 19:30:56,151 - INFO - , with total : 976803 rows
2019-07-02 19:31:02,369 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 FMCG Buyers_6.csv
2019-07-02 19:31:02,369 - INFO - , with total : 976803 rows
2019-07-02 19:31:11,220 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 FMCG Buyers_7.csv
2019-07-02 19:31:11,221 - INFO - , with total : 976802 rows
2019-07-02 19:31:21,352 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 FMCG Buyers_8.csv
2019-07-02 19:31:21,355 - INFO - , with total : 976802 rows
2019-07-02 19:31:36,539 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 FMCG Buyers_9.csv
2019-07-02 19:31:36,540 - INFO - , with total : 976802 rows
2019-07-02 19:31:40,295 - INFO - Row 2
2019-07-02 19:31:40,296 - INFO - Filename: A3 EL Buyers
2019-07-02 19:31:40,296 - INFO - Category: 'Electronics','Mobile & Accessories','Computer & Accessories','Photography'
2019-07-02 19:31:40,298 - INFO - Last Login: 3
2019-07-02 19:31:40,299 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 19:31:40,301 - INFO - Start Running query A3 EL Buyers
2019-07-02 19:35:11,017 - INFO - Running A3 EL Buyers Done
2019-07-02 19:35:11,019 - INFO - CSV file path: A3 EL Buyers
2019-07-02 19:35:11,293 - INFO - Starting save the query results
2019-07-02 19:35:11,293 - INFO - Total Rows : 5679905
2019-07-02 19:35:11,295 - INFO - Will split into : 6.0 files
2019-07-02 19:35:17,523 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A3 EL Buyers_1.csv
2019-07-02 19:35:17,526 - INFO - , with total : 946651 rows
2019-07-02 19:35:23,171 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A3 EL Buyers_2.csv
2019-07-02 19:35:23,171 - INFO - , with total : 946651 rows
2019-07-02 19:35:28,917 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A3 EL Buyers_3.csv
2019-07-02 19:35:28,917 - INFO - , with total : 946651 rows
2019-07-02 19:35:35,431 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A3 EL Buyers_4.csv
2019-07-02 19:35:35,431 - INFO - , with total : 946651 rows
2019-07-02 19:35:43,384 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A3 EL Buyers_5.csv
2019-07-02 19:35:43,385 - INFO - , with total : 946651 rows
2019-07-02 19:35:50,579 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A3 EL Buyers_6.csv
2019-07-02 19:35:50,581 - INFO - , with total : 946650 rows
2019-07-02 19:35:51,605 - INFO - Delete all data in the sheet
2019-07-02 19:35:51,607 - INFO - Delete row 6
2019-07-02 19:35:58,203 - INFO - Delete row 5
2019-07-02 19:36:04,785 - INFO - Delete row 4
2019-07-02 19:36:11,372 - INFO - Delete row 3
2019-07-02 19:36:17,983 - INFO - Delete row 2
2019-07-02 19:36:35,513 - INFO - Use sheet: Case 2
2019-07-02 19:36:45,513 - INFO - Reading Data From Google Sheet...
2019-07-02 19:36:46,240 - INFO - Get custom SQL..
2019-07-02 19:36:46,243 - INFO - USING CASE 2
2019-07-02 19:36:48,496 - INFO - Row 1
2019-07-02 19:36:48,497 - INFO - Filename: A7 Havent Purchase in Past 30 days
2019-07-02 19:36:48,497 - INFO - Last Login: 7
2019-07-02 19:36:48,499 - INFO - Date 1: 2019-06-30
2019-07-02 19:36:48,499 - INFO - Date 2: 2019-07-02
2019-07-02 19:36:48,500 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-30' and date'2019-07-02'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-02 19:36:48,500 - INFO - Start Running query A7 Havent Purchase in Past 30 days
2019-07-02 19:42:16,614 - INFO - Running A7 Havent Purchase in Past 30 days Done
2019-07-02 19:42:16,615 - INFO - CSV file path: A7 Havent Purchase in Past 30 days
2019-07-02 19:42:17,161 - INFO - Starting save the query results
2019-07-02 19:42:17,163 - INFO - Total Rows : 13194621
2019-07-02 19:42:17,164 - INFO - Will split into : 14.0 files
2019-07-02 19:42:22,161 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_1.csv
2019-07-02 19:42:22,161 - INFO - , with total : 942473 rows
2019-07-02 19:42:26,973 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_2.csv
2019-07-02 19:42:26,973 - INFO - , with total : 942473 rows
2019-07-02 19:42:32,474 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_3.csv
2019-07-02 19:42:32,476 - INFO - , with total : 942473 rows
2019-07-02 19:42:38,338 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_4.csv
2019-07-02 19:42:38,341 - INFO - , with total : 942473 rows
2019-07-02 19:42:45,788 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_5.csv
2019-07-02 19:42:45,792 - INFO - , with total : 942473 rows
2019-07-02 19:42:51,733 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_6.csv
2019-07-02 19:42:51,733 - INFO - , with total : 942473 rows
2019-07-02 19:42:57,569 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_7.csv
2019-07-02 19:42:57,571 - INFO - , with total : 942473 rows
2019-07-02 19:43:03,335 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_8.csv
2019-07-02 19:43:03,338 - INFO - , with total : 942473 rows
2019-07-02 19:43:09,456 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_9.csv
2019-07-02 19:43:09,456 - INFO - , with total : 942473 rows
2019-07-02 19:43:15,621 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_10.csv
2019-07-02 19:43:15,622 - INFO - , with total : 942473 rows
2019-07-02 19:43:22,273 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_11.csv
2019-07-02 19:43:22,273 - INFO - , with total : 942473 rows
2019-07-02 19:43:28,293 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_12.csv
2019-07-02 19:43:28,295 - INFO - , with total : 942473 rows
2019-07-02 19:43:35,720 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_13.csv
2019-07-02 19:43:35,720 - INFO - , with total : 942473 rows
2019-07-02 19:43:42,808 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A7 Havent Purchase in Past 30 days_14.csv
2019-07-02 19:43:42,809 - INFO - , with total : 942472 rows
2019-07-02 19:43:44,772 - INFO - Delete all data in the sheet
2019-07-02 19:43:44,773 - INFO - Delete row 6
2019-07-02 19:43:51,351 - INFO - Delete row 5
2019-07-02 19:43:57,930 - INFO - Delete row 4
2019-07-02 19:44:04,470 - INFO - Delete row 3
2019-07-02 19:44:11,071 - INFO - Delete row 2
2019-07-02 19:44:28,750 - INFO - Use sheet: Case 3
2019-07-02 19:44:38,752 - INFO - Reading Data From Google Sheet...
2019-07-02 19:44:39,308 - INFO - Get custom SQL..
2019-07-02 19:44:39,309 - INFO - USING CASE 3
2019-07-02 19:44:42,171 - INFO - Row 1
2019-07-02 19:44:42,173 - INFO - Filename: A30 EL Havent Purchase in Past 90 days
2019-07-02 19:44:42,173 - INFO - Category: 'Electronics','Mobile & Accessories','Computer & Accessories','Photography'
2019-07-02 19:44:42,174 - INFO - Last Login: 30
2019-07-02 19:44:42,174 - INFO - Date 1: 2019-07-02
2019-07-02 19:44:42,176 - INFO - Date 2: 2019-07-02
2019-07-02 19:44:42,177 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-02' and date'2019-07-02'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-02 19:44:42,177 - INFO - Start Running query A30 EL Havent Purchase in Past 90 days
2019-07-02 19:48:34,091 - INFO - Running A30 EL Havent Purchase in Past 90 days Done
2019-07-02 19:48:34,092 - INFO - CSV file path: A30 EL Havent Purchase in Past 90 days
2019-07-02 19:48:34,433 - INFO - Starting save the query results
2019-07-02 19:48:34,434 - INFO - Total Rows : 8475904
2019-07-02 19:48:34,434 - INFO - Will split into : 9.0 files
2019-07-02 19:48:39,315 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 EL Havent Purchase in Past 90 days_1.csv
2019-07-02 19:48:39,316 - INFO - , with total : 941768 rows
2019-07-02 19:48:45,566 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 EL Havent Purchase in Past 90 days_2.csv
2019-07-02 19:48:45,568 - INFO - , with total : 941767 rows
2019-07-02 19:48:51,510 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 EL Havent Purchase in Past 90 days_3.csv
2019-07-02 19:48:51,515 - INFO - , with total : 941767 rows
2019-07-02 19:48:57,098 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 EL Havent Purchase in Past 90 days_4.csv
2019-07-02 19:48:57,101 - INFO - , with total : 941767 rows
2019-07-02 19:49:02,809 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 EL Havent Purchase in Past 90 days_5.csv
2019-07-02 19:49:02,811 - INFO - , with total : 941767 rows
2019-07-02 19:49:10,604 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 EL Havent Purchase in Past 90 days_6.csv
2019-07-02 19:49:10,605 - INFO - , with total : 941767 rows
2019-07-02 19:49:17,269 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 EL Havent Purchase in Past 90 days_7.csv
2019-07-02 19:49:17,269 - INFO - , with total : 941767 rows
2019-07-02 19:49:24,140 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 EL Havent Purchase in Past 90 days_8.csv
2019-07-02 19:49:24,141 - INFO - , with total : 941767 rows
2019-07-02 19:49:30,269 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 EL Havent Purchase in Past 90 days_9.csv
2019-07-02 19:49:30,270 - INFO - , with total : 941767 rows
2019-07-02 19:49:31,667 - INFO - Delete all data in the sheet
2019-07-02 19:49:31,668 - INFO - Delete row 6
2019-07-02 19:49:38,273 - INFO - Delete row 5
2019-07-02 19:49:44,812 - INFO - Delete row 4
2019-07-02 19:49:51,405 - INFO - Delete row 3
2019-07-02 19:49:57,994 - INFO - Delete row 2
2019-07-02 19:50:15,706 - INFO - Use sheet: Case 4
2019-07-02 19:50:25,707 - INFO - Reading Data From Google Sheet...
2019-07-02 19:50:26,259 - INFO - Get custom SQL..
2019-07-02 19:50:26,260 - INFO - USING CASE 4
2019-07-02 19:50:28,440 - INFO - Row 1
2019-07-02 19:50:28,440 - INFO - Filename: A30 Male FMCG Buyers
2019-07-02 19:50:28,441 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-07-02 19:50:28,441 - INFO - Last Login: 30
2019-07-02 19:50:28,443 - INFO - Gender: 1,3
2019-07-02 19:50:28,443 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-02 19:50:28,444 - INFO - Start Running query A30 Male FMCG Buyers
2019-07-02 19:51:16,170 - INFO - Running A30 Male FMCG Buyers Done
2019-07-02 19:51:16,171 - INFO - CSV file path: A30 Male FMCG Buyers
2019-07-02 19:51:16,243 - INFO - Starting save the query results
2019-07-02 19:51:16,243 - INFO - Total Rows : 1651493
2019-07-02 19:51:16,243 - INFO - Will split into : 2.0 files
2019-07-02 19:51:20,670 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 Male FMCG Buyers_1.csv
2019-07-02 19:51:20,670 - INFO - , with total : 825747 rows
2019-07-02 19:51:24,831 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 19.24/A30 Male FMCG Buyers_2.csv
2019-07-02 19:51:24,832 - INFO - , with total : 825746 rows
2019-07-02 19:51:25,480 - INFO - Delete all data in the sheet
2019-07-02 19:51:25,482 - INFO - Delete row 6
2019-07-02 19:51:32,056 - INFO - Delete row 5
2019-07-02 19:51:38,634 - INFO - Delete row 4
2019-07-02 19:51:45,276 - INFO - Delete row 3
2019-07-02 19:51:51,881 - INFO - Delete row 2
2019-07-02 21:53:51,630 - INFO - Report date: 20190702 21.53
2019-07-02 21:53:53,382 - INFO - Connect Google Sheet Successfully...
2019-07-02 21:53:53,390 - INFO - Download sheet..
2019-07-02 21:53:53,391 - INFO - Change directory to script path
2019-07-02 21:53:54,242 - INFO - Spreadsheet downloaded
2019-07-02 21:53:54,243 - INFO - Checking sheet..
2019-07-02 21:54:05,595 - INFO - Use sheet: Case 1
2019-07-02 21:54:15,595 - INFO - Reading Data From Google Sheet...
2019-07-02 21:54:16,165 - INFO - Get custom SQL..
2019-07-02 21:54:16,167 - INFO - USING CASE 1
2019-07-02 21:54:17,790 - INFO - Row 1
2019-07-02 21:54:17,792 - INFO - Filename: A1 FMCG Buyers
2019-07-02 21:54:17,792 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-07-02 21:54:17,792 - INFO - Last Login: 1
2019-07-02 21:54:17,793 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-02 21:54:17,793 - INFO - Start Running query A1 FMCG Buyers
2019-07-02 21:56:03,233 - INFO - Running A1 FMCG Buyers Done
2019-07-02 21:56:03,233 - INFO - CSV file path: A1 FMCG Buyers
2019-07-02 21:56:03,403 - INFO - Starting save the query results
2019-07-02 21:56:03,404 - INFO - Total Rows : 4494848
2019-07-02 21:56:03,404 - INFO - Will split into : 5.0 files
2019-07-02 21:56:07,426 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 21.53/A1 FMCG Buyers_1.csv
2019-07-02 21:56:07,427 - INFO - , with total : 898970 rows
2019-07-02 21:56:11,710 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 21.53/A1 FMCG Buyers_2.csv
2019-07-02 21:56:11,711 - INFO - , with total : 898970 rows
2019-07-02 21:56:16,170 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 21.53/A1 FMCG Buyers_3.csv
2019-07-02 21:56:16,170 - INFO - , with total : 898970 rows
2019-07-02 21:56:20,703 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 21.53/A1 FMCG Buyers_4.csv
2019-07-02 21:56:20,703 - INFO - , with total : 898969 rows
2019-07-02 21:56:25,275 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190702 21.53/A1 FMCG Buyers_5.csv
2019-07-02 21:56:25,276 - INFO - , with total : 898969 rows
2019-07-02 21:56:26,496 - INFO - Delete all data in the sheet
2019-07-02 21:56:26,499 - INFO - Delete row 6
2019-07-02 21:56:33,075 - INFO - Delete row 5
2019-07-02 21:56:39,431 - INFO - Delete row 4
2019-07-02 21:56:46,039 - INFO - Delete row 3
2019-07-02 21:56:52,575 - INFO - Delete row 2
2019-07-02 21:57:10,484 - INFO - No value detected on sheet: Case 2
2019-07-02 21:57:21,575 - INFO - No value detected on sheet: Case 3
2019-07-02 21:57:32,617 - INFO - No value detected on sheet: Case 4
2019-07-03 10:00:19,252 - INFO - Report date: 20190703 10.00
2019-07-03 10:00:19,941 - INFO - Connect Google Sheet Successfully...
2019-07-03 10:00:20,013 - INFO - Download sheet..
2019-07-03 10:00:20,013 - INFO - Change directory to script path
2019-07-03 10:00:21,342 - INFO - Spreadsheet downloaded
2019-07-03 10:00:21,342 - INFO - Checking sheet..
2019-07-03 10:00:32,665 - INFO - No value detected on sheet: Case 1
2019-07-03 10:00:43,835 - INFO - No value detected on sheet: Case 2
2019-07-03 10:00:54,969 - INFO - No value detected on sheet: Case 3
2019-07-03 10:01:06,061 - INFO - No value detected on sheet: Case 4
2019-07-03 14:00:10,292 - INFO - Report date: 20190703 14.00
2019-07-03 17:00:01,650 - INFO - Report date: 20190703 17.00
2019-07-03 17:00:02,519 - INFO - Connect Google Sheet Successfully...
2019-07-03 17:00:02,559 - INFO - Download sheet..
2019-07-03 17:00:02,559 - INFO - Change directory to script path
2019-07-03 17:00:03,483 - INFO - Spreadsheet downloaded
2019-07-03 17:00:03,483 - INFO - Checking sheet..
2019-07-03 17:00:14,779 - INFO - No value detected on sheet: Case 1
2019-07-03 17:00:25,877 - INFO - No value detected on sheet: Case 2
2019-07-03 17:00:36,946 - INFO - Use sheet: Case 3
2019-07-03 17:00:46,947 - INFO - Reading Data From Google Sheet...
2019-07-03 17:00:47,503 - INFO - Get custom SQL..
2019-07-03 17:00:47,505 - INFO - USING CASE 3
2019-07-03 17:00:50,368 - INFO - Row 1
2019-07-03 17:00:50,371 - INFO - Filename: A30 Mom & Baby & BKF Buyers
2019-07-03 17:00:50,372 - INFO - Category: 'Baby & Kids Fashion','Mom & Baby'
2019-07-03 17:00:50,375 - INFO - Last Login: 30
2019-07-03 17:00:50,377 - INFO - Date 1: 2019-06-03
2019-07-03 17:00:50,378 - INFO - Date 2: 2019-07-03
2019-07-03 17:00:50,378 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-03' and date'2019-07-03'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-03 17:00:50,378 - INFO - Start Running query A30 Mom & Baby & BKF Buyers
2019-07-03 17:01:40,309 - INFO - Running A30 Mom & Baby & BKF Buyers Done
2019-07-03 17:01:40,309 - INFO - CSV file path: A30 Mom & Baby & BKF Buyers
2019-07-03 17:01:40,367 - INFO - Starting save the query results
2019-07-03 17:01:40,368 - INFO - Total Rows : 1632402
2019-07-03 17:01:40,368 - INFO - Will split into : 2.0 files
2019-07-03 17:01:43,868 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190703 17.00/A30 Mom & Baby & BKF Buyers_1.csv
2019-07-03 17:01:43,868 - INFO - , with total : 816201 rows
2019-07-03 17:01:48,084 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190703 17.00/A30 Mom & Baby & BKF Buyers_2.csv
2019-07-03 17:01:48,085 - INFO - , with total : 816201 rows
2019-07-03 17:01:49,677 - INFO - Delete all data in the sheet
2019-07-03 17:01:49,680 - INFO - Delete row 6
2019-07-03 17:01:56,299 - INFO - Delete row 5
2019-07-03 17:02:02,849 - INFO - Delete row 4
2019-07-03 17:02:09,211 - INFO - Delete row 3
2019-07-03 17:02:15,776 - INFO - Delete row 2
2019-07-03 17:02:33,237 - INFO - No value detected on sheet: Case 4
2019-07-05 10:00:15,338 - INFO - Report date: 20190705 10.00
2019-07-05 10:00:16,134 - INFO - Connect Google Sheet Successfully...
2019-07-05 10:00:16,193 - INFO - Download sheet..
2019-07-05 10:00:16,194 - INFO - Change directory to script path
2019-07-05 10:00:17,158 - INFO - Spreadsheet downloaded
2019-07-05 10:00:17,160 - INFO - Checking sheet..
2019-07-05 10:00:28,428 - INFO - Use sheet: Case 1
2019-07-05 10:00:38,430 - INFO - Reading Data From Google Sheet...
2019-07-05 10:00:38,984 - INFO - Get custom SQL..
2019-07-05 10:00:38,987 - INFO - USING CASE 1
2019-07-05 10:00:40,647 - INFO - Row 1
2019-07-05 10:00:40,647 - INFO - Filename: A30 MA Buyers
2019-07-05 10:00:40,648 - INFO - Category: 'Mobile & Accessories'
2019-07-05 10:00:40,648 - INFO - Last Login: 30
2019-07-05 10:00:40,648 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-05 10:00:40,650 - INFO - Start Running query A30 MA Buyers
2019-07-05 10:04:10,808 - INFO - Running A30 MA Buyers Done
2019-07-05 10:04:10,809 - INFO - CSV file path: A30 MA Buyers
2019-07-05 10:04:11,286 - INFO - Starting save the query results
2019-07-05 10:04:11,288 - INFO - Total Rows : 6920632
2019-07-05 10:04:11,289 - INFO - Will split into : 7.0 files
2019-07-05 10:04:16,351 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190705 10.00/A30 MA Buyers_1.csv
2019-07-05 10:04:16,361 - INFO - , with total : 988662 rows
2019-07-05 10:04:21,680 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190705 10.00/A30 MA Buyers_2.csv
2019-07-05 10:04:21,680 - INFO - , with total : 988662 rows
2019-07-05 10:04:26,927 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190705 10.00/A30 MA Buyers_3.csv
2019-07-05 10:04:26,927 - INFO - , with total : 988662 rows
2019-07-05 10:04:32,540 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190705 10.00/A30 MA Buyers_4.csv
2019-07-05 10:04:32,540 - INFO - , with total : 988662 rows
2019-07-05 10:04:38,230 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190705 10.00/A30 MA Buyers_5.csv
2019-07-05 10:04:38,232 - INFO - , with total : 988662 rows
2019-07-05 10:04:43,423 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190705 10.00/A30 MA Buyers_6.csv
2019-07-05 10:04:43,423 - INFO - , with total : 988661 rows
2019-07-05 10:04:48,726 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190705 10.00/A30 MA Buyers_7.csv
2019-07-05 10:04:48,733 - INFO - , with total : 988661 rows
2019-07-05 10:04:50,674 - INFO - Delete all data in the sheet
2019-07-05 10:04:50,676 - INFO - Delete row 6
2019-07-05 10:04:57,283 - INFO - Delete row 5
2019-07-05 10:05:07,135 - INFO - Delete row 4
2019-07-05 10:05:13,663 - INFO - Delete row 3
2019-07-05 10:05:20,234 - INFO - Delete row 2
2019-07-05 10:05:37,990 - INFO - No value detected on sheet: Case 2
2019-07-05 10:05:49,137 - INFO - No value detected on sheet: Case 3
2019-07-05 10:06:00,250 - INFO - Use sheet: Case 4
2019-07-05 10:06:10,250 - INFO - Reading Data From Google Sheet...
2019-07-05 10:06:10,798 - INFO - Get custom SQL..
2019-07-05 10:06:10,798 - INFO - USING CASE 4
2019-07-05 10:06:12,756 - INFO - Row 1
2019-07-05 10:06:12,773 - INFO - Filename: A7 Male Lifestyle Buyers
2019-07-05 10:06:12,776 - INFO - Category: 'Hobby & Collection'
2019-07-05 10:06:12,776 - INFO - Last Login: 30
2019-07-05 10:06:12,776 - INFO - Gender: 1,3
2019-07-05 10:06:12,776 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-05 10:06:12,778 - INFO - Start Running query A7 Male Lifestyle Buyers
2019-07-05 10:06:54,418 - INFO - Running A7 Male Lifestyle Buyers Done
2019-07-05 10:06:54,420 - INFO - CSV file path: A7 Male Lifestyle Buyers
2019-07-05 10:06:54,440 - INFO - Starting save the query results
2019-07-05 10:06:54,441 - INFO - Total Rows : 505093
2019-07-05 10:06:54,441 - INFO - Will split into : 1.0 files
2019-07-05 10:06:58,437 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190705 10.00/A7 Male Lifestyle Buyers_1.csv
2019-07-05 10:06:58,437 - INFO - , with total : 505093 rows
2019-07-05 10:06:59,328 - INFO - Delete all data in the sheet
2019-07-05 10:06:59,328 - INFO - Delete row 6
2019-07-05 10:07:05,697 - INFO - Delete row 5
2019-07-05 10:07:12,259 - INFO - Delete row 4
2019-07-05 10:07:18,627 - INFO - Delete row 3
2019-07-05 10:07:25,184 - INFO - Delete row 2
2019-07-06 14:00:05,293 - INFO - Report date: 20190706 14.00
2019-07-06 14:00:06,086 - INFO - Connect Google Sheet Successfully...
2019-07-06 14:00:06,151 - INFO - Download sheet..
2019-07-06 14:00:06,153 - INFO - Change directory to script path
2019-07-06 14:00:07,154 - INFO - Spreadsheet downloaded
2019-07-06 14:00:07,155 - INFO - Checking sheet..
2019-07-06 14:00:18,585 - INFO - No value detected on sheet: Case 1
2019-07-06 14:00:29,845 - INFO - No value detected on sheet: Case 2
2019-07-06 14:00:41,101 - INFO - Use sheet: Case 3
2019-07-06 14:00:51,104 - INFO - Reading Data From Google Sheet...
2019-07-06 14:00:51,736 - INFO - Get custom SQL..
2019-07-06 14:00:51,740 - INFO - USING CASE 3
2019-07-06 14:00:54,796 - INFO - Row 1
2019-07-06 14:00:54,799 - INFO - Filename: A30 Mom & Baby, Baby Kids Fashion Buyers
2019-07-06 14:00:54,799 - INFO - Category: 'Mom & Baby','Baby & Kids Fashion'
2019-07-06 14:00:54,802 - INFO - Last Login: 30
2019-07-06 14:00:54,803 - INFO - Date 1: 2019-06-05
2019-07-06 14:00:54,808 - INFO - Date 2: 2019-07-05
2019-07-06 14:00:54,809 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mom & Baby','Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-05' and date'2019-07-05'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-06 14:00:54,812 - INFO - Start Running query A30 Mom & Baby, Baby Kids Fashion Buyers
2019-07-06 14:01:53,177 - INFO - Running A30 Mom & Baby, Baby Kids Fashion Buyers Done
2019-07-06 14:01:53,177 - INFO - CSV file path: A30 Mom & Baby, Baby Kids Fashion Buyers
2019-07-06 14:01:53,234 - INFO - Starting save the query results
2019-07-06 14:01:53,236 - INFO - Total Rows : 1549426
2019-07-06 14:01:53,236 - INFO - Will split into : 2.0 files
2019-07-06 14:01:56,746 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190706 14.00/A30 Mom & Baby, Baby Kids Fashion Buyers_1.csv
2019-07-06 14:01:56,747 - INFO - , with total : 774713 rows
2019-07-06 14:02:00,536 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190706 14.00/A30 Mom & Baby, Baby Kids Fashion Buyers_2.csv
2019-07-06 14:02:00,536 - INFO - , with total : 774713 rows
2019-07-06 14:02:01,469 - INFO - Delete all data in the sheet
2019-07-06 14:02:01,470 - INFO - Delete row 6
2019-07-06 14:02:08,127 - INFO - Delete row 5
2019-07-06 14:02:14,736 - INFO - Delete row 4
2019-07-06 14:02:21,392 - INFO - Delete row 3
2019-07-06 14:02:28,006 - INFO - Delete row 2
2019-07-06 14:02:45,865 - INFO - No value detected on sheet: Case 4
2019-07-07 17:00:02,697 - INFO - Report date: 20190707 17.00
2019-07-07 17:00:03,572 - INFO - Connect Google Sheet Successfully...
2019-07-07 17:00:03,586 - INFO - Download sheet..
2019-07-07 17:00:03,592 - INFO - Change directory to script path
2019-07-07 17:00:04,819 - INFO - Spreadsheet downloaded
2019-07-07 17:00:04,819 - INFO - Checking sheet..
2019-07-07 17:00:16,204 - INFO - No value detected on sheet: Case 1
2019-07-07 17:00:27,184 - INFO - No value detected on sheet: Case 2
2019-07-07 17:00:37,878 - INFO - No value detected on sheet: Case 3
2019-07-07 17:00:48,934 - INFO - No value detected on sheet: Case 4
2019-07-09 10:00:19,809 - INFO - Report date: 20190709 10.00
2019-07-09 10:00:20,634 - INFO - Connect Google Sheet Successfully...
2019-07-09 10:00:20,716 - INFO - Download sheet..
2019-07-09 10:00:20,717 - INFO - Change directory to script path
2019-07-09 10:00:21,747 - INFO - Spreadsheet downloaded
2019-07-09 10:00:21,749 - INFO - Checking sheet..
2019-07-09 10:00:33,601 - INFO - No value detected on sheet: Case 1
2019-07-09 10:00:45,296 - INFO - No value detected on sheet: Case 2
2019-07-09 10:00:56,877 - INFO - No value detected on sheet: Case 3
2019-07-09 10:01:08,640 - INFO - No value detected on sheet: Case 4
2019-07-09 18:48:56,032 - INFO - Report date: 20190709 18.48
2019-07-09 18:48:57,882 - INFO - Connect Google Sheet Successfully...
2019-07-09 18:48:57,914 - INFO - Download sheet..
2019-07-09 18:48:57,915 - INFO - Change directory to script path
2019-07-09 18:48:59,069 - INFO - Spreadsheet downloaded
2019-07-09 18:48:59,072 - INFO - Checking sheet..
2019-07-09 18:52:41,974 - INFO - Report date: 20190709 18.52
2019-07-09 18:52:43,160 - INFO - Connect Google Sheet Successfully...
2019-07-09 18:52:43,217 - INFO - Download sheet..
2019-07-09 18:52:43,217 - INFO - Change directory to script path
2019-07-09 18:52:44,582 - INFO - Spreadsheet downloaded
2019-07-09 18:52:44,582 - INFO - Checking sheet..
2019-07-09 18:52:56,322 - INFO - Use sheet: Case 1
2019-07-09 18:53:06,322 - INFO - Reading Data From Google Sheet...
2019-07-09 18:53:07,109 - INFO - Get custom SQL..
2019-07-09 18:53:07,112 - INFO - USING CASE 1
2019-07-09 18:53:09,486 - INFO - Row 1
2019-07-09 18:53:09,487 - INFO - Filename: A30 Lifestyle Buyers
2019-07-09 18:53:09,487 - INFO - Category: 'Automotive','Hobby & Collection'
2019-07-09 18:53:09,487 - INFO - Last Login: 30
2019-07-09 18:53:09,489 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Automotive','Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-09 18:53:09,489 - INFO - Start Running query A30 Lifestyle Buyers
2019-07-09 18:54:49,582 - INFO - Running A30 Lifestyle Buyers Done
2019-07-09 18:54:49,585 - INFO - CSV file path: A30 Lifestyle Buyers
2019-07-09 18:54:49,742 - INFO - Starting save the query results
2019-07-09 18:54:49,743 - INFO - Total Rows : 4284249
2019-07-09 18:54:49,743 - INFO - Will split into : 5.0 files
2019-07-09 18:54:53,536 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190709 18.52/A30 Lifestyle Buyers_1.csv
2019-07-09 18:54:53,536 - INFO - , with total : 856850 rows
2019-07-09 18:54:57,631 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190709 18.52/A30 Lifestyle Buyers_2.csv
2019-07-09 18:54:57,631 - INFO - , with total : 856850 rows
2019-07-09 18:55:01,753 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190709 18.52/A30 Lifestyle Buyers_3.csv
2019-07-09 18:55:01,753 - INFO - , with total : 856850 rows
2019-07-09 18:55:05,999 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190709 18.52/A30 Lifestyle Buyers_4.csv
2019-07-09 18:55:06,000 - INFO - , with total : 856850 rows
2019-07-09 18:55:10,186 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190709 18.52/A30 Lifestyle Buyers_5.csv
2019-07-09 18:55:10,187 - INFO - , with total : 856849 rows
2019-07-09 18:55:11,546 - INFO - Delete all data in the sheet
2019-07-09 18:55:11,548 - INFO - Delete row 6
2019-07-09 18:55:18,414 - INFO - Delete row 5
2019-07-09 18:55:25,217 - INFO - Delete row 4
2019-07-09 18:55:32,049 - INFO - Delete row 3
2019-07-09 18:55:38,928 - INFO - Delete row 2
2019-07-09 18:55:57,365 - INFO - No value detected on sheet: Case 2
2019-07-09 18:56:08,969 - INFO - No value detected on sheet: Case 3
2019-07-09 18:56:20,568 - INFO - No value detected on sheet: Case 4
2019-07-10 10:00:12,904 - INFO - Report date: 20190710 10.00
2019-07-10 10:00:13,977 - INFO - Connect Google Sheet Successfully...
2019-07-10 10:00:14,056 - INFO - Download sheet..
2019-07-10 10:00:14,058 - INFO - Change directory to script path
2019-07-10 10:00:15,138 - INFO - Spreadsheet downloaded
2019-07-10 10:00:15,140 - INFO - Checking sheet..
2019-07-10 10:00:27,180 - INFO - No value detected on sheet: Case 1
2019-07-10 10:00:38,460 - INFO - No value detected on sheet: Case 2
2019-07-10 10:00:49,724 - INFO - No value detected on sheet: Case 3
2019-07-10 10:01:01,016 - INFO - No value detected on sheet: Case 4
2019-07-10 14:00:15,301 - INFO - Report date: 20190710 14.00
2019-07-10 14:00:15,990 - INFO - Connect Google Sheet Successfully...
2019-07-10 14:00:16,062 - INFO - Download sheet..
2019-07-10 14:00:16,063 - INFO - Change directory to script path
2019-07-10 14:00:17,016 - INFO - Spreadsheet downloaded
2019-07-10 14:00:17,016 - INFO - Checking sheet..
2019-07-10 14:00:28,584 - INFO - No value detected on sheet: Case 1
2019-07-10 14:00:39,858 - INFO - No value detected on sheet: Case 2
2019-07-10 14:00:51,171 - INFO - No value detected on sheet: Case 3
2019-07-10 14:01:02,447 - INFO - No value detected on sheet: Case 4
2019-07-10 14:55:21,380 - INFO - Report date: 20190710 14.55
2019-07-10 14:55:23,394 - INFO - Connect Google Sheet Successfully...
2019-07-10 14:55:23,420 - INFO - Download sheet..
2019-07-10 14:55:23,421 - INFO - Change directory to script path
2019-07-10 14:55:25,368 - INFO - Spreadsheet downloaded
2019-07-10 14:55:25,368 - INFO - Checking sheet..
2019-07-10 14:55:37,380 - INFO - No value detected on sheet: Case 1
2019-07-10 14:55:48,707 - INFO - No value detected on sheet: Case 2
2019-07-10 14:55:59,980 - INFO - No value detected on sheet: Case 3
2019-07-10 14:56:11,354 - INFO - No value detected on sheet: Case 4
2019-07-10 14:56:22,417 - INFO - Use sheet: Case 5
2019-07-10 14:56:32,418 - INFO - Reading Data From Google Sheet...
2019-07-10 14:56:33,085 - INFO - Get custom SQL..
2019-07-10 14:56:33,086 - INFO - USING CASE 5
2019-07-10 14:56:35,757 - INFO - Row 1
2019-07-10 14:56:35,759 - INFO - Filename: A1 MA CA G buyers
2019-07-10 14:56:35,762 - INFO - Category: 'Mobile & Accessories','Computer & Accessories'
2019-07-10 14:56:35,763 - INFO - Sub-category: 'Video Games','Gaming'
2019-07-10 14:56:35,763 - INFO - Last Login: 1
2019-07-10 14:56:35,766 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Mobile & Accessories','Computer & Accessories')
                                    or
                                    p.sub_category in ('Video Games','Gaming'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-10 14:56:35,770 - INFO - Start Running query A1 MA CA G buyers
2019-07-10 15:01:08,029 - INFO - Running A1 MA CA G buyers Done
2019-07-10 15:01:08,030 - INFO - CSV file path: A1 MA CA G buyers
2019-07-10 15:01:08,341 - INFO - Starting save the query results
2019-07-10 15:01:08,342 - INFO - Total Rows : 3733686
2019-07-10 15:01:08,342 - INFO - Will split into : 4.0 files
2019-07-10 15:01:13,520 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 14.55/A1 MA CA G buyers_1.csv
2019-07-10 15:01:13,522 - INFO - , with total : 933422 rows
2019-07-10 15:01:18,884 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 14.55/A1 MA CA G buyers_2.csv
2019-07-10 15:01:18,884 - INFO - , with total : 933422 rows
2019-07-10 15:01:24,936 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 14.55/A1 MA CA G buyers_3.csv
2019-07-10 15:01:24,938 - INFO - , with total : 933421 rows
2019-07-10 15:01:30,865 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 14.55/A1 MA CA G buyers_4.csv
2019-07-10 15:01:30,867 - INFO - , with total : 933421 rows
2019-07-10 15:01:32,430 - INFO - Delete all data in the sheet
2019-07-10 15:01:32,430 - INFO - Delete row 6
2019-07-10 15:01:39,125 - INFO - Delete row 5
2019-07-10 15:01:46,128 - INFO - Delete row 4
2019-07-10 15:01:52,796 - INFO - Delete row 3
2019-07-10 15:01:59,506 - INFO - Delete row 2
2019-07-10 15:02:18,015 - INFO - Use sheet: Case 6
2019-07-10 15:02:28,019 - INFO - Reading Data From Google Sheet...
2019-07-10 15:02:28,829 - INFO - Get custom SQL..
2019-07-10 15:02:28,832 - INFO - USING CASE 6
2019-07-10 15:02:33,493 - INFO - Row 1
2019-07-10 15:02:33,494 - INFO - Filename: A1 FMCG HC buyers havent shopped 30
2019-07-10 15:02:33,496 - INFO - Category: 'Health','Beauty','Health & Beauty',' Cosmetics','Mom & Baby'
2019-07-10 15:02:33,496 - INFO - Sub-category: 'Home Care'
2019-07-10 15:02:33,496 - INFO - Last Login: 1
2019-07-10 15:02:33,497 - INFO - Date 1: 2019-06-09
2019-07-10 15:02:33,497 - INFO - Date 2: 2019-07-09
2019-07-10 15:02:33,499 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Health','Beauty','Health & Beauty',' Cosmetics','Mom & Baby')
                                    or
                                    p.sub_category in ('Home Care'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-09' and date'2019-07-09'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-10 15:02:33,500 - INFO - Start Running query A1 FMCG HC buyers havent shopped 30
2019-07-10 15:03:58,338 - INFO - Running A1 FMCG HC buyers havent shopped 30 Done
2019-07-10 15:03:58,341 - INFO - CSV file path: A1 FMCG HC buyers havent shopped 30
2019-07-10 15:03:58,401 - INFO - Starting save the query results
2019-07-10 15:03:58,401 - INFO - Total Rows : 719223
2019-07-10 15:03:58,403 - INFO - Will split into : 1.0 files
2019-07-10 15:04:02,578 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 14.55/A1 FMCG HC buyers havent shopped 30_1.csv
2019-07-10 15:04:02,579 - INFO - , with total : 719223 rows
2019-07-10 15:04:03,025 - INFO - Delete all data in the sheet
2019-07-10 15:04:03,026 - INFO - Delete row 6
2019-07-10 15:04:09,720 - INFO - Delete row 5
2019-07-10 15:04:16,388 - INFO - Delete row 4
2019-07-10 15:04:22,845 - INFO - Delete row 3
2019-07-10 15:04:29,594 - INFO - Delete row 2
2019-07-10 15:04:47,959 - INFO - Use sheet: Case 7
2019-07-10 15:04:57,960 - INFO - Reading Data From Google Sheet...
2019-07-10 15:04:58,348 - INFO - Get custom SQL..
2019-07-10 15:04:58,351 - INFO - USING CASE 7
2019-07-10 15:04:59,345 - INFO - Row 1
2019-07-10 15:04:59,346 - INFO - Filename: Shop 1 followers
2019-07-10 15:04:59,348 - INFO - Shop ID: 10419711
2019-07-10 15:04:59,348 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 10419711 
                                and status = 1
                                
2019-07-10 15:04:59,351 - INFO - Start Running query Shop 1 followers
2019-07-10 15:05:08,681 - INFO - Running Shop 1 followers Done
2019-07-10 15:05:08,684 - INFO - CSV file path: Shop 1 followers
2019-07-10 15:05:08,696 - INFO - Starting save the query results
2019-07-10 15:05:08,697 - INFO - Total Rows : 22504
2019-07-10 15:05:08,701 - INFO - Will split into : 1.0 files
2019-07-10 15:05:08,864 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 14.55/Shop 1 followers_1.csv
2019-07-10 15:05:08,865 - INFO - , with total : 22504 rows
2019-07-10 15:05:09,338 - INFO - Delete all data in the sheet
2019-07-10 15:05:09,338 - INFO - Delete row 6
2019-07-10 15:05:15,989 - INFO - Delete row 5
2019-07-10 15:05:22,648 - INFO - Delete row 4
2019-07-10 15:05:29,339 - INFO - Delete row 3
2019-07-10 15:05:36,016 - INFO - Delete row 2
2019-07-10 17:00:02,522 - INFO - Report date: 20190710 17.00
2019-07-10 17:00:04,016 - INFO - Connect Google Sheet Successfully...
2019-07-10 17:00:04,032 - INFO - Download sheet..
2019-07-10 17:00:04,032 - INFO - Change directory to script path
2019-07-10 17:00:05,210 - INFO - Spreadsheet downloaded
2019-07-10 17:00:05,210 - INFO - Checking sheet..
2019-07-10 17:00:16,663 - INFO - No value detected on sheet: Case 1
2019-07-10 17:00:28,361 - INFO - No value detected on sheet: Case 2
2019-07-10 17:00:40,165 - INFO - No value detected on sheet: Case 3
2019-07-10 17:00:51,496 - INFO - No value detected on sheet: Case 4
2019-07-10 17:43:05,122 - INFO - Report date: 20190710 17.43
2019-07-10 17:43:11,540 - INFO - Connect Google Sheet Successfully...
2019-07-10 17:43:11,565 - INFO - Download sheet..
2019-07-10 17:43:11,565 - INFO - Change directory to script path
2019-07-10 17:43:13,895 - INFO - Spreadsheet downloaded
2019-07-10 17:43:13,897 - INFO - Checking sheet..
2019-07-10 17:43:26,579 - INFO - No value detected on sheet: Case 1
2019-07-10 17:43:38,226 - INFO - No value detected on sheet: Case 2
2019-07-10 17:43:50,180 - INFO - No value detected on sheet: Case 3
2019-07-10 17:44:01,673 - INFO - No value detected on sheet: Case 4
2019-07-10 17:44:13,249 - INFO - Value detected - use sheet: Case 5
2019-07-10 17:44:23,252 - INFO - Reading Data From Google Sheet...
2019-07-10 17:44:23,987 - INFO - Get custom SQL..
2019-07-10 17:44:23,989 - INFO - USING CASE 5
2019-07-10 17:44:27,322 - INFO - Row 1
2019-07-10 17:44:27,325 - INFO - Filename: A1 EL HC buyers
2019-07-10 17:44:27,328 - INFO - Category: 'Electronics'
2019-07-10 17:44:27,334 - INFO - Sub-category: 'Home Care'
2019-07-10 17:44:27,338 - INFO - Last Login: 1
2019-07-10 17:44:27,345 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Electronics')
                                    or
                                    p.sub_category in ('Home Care'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-10 17:44:27,349 - INFO - Start Running query A1 EL HC buyers
2019-07-10 17:47:10,190 - INFO - Running A1 EL HC buyers Done
2019-07-10 17:47:10,190 - INFO - CSV file path: A1 EL HC buyers
2019-07-10 17:47:10,391 - INFO - Starting save the query results
2019-07-10 17:47:10,391 - INFO - Total Rows : 2549122
2019-07-10 17:47:10,391 - INFO - Will split into : 3.0 files
2019-07-10 17:47:14,894 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 17.43/A1 EL HC buyers_1.csv
2019-07-10 17:47:14,894 - INFO - , with total : 849708 rows
2019-07-10 17:47:19,368 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 17.43/A1 EL HC buyers_2.csv
2019-07-10 17:47:19,369 - INFO - , with total : 849707 rows
2019-07-10 17:47:23,938 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 17.43/A1 EL HC buyers_3.csv
2019-07-10 17:47:23,938 - INFO - , with total : 849707 rows
2019-07-10 17:47:24,904 - INFO - Delete all data in the sheet
2019-07-10 17:47:24,904 - INFO - Delete row 6
2019-07-10 17:47:32,394 - INFO - Delete row 5
2019-07-10 17:47:41,299 - INFO - Delete row 4
2019-07-10 17:47:50,858 - INFO - Delete row 3
2019-07-10 17:48:00,319 - INFO - Delete row 2
2019-07-10 17:48:19,992 - INFO - Value detected - use sheet: Case 6
2019-07-10 17:48:29,993 - INFO - Reading Data From Google Sheet...
2019-07-10 17:48:30,930 - INFO - Get custom SQL..
2019-07-10 17:48:30,933 - INFO - USING CASE 6
2019-07-10 17:48:36,250 - INFO - Row 1
2019-07-10 17:48:36,253 - INFO - Filename: A1 HL G buyers
2019-07-10 17:48:36,256 - INFO - Category: 'Home & Living'
2019-07-10 17:48:36,259 - INFO - Sub-category: 'Gaming','Video Games'
2019-07-10 17:48:36,260 - INFO - Last Login: 1
2019-07-10 17:48:36,265 - INFO - Date 1: 2019-07-09
2019-07-10 17:48:36,266 - INFO - Date 2: 2019-06-09
2019-07-10 17:48:36,269 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Home & Living')
                                    or
                                    p.sub_category in ('Gaming','Video Games'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-09' and date'2019-06-09'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-10 17:48:36,276 - INFO - Start Running query A1 HL G buyers
2019-07-10 17:51:19,121 - INFO - Running A1 HL G buyers Done
2019-07-10 17:51:19,122 - INFO - CSV file path: A1 HL G buyers
2019-07-10 17:51:19,391 - INFO - Starting save the query results
2019-07-10 17:51:19,392 - INFO - Total Rows : 3389212
2019-07-10 17:51:19,392 - INFO - Will split into : 4.0 files
2019-07-10 17:51:23,720 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 17.43/A1 HL G buyers_1.csv
2019-07-10 17:51:23,721 - INFO - , with total : 847303 rows
2019-07-10 17:51:28,479 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 17.43/A1 HL G buyers_2.csv
2019-07-10 17:51:28,480 - INFO - , with total : 847303 rows
2019-07-10 17:51:32,815 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 17.43/A1 HL G buyers_3.csv
2019-07-10 17:51:32,815 - INFO - , with total : 847303 rows
2019-07-10 17:51:37,293 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 17.43/A1 HL G buyers_4.csv
2019-07-10 17:51:37,293 - INFO - , with total : 847303 rows
2019-07-10 17:51:38,517 - INFO - Delete all data in the sheet
2019-07-10 17:51:38,522 - INFO - Delete row 6
2019-07-10 17:51:45,174 - INFO - Delete row 5
2019-07-10 17:51:52,115 - INFO - Delete row 4
2019-07-10 17:51:58,950 - INFO - Delete row 3
2019-07-10 17:52:05,730 - INFO - Delete row 2
2019-07-10 17:52:23,838 - INFO - Value detected - use sheet: Case 7
2019-07-10 17:52:33,841 - INFO - Reading Data From Google Sheet...
2019-07-10 17:52:34,630 - INFO - Get custom SQL..
2019-07-10 17:52:34,632 - INFO - USING CASE 7
2019-07-10 17:52:36,690 - INFO - Row 1
2019-07-10 17:52:36,693 - INFO - Filename: PN shop followers
2019-07-10 17:52:36,696 - INFO - Shop ID: 139575757
2019-07-10 17:52:36,697 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 139575757 
                                and status = 1
                                
2019-07-10 17:52:36,706 - INFO - Start Running query PN shop followers
2019-07-10 17:52:52,809 - INFO - Running PN shop followers Done
2019-07-10 17:52:52,811 - INFO - CSV file path: PN shop followers
2019-07-10 17:52:52,816 - INFO - Starting save the query results
2019-07-10 17:52:52,819 - INFO - Total Rows : 1880
2019-07-10 17:52:52,823 - INFO - Will split into : 1.0 files
2019-07-10 17:52:52,881 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 17.43/PN shop followers_1.csv
2019-07-10 17:52:52,882 - INFO - , with total : 1880 rows
2019-07-10 17:52:53,548 - INFO - Delete all data in the sheet
2019-07-10 17:52:53,549 - INFO - Delete row 6
2019-07-10 17:53:00,141 - INFO - Delete row 5
2019-07-10 17:53:07,035 - INFO - Delete row 4
2019-07-10 17:53:13,664 - INFO - Delete row 3
2019-07-10 17:53:20,539 - INFO - Delete row 2
2019-07-10 18:30:53,990 - INFO - Report date: 20190710 18.30
2019-07-10 18:30:54,032 - INFO - Download sheet..
2019-07-10 18:30:54,032 - INFO - Change directory to script path
2019-07-10 18:30:56,565 - INFO - Spreadsheet downloaded
2019-07-10 18:30:56,565 - INFO - Checking sheet..
2019-07-10 18:31:10,131 - INFO - No value detected on sheet: Case 1
2019-07-10 18:31:22,048 - INFO - No value detected on sheet: Case 2
2019-07-10 18:31:33,710 - INFO - No value detected on sheet: Case 3
2019-07-10 18:31:45,155 - INFO - No value detected on sheet: Case 4
2019-07-10 18:31:57,138 - INFO - Value detected - use sheet: Case 5
2019-07-10 18:32:07,142 - INFO - Reading Data From Google Sheet...
2019-07-10 18:32:07,898 - INFO - Get custom SQL..
2019-07-10 18:32:07,901 - INFO - USING CASE 5
2019-07-10 18:32:10,937 - INFO - Row 1
2019-07-10 18:32:10,941 - INFO - Filename: A1 EL HC buyers
2019-07-10 18:32:10,944 - INFO - Category: 'Electronics'
2019-07-10 18:32:10,950 - INFO - Sub-category: 'Home Care'
2019-07-10 18:32:10,951 - INFO - Last Login: 1
2019-07-10 18:32:10,953 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Electronics')
                                    or
                                    p.sub_category in ('Home Care'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-10 18:32:10,959 - INFO - Start Running query A1 EL HC buyers
2019-07-10 18:34:22,086 - INFO - Running A1 EL HC buyers Done
2019-07-10 18:34:22,088 - INFO - CSV file path: A1 EL HC buyers
2019-07-10 18:34:22,289 - INFO - Starting save the query results
2019-07-10 18:34:22,289 - INFO - Total Rows : 2549122
2019-07-10 18:34:22,290 - INFO - Will split into : 3.0 files
2019-07-10 18:34:27,536 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 18.30/A1 EL HC buyers_1.csv
2019-07-10 18:34:27,538 - INFO - , with total : 849708 rows
2019-07-10 18:34:32,075 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 18.30/A1 EL HC buyers_2.csv
2019-07-10 18:34:32,078 - INFO - , with total : 849707 rows
2019-07-10 18:34:36,757 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190710 18.30/A1 EL HC buyers_3.csv
2019-07-10 18:34:36,757 - INFO - , with total : 849707 rows
2019-07-10 18:34:37,450 - INFO - Delete all data in the sheet
2019-07-10 18:34:37,451 - INFO - Delete row 6
2019-07-10 18:34:37,454 - INFO - 'Worksheet' object has no attribute 'delete_row'
2019-07-10 18:34:49,176 - INFO - Value detected - use sheet: Case 6
2019-07-10 18:34:59,180 - INFO - Reading Data From Google Sheet...
2019-07-10 18:35:00,279 - INFO - Get custom SQL..
2019-07-10 18:35:00,282 - INFO - USING CASE 6
2019-07-10 18:35:05,466 - INFO - Row 1
2019-07-10 18:35:05,470 - INFO - Filename: A1 HL G buyers
2019-07-10 18:35:05,471 - INFO - Category: 'Home & Living'
2019-07-10 18:35:05,473 - INFO - Sub-category: 'Gaming','Video Games'
2019-07-10 18:35:05,474 - INFO - Last Login: 1
2019-07-10 18:35:05,479 - INFO - Date 1: 2019-07-09
2019-07-10 18:35:05,482 - INFO - Date 2: 2019-06-09
2019-07-10 18:35:05,483 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Home & Living')
                                    or
                                    p.sub_category in ('Gaming','Video Games'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-09' and date'2019-06-09'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-10 18:35:05,492 - INFO - Start Running query A1 HL G buyers
2019-07-11 10:00:14,996 - INFO - Report date: 20190711 10.00
2019-07-11 10:00:16,736 - INFO - Connect Google Sheet Successfully...
2019-07-11 10:00:16,819 - INFO - Download sheet..
2019-07-11 10:00:16,821 - INFO - Change directory to script path
2019-07-11 10:00:17,986 - INFO - Spreadsheet downloaded
2019-07-11 10:00:17,987 - INFO - Checking sheet..
2019-07-11 10:00:29,338 - INFO - No value detected on sheet: Case 1
2019-07-11 10:00:40,447 - INFO - No value detected on sheet: Case 2
2019-07-11 10:00:51,591 - INFO - No value detected on sheet: Case 3
2019-07-11 10:01:02,808 - INFO - No value detected on sheet: Case 4
2019-07-11 14:00:14,035 - INFO - Report date: 20190711 14.00
2019-07-11 14:00:14,944 - INFO - Connect Google Sheet Successfully...
2019-07-11 14:00:15,095 - INFO - Download sheet..
2019-07-11 14:00:15,095 - INFO - Change directory to script path
2019-07-11 14:00:16,198 - INFO - Spreadsheet downloaded
2019-07-11 14:00:16,200 - INFO - Checking sheet..
2019-07-11 14:00:27,595 - INFO - No value detected on sheet: Case 1
2019-07-11 14:00:38,769 - INFO - No value detected on sheet: Case 2
2019-07-11 14:00:49,957 - INFO - No value detected on sheet: Case 3
2019-07-11 14:01:01,107 - INFO - No value detected on sheet: Case 4
2019-07-11 17:00:02,815 - INFO - Report date: 20190711 17.00
2019-07-11 17:00:03,717 - INFO - Connect Google Sheet Successfully...
2019-07-11 17:00:03,746 - INFO - Download sheet..
2019-07-11 17:00:03,746 - INFO - Change directory to script path
2019-07-11 17:00:05,078 - INFO - Spreadsheet downloaded
2019-07-11 17:00:05,079 - INFO - Checking sheet..
2019-07-11 17:00:16,444 - INFO - Use sheet: Case 1
2019-07-11 17:00:26,447 - INFO - Reading Data From Google Sheet...
2019-07-11 17:00:27,023 - INFO - Get custom SQL..
2019-07-11 17:00:27,023 - INFO - USING CASE 1
2019-07-11 17:00:28,743 - INFO - Row 1
2019-07-11 17:00:28,743 - INFO - Filename: A30 EL Buyers
2019-07-11 17:00:28,743 - INFO - Category: 'Computer & Accessories','Electronics'
2019-07-11 17:00:28,744 - INFO - Last Login: 30
2019-07-11 17:00:28,744 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Computer & Accessories','Electronics')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-11 17:00:28,746 - INFO - Start Running query A30 EL Buyers
2019-07-11 17:02:47,036 - INFO - Running A30 EL Buyers Done
2019-07-11 17:02:47,036 - INFO - CSV file path: A30 EL Buyers
2019-07-11 17:02:47,239 - INFO - Starting save the query results
2019-07-11 17:02:47,240 - INFO - Total Rows : 5374951
2019-07-11 17:02:47,240 - INFO - Will split into : 6.0 files
2019-07-11 17:02:51,220 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 EL Buyers_1.csv
2019-07-11 17:02:51,220 - INFO - , with total : 895826 rows
2019-07-11 17:02:55,469 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 EL Buyers_2.csv
2019-07-11 17:02:55,470 - INFO - , with total : 895825 rows
2019-07-11 17:02:59,927 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 EL Buyers_3.csv
2019-07-11 17:02:59,928 - INFO - , with total : 895825 rows
2019-07-11 17:03:04,345 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 EL Buyers_4.csv
2019-07-11 17:03:04,346 - INFO - , with total : 895825 rows
2019-07-11 17:03:08,724 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 EL Buyers_5.csv
2019-07-11 17:03:08,726 - INFO - , with total : 895825 rows
2019-07-11 17:03:13,191 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 EL Buyers_6.csv
2019-07-11 17:03:13,191 - INFO - , with total : 895825 rows
2019-07-11 17:03:15,973 - INFO - Row 2
2019-07-11 17:03:15,976 - INFO - Filename: A30 Lifestyle Buyers
2019-07-11 17:03:15,977 - INFO - Category: 'Hobby & Collection'
2019-07-11 17:03:15,979 - INFO - Last Login: 30
2019-07-11 17:03:15,980 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-11 17:03:15,982 - INFO - Start Running query A30 Lifestyle Buyers
2019-07-11 17:04:05,709 - INFO - Running A30 Lifestyle Buyers Done
2019-07-11 17:04:05,710 - INFO - CSV file path: A30 Lifestyle Buyers
2019-07-11 17:04:05,779 - INFO - Starting save the query results
2019-07-11 17:04:05,780 - INFO - Total Rows : 1951045
2019-07-11 17:04:05,782 - INFO - Will split into : 2.0 files
2019-07-11 17:04:10,023 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 Lifestyle Buyers_1.csv
2019-07-11 17:04:10,025 - INFO - , with total : 975523 rows
2019-07-11 17:04:14,539 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 Lifestyle Buyers_2.csv
2019-07-11 17:04:14,539 - INFO - , with total : 975522 rows
2019-07-11 17:04:15,539 - INFO - Delete all data in the sheet
2019-07-11 17:04:15,540 - INFO - Delete row 6
2019-07-11 17:04:21,934 - INFO - Delete row 5
2019-07-11 17:04:28,480 - INFO - Delete row 4
2019-07-11 17:04:35,119 - INFO - Delete row 3
2019-07-11 17:04:41,480 - INFO - Delete row 2
2019-07-11 17:04:59,207 - INFO - No value detected on sheet: Case 2
2019-07-11 17:05:10,319 - INFO - No value detected on sheet: Case 3
2019-07-11 17:05:21,263 - INFO - Use sheet: Case 4
2019-07-11 17:05:31,265 - INFO - Reading Data From Google Sheet...
2019-07-11 17:05:31,671 - INFO - Get custom SQL..
2019-07-11 17:05:31,673 - INFO - USING CASE 4
2019-07-11 17:05:33,977 - INFO - Row 1
2019-07-11 17:05:33,979 - INFO - Filename: A30 Male Lifestyle Buyers
2019-07-11 17:05:33,980 - INFO - Category: 'Sports & Outdoor'
2019-07-11 17:05:33,980 - INFO - Last Login: 30
2019-07-11 17:05:33,982 - INFO - Gender: 1,3
2019-07-11 17:05:33,982 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-11 17:05:33,982 - INFO - Start Running query A30 Male Lifestyle Buyers
2019-07-11 17:06:00,772 - INFO - Running A30 Male Lifestyle Buyers Done
2019-07-11 17:06:00,773 - INFO - CSV file path: A30 Male Lifestyle Buyers
2019-07-11 17:06:00,808 - INFO - Starting save the query results
2019-07-11 17:06:00,809 - INFO - Total Rows : 956330
2019-07-11 17:06:00,809 - INFO - Will split into : 1.0 files
2019-07-11 17:06:04,977 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 Male Lifestyle Buyers_1.csv
2019-07-11 17:06:04,979 - INFO - , with total : 956330 rows
2019-07-11 17:06:07,841 - INFO - Row 2
2019-07-11 17:06:07,844 - INFO - Filename: A30 Male Fashion Buyers
2019-07-11 17:06:07,845 - INFO - Category: '
Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','
Watches'
2019-07-11 17:06:07,846 - INFO - Last Login: 30
2019-07-11 17:06:07,848 - INFO - Gender: 1,3
2019-07-11 17:06:07,851 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('
Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','
Watches')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-11 17:06:07,852 - INFO - Start Running query A30 Male Fashion Buyers
2019-07-11 17:07:21,239 - INFO - Running A30 Male Fashion Buyers Done
2019-07-11 17:07:21,240 - INFO - CSV file path: A30 Male Fashion Buyers
2019-07-11 17:07:21,328 - INFO - Starting save the query results
2019-07-11 17:07:21,329 - INFO - Total Rows : 2517658
2019-07-11 17:07:21,331 - INFO - Will split into : 3.0 files
2019-07-11 17:07:25,016 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 Male Fashion Buyers_1.csv
2019-07-11 17:07:25,016 - INFO - , with total : 839220 rows
2019-07-11 17:07:28,979 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 Male Fashion Buyers_2.csv
2019-07-11 17:07:28,980 - INFO - , with total : 839219 rows
2019-07-11 17:07:33,017 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190711 17.00/A30 Male Fashion Buyers_3.csv
2019-07-11 17:07:33,019 - INFO - , with total : 839219 rows
2019-07-11 17:07:34,233 - INFO - Delete all data in the sheet
2019-07-11 17:07:34,234 - INFO - Delete row 6
2019-07-11 17:07:40,602 - INFO - Delete row 5
2019-07-11 17:07:46,976 - INFO - Delete row 4
2019-07-11 17:07:53,355 - INFO - Delete row 3
2019-07-11 17:07:59,956 - INFO - Delete row 2
2019-07-12 10:00:14,680 - INFO - Report date: 20190712 10.00
2019-07-12 10:00:15,505 - INFO - Connect Google Sheet Successfully...
2019-07-12 10:00:15,552 - INFO - Download sheet..
2019-07-12 10:00:15,552 - INFO - Change directory to script path
2019-07-12 10:00:17,026 - INFO - Spreadsheet downloaded
2019-07-12 10:00:17,040 - INFO - Checking sheet..
2019-07-12 10:00:28,760 - INFO - No value detected on sheet: Case 1
2019-07-12 10:00:40,323 - INFO - No value detected on sheet: Case 2
2019-07-12 10:00:51,871 - INFO - No value detected on sheet: Case 3
2019-07-12 10:01:03,433 - INFO - No value detected on sheet: Case 4
2019-07-12 10:48:11,082 - INFO - Report date: 20190712 10.48
2019-07-12 10:48:13,017 - INFO - Download sheet..
2019-07-12 10:48:13,019 - INFO - Change directory to script path
2019-07-12 10:48:15,655 - INFO - Spreadsheet downloaded
2019-07-12 10:48:15,664 - INFO - Checking sheet..
2019-07-12 10:48:18,611 - INFO - No value detected on sheet: Case 1
2019-07-12 10:48:20,762 - INFO - No value detected on sheet: Case 2
2019-07-12 10:48:22,723 - INFO - No value detected on sheet: Case 3
2019-07-12 10:48:24,625 - INFO - No value detected on sheet: Case 4
2019-07-12 10:48:26,494 - INFO - Value detected - use sheet: Case 5
2019-07-12 10:48:26,499 - INFO - Reading Data From Google Sheet...
2019-07-12 10:48:27,430 - INFO - Get custom SQL..
2019-07-12 10:48:27,430 - INFO - USING CASE 5
2019-07-12 10:48:31,073 - INFO - Row 1
2019-07-12 10:48:31,076 - INFO - Filename: A1 EL HC buyers
2019-07-12 10:48:31,078 - INFO - Category: 'Electronics'
2019-07-12 10:48:31,082 - INFO - Sub-category: 'Home Care'
2019-07-12 10:48:31,085 - INFO - Last Login: 1
2019-07-12 10:48:31,086 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Electronics')
                                    or
                                    p.sub_category in ('Home Care'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-12 10:48:31,095 - INFO - Start Running query A1 EL HC buyers
2019-07-12 10:52:00,565 - INFO - Running A1 EL HC buyers Done
2019-07-12 10:52:00,566 - INFO - CSV file path: A1 EL HC buyers
2019-07-12 10:52:00,993 - INFO - Starting save the query results
2019-07-12 10:52:00,996 - INFO - Total Rows : 2525732
2019-07-12 10:52:00,997 - INFO - Will split into : 3.0 files
2019-07-12 10:52:10,341 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.48/A1 EL HC buyers_1.csv
2019-07-12 10:52:10,345 - INFO - , with total : 841911 rows
2019-07-12 10:52:15,951 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.48/A1 EL HC buyers_2.csv
2019-07-12 10:52:15,956 - INFO - , with total : 841911 rows
2019-07-12 10:52:21,055 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.48/A1 EL HC buyers_3.csv
2019-07-12 10:52:21,056 - INFO - , with total : 841910 rows
2019-07-12 10:52:22,075 - INFO - Delete all data in sheet: Case 5
2019-07-12 10:52:22,078 - INFO - 'str' object has no attribute 'clear'
2019-07-12 10:52:23,539 - INFO - Value detected - use sheet: Case 6
2019-07-12 10:52:23,540 - INFO - Reading Data From Google Sheet...
2019-07-12 10:52:24,477 - INFO - Get custom SQL..
2019-07-12 10:52:24,480 - INFO - USING CASE 6
2019-07-12 10:52:30,012 - INFO - Row 1
2019-07-12 10:52:30,013 - INFO - Filename: A1 HL G buyers
2019-07-12 10:52:30,017 - INFO - Category: 'Home & Living'
2019-07-12 10:52:30,019 - INFO - Sub-category: 'Gaming','Video Games'
2019-07-12 10:52:30,022 - INFO - Last Login: 1
2019-07-12 10:52:30,023 - INFO - Date 1: 2019-07-09
2019-07-12 10:52:30,023 - INFO - Date 2: 2019-06-09
2019-07-12 10:52:30,026 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Home & Living')
                                    or
                                    p.sub_category in ('Gaming','Video Games'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-09' and date'2019-06-09'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-12 10:52:30,032 - INFO - Start Running query A1 HL G buyers
2019-07-12 10:55:34,006 - INFO - Report date: 20190712 10.55
2019-07-12 10:55:34,049 - INFO - Download sheet..
2019-07-12 10:55:34,049 - INFO - Change directory to script path
2019-07-12 10:55:36,332 - INFO - Spreadsheet downloaded
2019-07-12 10:55:36,332 - INFO - Checking sheet..
2019-07-12 10:55:38,687 - INFO - No value detected on sheet: Case 1
2019-07-12 10:55:40,427 - INFO - No value detected on sheet: Case 2
2019-07-12 10:55:42,226 - INFO - No value detected on sheet: Case 3
2019-07-12 10:55:43,963 - INFO - No value detected on sheet: Case 4
2019-07-12 10:55:45,763 - INFO - Value detected - use sheet: Case 5
2019-07-12 10:55:45,769 - INFO - Reading Data From Google Sheet...
2019-07-12 10:55:46,598 - INFO - Get custom SQL..
2019-07-12 10:55:46,601 - INFO - USING CASE 5
2019-07-12 10:55:50,855 - INFO - Row 1
2019-07-12 10:55:50,858 - INFO - Filename: A1 EL HC buyers
2019-07-12 10:55:50,859 - INFO - Category: 'Electronics'
2019-07-12 10:55:50,861 - INFO - Sub-category: 'Home Care'
2019-07-12 10:55:50,864 - INFO - Last Login: 1
2019-07-12 10:55:50,865 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Electronics')
                                    or
                                    p.sub_category in ('Home Care'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-12 10:55:50,875 - INFO - Start Running query A1 EL HC buyers
2019-07-12 10:58:27,552 - INFO - Running A1 EL HC buyers Done
2019-07-12 10:58:27,553 - INFO - CSV file path: A1 EL HC buyers
2019-07-12 10:58:27,753 - INFO - Starting save the query results
2019-07-12 10:58:27,755 - INFO - Total Rows : 2525732
2019-07-12 10:58:27,755 - INFO - Will split into : 3.0 files
2019-07-12 10:58:33,890 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.55/A1 EL HC buyers_1.csv
2019-07-12 10:58:33,894 - INFO - , with total : 841911 rows
2019-07-12 10:58:39,124 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.55/A1 EL HC buyers_2.csv
2019-07-12 10:58:39,124 - INFO - , with total : 841911 rows
2019-07-12 10:58:43,755 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.55/A1 EL HC buyers_3.csv
2019-07-12 10:58:43,757 - INFO - , with total : 841910 rows
2019-07-12 10:58:44,775 - INFO - Delete all data in sheet: Case 5
2019-07-12 10:58:47,487 - INFO - Value detected - use sheet: Case 6
2019-07-12 10:58:47,490 - INFO - Reading Data From Google Sheet...
2019-07-12 10:58:48,410 - INFO - Get custom SQL..
2019-07-12 10:58:48,417 - INFO - USING CASE 6
2019-07-12 10:58:53,621 - INFO - Row 1
2019-07-12 10:58:53,631 - INFO - Filename: A1 HL G buyers
2019-07-12 10:58:53,634 - INFO - Category: 'Home & Living'
2019-07-12 10:58:53,635 - INFO - Sub-category: 'Gaming','Video Games'
2019-07-12 10:58:53,637 - INFO - Last Login: 1
2019-07-12 10:58:53,638 - INFO - Date 1: 2019-07-09
2019-07-12 10:58:53,638 - INFO - Date 2: 2019-06-09
2019-07-12 10:58:53,640 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Home & Living')
                                    or
                                    p.sub_category in ('Gaming','Video Games'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-09' and date'2019-06-09'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-12 10:58:53,647 - INFO - Start Running query A1 HL G buyers
2019-07-12 11:02:52,253 - INFO - Running A1 HL G buyers Done
2019-07-12 11:02:52,256 - INFO - CSV file path: A1 HL G buyers
2019-07-12 11:02:52,815 - INFO - Starting save the query results
2019-07-12 11:02:52,818 - INFO - Total Rows : 3357609
2019-07-12 11:02:52,819 - INFO - Will split into : 4.0 files
2019-07-12 11:03:04,164 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.55/A1 HL G buyers_1.csv
2019-07-12 11:03:04,171 - INFO - , with total : 839403 rows
2019-07-12 11:03:14,469 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.55/A1 HL G buyers_2.csv
2019-07-12 11:03:14,473 - INFO - , with total : 839402 rows
2019-07-12 11:03:24,658 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.55/A1 HL G buyers_3.csv
2019-07-12 11:03:24,661 - INFO - , with total : 839402 rows
2019-07-12 11:03:32,052 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.55/A1 HL G buyers_4.csv
2019-07-12 11:03:32,053 - INFO - , with total : 839402 rows
2019-07-12 11:03:33,315 - INFO - Delete all data in sheet: Case 6
2019-07-12 11:03:36,069 - INFO - Value detected - use sheet: Case 7
2019-07-12 11:03:36,071 - INFO - Reading Data From Google Sheet...
2019-07-12 11:03:36,960 - INFO - Get custom SQL..
2019-07-12 11:03:36,960 - INFO - USING CASE 7
2019-07-12 11:03:38,693 - INFO - Row 1
2019-07-12 11:03:38,694 - INFO - Filename: PN shop followers
2019-07-12 11:03:38,697 - INFO - Shop ID: 139575757
2019-07-12 11:03:38,698 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 139575757 
                                and status = 1
                                
2019-07-12 11:03:38,706 - INFO - Start Running query PN shop followers
2019-07-12 11:04:16,151 - INFO - Running PN shop followers Done
2019-07-12 11:04:16,157 - INFO - CSV file path: PN shop followers
2019-07-12 11:04:16,160 - INFO - Starting save the query results
2019-07-12 11:04:16,161 - INFO - Total Rows : 1936
2019-07-12 11:04:16,163 - INFO - Will split into : 1.0 files
2019-07-12 11:04:16,232 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.55/PN shop followers_1.csv
2019-07-12 11:04:16,233 - INFO - , with total : 1936 rows
2019-07-12 11:04:17,140 - INFO - Delete all data in sheet: Case 7
2019-07-12 11:04:19,795 - INFO - Value detected - use sheet: Case 8
2019-07-12 11:04:19,799 - INFO - Reading Data From Google Sheet...
2019-07-12 11:04:20,210 - INFO - Get custom SQL..
2019-07-12 11:04:20,216 - INFO - USING CASE 8
2019-07-12 11:04:22,155 - INFO - Row 1
2019-07-12 11:04:22,158 - INFO - Filename: A7 DP buyers
2019-07-12 11:04:22,164 - INFO - Last Login: 7
2019-07-12 11:04:22,168 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar))
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-07-12 11:04:22,177 - INFO - Start Running query A7 DP buyers
2019-07-12 11:06:57,549 - INFO - Running A7 DP buyers Done
2019-07-12 11:06:57,552 - INFO - CSV file path: A7 DP buyers
2019-07-12 11:06:57,832 - INFO - Starting save the query results
2019-07-12 11:06:57,834 - INFO - Total Rows : 1993834
2019-07-12 11:06:57,835 - INFO - Will split into : 2.0 files
2019-07-12 11:07:06,704 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.55/A7 DP buyers_1.csv
2019-07-12 11:07:06,711 - INFO - , with total : 996917 rows
2019-07-12 11:07:14,098 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 10.55/A7 DP buyers_2.csv
2019-07-12 11:07:14,101 - INFO - , with total : 996917 rows
2019-07-12 11:07:15,237 - INFO - Delete all data in sheet: Case 8
2019-07-12 11:07:17,002 - INFO - Value detected - use sheet: Case 9
2019-07-12 11:07:17,003 - INFO - Reading Data From Google Sheet...
2019-07-12 11:07:17,864 - INFO - Get custom SQL..
2019-07-12 11:07:17,865 - INFO - USING CASE 9
2019-07-12 11:07:19,940 - INFO - Row 1
2019-07-12 11:07:19,940 - INFO - Filename: A14 Fashion & CA buyers who haven't shopped DP
2019-07-12 11:07:19,940 - INFO - Last Login: 14
2019-07-12 11:07:19,941 - INFO - Query:
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Computer & Accessories') 
                                    and
                                    last_login >= current_date - interval '14' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-12 11:07:19,944 - INFO - Start Running query A14 Fashion & CA buyers who haven't shopped DP
2019-07-12 11:07:20,523 - INFO - java.sql.SQLException: Query failed (#20190712_040721_08762_awhya): line 2:33: mismatched input 'b'. Expecting: 'ALTER', 'ANALYZE', 'CALL', 'COMMENT', 'COMMIT', 'CREATE', 'DEALLOCATE', 'DELETE', 'DESC', 'DESCRIBE', 'DROP', 'EXECUTE', 'EXPLAIN', 'GRANT', 'INSERT', 'PREPARE', 'RESET', 'REVOKE', 'ROLLBACK', 'SET', 'SHOW', 'START', 'USE', <query>
2019-07-12 11:07:20,663 - INFO - java.sql.SQLException: Query failed (#20190712_040721_08764_awhya): line 2:33: mismatched input 'b'. Expecting: 'ALTER', 'ANALYZE', 'CALL', 'COMMENT', 'COMMIT', 'CREATE', 'DEALLOCATE', 'DELETE', 'DESC', 'DESCRIBE', 'DROP', 'EXECUTE', 'EXPLAIN', 'GRANT', 'INSERT', 'PREPARE', 'RESET', 'REVOKE', 'ROLLBACK', 'SET', 'SHOW', 'START', 'USE', <query>
2019-07-12 11:07:20,782 - INFO - java.sql.SQLException: Query failed (#20190712_040721_08765_awhya): line 2:33: mismatched input 'b'. Expecting: 'ALTER', 'ANALYZE', 'CALL', 'COMMENT', 'COMMIT', 'CREATE', 'DEALLOCATE', 'DELETE', 'DESC', 'DESCRIBE', 'DROP', 'EXECUTE', 'EXPLAIN', 'GRANT', 'INSERT', 'PREPARE', 'RESET', 'REVOKE', 'ROLLBACK', 'SET', 'SHOW', 'START', 'USE', <query>
2019-07-12 11:07:20,904 - INFO - java.sql.SQLException: Query failed (#20190712_040721_08766_awhya): line 2:33: mismatched input 'b'. Expecting: 'ALTER', 'ANALYZE', 'CALL', 'COMMENT', 'COMMIT', 'CREATE', 'DEALLOCATE', 'DELETE', 'DESC', 'DESCRIBE', 'DROP', 'EXECUTE', 'EXPLAIN', 'GRANT', 'INSERT', 'PREPARE', 'RESET', 'REVOKE', 'ROLLBACK', 'SET', 'SHOW', 'START', 'USE', <query>
2019-07-12 11:07:21,026 - INFO - java.sql.SQLException: Query failed (#20190712_040722_08767_awhya): line 2:33: mismatched input 'b'. Expecting: 'ALTER', 'ANALYZE', 'CALL', 'COMMENT', 'COMMIT', 'CREATE', 'DEALLOCATE', 'DELETE', 'DESC', 'DESCRIBE', 'DROP', 'EXECUTE', 'EXPLAIN', 'GRANT', 'INSERT', 'PREPARE', 'RESET', 'REVOKE', 'ROLLBACK', 'SET', 'SHOW', 'START', 'USE', <query>
2019-07-12 11:07:21,029 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-12 11:07:23,555 - INFO - Row 2
2019-07-12 11:07:23,558 - INFO - Filename: A1 HL buyers who haven't shopped DP
2019-07-12 11:07:23,559 - INFO - Last Login: 1
2019-07-12 11:07:23,562 - INFO - Query:
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living') 
                                    and
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-12 11:07:23,575 - INFO - Start Running query A1 HL buyers who haven't shopped DP
2019-07-12 11:07:23,729 - INFO - java.sql.SQLException: Query failed (#20190712_040724_08768_awhya): line 2:33: mismatched input 'b'. Expecting: 'ALTER', 'ANALYZE', 'CALL', 'COMMENT', 'COMMIT', 'CREATE', 'DEALLOCATE', 'DELETE', 'DESC', 'DESCRIBE', 'DROP', 'EXECUTE', 'EXPLAIN', 'GRANT', 'INSERT', 'PREPARE', 'RESET', 'REVOKE', 'ROLLBACK', 'SET', 'SHOW', 'START', 'USE', <query>
2019-07-12 11:07:23,844 - INFO - java.sql.SQLException: Query failed (#20190712_040724_08769_awhya): line 2:33: mismatched input 'b'. Expecting: 'ALTER', 'ANALYZE', 'CALL', 'COMMENT', 'COMMIT', 'CREATE', 'DEALLOCATE', 'DELETE', 'DESC', 'DESCRIBE', 'DROP', 'EXECUTE', 'EXPLAIN', 'GRANT', 'INSERT', 'PREPARE', 'RESET', 'REVOKE', 'ROLLBACK', 'SET', 'SHOW', 'START', 'USE', <query>
2019-07-12 11:07:23,946 - INFO - java.sql.SQLException: Query failed (#20190712_040724_08770_awhya): line 2:33: mismatched input 'b'. Expecting: 'ALTER', 'ANALYZE', 'CALL', 'COMMENT', 'COMMIT', 'CREATE', 'DEALLOCATE', 'DELETE', 'DESC', 'DESCRIBE', 'DROP', 'EXECUTE', 'EXPLAIN', 'GRANT', 'INSERT', 'PREPARE', 'RESET', 'REVOKE', 'ROLLBACK', 'SET', 'SHOW', 'START', 'USE', <query>
2019-07-12 11:07:24,052 - INFO - java.sql.SQLException: Query failed (#20190712_040725_08771_awhya): line 2:33: mismatched input 'b'. Expecting: 'ALTER', 'ANALYZE', 'CALL', 'COMMENT', 'COMMIT', 'CREATE', 'DEALLOCATE', 'DELETE', 'DESC', 'DESCRIBE', 'DROP', 'EXECUTE', 'EXPLAIN', 'GRANT', 'INSERT', 'PREPARE', 'RESET', 'REVOKE', 'ROLLBACK', 'SET', 'SHOW', 'START', 'USE', <query>
2019-07-12 11:07:24,155 - INFO - java.sql.SQLException: Query failed (#20190712_040725_08772_awhya): line 2:33: mismatched input 'b'. Expecting: 'ALTER', 'ANALYZE', 'CALL', 'COMMENT', 'COMMIT', 'CREATE', 'DEALLOCATE', 'DELETE', 'DESC', 'DESCRIBE', 'DROP', 'EXECUTE', 'EXPLAIN', 'GRANT', 'INSERT', 'PREPARE', 'RESET', 'REVOKE', 'ROLLBACK', 'SET', 'SHOW', 'START', 'USE', <query>
2019-07-12 11:07:24,160 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-12 11:07:25,032 - INFO - Delete all data in sheet: Case 9
2019-07-12 12:38:44,019 - INFO - Report date: 20190712 12.38
2019-07-12 12:38:44,059 - INFO - Download sheet..
2019-07-12 12:38:44,059 - INFO - Change directory to script path
2019-07-12 12:38:46,180 - INFO - Spreadsheet downloaded
2019-07-12 12:38:46,180 - INFO - Checking sheet..
2019-07-12 12:38:48,532 - INFO - No value detected on sheet: Case 1
2019-07-12 12:38:50,184 - INFO - No value detected on sheet: Case 2
2019-07-12 12:38:52,092 - INFO - No value detected on sheet: Case 3
2019-07-12 12:38:53,765 - INFO - No value detected on sheet: Case 4
2019-07-12 12:38:55,454 - INFO - Value detected - use sheet: Case 5
2019-07-12 12:38:55,457 - INFO - Reading Data From Google Sheet...
2019-07-12 12:38:56,331 - INFO - Get custom SQL..
2019-07-12 12:38:56,332 - INFO - USING CASE 5
2019-07-12 12:38:59,719 - INFO - Row 1
2019-07-12 12:38:59,720 - INFO - Filename: A1 EL HC buyers
2019-07-12 12:38:59,723 - INFO - Category: 'Electronics'
2019-07-12 12:38:59,726 - INFO - Sub-category: 'Home Care'
2019-07-12 12:38:59,730 - INFO - Last Login: 1
2019-07-12 12:38:59,733 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Electronics')
                                    or
                                    p.sub_category in ('Home Care'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-12 12:38:59,746 - INFO - Start Running query A1 EL HC buyers
2019-07-12 12:41:01,203 - INFO - Running A1 EL HC buyers Done
2019-07-12 12:41:01,204 - INFO - CSV file path: A1 EL HC buyers
2019-07-12 12:41:01,392 - INFO - Starting save the query results
2019-07-12 12:41:01,394 - INFO - Total Rows : 2525732
2019-07-12 12:41:01,394 - INFO - Will split into : 3.0 files
2019-07-12 12:41:05,890 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A1 EL HC buyers_1.csv
2019-07-12 12:41:05,891 - INFO - , with total : 841911 rows
2019-07-12 12:41:10,579 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A1 EL HC buyers_2.csv
2019-07-12 12:41:10,581 - INFO - , with total : 841911 rows
2019-07-12 12:41:15,657 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A1 EL HC buyers_3.csv
2019-07-12 12:41:15,657 - INFO - , with total : 841910 rows
2019-07-12 12:41:16,230 - INFO - Delete all data in sheet: Case 5
2019-07-12 12:41:18,384 - INFO - Value detected - use sheet: Case 6
2019-07-12 12:41:18,384 - INFO - Reading Data From Google Sheet...
2019-07-12 12:41:18,798 - INFO - Get custom SQL..
2019-07-12 12:41:18,799 - INFO - USING CASE 6
2019-07-12 12:41:22,592 - INFO - Row 1
2019-07-12 12:41:22,592 - INFO - Filename: A1 HL G buyers
2019-07-12 12:41:22,594 - INFO - Category: 'Home & Living'
2019-07-12 12:41:22,595 - INFO - Sub-category: 'Gaming','Video Games'
2019-07-12 12:41:22,595 - INFO - Last Login: 1
2019-07-12 12:41:22,595 - INFO - Date 1: 2019-07-09
2019-07-12 12:41:22,596 - INFO - Date 2: 2019-06-09
2019-07-12 12:41:22,598 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    (p.main_category in ('Home & Living')
                                    or
                                    p.sub_category in ('Gaming','Video Games'))
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-09' and date'2019-06-09'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-12 12:41:22,599 - INFO - Start Running query A1 HL G buyers
2019-07-12 12:42:58,937 - INFO - Running A1 HL G buyers Done
2019-07-12 12:42:58,937 - INFO - CSV file path: A1 HL G buyers
2019-07-12 12:42:59,184 - INFO - Starting save the query results
2019-07-12 12:42:59,186 - INFO - Total Rows : 3357609
2019-07-12 12:42:59,186 - INFO - Will split into : 4.0 files
2019-07-12 12:43:03,372 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A1 HL G buyers_1.csv
2019-07-12 12:43:03,375 - INFO - , with total : 839403 rows
2019-07-12 12:43:07,605 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A1 HL G buyers_2.csv
2019-07-12 12:43:07,607 - INFO - , with total : 839402 rows
2019-07-12 12:43:12,306 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A1 HL G buyers_3.csv
2019-07-12 12:43:12,309 - INFO - , with total : 839402 rows
2019-07-12 12:43:17,224 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A1 HL G buyers_4.csv
2019-07-12 12:43:17,229 - INFO - , with total : 839402 rows
2019-07-12 12:43:18,253 - INFO - Delete all data in sheet: Case 6
2019-07-12 12:43:19,737 - INFO - Value detected - use sheet: Case 7
2019-07-12 12:43:19,739 - INFO - Reading Data From Google Sheet...
2019-07-12 12:43:20,155 - INFO - Get custom SQL..
2019-07-12 12:43:20,157 - INFO - USING CASE 7
2019-07-12 12:43:21,404 - INFO - Row 1
2019-07-12 12:43:21,405 - INFO - Filename: PN shop followers
2019-07-12 12:43:21,408 - INFO - Shop ID: 30302620
2019-07-12 12:43:21,413 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 30302620 
                                and status = 1
                                
2019-07-12 12:43:21,420 - INFO - Start Running query PN shop followers
2019-07-12 12:43:32,993 - INFO - Running PN shop followers Done
2019-07-12 12:43:32,993 - INFO - CSV file path: PN shop followers
2019-07-12 12:43:33,020 - INFO - Starting save the query results
2019-07-12 12:43:33,022 - INFO - Total Rows : 149676
2019-07-12 12:43:33,023 - INFO - Will split into : 1.0 files
2019-07-12 12:43:33,851 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/PN shop followers_1.csv
2019-07-12 12:43:33,852 - INFO - , with total : 149676 rows
2019-07-12 12:43:34,288 - INFO - Delete all data in sheet: Case 7
2019-07-12 12:43:36,039 - INFO - Value detected - use sheet: Case 8
2019-07-12 12:43:36,042 - INFO - Reading Data From Google Sheet...
2019-07-12 12:43:36,489 - INFO - Get custom SQL..
2019-07-12 12:43:36,490 - INFO - USING CASE 8
2019-07-12 12:43:37,326 - INFO - Row 1
2019-07-12 12:43:37,328 - INFO - Filename: A7 DP buyers
2019-07-12 12:43:37,329 - INFO - Last Login: 7
2019-07-12 12:43:37,332 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar))
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-07-12 12:43:37,339 - INFO - Start Running query A7 DP buyers
2019-07-12 12:44:33,355 - INFO - Running A7 DP buyers Done
2019-07-12 12:44:33,357 - INFO - CSV file path: A7 DP buyers
2019-07-12 12:44:33,503 - INFO - Starting save the query results
2019-07-12 12:44:33,503 - INFO - Total Rows : 1993834
2019-07-12 12:44:33,503 - INFO - Will split into : 2.0 files
2019-07-12 12:44:38,457 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A7 DP buyers_1.csv
2019-07-12 12:44:38,459 - INFO - , with total : 996917 rows
2019-07-12 12:44:43,246 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A7 DP buyers_2.csv
2019-07-12 12:44:43,246 - INFO - , with total : 996917 rows
2019-07-12 12:44:43,842 - INFO - Delete all data in sheet: Case 8
2019-07-12 12:44:45,167 - INFO - Value detected - use sheet: Case 9
2019-07-12 12:44:45,170 - INFO - Reading Data From Google Sheet...
2019-07-12 12:44:45,605 - INFO - Get custom SQL..
2019-07-12 12:44:45,608 - INFO - USING CASE 9
2019-07-12 12:44:47,375 - INFO - Row 1
2019-07-12 12:44:47,375 - INFO - Filename: A14 Fashion & CA buyers who haven't shopped DP
2019-07-12 12:44:47,377 - INFO - Last Login: 14
2019-07-12 12:44:47,377 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Computer & Accessories') 
                                    and
                                    last_login >= current_date - interval '14' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-12 12:44:47,378 - INFO - Start Running query A14 Fashion & CA buyers who haven't shopped DP
2019-07-12 12:45:51,739 - INFO - Running A14 Fashion & CA buyers who haven't shopped DP Done
2019-07-12 12:45:51,740 - INFO - CSV file path: A14 Fashion & CA buyers who haven't shopped DP
2019-07-12 12:45:51,868 - INFO - Starting save the query results
2019-07-12 12:45:51,868 - INFO - Total Rows : 1715759
2019-07-12 12:45:51,868 - INFO - Will split into : 2.0 files
2019-07-12 12:45:56,141 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A14 Fashion & CA buyers who haven't shopped DP_1.csv
2019-07-12 12:45:56,141 - INFO - , with total : 857880 rows
2019-07-12 12:46:00,263 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A14 Fashion & CA buyers who haven't shopped DP_2.csv
2019-07-12 12:46:00,265 - INFO - , with total : 857879 rows
2019-07-12 12:46:02,546 - INFO - Row 2
2019-07-12 12:46:02,548 - INFO - Filename: A1 HL buyers who haven't shopped DP
2019-07-12 12:46:02,549 - INFO - Last Login: 1
2019-07-12 12:46:02,549 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living') 
                                    and
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-12 12:46:02,552 - INFO - Start Running query A1 HL buyers who haven't shopped DP
2019-07-12 12:47:27,881 - INFO - Running A1 HL buyers who haven't shopped DP Done
2019-07-12 12:47:27,881 - INFO - CSV file path: A1 HL buyers who haven't shopped DP
2019-07-12 12:47:28,056 - INFO - Starting save the query results
2019-07-12 12:47:28,058 - INFO - Total Rows : 2424800
2019-07-12 12:47:28,058 - INFO - Will split into : 3.0 files
2019-07-12 12:47:31,938 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A1 HL buyers who haven't shopped DP_1.csv
2019-07-12 12:47:31,940 - INFO - , with total : 808267 rows
2019-07-12 12:47:35,834 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A1 HL buyers who haven't shopped DP_2.csv
2019-07-12 12:47:35,835 - INFO - , with total : 808267 rows
2019-07-12 12:47:39,865 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 12.38/A1 HL buyers who haven't shopped DP_3.csv
2019-07-12 12:47:39,865 - INFO - , with total : 808266 rows
2019-07-12 12:47:40,828 - INFO - Delete all data in sheet: Case 9
2019-07-12 14:00:12,368 - INFO - Report date: 20190712 14.00
2019-07-12 14:00:13,677 - INFO - Connect Google Sheet Successfully...
2019-07-12 14:00:13,710 - INFO - Download sheet..
2019-07-12 14:00:13,711 - INFO - Change directory to script path
2019-07-12 14:00:14,799 - INFO - Spreadsheet downloaded
2019-07-12 14:00:14,799 - INFO - Checking sheet..
2019-07-12 14:00:26,546 - INFO - Use sheet: Case 1
2019-07-12 14:00:36,548 - INFO - Reading Data From Google Sheet...
2019-07-12 14:00:37,341 - INFO - Get custom SQL..
2019-07-12 14:00:37,341 - INFO - USING CASE 1
2019-07-12 14:00:39,734 - INFO - Row 1
2019-07-12 14:00:39,736 - INFO - Filename: A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers
2019-07-12 14:00:39,736 - INFO - Category: 'Home & Living','Health & Beauty','Muslim Fashion','Electronics','Stationery & Books'
2019-07-12 14:00:39,736 - INFO - Last Login: 30
2019-07-12 14:00:39,737 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living','Health & Beauty','Muslim Fashion','Electronics','Stationery & Books')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-12 14:00:39,737 - INFO - Start Running query A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers
2019-07-12 14:05:28,802 - INFO - Running A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers Done
2019-07-12 14:05:28,802 - INFO - CSV file path: A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers
2019-07-12 14:05:29,266 - INFO - Starting save the query results
2019-07-12 14:05:29,266 - INFO - Total Rows : 9737665
2019-07-12 14:05:29,269 - INFO - Will split into : 10.0 files
2019-07-12 14:05:33,786 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 14.00/A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers_1.csv
2019-07-12 14:05:33,786 - INFO - , with total : 973767 rows
2019-07-12 14:05:39,002 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 14.00/A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers_2.csv
2019-07-12 14:05:39,003 - INFO - , with total : 973767 rows
2019-07-12 14:05:46,904 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 14.00/A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers_3.csv
2019-07-12 14:05:46,904 - INFO - , with total : 973767 rows
2019-07-12 14:05:51,724 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 14.00/A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers_4.csv
2019-07-12 14:05:51,726 - INFO - , with total : 973767 rows
2019-07-12 14:05:57,088 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 14.00/A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers_5.csv
2019-07-12 14:05:57,089 - INFO - , with total : 973767 rows
2019-07-12 14:06:02,430 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 14.00/A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers_6.csv
2019-07-12 14:06:02,431 - INFO - , with total : 973766 rows
2019-07-12 14:06:07,302 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 14.00/A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers_7.csv
2019-07-12 14:06:07,305 - INFO - , with total : 973766 rows
2019-07-12 14:06:12,400 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 14.00/A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers_8.csv
2019-07-12 14:06:12,401 - INFO - , with total : 973766 rows
2019-07-12 14:06:18,354 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 14.00/A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers_9.csv
2019-07-12 14:06:18,364 - INFO - , with total : 973766 rows
2019-07-12 14:06:23,427 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190712 14.00/A30 HL, HBC, Muslim Fashion, Men Shoes, MA, HE, Stationery & Books buyers_10.csv
2019-07-12 14:06:23,428 - INFO - , with total : 973766 rows
2019-07-12 14:06:25,302 - INFO - Delete all data in the sheet
2019-07-12 14:06:25,303 - INFO - Delete row 6
2019-07-12 14:06:32,117 - INFO - Delete row 5
2019-07-12 14:06:38,956 - INFO - Delete row 4
2019-07-12 14:06:45,765 - INFO - Delete row 3
2019-07-12 14:06:52,552 - INFO - Delete row 2
2019-07-12 14:07:11,288 - INFO - No value detected on sheet: Case 2
2019-07-12 14:07:22,808 - INFO - No value detected on sheet: Case 3
2019-07-12 14:07:34,378 - INFO - No value detected on sheet: Case 4
2019-07-12 17:00:04,880 - INFO - Report date: 20190712 17.00
2019-07-12 17:00:05,858 - INFO - Connect Google Sheet Successfully...
2019-07-12 17:00:05,891 - INFO - Download sheet..
2019-07-12 17:00:05,892 - INFO - Change directory to script path
2019-07-12 17:00:07,092 - INFO - Spreadsheet downloaded
2019-07-12 17:00:07,092 - INFO - Checking sheet..
2019-07-12 17:00:19,073 - INFO - No value detected on sheet: Case 1
2019-07-12 17:00:30,625 - INFO - No value detected on sheet: Case 2
2019-07-12 17:00:42,668 - INFO - No value detected on sheet: Case 3
2019-07-12 17:00:54,204 - INFO - No value detected on sheet: Case 4
2019-07-15 17:15:27,650 - INFO - Report date: 20190715 17.15
2019-07-15 17:15:27,696 - INFO - Download sheet..
2019-07-15 17:15:27,697 - INFO - Change directory to script path
2019-07-15 17:15:30,226 - INFO - Spreadsheet downloaded
2019-07-15 17:15:30,226 - INFO - Checking sheet..
2019-07-15 17:15:32,665 - INFO - Value detected - use sheet: Case 1
2019-07-15 17:15:32,667 - INFO - Reading Data From Google Sheet...
2019-07-15 17:15:34,210 - INFO - Get custom SQL..
2019-07-15 17:15:34,211 - INFO - USING CASE 1
2019-07-15 17:15:38,349 - INFO - Row 1
2019-07-15 17:15:38,351 - INFO - Filename: A30 MA buyers (max. 8.500 users)
2019-07-15 17:15:38,352 - INFO - Category: 'Mobile & Accessories'
2019-07-15 17:15:38,355 - INFO - Last Login: 30
2019-07-15 17:15:38,355 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-15 17:15:38,358 - INFO - Start Running query A30 MA buyers (max. 8.500 users)
2019-07-15 17:22:13,861 - INFO - Running A30 MA buyers (max. 8.500 users) Done
2019-07-15 17:22:13,864 - INFO - CSV file path: A30 MA buyers (max. 8.500 users)
2019-07-15 17:22:15,253 - INFO - Starting save the query results
2019-07-15 17:22:15,256 - INFO - Total Rows : 7076117
2019-07-15 17:22:15,256 - INFO - Will split into : 8.0 files
2019-07-15 17:22:27,637 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 MA buyers (max. 8.500 users)_1.csv
2019-07-15 17:22:27,638 - INFO - , with total : 884515 rows
2019-07-15 17:22:37,407 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 MA buyers (max. 8.500 users)_2.csv
2019-07-15 17:22:37,408 - INFO - , with total : 884515 rows
2019-07-15 17:22:46,721 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 MA buyers (max. 8.500 users)_3.csv
2019-07-15 17:22:46,723 - INFO - , with total : 884515 rows
2019-07-15 17:22:55,454 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 MA buyers (max. 8.500 users)_4.csv
2019-07-15 17:22:55,457 - INFO - , with total : 884515 rows
2019-07-15 17:23:07,355 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 MA buyers (max. 8.500 users)_5.csv
2019-07-15 17:23:07,358 - INFO - , with total : 884515 rows
2019-07-15 17:23:15,361 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 MA buyers (max. 8.500 users)_6.csv
2019-07-15 17:23:15,364 - INFO - , with total : 884514 rows
2019-07-15 17:23:23,601 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 MA buyers (max. 8.500 users)_7.csv
2019-07-15 17:23:23,602 - INFO - , with total : 884514 rows
2019-07-15 17:23:32,694 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 MA buyers (max. 8.500 users)_8.csv
2019-07-15 17:23:32,701 - INFO - , with total : 884514 rows
2019-07-15 17:23:34,424 - INFO - Delete all data in sheet: Case 1
2019-07-15 17:23:37,028 - INFO - No value detected on sheet: Case 2
2019-07-15 17:23:38,872 - INFO - No value detected on sheet: Case 3
2019-07-15 17:23:40,538 - INFO - No value detected on sheet: Case 4
2019-07-15 17:23:42,250 - INFO - No value detected on sheet: Case 5
2019-07-15 17:23:44,013 - INFO - No value detected on sheet: Case 6
2019-07-15 17:23:45,711 - INFO - Value detected - use sheet: Case 7
2019-07-15 17:23:45,713 - INFO - Reading Data From Google Sheet...
2019-07-15 17:23:46,549 - INFO - Get custom SQL..
2019-07-15 17:23:46,551 - INFO - USING CASE 7
2019-07-15 17:23:48,282 - INFO - Row 1
2019-07-15 17:23:48,283 - INFO - Filename: Arema FC Official Shop Followers
2019-07-15 17:23:48,285 - INFO - Shop ID: 157863499
2019-07-15 17:23:48,286 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 157863499 
                                and status = 1
                                
2019-07-15 17:23:48,289 - INFO - Start Running query Arema FC Official Shop Followers
2019-07-15 17:23:58,157 - INFO - Running Arema FC Official Shop Followers Done
2019-07-15 17:23:58,164 - INFO - CSV file path: Arema FC Official Shop Followers
2019-07-15 17:23:58,174 - INFO - Starting save the query results
2019-07-15 17:23:58,180 - INFO - Total Rows : 155
2019-07-15 17:23:58,186 - INFO - Will split into : 1.0 files
2019-07-15 17:23:58,233 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/Arema FC Official Shop Followers_1.csv
2019-07-15 17:23:58,234 - INFO - , with total : 155 rows
2019-07-15 17:24:00,861 - INFO - Row 2
2019-07-15 17:24:00,868 - INFO - Filename: Bhayangkara FC Official Shop Followers
2019-07-15 17:24:00,871 - INFO - Shop ID: 156764051
2019-07-15 17:24:00,875 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 156764051 
                                and status = 1
                                
2019-07-15 17:24:00,890 - INFO - Start Running query Bhayangkara FC Official Shop Followers
2019-07-15 17:24:06,769 - INFO - Running Bhayangkara FC Official Shop Followers Done
2019-07-15 17:24:06,775 - INFO - CSV file path: Bhayangkara FC Official Shop Followers
2019-07-15 17:24:06,778 - INFO - Starting save the query results
2019-07-15 17:24:06,779 - INFO - Total Rows : 47
2019-07-15 17:24:06,782 - INFO - Will split into : 1.0 files
2019-07-15 17:24:06,815 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/Bhayangkara FC Official Shop Followers_1.csv
2019-07-15 17:24:06,819 - INFO - , with total : 47 rows
2019-07-15 17:24:09,755 - INFO - Row 3
2019-07-15 17:24:09,757 - INFO - Filename: Madura United Official Shop Followers
2019-07-15 17:24:09,762 - INFO - Shop ID: 156959596
2019-07-15 17:24:09,766 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 156959596 
                                and status = 1
                                
2019-07-15 17:24:09,782 - INFO - Start Running query Madura United Official Shop Followers
2019-07-15 17:24:20,217 - INFO - Running Madura United Official Shop Followers Done
2019-07-15 17:24:20,223 - INFO - CSV file path: Madura United Official Shop Followers
2019-07-15 17:24:20,226 - INFO - Starting save the query results
2019-07-15 17:24:20,229 - INFO - Total Rows : 57
2019-07-15 17:24:20,230 - INFO - Will split into : 1.0 files
2019-07-15 17:24:20,266 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/Madura United Official Shop Followers_1.csv
2019-07-15 17:24:20,269 - INFO - , with total : 57 rows
2019-07-15 17:24:23,256 - INFO - Row 4
2019-07-15 17:24:23,259 - INFO - Filename: Persela Official Shop Followers
2019-07-15 17:24:23,262 - INFO - Shop ID: 155991601
2019-07-15 17:24:23,265 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 155991601 
                                and status = 1
                                
2019-07-15 17:24:23,269 - INFO - Start Running query Persela Official Shop Followers
2019-07-15 17:24:28,760 - INFO - Running Persela Official Shop Followers Done
2019-07-15 17:24:28,765 - INFO - CSV file path: Persela Official Shop Followers
2019-07-15 17:24:28,766 - INFO - Starting save the query results
2019-07-15 17:24:28,767 - INFO - Total Rows : 48
2019-07-15 17:24:28,769 - INFO - Will split into : 1.0 files
2019-07-15 17:24:28,792 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/Persela Official Shop Followers_1.csv
2019-07-15 17:24:28,793 - INFO - , with total : 48 rows
2019-07-15 17:24:32,756 - INFO - Row 5
2019-07-15 17:24:32,757 - INFO - Filename: Semen Padang Official Shop Followers
2019-07-15 17:24:32,759 - INFO - Shop ID: 156734144
2019-07-15 17:24:32,762 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 156734144 
                                and status = 1
                                
2019-07-15 17:24:32,769 - INFO - Start Running query Semen Padang Official Shop Followers
2019-07-15 17:24:39,867 - INFO - Running Semen Padang Official Shop Followers Done
2019-07-15 17:24:39,871 - INFO - CSV file path: Semen Padang Official Shop Followers
2019-07-15 17:24:39,875 - INFO - Starting save the query results
2019-07-15 17:24:39,880 - INFO - Total Rows : 25
2019-07-15 17:24:39,884 - INFO - Will split into : 1.0 files
2019-07-15 17:24:39,920 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/Semen Padang Official Shop Followers_1.csv
2019-07-15 17:24:39,921 - INFO - , with total : 25 rows
2019-07-15 17:24:43,328 - INFO - Row 6
2019-07-15 17:24:43,332 - INFO - Filename: Vivo Official Shop Followers
2019-07-15 17:24:43,335 - INFO - Shop ID: 30843261
2019-07-15 17:24:43,335 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 30843261 
                                and status = 1
                                
2019-07-15 17:24:43,346 - INFO - Start Running query Vivo Official Shop Followers
2019-07-15 17:25:05,276 - INFO - Running Vivo Official Shop Followers Done
2019-07-15 17:25:05,278 - INFO - CSV file path: Vivo Official Shop Followers
2019-07-15 17:25:05,301 - INFO - Starting save the query results
2019-07-15 17:25:05,303 - INFO - Total Rows : 149077
2019-07-15 17:25:05,305 - INFO - Will split into : 1.0 files
2019-07-15 17:25:07,346 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/Vivo Official Shop Followers_1.csv
2019-07-15 17:25:07,348 - INFO - , with total : 149077 rows
2019-07-15 17:25:08,437 - INFO - Delete all data in sheet: Case 7
2019-07-15 17:25:11,065 - INFO - Value detected - use sheet: Case 8
2019-07-15 17:25:11,068 - INFO - Reading Data From Google Sheet...
2019-07-15 17:25:11,969 - INFO - Get custom SQL..
2019-07-15 17:25:11,970 - INFO - USING CASE 8
2019-07-15 17:25:13,674 - INFO - Row 1
2019-07-15 17:25:13,677 - INFO - Filename: A30 DP buyers (max. 8.500 users)
2019-07-15 17:25:13,677 - INFO - Last Login: 30
2019-07-15 17:25:13,677 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar))
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-07-15 17:25:13,681 - INFO - Start Running query A30 DP buyers (max. 8.500 users)
2019-07-15 17:27:54,413 - INFO - Running A30 DP buyers (max. 8.500 users) Done
2019-07-15 17:27:54,415 - INFO - CSV file path: A30 DP buyers (max. 8.500 users)
2019-07-15 17:27:54,763 - INFO - Starting save the query results
2019-07-15 17:27:54,763 - INFO - Total Rows : 2340947
2019-07-15 17:27:54,765 - INFO - Will split into : 3.0 files
2019-07-15 17:28:06,046 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 DP buyers (max. 8.500 users)_1.csv
2019-07-15 17:28:06,048 - INFO - , with total : 780316 rows
2019-07-15 17:28:14,822 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 DP buyers (max. 8.500 users)_2.csv
2019-07-15 17:28:14,822 - INFO - , with total : 780316 rows
2019-07-15 17:28:22,750 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190715 17.15/A30 DP buyers (max. 8.500 users)_3.csv
2019-07-15 17:28:22,755 - INFO - , with total : 780315 rows
2019-07-15 17:28:23,836 - INFO - Delete all data in sheet: Case 8
2019-07-15 17:28:25,660 - INFO - No value detected on sheet: Case 9
2019-07-16 10:00:21,299 - INFO - Report date: 20190716 10.00
2019-07-16 10:00:26,497 - INFO - Download sheet..
2019-07-16 10:00:26,499 - INFO - Change directory to script path
2019-07-16 10:00:27,469 - INFO - Spreadsheet downloaded
2019-07-16 10:00:27,470 - INFO - Checking sheet..
2019-07-16 10:00:29,150 - INFO - Value detected - use sheet: Case 1
2019-07-16 10:00:29,151 - INFO - Reading Data From Google Sheet...
2019-07-16 10:00:29,750 - INFO - Get custom SQL..
2019-07-16 10:00:29,752 - INFO - USING CASE 1
2019-07-16 10:00:31,549 - INFO - Row 1
2019-07-16 10:00:31,552 - INFO - Filename: A30 Lifestyle Buyers
2019-07-16 10:00:31,552 - INFO - Category: 'Hobby & Collection'
2019-07-16 10:00:31,553 - INFO - Last Login: 30
2019-07-16 10:00:31,553 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-16 10:00:31,555 - INFO - Start Running query A30 Lifestyle Buyers
2019-07-16 10:02:33,039 - INFO - Running A30 Lifestyle Buyers Done
2019-07-16 10:02:33,043 - INFO - CSV file path: A30 Lifestyle Buyers
2019-07-16 10:02:33,127 - INFO - Starting save the query results
2019-07-16 10:02:33,128 - INFO - Total Rows : 1978173
2019-07-16 10:02:33,131 - INFO - Will split into : 2.0 files
2019-07-16 10:02:37,539 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 10.00/A30 Lifestyle Buyers_1.csv
2019-07-16 10:02:37,542 - INFO - , with total : 989087 rows
2019-07-16 10:02:42,503 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 10.00/A30 Lifestyle Buyers_2.csv
2019-07-16 10:02:42,506 - INFO - , with total : 989086 rows
2019-07-16 10:02:49,319 - INFO - Delete all data in sheet: Case 1
2019-07-16 10:02:59,209 - INFO - No value detected on sheet: Case 2
2019-07-16 10:03:00,446 - INFO - No value detected on sheet: Case 3
2019-07-16 10:03:09,438 - INFO - Value detected - use sheet: Case 4
2019-07-16 10:03:09,440 - INFO - Reading Data From Google Sheet...
2019-07-16 10:03:10,046 - INFO - Get custom SQL..
2019-07-16 10:03:10,049 - INFO - USING CASE 4
2019-07-16 10:03:12,971 - INFO - Row 1
2019-07-16 10:03:12,973 - INFO - Filename: A7 male users
2019-07-16 10:03:12,973 - INFO - Category: ''
2019-07-16 10:03:12,974 - INFO - Last Login: 7
2019-07-16 10:03:12,974 - INFO - Gender: 1,3
2019-07-16 10:03:12,974 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-16 10:03:12,976 - INFO - Start Running query A7 male users
2019-07-16 10:04:29,842 - INFO - Running A7 male users Done
2019-07-16 10:04:29,848 - INFO - CSV file path: A7 male users
2019-07-16 10:04:29,849 - INFO - Starting save the query results
2019-07-16 10:04:29,851 - INFO - Total Rows : 11
2019-07-16 10:04:29,851 - INFO - Will split into : 1.0 files
2019-07-16 10:04:29,858 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 10.00/A7 male users_1.csv
2019-07-16 10:04:29,858 - INFO - , with total : 11 rows
2019-07-16 10:04:49,904 - INFO - Error in get_custom_sql -> Timeout : SSLError('The read operation timed out',)
2019-07-16 10:04:49,930 - INFO - Delete all data in sheet: Case 4
2019-07-16 10:05:10,010 - INFO - Timeout : SSLError('The read operation timed out',)
2019-07-16 10:05:30,095 - INFO - Timeout : SSLError('The read operation timed out',)
2019-07-16 10:05:31,615 - INFO - No value detected on sheet: Case 6
2019-07-16 10:05:32,973 - INFO - No value detected on sheet: Case 7
2019-07-16 10:05:34,315 - INFO - No value detected on sheet: Case 8
2019-07-16 10:05:35,740 - INFO - No value detected on sheet: Case 9
2019-07-16 12:06:29,026 - INFO - Report date: 20190716 12.06
2019-07-16 12:06:29,055 - INFO - Download sheet..
2019-07-16 12:06:29,055 - INFO - Change directory to script path
2019-07-16 12:06:31,336 - INFO - Spreadsheet downloaded
2019-07-16 12:06:31,338 - INFO - Checking sheet..
2019-07-16 12:06:33,588 - INFO - Value detected - use sheet: Case 1
2019-07-16 12:06:33,592 - INFO - Reading Data From Google Sheet...
2019-07-16 12:06:34,506 - INFO - Get custom SQL..
2019-07-16 12:06:34,507 - INFO - USING CASE 1
2019-07-16 12:06:36,480 - INFO - Row 1
2019-07-16 12:06:36,480 - INFO - Filename: A30 Lifestyle Buyers
2019-07-16 12:06:36,483 - INFO - Category: 'Hobby & Collection'
2019-07-16 12:06:36,483 - INFO - Last Login: 30
2019-07-16 12:06:36,483 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-16 12:06:36,484 - INFO - Start Running query A30 Lifestyle Buyers
2019-07-16 12:08:58,075 - INFO - Running A30 Lifestyle Buyers Done
2019-07-16 12:08:58,076 - INFO - CSV file path: A30 Lifestyle Buyers
2019-07-16 12:08:58,424 - INFO - Starting save the query results
2019-07-16 12:08:58,426 - INFO - Total Rows : 1978173
2019-07-16 12:08:58,428 - INFO - Will split into : 2.0 files
2019-07-16 12:09:08,033 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 12.06/A30 Lifestyle Buyers_1.csv
2019-07-16 12:09:08,038 - INFO - , with total : 989087 rows
2019-07-16 12:09:18,276 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 12.06/A30 Lifestyle Buyers_2.csv
2019-07-16 12:09:18,280 - INFO - , with total : 989086 rows
2019-07-16 12:09:18,875 - INFO - Delete all data in sheet: Case 1
2019-07-16 12:09:21,545 - INFO - No value detected on sheet: Case 2
2019-07-16 12:09:23,102 - INFO - No value detected on sheet: Case 3
2019-07-16 12:09:24,631 - INFO - Value detected - use sheet: Case 4
2019-07-16 12:09:24,631 - INFO - Reading Data From Google Sheet...
2019-07-16 12:09:25,420 - INFO - Get custom SQL..
2019-07-16 12:09:25,440 - INFO - USING CASE 4
2019-07-16 12:09:28,456 - INFO - Row 1
2019-07-16 12:09:28,460 - INFO - Filename: A7 male users
2019-07-16 12:09:28,470 - INFO - Category: ''
2019-07-16 12:09:28,473 - INFO - Last Login: 7
2019-07-16 12:09:28,486 - INFO - Gender: 1,3
2019-07-16 12:09:28,492 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-16 12:09:28,528 - INFO - Start Running query A7 male users
2019-07-16 12:10:41,197 - INFO - Running A7 male users Done
2019-07-16 12:10:41,198 - INFO - CSV file path: A7 male users
2019-07-16 12:10:41,207 - INFO - Starting save the query results
2019-07-16 12:10:41,210 - INFO - Total Rows : 11
2019-07-16 12:10:41,211 - INFO - Will split into : 1.0 files
2019-07-16 12:10:41,253 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 12.06/A7 male users_1.csv
2019-07-16 12:10:41,256 - INFO - , with total : 11 rows
2019-07-16 12:10:44,051 - INFO - Row 2
2019-07-16 12:10:44,052 - INFO - Filename: A30 male & predicted male users
2019-07-16 12:10:44,052 - INFO - Category: ''
2019-07-16 12:10:44,053 - INFO - Last Login: 30
2019-07-16 12:10:44,053 - INFO - Gender: 1,3
2019-07-16 12:10:44,055 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-16 12:10:44,056 - INFO - Start Running query A30 male & predicted male users
2019-07-16 12:11:41,641 - INFO - Running A30 male & predicted male users Done
2019-07-16 12:11:41,648 - INFO - CSV file path: A30 male & predicted male users
2019-07-16 12:11:41,655 - INFO - Starting save the query results
2019-07-16 12:11:41,660 - INFO - Total Rows : 16
2019-07-16 12:11:41,661 - INFO - Will split into : 1.0 files
2019-07-16 12:11:41,726 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 12.06/A30 male & predicted male users_1.csv
2019-07-16 12:11:41,730 - INFO - , with total : 16 rows
2019-07-16 12:11:42,328 - INFO - Delete all data in sheet: Case 4
2019-07-16 12:11:44,430 - INFO - No value detected on sheet: Case 5
2019-07-16 12:11:45,996 - INFO - No value detected on sheet: Case 6
2019-07-16 12:11:47,095 - INFO - No value detected on sheet: Case 7
2019-07-16 12:11:48,470 - INFO - No value detected on sheet: Case 8
2019-07-16 12:11:50,309 - INFO - No value detected on sheet: Case 9
2019-07-16 14:00:10,470 - INFO - Report date: 20190716 14.00
2019-07-16 14:00:14,923 - INFO - Download sheet..
2019-07-16 14:00:14,924 - INFO - Change directory to script path
2019-07-16 14:00:16,229 - INFO - Spreadsheet downloaded
2019-07-16 14:00:16,230 - INFO - Checking sheet..
2019-07-16 14:00:18,025 - INFO - No value detected on sheet: Case 1
2019-07-16 14:00:19,358 - INFO - No value detected on sheet: Case 2
2019-07-16 14:00:20,716 - INFO - No value detected on sheet: Case 3
2019-07-16 14:00:22,173 - INFO - No value detected on sheet: Case 4
2019-07-16 14:00:23,556 - INFO - No value detected on sheet: Case 5
2019-07-16 14:00:24,890 - INFO - No value detected on sheet: Case 6
2019-07-16 14:00:26,270 - INFO - Value detected - use sheet: Case 7
2019-07-16 14:00:26,270 - INFO - Reading Data From Google Sheet...
2019-07-16 14:00:26,934 - INFO - Get custom SQL..
2019-07-16 14:00:26,934 - INFO - USING CASE 7
2019-07-16 14:00:28,288 - INFO - Row 1
2019-07-16 14:00:28,289 - INFO - Filename: Official Shop Followers
2019-07-16 14:00:28,289 - INFO - Shop ID: 18395153
2019-07-16 14:00:28,290 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 18395153 
                                and status = 1
                                
2019-07-16 14:00:28,290 - INFO - Start Running query Official Shop Followers
2019-07-16 14:00:48,493 - INFO - Running Official Shop Followers Done
2019-07-16 14:00:48,494 - INFO - CSV file path: Official Shop Followers
2019-07-16 14:00:48,496 - INFO - Starting save the query results
2019-07-16 14:00:48,496 - INFO - Total Rows : 6486
2019-07-16 14:00:48,497 - INFO - Will split into : 1.0 files
2019-07-16 14:00:48,551 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 14.00/Official Shop Followers_1.csv
2019-07-16 14:00:48,552 - INFO - , with total : 6486 rows
2019-07-16 14:00:49,269 - INFO - Delete all data in sheet: Case 7
2019-07-16 14:00:51,474 - INFO - No value detected on sheet: Case 8
2019-07-16 14:00:52,088 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-07-16 17:00:03,203 - INFO - Report date: 20190716 17.00
2019-07-16 17:00:07,112 - INFO - Download sheet..
2019-07-16 17:00:07,114 - INFO - Change directory to script path
2019-07-16 17:00:08,154 - INFO - Spreadsheet downloaded
2019-07-16 17:00:08,154 - INFO - Checking sheet..
2019-07-16 17:00:10,072 - INFO - Value detected - use sheet: Case 1
2019-07-16 17:00:10,073 - INFO - Reading Data From Google Sheet...
2019-07-16 17:00:10,746 - INFO - Get custom SQL..
2019-07-16 17:00:10,746 - INFO - USING CASE 1
2019-07-16 17:00:12,789 - INFO - Row 1
2019-07-16 17:00:12,790 - INFO - Filename: A30 Lifestyle Buyers
2019-07-16 17:00:12,792 - INFO - Category: 'Sports & Outdoor'
2019-07-16 17:00:12,793 - INFO - Last Login: 30
2019-07-16 17:00:12,795 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-16 17:00:12,799 - INFO - Start Running query A30 Lifestyle Buyers
2019-07-16 17:01:22,831 - INFO - Running A30 Lifestyle Buyers Done
2019-07-16 17:01:22,832 - INFO - CSV file path: A30 Lifestyle Buyers
2019-07-16 17:01:22,926 - INFO - Starting save the query results
2019-07-16 17:01:22,927 - INFO - Total Rows : 2495499
2019-07-16 17:01:22,927 - INFO - Will split into : 3.0 files
2019-07-16 17:01:26,582 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 17.00/A30 Lifestyle Buyers_1.csv
2019-07-16 17:01:26,584 - INFO - , with total : 831833 rows
2019-07-16 17:01:30,525 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 17.00/A30 Lifestyle Buyers_2.csv
2019-07-16 17:01:30,526 - INFO - , with total : 831833 rows
2019-07-16 17:01:34,486 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190716 17.00/A30 Lifestyle Buyers_3.csv
2019-07-16 17:01:34,487 - INFO - , with total : 831833 rows
2019-07-16 17:01:35,592 - INFO - Delete all data in sheet: Case 1
2019-07-16 17:01:37,650 - INFO - No value detected on sheet: Case 2
2019-07-16 17:01:39,003 - INFO - No value detected on sheet: Case 3
2019-07-16 17:01:40,069 - INFO - No value detected on sheet: Case 4
2019-07-16 17:01:41,394 - INFO - No value detected on sheet: Case 5
2019-07-16 17:01:42,743 - INFO - No value detected on sheet: Case 6
2019-07-16 17:01:44,059 - INFO - No value detected on sheet: Case 7
2019-07-16 17:01:45,079 - INFO - No value detected on sheet: Case 8
2019-07-16 17:01:46,170 - INFO - No value detected on sheet: Case 9
2019-07-17 10:00:13,275 - INFO - Report date: 20190717 10.00
2019-07-17 10:00:17,065 - INFO - Download sheet..
2019-07-17 10:00:17,065 - INFO - Change directory to script path
2019-07-17 10:00:18,164 - INFO - Spreadsheet downloaded
2019-07-17 10:00:18,165 - INFO - Checking sheet..
2019-07-17 10:00:20,000 - INFO - Value detected - use sheet: Case 1
2019-07-17 10:00:20,002 - INFO - Reading Data From Google Sheet...
2019-07-17 10:00:20,619 - INFO - Get custom SQL..
2019-07-17 10:00:20,621 - INFO - USING CASE 1
2019-07-17 10:00:22,493 - INFO - Row 1
2019-07-17 10:00:22,494 - INFO - Filename: A7 Health Buyers
2019-07-17 10:00:22,496 - INFO - Category: 'Health'
2019-07-17 10:00:22,497 - INFO - Last Login: 7
2019-07-17 10:00:22,497 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Health')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-17 10:00:22,499 - INFO - Start Running query A7 Health Buyers
2019-07-17 10:03:42,660 - INFO - Running A7 Health Buyers Done
2019-07-17 10:03:42,664 - INFO - CSV file path: A7 Health Buyers
2019-07-17 10:03:42,795 - INFO - Starting save the query results
2019-07-17 10:03:42,795 - INFO - Total Rows : 2909628
2019-07-17 10:03:42,796 - INFO - Will split into : 3.0 files
2019-07-17 10:03:47,230 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190717 10.00/A7 Health Buyers_1.csv
2019-07-17 10:03:47,230 - INFO - , with total : 969876 rows
2019-07-17 10:03:51,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190717 10.00/A7 Health Buyers_2.csv
2019-07-17 10:03:51,969 - INFO - , with total : 969876 rows
2019-07-17 10:03:56,963 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190717 10.00/A7 Health Buyers_3.csv
2019-07-17 10:03:56,964 - INFO - , with total : 969876 rows
2019-07-17 10:03:58,181 - INFO - Delete all data in sheet: Case 1
2019-07-17 10:04:00,009 - INFO - No value detected on sheet: Case 2
2019-07-17 10:04:01,220 - INFO - No value detected on sheet: Case 3
2019-07-17 10:04:02,414 - INFO - No value detected on sheet: Case 4
2019-07-17 10:04:03,640 - INFO - No value detected on sheet: Case 5
2019-07-17 10:04:04,861 - INFO - No value detected on sheet: Case 6
2019-07-17 10:04:06,135 - INFO - Value detected - use sheet: Case 7
2019-07-17 10:04:06,137 - INFO - Reading Data From Google Sheet...
2019-07-17 10:04:06,737 - INFO - Get custom SQL..
2019-07-17 10:04:06,739 - INFO - USING CASE 7
2019-07-17 10:04:08,075 - INFO - Row 1
2019-07-17 10:04:08,076 - INFO - Filename: Fibre First Official Shop Followers
2019-07-17 10:04:08,078 - INFO - Shop ID: 90108860
2019-07-17 10:04:08,079 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 90108860 
                                and status = 1
                                
2019-07-17 10:04:08,081 - INFO - Start Running query Fibre First Official Shop Followers
2019-07-17 10:06:05,631 - INFO - Running Fibre First Official Shop Followers Done
2019-07-17 10:06:05,638 - INFO - CSV file path: Fibre First Official Shop Followers
2019-07-17 10:06:05,645 - INFO - Starting save the query results
2019-07-17 10:06:05,645 - INFO - Total Rows : 738
2019-07-17 10:06:05,648 - INFO - Will split into : 1.0 files
2019-07-17 10:06:05,660 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190717 10.00/Fibre First Official Shop Followers_1.csv
2019-07-17 10:06:05,661 - INFO - , with total : 738 rows
2019-07-17 10:06:06,404 - INFO - Delete all data in sheet: Case 7
2019-07-17 10:06:07,846 - INFO - No value detected on sheet: Case 8
2019-07-17 10:06:09,109 - INFO - No value detected on sheet: Case 9
2019-07-17 14:00:05,700 - INFO - Report date: 20190717 14.00
2019-07-17 14:00:09,463 - INFO - Download sheet..
2019-07-17 14:00:09,463 - INFO - Change directory to script path
2019-07-17 14:00:10,588 - INFO - Spreadsheet downloaded
2019-07-17 14:00:10,588 - INFO - Checking sheet..
2019-07-17 14:00:12,319 - INFO - No value detected on sheet: Case 1
2019-07-17 14:00:13,483 - INFO - No value detected on sheet: Case 2
2019-07-17 14:00:14,680 - INFO - No value detected on sheet: Case 3
2019-07-17 14:00:15,841 - INFO - No value detected on sheet: Case 4
2019-07-17 14:00:16,997 - INFO - No value detected on sheet: Case 5
2019-07-17 14:00:18,148 - INFO - No value detected on sheet: Case 6
2019-07-17 14:00:19,148 - INFO - No value detected on sheet: Case 7
2019-07-17 14:00:20,401 - INFO - No value detected on sheet: Case 8
2019-07-17 14:00:21,503 - INFO - No value detected on sheet: Case 9
2019-07-17 17:00:02,782 - INFO - Report date: 20190717 17.00
2019-07-17 17:00:06,055 - INFO - Download sheet..
2019-07-17 17:00:06,055 - INFO - Change directory to script path
2019-07-17 17:00:07,378 - INFO - Spreadsheet downloaded
2019-07-17 17:00:07,378 - INFO - Checking sheet..
2019-07-17 17:00:08,987 - INFO - No value detected on sheet: Case 1
2019-07-17 17:00:10,207 - INFO - No value detected on sheet: Case 2
2019-07-17 17:00:11,382 - INFO - No value detected on sheet: Case 3
2019-07-17 17:00:12,545 - INFO - No value detected on sheet: Case 4
2019-07-17 17:00:13,720 - INFO - No value detected on sheet: Case 5
2019-07-17 17:00:14,924 - INFO - No value detected on sheet: Case 6
2019-07-17 17:00:16,148 - INFO - No value detected on sheet: Case 7
2019-07-17 17:00:17,362 - INFO - No value detected on sheet: Case 8
2019-07-17 17:00:18,664 - INFO - No value detected on sheet: Case 9
2019-07-18 10:00:12,351 - INFO - Report date: 20190718 10.00
2019-07-18 10:00:16,858 - INFO - Download sheet..
2019-07-18 10:00:16,858 - INFO - Change directory to script path
2019-07-18 10:00:18,013 - INFO - Spreadsheet downloaded
2019-07-18 10:00:18,015 - INFO - Checking sheet..
2019-07-18 10:00:19,584 - INFO - Value detected - use sheet: Case 1
2019-07-18 10:00:19,585 - INFO - Reading Data From Google Sheet...
2019-07-18 10:00:20,157 - INFO - Get custom SQL..
2019-07-18 10:00:20,157 - INFO - USING CASE 1
2019-07-18 10:00:22,086 - INFO - Row 1
2019-07-18 10:00:22,088 - INFO - Filename: A30 Lifestyle Buyers
2019-07-18 10:00:22,088 - INFO - Category: 'Sports & Outdoor'
2019-07-18 10:00:22,088 - INFO - Last Login: 30
2019-07-18 10:00:22,089 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-18 10:00:22,089 - INFO - Start Running query A30 Lifestyle Buyers
2019-07-18 10:01:48,846 - INFO - Running A30 Lifestyle Buyers Done
2019-07-18 10:01:48,848 - INFO - CSV file path: A30 Lifestyle Buyers
2019-07-18 10:01:48,948 - INFO - Starting save the query results
2019-07-18 10:01:48,950 - INFO - Total Rows : 2496414
2019-07-18 10:01:48,950 - INFO - Will split into : 3.0 files
2019-07-18 10:01:52,880 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 10.00/A30 Lifestyle Buyers_1.csv
2019-07-18 10:01:52,880 - INFO - , with total : 832138 rows
2019-07-18 10:01:57,016 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 10.00/A30 Lifestyle Buyers_2.csv
2019-07-18 10:01:57,017 - INFO - , with total : 832138 rows
2019-07-18 10:02:01,115 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 10.00/A30 Lifestyle Buyers_3.csv
2019-07-18 10:02:01,117 - INFO - , with total : 832138 rows
2019-07-18 10:02:02,154 - INFO - Delete all data in sheet: Case 1
2019-07-18 10:02:04,042 - INFO - No value detected on sheet: Case 2
2019-07-18 10:02:05,203 - INFO - No value detected on sheet: Case 3
2019-07-18 10:02:06,365 - INFO - Value detected - use sheet: Case 4
2019-07-18 10:02:06,367 - INFO - Reading Data From Google Sheet...
2019-07-18 10:02:06,963 - INFO - Get custom SQL..
2019-07-18 10:02:06,964 - INFO - USING CASE 4
2019-07-18 10:02:09,342 - INFO - Row 1
2019-07-18 10:02:09,344 - INFO - Filename: A30 Male Fashion Buyers
2019-07-18 10:02:09,345 - INFO - Category: 'Men Bags','Men Clothes','Men Shoes'
2019-07-18 10:02:09,346 - INFO - Last Login: 30
2019-07-18 10:02:09,346 - INFO - Gender: 1,3
2019-07-18 10:02:09,348 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Men Bags','Men Clothes','Men Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-18 10:02:09,348 - INFO - Start Running query A30 Male Fashion Buyers
2019-07-18 10:03:42,351 - INFO - Running A30 Male Fashion Buyers Done
2019-07-18 10:03:42,351 - INFO - CSV file path: A30 Male Fashion Buyers
2019-07-18 10:03:42,437 - INFO - Starting save the query results
2019-07-18 10:03:42,437 - INFO - Total Rows : 2314591
2019-07-18 10:03:42,437 - INFO - Will split into : 3.0 files
2019-07-18 10:03:45,908 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 10.00/A30 Male Fashion Buyers_1.csv
2019-07-18 10:03:45,910 - INFO - , with total : 771531 rows
2019-07-18 10:03:49,674 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 10.00/A30 Male Fashion Buyers_2.csv
2019-07-18 10:03:49,674 - INFO - , with total : 771530 rows
2019-07-18 10:03:53,556 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 10.00/A30 Male Fashion Buyers_3.csv
2019-07-18 10:03:53,558 - INFO - , with total : 771530 rows
2019-07-18 10:03:54,338 - INFO - Delete all data in sheet: Case 4
2019-07-18 10:03:55,483 - INFO - No value detected on sheet: Case 5
2019-07-18 10:03:56,849 - INFO - No value detected on sheet: Case 6
2019-07-18 10:03:58,305 - INFO - No value detected on sheet: Case 7
2019-07-18 10:03:59,246 - INFO - No value detected on sheet: Case 8
2019-07-18 10:04:00,216 - INFO - No value detected on sheet: Case 9
2019-07-18 14:00:13,025 - INFO - Report date: 20190718 14.00
2019-07-18 14:00:17,437 - INFO - Download sheet..
2019-07-18 14:00:17,437 - INFO - Change directory to script path
2019-07-18 14:00:19,280 - INFO - Spreadsheet downloaded
2019-07-18 14:00:19,282 - INFO - Checking sheet..
2019-07-18 14:00:22,410 - INFO - No value detected on sheet: Case 1
2019-07-18 14:00:23,862 - INFO - No value detected on sheet: Case 2
2019-07-18 14:00:25,165 - INFO - Value detected - use sheet: Case 3
2019-07-18 14:00:25,167 - INFO - Reading Data From Google Sheet...
2019-07-18 14:00:25,750 - INFO - Get custom SQL..
2019-07-18 14:00:25,750 - INFO - USING CASE 3
2019-07-18 14:00:29,528 - INFO - Row 1
2019-07-18 14:00:29,529 - INFO - Filename: A30 MA buyers who haven't shopped in the last 30 days
2019-07-18 14:00:29,529 - INFO - Category: 'Computer & Accessories'
2019-07-18 14:00:29,529 - INFO - Last Login: 30
2019-07-18 14:00:29,530 - INFO - Date 1: 2019-06-12
2019-07-18 14:00:29,530 - INFO - Date 2: 2019-07-18
2019-07-18 14:00:29,532 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Computer & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-12' and date'2019-07-18'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-18 14:00:29,532 - INFO - Start Running query A30 MA buyers who haven't shopped in the last 30 days
2019-07-18 14:01:13,671 - INFO - Running A30 MA buyers who haven't shopped in the last 30 days Done
2019-07-18 14:01:13,673 - INFO - CSV file path: A30 MA buyers who haven't shopped in the last 30 days
2019-07-18 14:01:13,700 - INFO - Starting save the query results
2019-07-18 14:01:13,700 - INFO - Total Rows : 720014
2019-07-18 14:01:13,701 - INFO - Will split into : 1.0 files
2019-07-18 14:01:17,026 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 14.00/A30 MA buyers who haven't shopped in the last 30 days_1.csv
2019-07-18 14:01:17,028 - INFO - , with total : 720014 rows
2019-07-18 14:01:17,793 - INFO - Delete all data in sheet: Case 3
2019-07-18 14:01:19,651 - INFO - Value detected - use sheet: Case 4
2019-07-18 14:01:19,651 - INFO - Reading Data From Google Sheet...
2019-07-18 14:01:20,203 - INFO - Get custom SQL..
2019-07-18 14:01:20,204 - INFO - USING CASE 4
2019-07-18 14:01:21,881 - INFO - Row 1
2019-07-18 14:01:21,881 - INFO - Filename: A7 Male Lifestyle Buyers
2019-07-18 14:01:21,881 - INFO - Category: 'Hobby & Collection'
2019-07-18 14:01:21,882 - INFO - Last Login: 30
2019-07-18 14:01:21,884 - INFO - Gender: 1,3
2019-07-18 14:01:21,884 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-18 14:01:21,884 - INFO - Start Running query A7 Male Lifestyle Buyers
2019-07-18 14:02:01,740 - INFO - Running A7 Male Lifestyle Buyers Done
2019-07-18 14:02:01,740 - INFO - CSV file path: A7 Male Lifestyle Buyers
2019-07-18 14:02:01,760 - INFO - Starting save the query results
2019-07-18 14:02:01,762 - INFO - Total Rows : 527616
2019-07-18 14:02:01,762 - INFO - Will split into : 1.0 files
2019-07-18 14:02:04,246 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 14.00/A7 Male Lifestyle Buyers_1.csv
2019-07-18 14:02:04,247 - INFO - , with total : 527616 rows
2019-07-18 14:02:05,010 - INFO - Error in get_custom_sql -> <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%204%21A3%3AA3?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-07-18 14:02:05,013 - INFO - Delete all data in sheet: Case 4
2019-07-18 14:02:06,015 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-07-18 14:02:06,743 - INFO - No value detected on sheet: Case 6
2019-07-18 14:02:07,693 - INFO - No value detected on sheet: Case 7
2019-07-18 14:02:08,841 - INFO - No value detected on sheet: Case 8
2019-07-18 14:02:09,769 - INFO - No value detected on sheet: Case 9
2019-07-18 17:00:02,263 - INFO - Report date: 20190718 17.00
2019-07-18 17:00:05,753 - INFO - Download sheet..
2019-07-18 17:00:05,753 - INFO - Change directory to script path
2019-07-18 17:00:07,006 - INFO - Spreadsheet downloaded
2019-07-18 17:00:07,007 - INFO - Checking sheet..
2019-07-18 17:00:08,581 - INFO - No value detected on sheet: Case 1
2019-07-18 17:00:09,713 - INFO - No value detected on sheet: Case 2
2019-07-18 17:00:10,857 - INFO - No value detected on sheet: Case 3
2019-07-18 17:00:12,006 - INFO - Value detected - use sheet: Case 4
2019-07-18 17:00:12,006 - INFO - Reading Data From Google Sheet...
2019-07-18 17:00:12,608 - INFO - Get custom SQL..
2019-07-18 17:00:12,609 - INFO - USING CASE 4
2019-07-18 17:00:14,904 - INFO - Row 1
2019-07-18 17:00:14,904 - INFO - Filename: A30 Lifestyle Buyers
2019-07-18 17:00:14,905 - INFO - Category: 'Hobby & Collection'
2019-07-18 17:00:14,905 - INFO - Last Login: 30
2019-07-18 17:00:14,907 - INFO - Gender: 1,3
2019-07-18 17:00:14,907 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-18 17:00:14,907 - INFO - Start Running query A30 Lifestyle Buyers
2019-07-18 17:01:01,065 - INFO - Running A30 Lifestyle Buyers Done
2019-07-18 17:01:01,065 - INFO - CSV file path: A30 Lifestyle Buyers
2019-07-18 17:01:01,085 - INFO - Starting save the query results
2019-07-18 17:01:01,088 - INFO - Total Rows : 527616
2019-07-18 17:01:01,088 - INFO - Will split into : 1.0 files
2019-07-18 17:01:03,423 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Lifestyle Buyers_1.csv
2019-07-18 17:01:03,424 - INFO - , with total : 527616 rows
2019-07-18 17:01:06,420 - INFO - Row 2
2019-07-18 17:01:06,421 - INFO - Filename: A30 Lifestyle Buyers
2019-07-18 17:01:06,421 - INFO - Category: 'Hobby & Collection'
2019-07-18 17:01:06,423 - INFO - Last Login: 30
2019-07-18 17:01:06,423 - INFO - Gender: 2,4
2019-07-18 17:01:06,423 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-18 17:01:06,424 - INFO - Start Running query A30 Lifestyle Buyers
2019-07-18 17:02:08,446 - INFO - Running A30 Lifestyle Buyers Done
2019-07-18 17:02:08,447 - INFO - CSV file path: A30 Lifestyle Buyers
2019-07-18 17:02:08,503 - INFO - Starting save the query results
2019-07-18 17:02:08,503 - INFO - Total Rows : 1458868
2019-07-18 17:02:08,503 - INFO - Will split into : 2.0 files
2019-07-18 17:02:11,801 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Lifestyle Buyers_1.csv
2019-07-18 17:02:11,802 - INFO - , with total : 729434 rows
2019-07-18 17:02:15,233 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Lifestyle Buyers_2.csv
2019-07-18 17:02:15,233 - INFO - , with total : 729434 rows
2019-07-18 17:02:18,112 - INFO - Row 3
2019-07-18 17:02:18,115 - INFO - Filename: A30 Lifestyle Buyers
2019-07-18 17:02:18,115 - INFO - Category: 'Sports & Outdoor'
2019-07-18 17:02:18,115 - INFO - Last Login: 30
2019-07-18 17:02:18,115 - INFO - Gender: 1,3
2019-07-18 17:02:18,115 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-18 17:02:18,117 - INFO - Start Running query A30 Lifestyle Buyers
2019-07-18 17:04:09,428 - INFO - Running A30 Lifestyle Buyers Done
2019-07-18 17:04:09,430 - INFO - CSV file path: A30 Lifestyle Buyers
2019-07-18 17:04:09,467 - INFO - Starting save the query results
2019-07-18 17:04:09,469 - INFO - Total Rows : 975770
2019-07-18 17:04:09,469 - INFO - Will split into : 1.0 files
2019-07-18 17:04:13,769 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Lifestyle Buyers_1.csv
2019-07-18 17:04:13,770 - INFO - , with total : 975770 rows
2019-07-18 17:04:16,750 - INFO - Row 4
2019-07-18 17:04:16,752 - INFO - Filename: A30 Lifestyle Buyers
2019-07-18 17:04:16,753 - INFO - Category: 'Sports & Outdoor'
2019-07-18 17:04:16,753 - INFO - Last Login: 30
2019-07-18 17:04:16,753 - INFO - Gender: 2,4
2019-07-18 17:04:16,753 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-18 17:04:16,755 - INFO - Start Running query A30 Lifestyle Buyers
2019-07-18 17:06:04,801 - INFO - Running A30 Lifestyle Buyers Done
2019-07-18 17:06:04,802 - INFO - CSV file path: A30 Lifestyle Buyers
2019-07-18 17:06:04,858 - INFO - Starting save the query results
2019-07-18 17:06:04,858 - INFO - Total Rows : 1528942
2019-07-18 17:06:04,859 - INFO - Will split into : 2.0 files
2019-07-18 17:06:08,270 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Lifestyle Buyers_1.csv
2019-07-18 17:06:08,272 - INFO - , with total : 764471 rows
2019-07-18 17:06:11,868 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Lifestyle Buyers_2.csv
2019-07-18 17:06:11,869 - INFO - , with total : 764471 rows
2019-07-18 17:06:14,533 - INFO - Row 5
2019-07-18 17:06:14,535 - INFO - Filename: A30 Fashion Buyers
2019-07-18 17:06:14,535 - INFO - Category: 'Fashion Accessories','Muslim Fashion','Watches','Men Bags','Men Clothes','Men Shoes'
2019-07-18 17:06:14,536 - INFO - Last Login: 30
2019-07-18 17:06:14,536 - INFO - Gender: 1,3
2019-07-18 17:06:14,536 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories','Muslim Fashion','Watches','Men Bags','Men Clothes','Men Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-18 17:06:14,536 - INFO - Start Running query A30 Fashion Buyers
2019-07-18 17:08:03,381 - INFO - Running A30 Fashion Buyers Done
2019-07-18 17:08:03,382 - INFO - CSV file path: A30 Fashion Buyers
2019-07-18 17:08:03,493 - INFO - Starting save the query results
2019-07-18 17:08:03,494 - INFO - Total Rows : 2849907
2019-07-18 17:08:03,494 - INFO - Will split into : 3.0 files
2019-07-18 17:08:07,927 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_1.csv
2019-07-18 17:08:07,928 - INFO - , with total : 949969 rows
2019-07-18 17:08:12,571 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_2.csv
2019-07-18 17:08:12,572 - INFO - , with total : 949969 rows
2019-07-18 17:08:17,194 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_3.csv
2019-07-18 17:08:17,196 - INFO - , with total : 949969 rows
2019-07-18 17:08:20,049 - INFO - Row 6
2019-07-18 17:08:20,049 - INFO - Filename: A30 Fashion Buyers
2019-07-18 17:08:20,051 - INFO - Category: 'Fashion Accessories','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes'
2019-07-18 17:08:20,052 - INFO - Last Login: 30
2019-07-18 17:08:20,052 - INFO - Gender: 2,4
2019-07-18 17:08:20,052 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-18 17:08:20,053 - INFO - Start Running query A30 Fashion Buyers
2019-07-18 17:12:28,992 - INFO - Running A30 Fashion Buyers Done
2019-07-18 17:12:28,993 - INFO - CSV file path: A30 Fashion Buyers
2019-07-18 17:12:29,328 - INFO - Starting save the query results
2019-07-18 17:12:29,329 - INFO - Total Rows : 8508153
2019-07-18 17:12:29,331 - INFO - Will split into : 9.0 files
2019-07-18 17:12:33,641 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_1.csv
2019-07-18 17:12:33,642 - INFO - , with total : 945351 rows
2019-07-18 17:12:38,013 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_2.csv
2019-07-18 17:12:38,015 - INFO - , with total : 945351 rows
2019-07-18 17:12:42,637 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_3.csv
2019-07-18 17:12:42,638 - INFO - , with total : 945351 rows
2019-07-18 17:12:47,286 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_4.csv
2019-07-18 17:12:47,286 - INFO - , with total : 945350 rows
2019-07-18 17:12:51,970 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_5.csv
2019-07-18 17:12:51,971 - INFO - , with total : 945350 rows
2019-07-18 17:12:56,598 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_6.csv
2019-07-18 17:12:56,599 - INFO - , with total : 945350 rows
2019-07-18 17:13:01,346 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_7.csv
2019-07-18 17:13:01,348 - INFO - , with total : 945350 rows
2019-07-18 17:13:06,368 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_8.csv
2019-07-18 17:13:06,369 - INFO - , with total : 945350 rows
2019-07-18 17:13:10,983 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190718 17.00/A30 Fashion Buyers_9.csv
2019-07-18 17:13:10,984 - INFO - , with total : 945350 rows
2019-07-18 17:13:12,480 - INFO - Delete all data in sheet: Case 4
2019-07-18 17:13:14,250 - INFO - No value detected on sheet: Case 5
2019-07-18 17:13:15,464 - INFO - No value detected on sheet: Case 6
2019-07-18 17:13:16,619 - INFO - No value detected on sheet: Case 7
2019-07-18 17:13:17,750 - INFO - No value detected on sheet: Case 8
2019-07-18 17:13:18,911 - INFO - No value detected on sheet: Case 9
2019-07-19 14:00:04,059 - INFO - Report date: 20190719 14.00
2019-07-19 14:00:08,661 - INFO - Download sheet..
2019-07-19 14:00:08,663 - INFO - Change directory to script path
2019-07-19 14:00:10,346 - INFO - Spreadsheet downloaded
2019-07-19 14:00:10,348 - INFO - Checking sheet..
2019-07-19 14:00:12,720 - INFO - Value detected - use sheet: Case 1
2019-07-19 14:00:12,721 - INFO - Reading Data From Google Sheet...
2019-07-19 14:00:13,438 - INFO - Get custom SQL..
2019-07-19 14:00:13,440 - INFO - USING CASE 1
2019-07-19 14:00:16,484 - INFO - Row 1
2019-07-19 14:00:16,486 - INFO - Filename: A30 EL Buyers
2019-07-19 14:00:16,486 - INFO - Category: 'Mobile & Accessories','Photography'
2019-07-19 14:00:16,486 - INFO - Last Login: 30
2019-07-19 14:00:16,487 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-19 14:00:16,487 - INFO - Start Running query A30 EL Buyers
2019-07-19 14:26:34,680 - INFO - Running A30 EL Buyers Done
2019-07-19 14:26:34,684 - INFO - CSV file path: A30 EL Buyers
2019-07-19 14:26:35,454 - INFO - Starting save the query results
2019-07-19 14:26:35,456 - INFO - Total Rows : 7369754
2019-07-19 14:26:35,457 - INFO - Will split into : 8.0 files
2019-07-19 14:26:39,872 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 EL Buyers_1.csv
2019-07-19 14:26:39,875 - INFO - , with total : 921220 rows
2019-07-19 14:26:44,368 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 EL Buyers_2.csv
2019-07-19 14:26:44,369 - INFO - , with total : 921220 rows
2019-07-19 14:26:48,983 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 EL Buyers_3.csv
2019-07-19 14:26:48,983 - INFO - , with total : 921219 rows
2019-07-19 14:26:53,690 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 EL Buyers_4.csv
2019-07-19 14:26:53,691 - INFO - , with total : 921219 rows
2019-07-19 14:26:58,331 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 EL Buyers_5.csv
2019-07-19 14:26:58,332 - INFO - , with total : 921219 rows
2019-07-19 14:27:03,092 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 EL Buyers_6.csv
2019-07-19 14:27:03,094 - INFO - , with total : 921219 rows
2019-07-19 14:27:07,697 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 EL Buyers_7.csv
2019-07-19 14:27:07,698 - INFO - , with total : 921219 rows
2019-07-19 14:27:12,359 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 EL Buyers_8.csv
2019-07-19 14:27:12,361 - INFO - , with total : 921219 rows
2019-07-19 14:27:14,168 - INFO - Delete all data in sheet: Case 1
2019-07-19 14:27:16,461 - INFO - No value detected on sheet: Case 2
2019-07-19 14:27:17,983 - INFO - No value detected on sheet: Case 3
2019-07-19 14:27:19,443 - INFO - Value detected - use sheet: Case 4
2019-07-19 14:27:19,444 - INFO - Reading Data From Google Sheet...
2019-07-19 14:27:20,210 - INFO - Get custom SQL..
2019-07-19 14:27:20,211 - INFO - USING CASE 4
2019-07-19 14:27:23,596 - INFO - Row 1
2019-07-19 14:27:23,598 - INFO - Filename: A30 Male Lifestyle Buyers
2019-07-19 14:27:23,598 - INFO - Category: 'Hobby &Collection'
2019-07-19 14:27:23,598 - INFO - Last Login: 30
2019-07-19 14:27:23,598 - INFO - Gender: 1,3
2019-07-19 14:27:23,598 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby &Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-19 14:27:23,599 - INFO - Start Running query A30 Male Lifestyle Buyers
2019-07-19 14:27:38,394 - INFO - Running A30 Male Lifestyle Buyers Done
2019-07-19 14:27:38,394 - INFO - CSV file path: A30 Male Lifestyle Buyers
2019-07-19 14:27:38,479 - INFO - Starting save the query results
2019-07-19 14:27:38,480 - INFO - Total Rows : 0
2019-07-19 14:27:38,480 - INFO - Will split into : 0.0 files
2019-07-19 14:27:38,480 - INFO - ERROR -> number sections must be larger than 0.
2019-07-19 14:27:41,194 - INFO - Row 2
2019-07-19 14:27:41,194 - INFO - Filename: A30 Female Lifestyle Buyers
2019-07-19 14:27:41,194 - INFO - Category: 'Hobby &Collection'
2019-07-19 14:27:41,196 - INFO - Last Login: 30
2019-07-19 14:27:41,196 - INFO - Gender: 2,4
2019-07-19 14:27:41,197 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby &Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-19 14:27:41,197 - INFO - Start Running query A30 Female Lifestyle Buyers
2019-07-19 14:27:52,426 - INFO - Running A30 Female Lifestyle Buyers Done
2019-07-19 14:27:52,427 - INFO - CSV file path: A30 Female Lifestyle Buyers
2019-07-19 14:27:52,430 - INFO - Starting save the query results
2019-07-19 14:27:52,430 - INFO - Total Rows : 0
2019-07-19 14:27:52,430 - INFO - Will split into : 0.0 files
2019-07-19 14:27:52,431 - INFO - ERROR -> number sections must be larger than 0.
2019-07-19 14:27:55,237 - INFO - Row 3
2019-07-19 14:27:55,239 - INFO - Filename: A30 Lifestyle Buyers MALE (Sports & Outdoor)
2019-07-19 14:27:55,240 - INFO - Category: 'Sports & Outdoor'
2019-07-19 14:27:55,240 - INFO - Last Login: 30
2019-07-19 14:27:55,240 - INFO - Gender: 1,3
2019-07-19 14:27:55,240 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-19 14:27:55,242 - INFO - Start Running query A30 Lifestyle Buyers MALE (Sports & Outdoor)
2019-07-19 14:29:50,512 - INFO - Running A30 Lifestyle Buyers MALE (Sports & Outdoor) Done
2019-07-19 14:29:50,513 - INFO - CSV file path: A30 Lifestyle Buyers MALE (Sports & Outdoor)
2019-07-19 14:29:50,548 - INFO - Starting save the query results
2019-07-19 14:29:50,549 - INFO - Total Rows : 981683
2019-07-19 14:29:50,549 - INFO - Will split into : 1.0 files
2019-07-19 14:29:54,829 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Lifestyle Buyers MALE (Sports & Outdoor)_1.csv
2019-07-19 14:29:54,831 - INFO - , with total : 981683 rows
2019-07-19 14:29:58,109 - INFO - Row 4
2019-07-19 14:29:58,111 - INFO - Filename: A30 Lifestyle Buyers FEMALE (Sports & Outdoor)
2019-07-19 14:29:58,111 - INFO - Category: 'Sports & Outdoor'
2019-07-19 14:29:58,112 - INFO - Last Login: 30
2019-07-19 14:29:58,112 - INFO - Gender: 2,4
2019-07-19 14:29:58,112 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-19 14:29:58,114 - INFO - Start Running query A30 Lifestyle Buyers FEMALE (Sports & Outdoor)
2019-07-19 14:30:42,819 - INFO - Running A30 Lifestyle Buyers FEMALE (Sports & Outdoor) Done
2019-07-19 14:30:42,821 - INFO - CSV file path: A30 Lifestyle Buyers FEMALE (Sports & Outdoor)
2019-07-19 14:30:42,874 - INFO - Starting save the query results
2019-07-19 14:30:42,875 - INFO - Total Rows : 1533596
2019-07-19 14:30:42,875 - INFO - Will split into : 2.0 files
2019-07-19 14:30:46,256 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Lifestyle Buyers FEMALE (Sports & Outdoor)_1.csv
2019-07-19 14:30:46,256 - INFO - , with total : 766798 rows
2019-07-19 14:30:49,976 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Lifestyle Buyers FEMALE (Sports & Outdoor)_2.csv
2019-07-19 14:30:49,977 - INFO - , with total : 766798 rows
2019-07-19 14:30:53,278 - INFO - Row 5
2019-07-19 14:30:53,279 - INFO - Filename: A30 Fashion Buyers MALE
2019-07-19 14:30:53,279 - INFO - Category: 'Fashion Accedories','Muslim Fashion',' Watch','Men Bags','Men Clothes','Men Shoes'
2019-07-19 14:30:53,279 - INFO - Last Login: 30
2019-07-19 14:30:53,279 - INFO - Gender: 1,3
2019-07-19 14:30:53,280 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accedories','Muslim Fashion',' Watch','Men Bags','Men Clothes','Men Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-19 14:30:53,282 - INFO - Start Running query A30 Fashion Buyers MALE
2019-07-19 14:32:27,976 - INFO - Running A30 Fashion Buyers MALE Done
2019-07-19 14:32:27,977 - INFO - CSV file path: A30 Fashion Buyers MALE
2019-07-19 14:32:28,066 - INFO - Starting save the query results
2019-07-19 14:32:28,069 - INFO - Total Rows : 2540678
2019-07-19 14:32:28,069 - INFO - Will split into : 3.0 files
2019-07-19 14:32:31,793 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers MALE_1.csv
2019-07-19 14:32:31,795 - INFO - , with total : 846893 rows
2019-07-19 14:32:35,901 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers MALE_2.csv
2019-07-19 14:32:35,903 - INFO - , with total : 846893 rows
2019-07-19 14:32:40,164 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers MALE_3.csv
2019-07-19 14:32:40,164 - INFO - , with total : 846892 rows
2019-07-19 14:32:43,608 - INFO - Row 6
2019-07-19 14:32:43,608 - INFO - Filename: A30 Fashion Buyers FEMALE
2019-07-19 14:32:43,608 - INFO - Category: 'Fashion Accedories','Muslim Fashion',' Watch','Women Bags','Women Clothes','Women Shoes'
2019-07-19 14:32:43,609 - INFO - Last Login: 30
2019-07-19 14:32:43,609 - INFO - Gender: 2,4
2019-07-19 14:32:43,611 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accedories','Muslim Fashion',' Watch','Women Bags','Women Clothes','Women Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-19 14:32:43,611 - INFO - Start Running query A30 Fashion Buyers FEMALE
2019-07-19 14:36:12,026 - INFO - Running A30 Fashion Buyers FEMALE Done
2019-07-19 14:36:12,028 - INFO - CSV file path: A30 Fashion Buyers FEMALE
2019-07-19 14:36:12,328 - INFO - Starting save the query results
2019-07-19 14:36:12,329 - INFO - Total Rows : 8088288
2019-07-19 14:36:12,329 - INFO - Will split into : 9.0 files
2019-07-19 14:36:16,388 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers FEMALE_1.csv
2019-07-19 14:36:16,388 - INFO - , with total : 898699 rows
2019-07-19 14:36:20,750 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers FEMALE_2.csv
2019-07-19 14:36:20,752 - INFO - , with total : 898699 rows
2019-07-19 14:36:25,255 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers FEMALE_3.csv
2019-07-19 14:36:25,256 - INFO - , with total : 898699 rows
2019-07-19 14:36:29,801 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers FEMALE_4.csv
2019-07-19 14:36:29,802 - INFO - , with total : 898699 rows
2019-07-19 14:36:34,279 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers FEMALE_5.csv
2019-07-19 14:36:34,282 - INFO - , with total : 898699 rows
2019-07-19 14:36:38,766 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers FEMALE_6.csv
2019-07-19 14:36:38,767 - INFO - , with total : 898699 rows
2019-07-19 14:36:43,211 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers FEMALE_7.csv
2019-07-19 14:36:43,213 - INFO - , with total : 898698 rows
2019-07-19 14:36:47,862 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers FEMALE_8.csv
2019-07-19 14:36:47,864 - INFO - , with total : 898698 rows
2019-07-19 14:36:52,309 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A30 Fashion Buyers FEMALE_9.csv
2019-07-19 14:36:52,309 - INFO - , with total : 898698 rows
2019-07-19 14:36:54,226 - INFO - Delete all data in sheet: Case 4
2019-07-19 14:36:56,543 - INFO - Value detected - use sheet: Case 5
2019-07-19 14:36:56,545 - INFO - Reading Data From Google Sheet...
2019-07-19 14:36:57,267 - INFO - Get custom SQL..
2019-07-19 14:36:57,267 - INFO - USING CASE 5
2019-07-19 14:36:59,608 - INFO - Row 1
2019-07-19 14:36:59,609 - INFO - Filename: A30 Face,Lips,Eyes Cosmetics Buyers
2019-07-19 14:36:59,609 - INFO - Sub-category: 'Face Cosmetics','Lips Cosmetics','Eyes Cosmetics'
2019-07-19 14:36:59,611 - INFO - Last Login: 30
2019-07-19 14:36:59,611 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Face Cosmetics','Lips Cosmetics','Eyes Cosmetics'))
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-19 14:36:59,611 - INFO - Start Running query A30 Face,Lips,Eyes Cosmetics Buyers
2019-07-19 14:36:59,838 - INFO - java.sql.SQLException: Query failed (#20190719_073701_12964_awhya): line 8:107: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 14:36:59,927 - INFO - java.sql.SQLException: Query failed (#20190719_073701_12965_awhya): line 8:107: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 14:37:00,229 - INFO - java.sql.SQLException: Query failed (#20190719_073701_12966_awhya): line 8:107: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 14:37:00,552 - INFO - java.sql.SQLException: Query failed (#20190719_073701_12968_awhya): line 8:107: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 14:37:00,687 - INFO - java.sql.SQLException: Query failed (#20190719_073701_12969_awhya): line 8:107: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 14:37:00,688 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-19 14:37:01,448 - INFO - Delete all data in sheet: Case 5
2019-07-19 14:37:03,727 - INFO - No value detected on sheet: Case 6
2019-07-19 14:37:05,223 - INFO - No value detected on sheet: Case 7
2019-07-19 14:37:06,743 - INFO - No value detected on sheet: Case 8
2019-07-19 14:37:08,210 - INFO - Value detected - use sheet: Case 9
2019-07-19 14:37:08,213 - INFO - Reading Data From Google Sheet...
2019-07-19 14:37:08,940 - INFO - Get custom SQL..
2019-07-19 14:37:08,941 - INFO - USING CASE 9
2019-07-19 14:37:11,280 - INFO - Row 1
2019-07-19 14:37:11,282 - INFO - Filename: A1 Fashion buyers who haven't shopped DP 
2019-07-19 14:37:11,282 - INFO - Last Login: 1
2019-07-19 14:37:11,283 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes') 
                                    and
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-19 14:37:11,285 - INFO - Start Running query A1 Fashion buyers who haven't shopped DP 
2019-07-19 14:39:05,025 - INFO - Running A1 Fashion buyers who haven't shopped DP  Done
2019-07-19 14:39:05,026 - INFO - CSV file path: A1 Fashion buyers who haven't shopped DP 
2019-07-19 14:39:05,180 - INFO - Starting save the query results
2019-07-19 14:39:05,180 - INFO - Total Rows : 4259421
2019-07-19 14:39:05,181 - INFO - Will split into : 5.0 files
2019-07-19 14:39:08,993 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A1 Fashion buyers who haven't shopped DP _1.csv
2019-07-19 14:39:08,994 - INFO - , with total : 851885 rows
2019-07-19 14:39:13,194 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A1 Fashion buyers who haven't shopped DP _2.csv
2019-07-19 14:39:13,196 - INFO - , with total : 851884 rows
2019-07-19 14:39:17,414 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A1 Fashion buyers who haven't shopped DP _3.csv
2019-07-19 14:39:17,415 - INFO - , with total : 851884 rows
2019-07-19 14:39:21,647 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A1 Fashion buyers who haven't shopped DP _4.csv
2019-07-19 14:39:21,648 - INFO - , with total : 851884 rows
2019-07-19 14:39:25,890 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A1 Fashion buyers who haven't shopped DP _5.csv
2019-07-19 14:39:25,891 - INFO - , with total : 851884 rows
2019-07-19 14:39:29,628 - INFO - Row 2
2019-07-19 14:39:29,628 - INFO - Filename: A1 FMCG buyers who haven't shopped DP
2019-07-19 14:39:29,628 - INFO - Last Login: 1
2019-07-19 14:39:29,630 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty','Cosmetics','Food & Beverages','Health','Health & Beauty','Mom & Baby') 
                                    and
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-19 14:39:29,631 - INFO - Start Running query A1 FMCG buyers who haven't shopped DP
2019-07-19 14:40:57,911 - INFO - Running A1 FMCG buyers who haven't shopped DP Done
2019-07-19 14:40:57,911 - INFO - CSV file path: A1 FMCG buyers who haven't shopped DP
2019-07-19 14:40:58,036 - INFO - Starting save the query results
2019-07-19 14:40:58,036 - INFO - Total Rows : 3438543
2019-07-19 14:40:58,036 - INFO - Will split into : 4.0 files
2019-07-19 14:41:01,851 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A1 FMCG buyers who haven't shopped DP_1.csv
2019-07-19 14:41:01,852 - INFO - , with total : 859636 rows
2019-07-19 14:41:06,029 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A1 FMCG buyers who haven't shopped DP_2.csv
2019-07-19 14:41:06,029 - INFO - , with total : 859636 rows
2019-07-19 14:41:10,328 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A1 FMCG buyers who haven't shopped DP_3.csv
2019-07-19 14:41:10,328 - INFO - , with total : 859636 rows
2019-07-19 14:41:14,642 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 14.00/A1 FMCG buyers who haven't shopped DP_4.csv
2019-07-19 14:41:14,642 - INFO - , with total : 859635 rows
2019-07-19 14:41:15,704 - INFO - Delete all data in sheet: Case 9
2019-07-19 17:00:11,489 - INFO - Report date: 20190719 17.00
2019-07-19 17:00:14,634 - INFO - Download sheet..
2019-07-19 17:00:14,634 - INFO - Change directory to script path
2019-07-19 17:00:15,923 - INFO - Spreadsheet downloaded
2019-07-19 17:00:15,924 - INFO - Checking sheet..
2019-07-19 17:00:17,839 - INFO - Value detected - use sheet: Case 1
2019-07-19 17:00:17,842 - INFO - Reading Data From Google Sheet...
2019-07-19 17:00:18,566 - INFO - Get custom SQL..
2019-07-19 17:00:18,568 - INFO - USING CASE 1
2019-07-19 17:00:20,961 - INFO - Row 1
2019-07-19 17:00:20,963 - INFO - Filename: A14  FMCG Buyers
2019-07-19 17:00:20,963 - INFO - Category: 'Food & Beverages & Beauty'
2019-07-19 17:00:20,963 - INFO - Last Login: 14
2019-07-19 17:00:20,964 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages & Beauty')
                                    and
                                    last_login >= current_date - interval '14' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-19 17:00:20,964 - INFO - Start Running query A14  FMCG Buyers
2019-07-19 17:00:25,315 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:25,371 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:25,394 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:25,420 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:25,444 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:25,446 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-19 17:00:28,437 - INFO - Row 2
2019-07-19 17:00:28,438 - INFO - Filename: A30 EL Buyers
2019-07-19 17:00:28,438 - INFO - Category: 'Computer & Accessories'
2019-07-19 17:00:28,440 - INFO - Last Login: 30
2019-07-19 17:00:28,440 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Computer & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-19 17:00:28,440 - INFO - Start Running query A30 EL Buyers
2019-07-19 17:00:28,463 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:28,486 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:28,509 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:28,530 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:28,555 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:28,556 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-19 17:00:28,959 - INFO - Delete all data in sheet: Case 1
2019-07-19 17:00:30,540 - INFO - No value detected on sheet: Case 2
2019-07-19 17:00:31,660 - INFO - No value detected on sheet: Case 3
2019-07-19 17:00:33,154 - INFO - Value detected - use sheet: Case 4
2019-07-19 17:00:33,154 - INFO - Reading Data From Google Sheet...
2019-07-19 17:00:33,543 - INFO - Get custom SQL..
2019-07-19 17:00:33,545 - INFO - USING CASE 4
2019-07-19 17:00:35,818 - INFO - Row 1
2019-07-19 17:00:35,819 - INFO - Filename: A30 MALE Lifestyle Buyers (Hobi & Collection)
2019-07-19 17:00:35,819 - INFO - Category: 'Hobby & Collection'
2019-07-19 17:00:35,819 - INFO - Last Login: 30
2019-07-19 17:00:35,819 - INFO - Gender: 1,3
2019-07-19 17:00:35,821 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-19 17:00:35,821 - INFO - Start Running query A30 MALE Lifestyle Buyers (Hobi & Collection)
2019-07-19 17:00:35,844 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:35,867 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:35,891 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:35,914 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:35,937 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:35,940 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-19 17:00:39,482 - INFO - Row 2
2019-07-19 17:00:39,483 - INFO - Filename: A30 FEMALE Lifestyle Buyers (Hobi & Collection)
2019-07-19 17:00:39,483 - INFO - Category: 'Hobby & Collection'
2019-07-19 17:00:39,484 - INFO - Last Login: 30
2019-07-19 17:00:39,484 - INFO - Gender: 2,4
2019-07-19 17:00:39,484 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-19 17:00:39,486 - INFO - Start Running query A30 FEMALE Lifestyle Buyers (Hobi & Collection)
2019-07-19 17:00:39,509 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:39,532 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:39,556 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:39,591 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:39,614 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:39,615 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-19 17:00:42,344 - INFO - Row 3
2019-07-19 17:00:42,345 - INFO - Filename: A30 Fashion Buyers MALE (PN Sunday)
2019-07-19 17:00:42,345 - INFO - Category: 'Fashion Accessories','Muslim Fashion','Watches','Men Bags','Men Clothes','Men Shoes'
2019-07-19 17:00:42,345 - INFO - Last Login: 30
2019-07-19 17:00:42,345 - INFO - Gender: 1,3
2019-07-19 17:00:42,346 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories','Muslim Fashion','Watches','Men Bags','Men Clothes','Men Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-19 17:00:42,346 - INFO - Start Running query A30 Fashion Buyers MALE (PN Sunday)
2019-07-19 17:00:42,371 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:42,394 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:42,502 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:42,525 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:42,546 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:42,548 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-19 17:00:45,250 - INFO - Row 4
2019-07-19 17:00:45,252 - INFO - Filename: A30 Fashion Buyers FEMALE (PN Sunday)
2019-07-19 17:00:45,253 - INFO - Category: 'Fashion Accessories','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes'
2019-07-19 17:00:45,253 - INFO - Last Login: 30
2019-07-19 17:00:45,253 - INFO - Gender: 2,4
2019-07-19 17:00:45,253 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-19 17:00:45,255 - INFO - Start Running query A30 Fashion Buyers FEMALE (PN Sunday)
2019-07-19 17:00:45,276 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:45,302 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:45,325 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:45,346 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:45,368 - INFO - java.sql.SQLException: Error executing query
2019-07-19 17:00:45,369 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-19 17:00:45,783 - INFO - Delete all data in sheet: Case 4
2019-07-19 17:00:47,059 - INFO - No value detected on sheet: Case 5
2019-07-19 17:00:48,203 - INFO - No value detected on sheet: Case 6
2019-07-19 17:00:49,046 - INFO - No value detected on sheet: Case 7
2019-07-19 17:00:49,868 - INFO - No value detected on sheet: Case 8
2019-07-19 17:00:50,670 - INFO - No value detected on sheet: Case 9
2019-07-19 18:36:14,084 - INFO - Report date: 20190719 18.36
2019-07-19 18:36:14,124 - INFO - Download sheet..
2019-07-19 18:36:14,128 - INFO - Change directory to script path
2019-07-19 18:36:16,256 - INFO - Spreadsheet downloaded
2019-07-19 18:36:16,256 - INFO - Checking sheet..
2019-07-19 18:36:18,617 - INFO - Value detected - use sheet: Case 1
2019-07-19 18:36:18,621 - INFO - Reading Data From Google Sheet...
2019-07-19 18:36:19,377 - INFO - Get custom SQL..
2019-07-19 18:36:19,377 - INFO - USING CASE 1
2019-07-19 18:36:21,900 - INFO - Row 1
2019-07-19 18:36:21,900 - INFO - Filename: A30 EL buyers
2019-07-19 18:36:21,900 - INFO - Category: 'Computer & Accesories'
2019-07-19 18:36:21,900 - INFO - Last Login: 30
2019-07-19 18:36:21,900 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Computer & Accesories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-19 18:36:21,904 - INFO - Start Running query A30 EL buyers
2019-07-19 18:36:30,476 - INFO - Running A30 EL buyers Done
2019-07-19 18:36:30,476 - INFO - CSV file path: A30 EL buyers
2019-07-19 18:36:30,500 - INFO - Starting save the query results
2019-07-19 18:36:30,500 - INFO - Total Rows : 0
2019-07-19 18:36:30,505 - INFO - Will split into : 0.0 files
2019-07-19 18:36:30,505 - INFO - ERROR -> number sections must be larger than 0.
2019-07-19 18:36:33,477 - INFO - Row 2
2019-07-19 18:36:33,482 - INFO - Filename: A30 FMCG Buyers
2019-07-19 18:36:33,482 - INFO - Category: 'Food & Beverages '
2019-07-19 18:36:33,482 - INFO - Last Login: 30
2019-07-19 18:36:33,482 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages ')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-19 18:36:33,486 - INFO - Start Running query A30 FMCG Buyers
2019-07-19 18:36:38,118 - INFO - Running A30 FMCG Buyers Done
2019-07-19 18:36:38,118 - INFO - CSV file path: A30 FMCG Buyers
2019-07-19 18:36:38,122 - INFO - Starting save the query results
2019-07-19 18:36:38,122 - INFO - Total Rows : 0
2019-07-19 18:36:38,127 - INFO - Will split into : 0.0 files
2019-07-19 18:36:38,127 - INFO - ERROR -> number sections must be larger than 0.
2019-07-19 18:36:41,119 - INFO - Row 3
2019-07-19 18:36:41,124 - INFO - Filename: A30 FMCG Buyers
2019-07-19 18:36:41,124 - INFO - Category: 'Beauty'
2019-07-19 18:36:41,128 - INFO - Last Login: 30
2019-07-19 18:36:41,128 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-19 18:36:41,131 - INFO - Start Running query A30 FMCG Buyers
2019-07-19 18:39:36,313 - INFO - Running A30 FMCG Buyers Done
2019-07-19 18:42:49,871 - INFO - CSV file path: A30 FMCG Buyers
2019-07-19 18:42:50,431 - INFO - Starting save the query results
2019-07-19 18:42:50,431 - INFO - Total Rows : 7133583
2019-07-19 18:42:50,431 - INFO - Will split into : 8.0 files
2019-07-19 18:42:54,700 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 FMCG Buyers_1.csv
2019-07-19 18:42:54,700 - INFO - , with total : 891698 rows
2019-07-19 18:42:59,260 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 FMCG Buyers_2.csv
2019-07-19 18:42:59,265 - INFO - , with total : 891698 rows
2019-07-19 18:43:04,213 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 FMCG Buyers_3.csv
2019-07-19 18:43:04,213 - INFO - , with total : 891698 rows
2019-07-19 18:43:10,096 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 FMCG Buyers_4.csv
2019-07-19 18:43:10,101 - INFO - , with total : 891698 rows
2019-07-19 18:43:15,233 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 FMCG Buyers_5.csv
2019-07-19 18:43:15,236 - INFO - , with total : 891698 rows
2019-07-19 18:43:21,101 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 FMCG Buyers_6.csv
2019-07-19 18:43:21,105 - INFO - , with total : 891698 rows
2019-07-19 18:43:26,265 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 FMCG Buyers_7.csv
2019-07-19 18:43:26,265 - INFO - , with total : 891698 rows
2019-07-19 18:43:31,467 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 FMCG Buyers_8.csv
2019-07-19 18:43:31,467 - INFO - , with total : 891697 rows
2019-07-19 18:43:35,390 - INFO - Row 4
2019-07-19 18:43:35,390 - INFO - Filename: A14 Fashion Buyers
2019-07-19 18:43:35,390 - INFO - Category: 'Fashion'
2019-07-19 18:43:35,390 - INFO - Last Login: 14
2019-07-19 18:43:35,394 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion')
                                    and
                                    last_login >= current_date - interval '14' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-19 18:43:35,394 - INFO - Start Running query A14 Fashion Buyers
2019-07-19 18:43:41,640 - INFO - Running A14 Fashion Buyers Done
2019-07-19 18:43:41,640 - INFO - CSV file path: A14 Fashion Buyers
2019-07-19 18:43:41,648 - INFO - Starting save the query results
2019-07-19 18:43:41,648 - INFO - Total Rows : 0
2019-07-19 18:43:41,648 - INFO - Will split into : 0.0 files
2019-07-19 18:43:41,651 - INFO - ERROR -> number sections must be larger than 0.
2019-07-19 18:43:42,385 - INFO - Delete all data in sheet: Case 1
2019-07-19 18:43:44,605 - INFO - No value detected on sheet: Case 2
2019-07-19 18:43:46,082 - INFO - No value detected on sheet: Case 3
2019-07-19 18:43:47,539 - INFO - Value detected - use sheet: Case 4
2019-07-19 18:43:47,539 - INFO - Reading Data From Google Sheet...
2019-07-19 18:43:48,262 - INFO - Get custom SQL..
2019-07-19 18:43:48,262 - INFO - USING CASE 4
2019-07-19 18:43:51,197 - INFO - Row 1
2019-07-19 18:43:51,197 - INFO - Filename: A30 MALE Lifestyle Buyers (Hobi & Collection)
2019-07-19 18:43:51,197 - INFO - Category: 'Hobby & Collection'
2019-07-19 18:43:51,201 - INFO - Last Login: 30
2019-07-19 18:43:51,201 - INFO - Gender: 1,3
2019-07-19 18:43:51,201 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-19 18:43:51,201 - INFO - Start Running query A30 MALE Lifestyle Buyers (Hobi & Collection)
2019-07-19 18:44:07,292 - INFO - Running A30 MALE Lifestyle Buyers (Hobi & Collection) Done
2019-07-19 18:44:07,296 - INFO - CSV file path: A30 MALE Lifestyle Buyers (Hobi & Collection)
2019-07-19 18:44:07,341 - INFO - Starting save the query results
2019-07-19 18:44:07,341 - INFO - Total Rows : 531152
2019-07-19 18:44:07,345 - INFO - Will split into : 1.0 files
2019-07-19 18:44:10,032 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 MALE Lifestyle Buyers (Hobi & Collection)_1.csv
2019-07-19 18:44:10,032 - INFO - , with total : 531152 rows
2019-07-19 18:44:14,233 - INFO - Row 2
2019-07-19 18:44:14,233 - INFO - Filename: A30 FEMALE Lifestyle Buyers (Hobi & Collection)
2019-07-19 18:44:14,233 - INFO - Category: 'Hobby & Collection'
2019-07-19 18:44:14,233 - INFO - Last Login: 30
2019-07-19 18:44:14,233 - INFO - Gender: 2,4
2019-07-19 18:44:14,236 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-19 18:44:14,236 - INFO - Start Running query A30 FEMALE Lifestyle Buyers (Hobi & Collection)
2019-07-19 18:44:54,746 - INFO - Running A30 FEMALE Lifestyle Buyers (Hobi & Collection) Done
2019-07-19 18:44:54,750 - INFO - CSV file path: A30 FEMALE Lifestyle Buyers (Hobi & Collection)
2019-07-19 18:44:54,871 - INFO - Starting save the query results
2019-07-19 18:44:54,875 - INFO - Total Rows : 1464455
2019-07-19 18:44:54,875 - INFO - Will split into : 2.0 files
2019-07-19 18:44:58,474 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 FEMALE Lifestyle Buyers (Hobi & Collection)_1.csv
2019-07-19 18:44:58,474 - INFO - , with total : 732228 rows
2019-07-19 18:45:02,233 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 FEMALE Lifestyle Buyers (Hobi & Collection)_2.csv
2019-07-19 18:45:02,233 - INFO - , with total : 732227 rows
2019-07-19 18:45:05,993 - INFO - Row 3
2019-07-19 18:45:05,993 - INFO - Filename: A30 Fashion Buyers MALE (PN Sunday)
2019-07-19 18:45:05,993 - INFO - Category: 'Fashion Accessories','Muslim Fashion','Watches','Men Bags','Men Clothes','Men Shoes'
2019-07-19 18:45:05,996 - INFO - Last Login: 30
2019-07-19 18:45:05,996 - INFO - Gender: 1,3
2019-07-19 18:45:05,996 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories','Muslim Fashion','Watches','Men Bags','Men Clothes','Men Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-19 18:45:06,000 - INFO - Start Running query A30 Fashion Buyers MALE (PN Sunday)
2019-07-19 18:46:18,737 - INFO - Running A30 Fashion Buyers MALE (PN Sunday) Done
2019-07-19 18:46:18,742 - INFO - CSV file path: A30 Fashion Buyers MALE (PN Sunday)
2019-07-19 18:46:18,950 - INFO - Starting save the query results
2019-07-19 18:46:18,950 - INFO - Total Rows : 2865847
2019-07-19 18:46:18,950 - INFO - Will split into : 3.0 files
2019-07-19 18:46:23,487 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers MALE (PN Sunday)_1.csv
2019-07-19 18:46:23,487 - INFO - , with total : 955283 rows
2019-07-19 18:46:28,359 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers MALE (PN Sunday)_2.csv
2019-07-19 18:46:28,359 - INFO - , with total : 955282 rows
2019-07-19 18:46:36,961 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers MALE (PN Sunday)_3.csv
2019-07-19 18:46:36,966 - INFO - , with total : 955282 rows
2019-07-19 18:46:40,921 - INFO - Row 4
2019-07-19 18:46:40,924 - INFO - Filename: A30 Fashion Buyers FEMALE (PN Sunday)
2019-07-19 18:46:40,924 - INFO - Category: 'Fashion Accessories','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes'
2019-07-19 18:46:40,924 - INFO - Last Login: 30
2019-07-19 18:46:40,928 - INFO - Gender: 2,4
2019-07-19 18:46:40,928 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-19 18:46:40,928 - INFO - Start Running query A30 Fashion Buyers FEMALE (PN Sunday)
2019-07-19 18:50:14,553 - INFO - Running A30 Fashion Buyers FEMALE (PN Sunday) Done
2019-07-19 18:50:14,558 - INFO - CSV file path: A30 Fashion Buyers FEMALE (PN Sunday)
2019-07-19 18:50:15,266 - INFO - Starting save the query results
2019-07-19 18:50:15,266 - INFO - Total Rows : 8544185
2019-07-19 18:50:15,266 - INFO - Will split into : 9.0 files
2019-07-19 18:50:23,638 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers FEMALE (PN Sunday)_1.csv
2019-07-19 18:50:23,638 - INFO - , with total : 949354 rows
2019-07-19 18:50:30,482 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers FEMALE (PN Sunday)_2.csv
2019-07-19 18:50:30,482 - INFO - , with total : 949354 rows
2019-07-19 18:50:37,769 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers FEMALE (PN Sunday)_3.csv
2019-07-19 18:50:37,769 - INFO - , with total : 949354 rows
2019-07-19 18:50:44,756 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers FEMALE (PN Sunday)_4.csv
2019-07-19 18:50:44,756 - INFO - , with total : 949354 rows
2019-07-19 18:50:50,401 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers FEMALE (PN Sunday)_5.csv
2019-07-19 18:50:50,405 - INFO - , with total : 949354 rows
2019-07-19 18:50:56,243 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers FEMALE (PN Sunday)_6.csv
2019-07-19 18:50:56,243 - INFO - , with total : 949354 rows
2019-07-19 18:51:02,052 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers FEMALE (PN Sunday)_7.csv
2019-07-19 18:51:02,052 - INFO - , with total : 949354 rows
2019-07-19 18:51:07,926 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers FEMALE (PN Sunday)_8.csv
2019-07-19 18:51:07,926 - INFO - , with total : 949354 rows
2019-07-19 18:51:13,555 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190719 18.36/A30 Fashion Buyers FEMALE (PN Sunday)_9.csv
2019-07-19 18:51:13,555 - INFO - , with total : 949353 rows
2019-07-19 18:51:15,582 - INFO - Delete all data in sheet: Case 4
2019-07-19 18:51:17,802 - INFO - Value detected - use sheet: Case 5
2019-07-19 18:51:17,802 - INFO - Reading Data From Google Sheet...
2019-07-19 18:51:18,507 - INFO - Get custom SQL..
2019-07-19 18:51:18,510 - INFO - USING CASE 5
2019-07-19 18:51:20,724 - INFO - Row 1
2019-07-19 18:51:20,724 - INFO - Filename: A30 Gaming buyers
2019-07-19 18:51:20,724 - INFO - Sub-category: 'Video Games','Gaming'
2019-07-19 18:51:20,724 - INFO - Last Login: 30
2019-07-19 18:51:20,729 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Video Games','Gaming'))
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-19 18:51:20,729 - INFO - Start Running query A30 Gaming buyers
2019-07-19 18:51:21,017 - INFO - java.sql.SQLException: Query failed (#20190719_115122_20092_awhya): line 8:79: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 18:51:21,122 - INFO - java.sql.SQLException: Query failed (#20190719_115122_20093_awhya): line 8:79: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 18:51:21,223 - INFO - java.sql.SQLException: Query failed (#20190719_115122_20094_awhya): line 8:79: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 18:51:21,342 - INFO - java.sql.SQLException: Query failed (#20190719_115122_20095_awhya): line 8:79: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 18:51:21,430 - INFO - java.sql.SQLException: Query failed (#20190719_115122_20096_awhya): line 8:79: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 18:51:21,430 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-19 18:51:24,380 - INFO - Row 2
2019-07-19 18:51:24,380 - INFO - Filename: A30 Voucher buyers
2019-07-19 18:51:24,380 - INFO - Sub-category: 'Gaming'
2019-07-19 18:51:24,384 - INFO - Last Login: 30
2019-07-19 18:51:24,384 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Gaming'))
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-19 18:51:24,384 - INFO - Start Running query A30 Voucher buyers
2019-07-19 18:51:24,471 - INFO - java.sql.SQLException: Query failed (#20190719_115125_20098_awhya): line 8:65: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 18:51:24,569 - INFO - java.sql.SQLException: Query failed (#20190719_115125_20101_awhya): line 8:65: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 18:51:24,661 - INFO - java.sql.SQLException: Query failed (#20190719_115125_20102_awhya): line 8:65: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 18:51:24,755 - INFO - java.sql.SQLException: Query failed (#20190719_115125_20103_awhya): line 8:65: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 18:51:24,855 - INFO - java.sql.SQLException: Query failed (#20190719_115126_20104_awhya): line 8:65: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-19 18:51:24,855 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-19 18:51:25,615 - INFO - Delete all data in sheet: Case 5
2019-07-19 18:51:27,664 - INFO - No value detected on sheet: Case 6
2019-07-19 18:51:29,325 - INFO - No value detected on sheet: Case 7
2019-07-19 18:51:30,114 - INFO - No value detected on sheet: Case 8
2019-07-19 18:51:31,565 - INFO - No value detected on sheet: Case 9
2019-07-20 10:00:04,825 - INFO - Report date: 20190720 10.00
2019-07-20 10:00:12,579 - INFO - Download sheet..
2019-07-20 10:00:12,579 - INFO - Change directory to script path
2019-07-20 10:00:14,259 - INFO - Spreadsheet downloaded
2019-07-20 10:00:14,260 - INFO - Checking sheet..
2019-07-20 10:00:16,046 - INFO - No value detected on sheet: Case 1
2019-07-20 10:00:17,430 - INFO - No value detected on sheet: Case 2
2019-07-20 10:00:18,759 - INFO - No value detected on sheet: Case 3
2019-07-20 10:00:20,223 - INFO - No value detected on sheet: Case 4
2019-07-20 10:00:21,792 - INFO - No value detected on sheet: Case 5
2019-07-20 10:00:23,414 - INFO - No value detected on sheet: Case 6
2019-07-20 10:00:24,730 - INFO - No value detected on sheet: Case 7
2019-07-20 10:00:26,039 - INFO - No value detected on sheet: Case 8
2019-07-20 10:00:27,520 - INFO - No value detected on sheet: Case 9
2019-07-20 14:00:02,336 - INFO - Report date: 20190720 14.00
2019-07-20 14:00:05,813 - INFO - Download sheet..
2019-07-20 14:00:05,815 - INFO - Change directory to script path
2019-07-20 14:00:07,378 - INFO - Spreadsheet downloaded
2019-07-20 14:00:07,378 - INFO - Checking sheet..
2019-07-20 14:00:09,059 - INFO - No value detected on sheet: Case 1
2019-07-20 14:00:10,368 - INFO - No value detected on sheet: Case 2
2019-07-20 14:00:11,667 - INFO - No value detected on sheet: Case 3
2019-07-20 14:00:12,961 - INFO - No value detected on sheet: Case 4
2019-07-20 14:00:14,272 - INFO - No value detected on sheet: Case 5
2019-07-20 14:00:15,579 - INFO - No value detected on sheet: Case 6
2019-07-20 14:00:16,904 - INFO - No value detected on sheet: Case 7
2019-07-20 14:00:18,203 - INFO - No value detected on sheet: Case 8
2019-07-20 14:00:19,503 - INFO - No value detected on sheet: Case 9
2019-07-20 17:00:02,351 - INFO - Report date: 20190720 17.00
2019-07-20 17:00:06,111 - INFO - Download sheet..
2019-07-20 17:00:06,112 - INFO - Change directory to script path
2019-07-20 17:00:07,529 - INFO - Spreadsheet downloaded
2019-07-20 17:00:07,530 - INFO - Checking sheet..
2019-07-20 17:00:09,230 - INFO - No value detected on sheet: Case 1
2019-07-20 17:00:10,551 - INFO - No value detected on sheet: Case 2
2019-07-20 17:00:11,801 - INFO - No value detected on sheet: Case 3
2019-07-20 17:00:13,072 - INFO - No value detected on sheet: Case 4
2019-07-20 17:00:14,342 - INFO - No value detected on sheet: Case 5
2019-07-20 17:00:15,736 - INFO - No value detected on sheet: Case 6
2019-07-20 17:00:17,384 - INFO - No value detected on sheet: Case 7
2019-07-20 17:00:18,641 - INFO - No value detected on sheet: Case 8
2019-07-20 17:00:19,924 - INFO - No value detected on sheet: Case 9
2019-07-21 10:00:02,681 - INFO - Report date: 20190721 10.00
2019-07-21 10:00:06,532 - INFO - Download sheet..
2019-07-21 10:00:06,532 - INFO - Change directory to script path
2019-07-21 10:00:08,147 - INFO - Spreadsheet downloaded
2019-07-21 10:00:08,148 - INFO - Checking sheet..
2019-07-21 10:00:09,813 - INFO - No value detected on sheet: Case 1
2019-07-21 10:00:11,144 - INFO - No value detected on sheet: Case 2
2019-07-21 10:00:12,437 - INFO - No value detected on sheet: Case 3
2019-07-21 10:00:13,716 - INFO - No value detected on sheet: Case 4
2019-07-21 10:00:15,056 - INFO - No value detected on sheet: Case 5
2019-07-21 10:00:16,358 - INFO - No value detected on sheet: Case 6
2019-07-21 10:00:17,678 - INFO - No value detected on sheet: Case 7
2019-07-21 10:00:18,982 - INFO - No value detected on sheet: Case 8
2019-07-21 10:00:20,312 - INFO - No value detected on sheet: Case 9
2019-07-21 14:00:02,608 - INFO - Report date: 20190721 14.00
2019-07-21 14:00:06,631 - INFO - Download sheet..
2019-07-21 14:00:06,632 - INFO - Change directory to script path
2019-07-21 14:00:08,000 - INFO - Spreadsheet downloaded
2019-07-21 14:00:08,000 - INFO - Checking sheet..
2019-07-21 14:00:09,697 - INFO - No value detected on sheet: Case 1
2019-07-21 14:00:11,010 - INFO - No value detected on sheet: Case 2
2019-07-21 14:00:12,322 - INFO - No value detected on sheet: Case 3
2019-07-21 14:00:13,585 - INFO - No value detected on sheet: Case 4
2019-07-21 14:00:14,855 - INFO - No value detected on sheet: Case 5
2019-07-21 14:00:16,135 - INFO - No value detected on sheet: Case 6
2019-07-21 14:00:17,441 - INFO - No value detected on sheet: Case 7
2019-07-21 14:00:18,733 - INFO - No value detected on sheet: Case 8
2019-07-21 14:00:20,012 - INFO - No value detected on sheet: Case 9
2019-07-21 17:00:02,526 - INFO - Report date: 20190721 17.00
2019-07-21 17:00:07,345 - INFO - Download sheet..
2019-07-21 17:00:07,345 - INFO - Change directory to script path
2019-07-21 17:00:08,720 - INFO - Spreadsheet downloaded
2019-07-21 17:00:08,721 - INFO - Checking sheet..
2019-07-21 17:00:10,404 - INFO - No value detected on sheet: Case 1
2019-07-21 17:00:11,680 - INFO - No value detected on sheet: Case 2
2019-07-21 17:00:12,967 - INFO - No value detected on sheet: Case 3
2019-07-21 17:00:14,234 - INFO - No value detected on sheet: Case 4
2019-07-21 17:00:15,628 - INFO - No value detected on sheet: Case 5
2019-07-21 17:00:16,894 - INFO - No value detected on sheet: Case 6
2019-07-21 17:00:18,210 - INFO - No value detected on sheet: Case 7
2019-07-21 17:00:19,493 - INFO - No value detected on sheet: Case 8
2019-07-21 17:00:20,770 - INFO - No value detected on sheet: Case 9
2019-07-22 10:00:02,980 - INFO - Report date: 20190722 10.00
2019-07-22 10:00:06,022 - INFO - Download sheet..
2019-07-22 10:00:06,023 - INFO - Change directory to script path
2019-07-22 10:00:07,532 - INFO - Spreadsheet downloaded
2019-07-22 10:00:07,533 - INFO - Checking sheet..
2019-07-22 10:00:09,243 - INFO - No value detected on sheet: Case 1
2019-07-22 10:00:10,686 - INFO - No value detected on sheet: Case 2
2019-07-22 10:00:11,973 - INFO - No value detected on sheet: Case 3
2019-07-22 10:00:13,262 - INFO - No value detected on sheet: Case 4
2019-07-22 10:00:14,828 - INFO - No value detected on sheet: Case 5
2019-07-22 10:00:16,128 - INFO - No value detected on sheet: Case 6
2019-07-22 10:00:17,440 - INFO - No value detected on sheet: Case 7
2019-07-22 10:00:18,713 - INFO - No value detected on sheet: Case 8
2019-07-22 10:00:20,015 - INFO - No value detected on sheet: Case 9
2019-07-22 11:40:39,108 - INFO - Report date: 20190722 11.40
2019-07-22 11:40:39,615 - INFO - Download sheet..
2019-07-22 11:40:39,615 - INFO - Change directory to script path
2019-07-22 11:41:03,709 - INFO - Report date: 20190722 11.41
2019-07-22 11:41:03,737 - INFO - Download sheet..
2019-07-22 11:41:03,739 - INFO - Change directory to script path
2019-07-22 11:41:05,602 - INFO - Spreadsheet downloaded
2019-07-22 11:41:05,604 - INFO - Checking sheet..
2019-07-22 11:41:07,572 - INFO - No value detected on sheet: Case 1
2019-07-22 11:41:08,915 - INFO - No value detected on sheet: Case 2
2019-07-22 11:41:10,262 - INFO - No value detected on sheet: Case 3
2019-07-22 11:41:11,569 - INFO - Value detected - use sheet: Case 4
2019-07-22 11:41:11,579 - INFO - Reading Data From Google Sheet...
2019-07-22 11:41:12,219 - INFO - Get custom SQL..
2019-07-22 11:41:12,220 - INFO - USING CASE 4
2019-07-22 11:41:14,819 - INFO - Row 1
2019-07-22 11:41:14,819 - INFO - Filename: A30 Female Muslim Fashion Buyers
2019-07-22 11:41:14,819 - INFO - Category: 'Muslim Fashion'
2019-07-22 11:41:14,819 - INFO - Last Login: 30
2019-07-22 11:41:14,822 - INFO - Gender: 2,4
2019-07-22 11:41:14,822 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Muslim Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-22 11:41:14,822 - INFO - Start Running query A30 Female Muslim Fashion Buyers
2019-07-22 11:50:02,835 - INFO - Running A30 Female Muslim Fashion Buyers Done
2019-07-22 11:50:02,835 - INFO - CSV file path: A30 Female Muslim Fashion Buyers
2019-07-22 11:50:03,055 - INFO - Starting save the query results
2019-07-22 11:50:03,055 - INFO - Total Rows : 4773955
2019-07-22 11:50:03,056 - INFO - Will split into : 5.0 files
2019-07-22 11:50:08,678 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 11.41/A30 Female Muslim Fashion Buyers_1.csv
2019-07-22 11:50:08,678 - INFO - , with total : 954791 rows
2019-07-22 11:50:13,575 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 11.41/A30 Female Muslim Fashion Buyers_2.csv
2019-07-22 11:50:13,576 - INFO - , with total : 954791 rows
2019-07-22 11:50:24,681 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 11.41/A30 Female Muslim Fashion Buyers_3.csv
2019-07-22 11:50:24,684 - INFO - , with total : 954791 rows
2019-07-22 11:50:35,605 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 11.41/A30 Female Muslim Fashion Buyers_4.csv
2019-07-22 11:50:35,608 - INFO - , with total : 954791 rows
2019-07-22 11:50:42,948 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 11.41/A30 Female Muslim Fashion Buyers_5.csv
2019-07-22 11:50:42,951 - INFO - , with total : 954791 rows
2019-07-22 11:50:44,030 - INFO - Delete all data in sheet: Case 4
2019-07-22 11:50:46,132 - INFO - Value detected - use sheet: Case 5
2019-07-22 11:50:46,134 - INFO - Reading Data From Google Sheet...
2019-07-22 11:50:46,779 - INFO - Get custom SQL..
2019-07-22 11:50:46,779 - INFO - USING CASE 5
2019-07-22 11:50:49,007 - INFO - Row 1
2019-07-22 11:50:49,009 - INFO - Filename: A30 Gaming buyers
2019-07-22 11:50:49,009 - INFO - Sub-category: 'Video Games','Gaming'
2019-07-22 11:50:49,009 - INFO - Last Login: 30
2019-07-22 11:50:49,009 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Video Games','Gaming'))
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-22 11:50:49,012 - INFO - Start Running query A30 Gaming buyers
2019-07-22 11:50:49,280 - INFO - java.sql.SQLException: Query failed (#20190722_045049_09287_awhya): line 8:79: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-22 11:50:49,421 - INFO - java.sql.SQLException: Query failed (#20190722_045049_09288_awhya): line 8:79: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-22 11:50:49,565 - INFO - java.sql.SQLException: Query failed (#20190722_045050_09289_awhya): line 8:79: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-22 11:50:49,698 - INFO - java.sql.SQLException: Query failed (#20190722_045050_09290_awhya): line 8:79: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-22 11:50:49,851 - INFO - java.sql.SQLException: Query failed (#20190722_045050_09291_awhya): line 8:79: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-22 11:50:49,851 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-22 11:50:52,516 - INFO - Row 2
2019-07-22 11:50:52,517 - INFO - Filename: A30 Voucher buyers
2019-07-22 11:50:52,519 - INFO - Sub-category: 'Gaming'
2019-07-22 11:50:52,519 - INFO - Last Login: 30
2019-07-22 11:50:52,519 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Gaming'))
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-22 11:50:52,520 - INFO - Start Running query A30 Voucher buyers
2019-07-22 11:50:53,352 - INFO - java.sql.SQLException: Query failed (#20190722_045053_09293_awhya): line 8:65: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-22 11:50:53,721 - INFO - java.sql.SQLException: Query failed (#20190722_045054_09295_awhya): line 8:65: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-22 11:50:53,901 - INFO - java.sql.SQLException: Query failed (#20190722_045054_09296_awhya): line 8:65: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-22 11:50:54,003 - INFO - java.sql.SQLException: Query failed (#20190722_045054_09297_awhya): line 8:65: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-22 11:50:54,171 - INFO - java.sql.SQLException: Query failed (#20190722_045054_09298_awhya): line 8:65: mismatched input ')'. Expecting: 'AND', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', <EOF>
2019-07-22 11:50:54,173 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-22 11:50:54,839 - INFO - Delete all data in sheet: Case 5
2019-07-22 11:50:56,861 - INFO - No value detected on sheet: Case 6
2019-07-22 11:50:58,174 - INFO - Value detected - use sheet: Case 7
2019-07-22 11:50:58,174 - INFO - Reading Data From Google Sheet...
2019-07-22 11:50:58,823 - INFO - Get custom SQL..
2019-07-22 11:50:58,823 - INFO - USING CASE 7
2019-07-22 11:51:00,140 - INFO - Row 1
2019-07-22 11:51:00,141 - INFO - Filename: Official Shop Followers
2019-07-22 11:51:00,141 - INFO - Shop ID: 15570835
2019-07-22 11:51:00,141 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 15570835 
                                and status = 1
                                
2019-07-22 11:51:00,142 - INFO - Start Running query Official Shop Followers
2019-07-22 11:52:21,204 - INFO - Running Official Shop Followers Done
2019-07-22 11:52:21,207 - INFO - CSV file path: Official Shop Followers
2019-07-22 11:52:21,210 - INFO - Starting save the query results
2019-07-22 11:52:21,210 - INFO - Total Rows : 65255
2019-07-22 11:52:21,210 - INFO - Will split into : 1.0 files
2019-07-22 11:52:21,529 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 11.41/Official Shop Followers_1.csv
2019-07-22 11:52:21,529 - INFO - , with total : 65255 rows
2019-07-22 11:52:22,204 - INFO - Delete all data in sheet: Case 7
2019-07-22 11:52:24,401 - INFO - No value detected on sheet: Case 8
2019-07-22 11:52:25,710 - INFO - No value detected on sheet: Case 9
2019-07-22 13:26:09,640 - INFO - Report date: 20190722 13.26
2019-07-22 13:26:09,676 - INFO - Download sheet..
2019-07-22 13:26:09,677 - INFO - Change directory to script path
2019-07-22 13:26:11,776 - INFO - Spreadsheet downloaded
2019-07-22 13:26:11,778 - INFO - Checking sheet..
2019-07-22 13:26:13,977 - INFO - No value detected on sheet: Case 1
2019-07-22 13:26:15,296 - INFO - No value detected on sheet: Case 2
2019-07-22 13:26:16,607 - INFO - No value detected on sheet: Case 3
2019-07-22 13:26:18,016 - INFO - No value detected on sheet: Case 4
2019-07-22 13:26:19,332 - INFO - No value detected on sheet: Case 5
2019-07-22 13:26:20,663 - INFO - No value detected on sheet: Case 6
2019-07-22 13:26:21,984 - INFO - No value detected on sheet: Case 7
2019-07-22 13:27:40,789 - INFO - Report date: 20190722 13.27
2019-07-22 13:27:40,822 - INFO - Download sheet..
2019-07-22 13:27:40,822 - INFO - Change directory to script path
2019-07-22 13:27:42,805 - INFO - Spreadsheet downloaded
2019-07-22 13:27:42,806 - INFO - Checking sheet..
2019-07-22 13:27:44,762 - INFO - No value detected on sheet: Case 1
2019-07-22 13:27:46,071 - INFO - No value detected on sheet: Case 2
2019-07-22 13:27:47,405 - INFO - No value detected on sheet: Case 3
2019-07-22 13:27:48,747 - INFO - No value detected on sheet: Case 4
2019-07-22 13:27:50,059 - INFO - Value detected - use sheet: Case 5
2019-07-22 13:27:50,059 - INFO - Reading Data From Google Sheet...
2019-07-22 13:27:50,713 - INFO - Get custom SQL..
2019-07-22 13:27:50,713 - INFO - USING CASE 5
2019-07-22 13:27:52,858 - INFO - Row 1
2019-07-22 13:27:52,859 - INFO - Filename: A30 Gaming buyers
2019-07-22 13:27:52,861 - INFO - Sub-category: 'Video Games','Gaming'
2019-07-22 13:27:52,861 - INFO - Last Login: 30
2019-07-22 13:27:52,861 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Video Games','Gaming')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-22 13:27:52,864 - INFO - Start Running query A30 Gaming buyers
2019-07-22 13:29:20,046 - INFO - Running A30 Gaming buyers Done
2019-07-22 13:29:20,048 - INFO - CSV file path: A30 Gaming buyers
2019-07-22 13:29:20,079 - INFO - Starting save the query results
2019-07-22 13:29:20,079 - INFO - Total Rows : 736703
2019-07-22 13:29:20,081 - INFO - Will split into : 1.0 files
2019-07-22 13:29:23,605 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 13.27/A30 Gaming buyers_1.csv
2019-07-22 13:29:23,605 - INFO - , with total : 736703 rows
2019-07-22 13:29:25,536 - INFO - Row 2
2019-07-22 13:29:25,538 - INFO - Filename: A30 Voucher buyers
2019-07-22 13:29:25,539 - INFO - Sub-category: 'Gaming'
2019-07-22 13:29:25,539 - INFO - Last Login: 30
2019-07-22 13:29:25,539 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Gaming')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-22 13:29:25,540 - INFO - Start Running query A30 Voucher buyers
2019-07-22 13:30:09,091 - INFO - Running A30 Voucher buyers Done
2019-07-22 13:30:09,092 - INFO - CSV file path: A30 Voucher buyers
2019-07-22 13:30:09,112 - INFO - Starting save the query results
2019-07-22 13:30:09,112 - INFO - Total Rows : 488740
2019-07-22 13:30:09,114 - INFO - Will split into : 1.0 files
2019-07-22 13:30:11,460 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 13.27/A30 Voucher buyers_1.csv
2019-07-22 13:30:11,460 - INFO - , with total : 488740 rows
2019-07-22 13:30:14,125 - INFO - Row 3
2019-07-22 13:30:14,125 - INFO - Filename: A30 Face Cosmetics Buyers
2019-07-22 13:30:14,127 - INFO - Sub-category: 'Face Cosmetics'
2019-07-22 13:30:14,127 - INFO - Last Login: 30
2019-07-22 13:30:14,128 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Face Cosmetics')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-22 13:30:14,128 - INFO - Start Running query A30 Face Cosmetics Buyers
2019-07-22 13:31:56,059 - INFO - Running A30 Face Cosmetics Buyers Done
2019-07-22 13:31:56,061 - INFO - CSV file path: A30 Face Cosmetics Buyers
2019-07-22 13:31:56,203 - INFO - Starting save the query results
2019-07-22 13:31:56,203 - INFO - Total Rows : 3259073
2019-07-22 13:31:56,204 - INFO - Will split into : 4.0 files
2019-07-22 13:32:01,122 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 13.27/A30 Face Cosmetics Buyers_1.csv
2019-07-22 13:32:01,124 - INFO - , with total : 814769 rows
2019-07-22 13:32:05,816 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 13.27/A30 Face Cosmetics Buyers_2.csv
2019-07-22 13:32:05,818 - INFO - , with total : 814768 rows
2019-07-22 13:32:11,131 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 13.27/A30 Face Cosmetics Buyers_3.csv
2019-07-22 13:32:11,132 - INFO - , with total : 814768 rows
2019-07-22 13:32:16,714 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 13.27/A30 Face Cosmetics Buyers_4.csv
2019-07-22 13:32:16,716 - INFO - , with total : 814768 rows
2019-07-22 13:32:17,661 - INFO - Delete all data in sheet: Case 5
2019-07-22 13:32:19,549 - INFO - No value detected on sheet: Case 6
2019-07-22 13:32:20,638 - INFO - No value detected on sheet: Case 7
2019-07-22 13:32:21,880 - INFO - No value detected on sheet: Case 8
2019-07-22 13:32:23,371 - INFO - No value detected on sheet: Case 9
2019-07-22 14:00:09,216 - INFO - Report date: 20190722 14.00
2019-07-22 14:00:13,911 - INFO - Download sheet..
2019-07-22 14:00:13,911 - INFO - Change directory to script path
2019-07-22 14:00:14,951 - INFO - Spreadsheet downloaded
2019-07-22 14:00:14,953 - INFO - Checking sheet..
2019-07-22 14:00:16,661 - INFO - Value detected - use sheet: Case 1
2019-07-22 14:00:16,663 - INFO - Reading Data From Google Sheet...
2019-07-22 14:00:17,427 - INFO - Get custom SQL..
2019-07-22 14:00:17,427 - INFO - USING CASE 1
2019-07-22 14:00:19,461 - INFO - Row 1
2019-07-22 14:00:19,463 - INFO - Filename: A30 EL buyers
2019-07-22 14:00:19,463 - INFO - Category: 'Computer & Accessories'
2019-07-22 14:00:19,463 - INFO - Last Login: 30
2019-07-22 14:00:19,463 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Computer & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-22 14:00:19,464 - INFO - Start Running query A30 EL buyers
2019-07-22 14:02:43,878 - INFO - Running A30 EL buyers Done
2019-07-22 14:02:43,881 - INFO - CSV file path: A30 EL buyers
2019-07-22 14:02:44,016 - INFO - Starting save the query results
2019-07-22 14:02:44,016 - INFO - Total Rows : 2590401
2019-07-22 14:02:44,016 - INFO - Will split into : 3.0 files
2019-07-22 14:02:47,948 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 14.00/A30 EL buyers_1.csv
2019-07-22 14:02:47,950 - INFO - , with total : 863467 rows
2019-07-22 14:02:52,361 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 14.00/A30 EL buyers_2.csv
2019-07-22 14:02:52,362 - INFO - , with total : 863467 rows
2019-07-22 14:02:57,002 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 14.00/A30 EL buyers_3.csv
2019-07-22 14:02:57,003 - INFO - , with total : 863467 rows
2019-07-22 14:02:58,846 - INFO - Delete all data in sheet: Case 1
2019-07-22 14:03:00,858 - INFO - No value detected on sheet: Case 2
2019-07-22 14:03:02,026 - INFO - No value detected on sheet: Case 3
2019-07-22 14:03:03,072 - INFO - No value detected on sheet: Case 4
2019-07-22 14:03:04,357 - INFO - No value detected on sheet: Case 5
2019-07-22 14:03:05,668 - INFO - No value detected on sheet: Case 6
2019-07-22 14:03:06,690 - INFO - No value detected on sheet: Case 7
2019-07-22 14:03:08,285 - INFO - No value detected on sheet: Case 8
2019-07-22 14:03:09,611 - INFO - No value detected on sheet: Case 9
2019-07-22 17:00:02,529 - INFO - Report date: 20190722 17.00
2019-07-22 17:00:05,487 - INFO - Download sheet..
2019-07-22 17:00:05,487 - INFO - Change directory to script path
2019-07-22 17:00:06,509 - INFO - Spreadsheet downloaded
2019-07-22 17:00:06,510 - INFO - Checking sheet..
2019-07-22 17:00:08,193 - INFO - No value detected on sheet: Case 1
2019-07-22 17:00:09,831 - INFO - No value detected on sheet: Case 2
2019-07-22 17:00:11,131 - INFO - Value detected - use sheet: Case 3
2019-07-22 17:00:11,131 - INFO - Reading Data From Google Sheet...
2019-07-22 17:00:11,769 - INFO - Get custom SQL..
2019-07-22 17:00:11,769 - INFO - USING CASE 3
2019-07-22 17:00:15,148 - INFO - Row 1
2019-07-22 17:00:15,148 - INFO - Filename: A30 EL haven't purchased in past 30 days
2019-07-22 17:00:15,150 - INFO - Category: 'Mobile & Accessories'
2019-07-22 17:00:15,151 - INFO - Last Login: 30
2019-07-22 17:00:15,151 - INFO - Date 1: 2019-06-16
2019-07-22 17:00:15,151 - INFO - Date 2: 2019-07-22
2019-07-22 17:00:15,151 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-16' and date'2019-07-22'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-07-22 17:00:15,153 - INFO - Start Running query A30 EL haven't purchased in past 30 days
2019-07-22 17:02:23,272 - INFO - Running A30 EL haven't purchased in past 30 days Done
2019-07-22 17:02:23,273 - INFO - CSV file path: A30 EL haven't purchased in past 30 days
2019-07-22 17:02:23,357 - INFO - Starting save the query results
2019-07-22 17:02:23,358 - INFO - Total Rows : 2151866
2019-07-22 17:02:23,358 - INFO - Will split into : 3.0 files
2019-07-22 17:02:26,576 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 17.00/A30 EL haven't purchased in past 30 days_1.csv
2019-07-22 17:02:26,578 - INFO - , with total : 717289 rows
2019-07-22 17:02:30,098 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 17.00/A30 EL haven't purchased in past 30 days_2.csv
2019-07-22 17:02:30,098 - INFO - , with total : 717289 rows
2019-07-22 17:02:33,686 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 17.00/A30 EL haven't purchased in past 30 days_3.csv
2019-07-22 17:02:33,687 - INFO - , with total : 717288 rows
2019-07-22 17:02:34,811 - INFO - Delete all data in sheet: Case 3
2019-07-22 17:02:36,841 - INFO - Value detected - use sheet: Case 4
2019-07-22 17:02:36,842 - INFO - Reading Data From Google Sheet...
2019-07-22 17:02:37,486 - INFO - Get custom SQL..
2019-07-22 17:02:37,487 - INFO - USING CASE 4
2019-07-22 17:02:39,865 - INFO - Row 1
2019-07-22 17:02:39,865 - INFO - Filename: A7 FMCG Buyers
2019-07-22 17:02:39,865 - INFO - Category: 'Health & Beauty'
2019-07-22 17:02:39,867 - INFO - Last Login: 7
2019-07-22 17:02:39,867 - INFO - Gender: 2,4
2019-07-22 17:02:39,868 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Health & Beauty')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-22 17:02:39,868 - INFO - Start Running query A7 FMCG Buyers
2019-07-22 17:04:38,114 - INFO - Running A7 FMCG Buyers Done
2019-07-22 17:04:38,115 - INFO - CSV file path: A7 FMCG Buyers
2019-07-22 17:04:38,157 - INFO - Starting save the query results
2019-07-22 17:04:38,158 - INFO - Total Rows : 1142699
2019-07-22 17:04:38,158 - INFO - Will split into : 2.0 files
2019-07-22 17:04:40,815 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 17.00/A7 FMCG Buyers_1.csv
2019-07-22 17:04:40,815 - INFO - , with total : 571350 rows
2019-07-22 17:04:43,631 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 17.00/A7 FMCG Buyers_2.csv
2019-07-22 17:04:43,632 - INFO - , with total : 571349 rows
2019-07-22 17:04:47,457 - INFO - Row 2
2019-07-22 17:04:47,457 - INFO - Filename: A30 FMCG Buyers
2019-07-22 17:04:47,459 - INFO - Category: 'Health & Beauty'
2019-07-22 17:04:47,460 - INFO - Last Login: 30
2019-07-22 17:04:47,460 - INFO - Gender: 2,4
2019-07-22 17:04:47,460 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Health & Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-22 17:04:47,460 - INFO - Start Running query A30 FMCG Buyers
2019-07-22 17:07:49,164 - INFO - Running A30 FMCG Buyers Done
2019-07-22 17:07:49,165 - INFO - CSV file path: A30 FMCG Buyers
2019-07-22 17:07:49,217 - INFO - Starting save the query results
2019-07-22 17:07:49,217 - INFO - Total Rows : 1324387
2019-07-22 17:07:49,219 - INFO - Will split into : 2.0 files
2019-07-22 17:07:52,174 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 17.00/A30 FMCG Buyers_1.csv
2019-07-22 17:07:52,174 - INFO - , with total : 662194 rows
2019-07-22 17:07:55,433 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 17.00/A30 FMCG Buyers_2.csv
2019-07-22 17:07:55,434 - INFO - , with total : 662193 rows
2019-07-22 17:07:56,279 - INFO - Delete all data in sheet: Case 4
2019-07-22 17:07:58,266 - INFO - No value detected on sheet: Case 5
2019-07-22 17:07:59,316 - INFO - No value detected on sheet: Case 6
2019-07-22 17:08:00,362 - INFO - Value detected - use sheet: Case 7
2019-07-22 17:08:00,364 - INFO - Reading Data From Google Sheet...
2019-07-22 17:08:01,009 - INFO - Get custom SQL..
2019-07-22 17:08:01,010 - INFO - USING CASE 7
2019-07-22 17:08:02,075 - INFO - Row 1
2019-07-22 17:08:02,075 - INFO - Filename: Vivo Official Shop Followers
2019-07-22 17:08:02,076 - INFO - Shop ID: 30843261
2019-07-22 17:08:02,076 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 30843261 
                                and status = 1
                                
2019-07-22 17:08:02,078 - INFO - Start Running query Vivo Official Shop Followers
2019-07-22 17:08:42,881 - INFO - Running Vivo Official Shop Followers Done
2019-07-22 17:08:42,881 - INFO - CSV file path: Vivo Official Shop Followers
2019-07-22 17:08:42,888 - INFO - Starting save the query results
2019-07-22 17:08:42,888 - INFO - Total Rows : 156348
2019-07-22 17:08:42,890 - INFO - Will split into : 1.0 files
2019-07-22 17:08:43,588 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 17.00/Vivo Official Shop Followers_1.csv
2019-07-22 17:08:43,588 - INFO - , with total : 156348 rows
2019-07-22 17:08:45,168 - INFO - Row 2
2019-07-22 17:08:45,170 - INFO - Filename: MacBear.id Official Shop followers
2019-07-22 17:08:45,171 - INFO - Shop ID: 15431941
2019-07-22 17:08:45,171 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 15431941 
                                and status = 1
                                
2019-07-22 17:08:45,171 - INFO - Start Running query MacBear.id Official Shop followers
2019-07-22 17:09:10,194 - INFO - Running MacBear.id Official Shop followers Done
2019-07-22 17:09:10,196 - INFO - CSV file path: MacBear.id Official Shop followers
2019-07-22 17:09:10,203 - INFO - Starting save the query results
2019-07-22 17:09:10,206 - INFO - Total Rows : 198791
2019-07-22 17:09:10,206 - INFO - Will split into : 1.0 files
2019-07-22 17:09:11,112 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190722 17.00/MacBear.id Official Shop followers_1.csv
2019-07-22 17:09:11,114 - INFO - , with total : 198791 rows
2019-07-22 17:09:11,642 - INFO - Delete all data in sheet: Case 7
2019-07-22 17:09:13,384 - INFO - No value detected on sheet: Case 8
2019-07-22 17:09:14,444 - INFO - No value detected on sheet: Case 9
2019-07-23 10:00:05,276 - INFO - Report date: 20190723 10.00
2019-07-23 10:00:11,413 - INFO - Download sheet..
2019-07-23 10:00:11,414 - INFO - Change directory to script path
2019-07-23 10:00:13,934 - INFO - Spreadsheet downloaded
2019-07-23 10:00:13,936 - INFO - Checking sheet..
2019-07-23 10:00:15,789 - INFO - Value detected - use sheet: Case 1
2019-07-23 10:00:15,799 - INFO - Reading Data From Google Sheet...
2019-07-23 10:00:16,502 - INFO - Get custom SQL..
2019-07-23 10:00:16,503 - INFO - USING CASE 1
2019-07-23 10:00:19,168 - INFO - Row 1
2019-07-23 10:00:19,170 - INFO - Filename: A30 Home & Living Buyers
2019-07-23 10:00:19,171 - INFO - Category: 'Dining Room','Kitchen & Cookware'
2019-07-23 10:00:19,171 - INFO - Last Login: 30
2019-07-23 10:00:19,171 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Dining Room','Kitchen & Cookware')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-23 10:00:19,171 - INFO - Start Running query A30 Home & Living Buyers
2019-07-23 10:01:52,019 - INFO - Running A30 Home & Living Buyers Done
2019-07-23 10:01:52,019 - INFO - CSV file path: A30 Home & Living Buyers
2019-07-23 10:01:52,028 - INFO - Starting save the query results
2019-07-23 10:01:52,029 - INFO - Total Rows : 0
2019-07-23 10:01:52,029 - INFO - Will split into : 0.0 files
2019-07-23 10:01:52,029 - INFO - ERROR -> number sections must be larger than 0.
2019-07-23 10:01:52,766 - INFO - Delete all data in sheet: Case 1
2019-07-23 10:01:54,980 - INFO - No value detected on sheet: Case 2
2019-07-23 10:01:56,440 - INFO - No value detected on sheet: Case 3
2019-07-23 10:01:57,828 - INFO - No value detected on sheet: Case 4
2019-07-23 10:01:59,269 - INFO - No value detected on sheet: Case 5
2019-07-23 10:02:00,663 - INFO - No value detected on sheet: Case 6
2019-07-23 10:02:02,286 - INFO - No value detected on sheet: Case 7
2019-07-23 10:02:03,654 - INFO - No value detected on sheet: Case 8
2019-07-23 10:02:04,788 - INFO - No value detected on sheet: Case 9
2019-07-23 14:00:04,542 - INFO - Report date: 20190723 14.00
2019-07-23 14:00:10,628 - INFO - Download sheet..
2019-07-23 14:00:10,630 - INFO - Change directory to script path
2019-07-23 14:00:11,940 - INFO - Spreadsheet downloaded
2019-07-23 14:00:11,941 - INFO - Checking sheet..
2019-07-23 14:00:14,582 - INFO - No value detected on sheet: Case 1
2019-07-23 14:00:16,048 - INFO - No value detected on sheet: Case 2
2019-07-23 14:00:17,517 - INFO - No value detected on sheet: Case 3
2019-07-23 14:00:18,979 - INFO - No value detected on sheet: Case 4
2019-07-23 14:00:20,529 - INFO - Value detected - use sheet: Case 5
2019-07-23 14:00:20,530 - INFO - Reading Data From Google Sheet...
2019-07-23 14:00:21,253 - INFO - Get custom SQL..
2019-07-23 14:00:21,255 - INFO - USING CASE 5
2019-07-23 14:00:23,677 - INFO - Row 1
2019-07-23 14:00:23,677 - INFO - Filename: A30 Home & Living
2019-07-23 14:00:23,678 - INFO - Sub-category: 'Kitchen & Cookware','Dining Room'
2019-07-23 14:00:23,678 - INFO - Last Login: 30
2019-07-23 14:00:23,680 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Kitchen & Cookware','Dining Room')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-23 14:00:23,680 - INFO - Start Running query A30 Home & Living
2019-07-23 14:01:57,101 - INFO - Running A30 Home & Living Done
2019-07-23 14:01:57,101 - INFO - CSV file path: A30 Home & Living
2019-07-23 14:01:57,227 - INFO - Starting save the query results
2019-07-23 14:01:57,229 - INFO - Total Rows : 3334333
2019-07-23 14:01:57,230 - INFO - Will split into : 4.0 files
2019-07-23 14:02:01,285 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 14.00/A30 Home & Living_1.csv
2019-07-23 14:02:01,286 - INFO - , with total : 833584 rows
2019-07-23 14:02:06,836 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 14.00/A30 Home & Living_2.csv
2019-07-23 14:02:06,838 - INFO - , with total : 833583 rows
2019-07-23 14:02:11,269 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 14.00/A30 Home & Living_3.csv
2019-07-23 14:02:11,270 - INFO - , with total : 833583 rows
2019-07-23 14:02:15,713 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 14.00/A30 Home & Living_4.csv
2019-07-23 14:02:15,713 - INFO - , with total : 833583 rows
2019-07-23 14:02:16,734 - INFO - Delete all data in sheet: Case 5
2019-07-23 14:02:18,868 - INFO - No value detected on sheet: Case 6
2019-07-23 14:02:20,345 - INFO - No value detected on sheet: Case 7
2019-07-23 14:02:21,124 - INFO - Value detected - use sheet: Case 8
2019-07-23 14:02:21,125 - INFO - Reading Data From Google Sheet...
2019-07-23 14:02:21,848 - INFO - Get custom SQL..
2019-07-23 14:02:21,848 - INFO - USING CASE 8
2019-07-23 14:02:22,963 - INFO - Row 1
2019-07-23 14:02:22,963 - INFO - Filename: A30 DP buyers (88 Digital Day)
2019-07-23 14:02:22,963 - INFO - Last Login: 30
2019-07-23 14:02:22,964 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar))
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-07-23 14:02:22,964 - INFO - Start Running query A30 DP buyers (88 Digital Day)
2019-07-23 14:03:33,401 - INFO - Running A30 DP buyers (88 Digital Day) Done
2019-07-23 14:03:33,403 - INFO - CSV file path: A30 DP buyers (88 Digital Day)
2019-07-23 14:03:33,492 - INFO - Starting save the query results
2019-07-23 14:03:33,493 - INFO - Total Rows : 2390034
2019-07-23 14:03:33,493 - INFO - Will split into : 3.0 files
2019-07-23 14:03:37,207 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 14.00/A30 DP buyers (88 Digital Day)_1.csv
2019-07-23 14:03:37,207 - INFO - , with total : 796678 rows
2019-07-23 14:03:41,648 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 14.00/A30 DP buyers (88 Digital Day)_2.csv
2019-07-23 14:03:41,648 - INFO - , with total : 796678 rows
2019-07-23 14:03:45,706 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 14.00/A30 DP buyers (88 Digital Day)_3.csv
2019-07-23 14:03:45,707 - INFO - , with total : 796678 rows
2019-07-23 14:03:46,950 - INFO - Delete all data in sheet: Case 8
2019-07-23 14:03:48,881 - INFO - No value detected on sheet: Case 9
2019-07-23 17:00:03,013 - INFO - Report date: 20190723 17.00
2019-07-23 17:00:10,059 - INFO - Download sheet..
2019-07-23 17:00:10,059 - INFO - Change directory to script path
2019-07-23 17:00:11,089 - INFO - Spreadsheet downloaded
2019-07-23 17:00:11,091 - INFO - Checking sheet..
2019-07-23 17:00:12,980 - INFO - No value detected on sheet: Case 1
2019-07-23 17:00:14,473 - INFO - No value detected on sheet: Case 2
2019-07-23 17:00:15,938 - INFO - No value detected on sheet: Case 3
2019-07-23 17:00:17,438 - INFO - No value detected on sheet: Case 4
2019-07-23 17:00:18,898 - INFO - Value detected - use sheet: Case 5
2019-07-23 17:00:18,898 - INFO - Reading Data From Google Sheet...
2019-07-23 17:00:19,638 - INFO - Get custom SQL..
2019-07-23 17:00:19,638 - INFO - USING CASE 5
2019-07-23 17:00:21,846 - INFO - Row 1
2019-07-23 17:00:21,848 - INFO - Filename: A30 who have made purchase on pet products
2019-07-23 17:00:21,848 - INFO - Sub-category: 'Pet Care'
2019-07-23 17:00:21,849 - INFO - Last Login: 30
2019-07-23 17:00:21,849 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Pet Care')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-23 17:00:21,851 - INFO - Start Running query A30 who have made purchase on pet products
2019-07-23 17:01:04,553 - INFO - Running A30 who have made purchase on pet products Done
2019-07-23 17:01:04,555 - INFO - CSV file path: A30 who have made purchase on pet products
2019-07-23 17:01:04,575 - INFO - Starting save the query results
2019-07-23 17:01:04,576 - INFO - Total Rows : 555539
2019-07-23 17:01:04,578 - INFO - Will split into : 1.0 files
2019-07-23 17:01:07,128 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A30 who have made purchase on pet products_1.csv
2019-07-23 17:01:07,128 - INFO - , with total : 555539 rows
2019-07-23 17:01:07,845 - INFO - Delete all data in sheet: Case 5
2019-07-23 17:01:09,726 - INFO - No value detected on sheet: Case 6
2019-07-23 17:01:11,266 - INFO - Value detected - use sheet: Case 7
2019-07-23 17:01:11,266 - INFO - Reading Data From Google Sheet...
2019-07-23 17:01:11,986 - INFO - Get custom SQL..
2019-07-23 17:01:12,026 - INFO - USING CASE 7
2019-07-23 17:01:13,526 - INFO - Row 1
2019-07-23 17:01:13,528 - INFO - Filename: Realme Official Shop Followers
2019-07-23 17:01:13,529 - INFO - Shop ID: 109598751
2019-07-23 17:01:13,529 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 109598751 
                                and status = 1
                                
2019-07-23 17:01:13,530 - INFO - Start Running query Realme Official Shop Followers
2019-07-23 17:01:21,546 - INFO - Running Realme Official Shop Followers Done
2019-07-23 17:01:21,546 - INFO - CSV file path: Realme Official Shop Followers
2019-07-23 17:01:21,552 - INFO - Starting save the query results
2019-07-23 17:01:21,552 - INFO - Total Rows : 96389
2019-07-23 17:01:21,553 - INFO - Will split into : 1.0 files
2019-07-23 17:01:22,006 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/Realme Official Shop Followers_1.csv
2019-07-23 17:01:22,007 - INFO - , with total : 96389 rows
2019-07-23 17:01:22,823 - INFO - Delete all data in sheet: Case 7
2019-07-23 17:01:25,061 - INFO - No value detected on sheet: Case 8
2019-07-23 17:01:26,539 - INFO - Value detected - use sheet: Case 9
2019-07-23 17:01:26,540 - INFO - Reading Data From Google Sheet...
2019-07-23 17:01:27,273 - INFO - Get custom SQL..
2019-07-23 17:01:27,275 - INFO - USING CASE 9
2019-07-23 17:01:29,457 - INFO - Row 1
2019-07-23 17:01:29,457 - INFO - Filename: A1 Fashion buyers who haven't shopped DP
2019-07-23 17:01:29,457 - INFO - Last Login: 1
2019-07-23 17:01:29,459 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes') 
                                    and
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-23 17:01:29,460 - INFO - Start Running query A1 Fashion buyers who haven't shopped DP
2019-07-23 17:03:30,243 - INFO - Running A1 Fashion buyers who haven't shopped DP Done
2019-07-23 17:03:30,244 - INFO - CSV file path: A1 Fashion buyers who haven't shopped DP
2019-07-23 17:03:30,401 - INFO - Starting save the query results
2019-07-23 17:03:30,401 - INFO - Total Rows : 4230894
2019-07-23 17:03:30,403 - INFO - Will split into : 5.0 files
2019-07-23 17:03:34,257 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 Fashion buyers who haven't shopped DP_1.csv
2019-07-23 17:03:34,259 - INFO - , with total : 846179 rows
2019-07-23 17:03:38,490 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 Fashion buyers who haven't shopped DP_2.csv
2019-07-23 17:03:38,492 - INFO - , with total : 846179 rows
2019-07-23 17:03:42,809 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 Fashion buyers who haven't shopped DP_3.csv
2019-07-23 17:03:42,811 - INFO - , with total : 846179 rows
2019-07-23 17:03:47,227 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 Fashion buyers who haven't shopped DP_4.csv
2019-07-23 17:03:47,227 - INFO - , with total : 846179 rows
2019-07-23 17:03:51,713 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 Fashion buyers who haven't shopped DP_5.csv
2019-07-23 17:03:51,714 - INFO - , with total : 846178 rows
2019-07-23 17:03:54,115 - INFO - Row 2
2019-07-23 17:03:54,115 - INFO - Filename: A1 FMCG buyers who haven't shopped DP
2019-07-23 17:03:54,115 - INFO - Last Login: 1
2019-07-23 17:03:54,115 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby') 
                                    and
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-23 17:03:54,117 - INFO - Start Running query A1 FMCG buyers who haven't shopped DP
2019-07-23 17:06:13,460 - INFO - Running A1 FMCG buyers who haven't shopped DP Done
2019-07-23 17:06:13,463 - INFO - CSV file path: A1 FMCG buyers who haven't shopped DP
2019-07-23 17:06:13,586 - INFO - Starting save the query results
2019-07-23 17:06:13,588 - INFO - Total Rows : 3395841
2019-07-23 17:06:13,588 - INFO - Will split into : 4.0 files
2019-07-23 17:06:17,526 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 FMCG buyers who haven't shopped DP_1.csv
2019-07-23 17:06:17,528 - INFO - , with total : 848961 rows
2019-07-23 17:06:21,740 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 FMCG buyers who haven't shopped DP_2.csv
2019-07-23 17:06:21,742 - INFO - , with total : 848960 rows
2019-07-23 17:06:26,184 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 FMCG buyers who haven't shopped DP_3.csv
2019-07-23 17:06:26,186 - INFO - , with total : 848960 rows
2019-07-23 17:06:30,700 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 FMCG buyers who haven't shopped DP_4.csv
2019-07-23 17:06:30,701 - INFO - , with total : 848960 rows
2019-07-23 17:06:33,651 - INFO - Row 3
2019-07-23 17:06:33,651 - INFO - Filename: A1 EL buyers who haven't shopped DP
2019-07-23 17:06:33,653 - INFO - Last Login: 1
2019-07-23 17:06:33,653 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography') 
                                    and
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-23 17:06:33,654 - INFO - Start Running query A1 EL buyers who haven't shopped DP
2019-07-23 17:10:00,230 - INFO - Running A1 EL buyers who haven't shopped DP Done
2019-07-23 17:10:00,232 - INFO - CSV file path: A1 EL buyers who haven't shopped DP
2019-07-23 17:10:00,345 - INFO - Starting save the query results
2019-07-23 17:10:00,345 - INFO - Total Rows : 3101053
2019-07-23 17:10:00,346 - INFO - Will split into : 4.0 files
2019-07-23 17:10:03,880 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 EL buyers who haven't shopped DP_1.csv
2019-07-23 17:10:03,881 - INFO - , with total : 775264 rows
2019-07-23 17:10:07,773 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 EL buyers who haven't shopped DP_2.csv
2019-07-23 17:10:07,773 - INFO - , with total : 775263 rows
2019-07-23 17:10:11,719 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 EL buyers who haven't shopped DP_3.csv
2019-07-23 17:10:11,720 - INFO - , with total : 775263 rows
2019-07-23 17:10:15,815 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190723 17.00/A1 EL buyers who haven't shopped DP_4.csv
2019-07-23 17:10:15,815 - INFO - , with total : 775263 rows
2019-07-23 17:10:16,815 - INFO - Delete all data in sheet: Case 9
2019-07-24 10:00:13,467 - INFO - Report date: 20190724 10.00
2019-07-24 10:00:19,119 - INFO - Download sheet..
2019-07-24 10:00:19,119 - INFO - Change directory to script path
2019-07-24 10:00:20,140 - INFO - Spreadsheet downloaded
2019-07-24 10:00:20,141 - INFO - Checking sheet..
2019-07-24 10:00:22,009 - INFO - No value detected on sheet: Case 1
2019-07-24 10:00:23,510 - INFO - No value detected on sheet: Case 2
2019-07-24 10:00:24,940 - INFO - No value detected on sheet: Case 3
2019-07-24 10:00:26,400 - INFO - No value detected on sheet: Case 4
2019-07-24 10:00:27,897 - INFO - No value detected on sheet: Case 5
2019-07-24 10:00:29,464 - INFO - No value detected on sheet: Case 6
2019-07-24 10:00:30,918 - INFO - No value detected on sheet: Case 7
2019-07-24 10:00:32,338 - INFO - No value detected on sheet: Case 8
2019-07-24 10:00:33,441 - INFO - No value detected on sheet: Case 9
2019-07-24 14:00:06,124 - INFO - Report date: 20190724 14.00
2019-07-24 14:00:10,729 - INFO - Download sheet..
2019-07-24 14:00:10,729 - INFO - Change directory to script path
2019-07-24 14:00:12,625 - INFO - Spreadsheet downloaded
2019-07-24 14:00:12,625 - INFO - Checking sheet..
2019-07-24 14:00:14,390 - INFO - No value detected on sheet: Case 1
2019-07-24 14:00:15,710 - INFO - No value detected on sheet: Case 2
2019-07-24 14:00:17,013 - INFO - No value detected on sheet: Case 3
2019-07-24 14:00:18,296 - INFO - No value detected on sheet: Case 4
2019-07-24 14:00:20,201 - INFO - No value detected on sheet: Case 5
2019-07-24 14:00:21,503 - INFO - No value detected on sheet: Case 6
2019-07-24 14:00:22,811 - INFO - No value detected on sheet: Case 7
2019-07-24 14:00:24,099 - INFO - No value detected on sheet: Case 8
2019-07-24 14:00:25,395 - INFO - No value detected on sheet: Case 9
2019-07-24 17:00:01,951 - INFO - Report date: 20190724 17.00
2019-07-24 17:00:07,326 - INFO - Download sheet..
2019-07-24 17:00:07,328 - INFO - Change directory to script path
2019-07-24 17:00:08,392 - INFO - Spreadsheet downloaded
2019-07-24 17:00:08,392 - INFO - Checking sheet..
2019-07-24 17:00:10,089 - INFO - Value detected - use sheet: Case 1
2019-07-24 17:00:10,091 - INFO - Reading Data From Google Sheet...
2019-07-24 17:00:10,971 - INFO - Get custom SQL..
2019-07-24 17:00:10,973 - INFO - USING CASE 1
2019-07-24 17:00:12,953 - INFO - Row 1
2019-07-24 17:00:12,953 - INFO - Filename: A30 FMCG Buyers
2019-07-24 17:00:12,954 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-07-24 17:00:12,956 - INFO - Last Login: 30
2019-07-24 17:00:12,957 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-24 17:00:12,957 - INFO - Start Running query A30 FMCG Buyers
2019-07-24 17:04:57,732 - INFO - Running A30 FMCG Buyers Done
2019-07-24 17:04:57,733 - INFO - CSV file path: A30 FMCG Buyers
2019-07-24 17:04:58,141 - INFO - Starting save the query results
2019-07-24 17:04:58,141 - INFO - Total Rows : 9215791
2019-07-24 17:04:58,142 - INFO - Will split into : 10.0 files
2019-07-24 17:05:02,466 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190724 17.00/A30 FMCG Buyers_1.csv
2019-07-24 17:05:02,467 - INFO - , with total : 921580 rows
2019-07-24 17:05:07,096 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190724 17.00/A30 FMCG Buyers_2.csv
2019-07-24 17:05:07,098 - INFO - , with total : 921579 rows
2019-07-24 17:05:12,177 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190724 17.00/A30 FMCG Buyers_3.csv
2019-07-24 17:05:12,177 - INFO - , with total : 921579 rows
2019-07-24 17:05:17,065 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190724 17.00/A30 FMCG Buyers_4.csv
2019-07-24 17:05:17,066 - INFO - , with total : 921579 rows
2019-07-24 17:05:21,950 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190724 17.00/A30 FMCG Buyers_5.csv
2019-07-24 17:05:21,951 - INFO - , with total : 921579 rows
2019-07-24 17:05:26,812 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190724 17.00/A30 FMCG Buyers_6.csv
2019-07-24 17:05:26,813 - INFO - , with total : 921579 rows
2019-07-24 17:05:31,677 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190724 17.00/A30 FMCG Buyers_7.csv
2019-07-24 17:05:31,678 - INFO - , with total : 921579 rows
2019-07-24 17:05:36,658 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190724 17.00/A30 FMCG Buyers_8.csv
2019-07-24 17:05:36,660 - INFO - , with total : 921579 rows
2019-07-24 17:05:41,759 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190724 17.00/A30 FMCG Buyers_9.csv
2019-07-24 17:05:41,760 - INFO - , with total : 921579 rows
2019-07-24 17:05:46,670 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190724 17.00/A30 FMCG Buyers_10.csv
2019-07-24 17:05:46,671 - INFO - , with total : 921579 rows
2019-07-24 17:05:48,430 - INFO - Delete all data in sheet: Case 1
2019-07-24 17:05:50,414 - INFO - No value detected on sheet: Case 2
2019-07-24 17:05:51,701 - INFO - No value detected on sheet: Case 3
2019-07-24 17:05:52,990 - INFO - Value detected - use sheet: Case 4
2019-07-24 17:05:52,992 - INFO - Reading Data From Google Sheet...
2019-07-24 17:05:53,640 - INFO - Get custom SQL..
2019-07-24 17:05:53,641 - INFO - USING CASE 4
2019-07-24 17:05:56,345 - INFO - Row 1
2019-07-24 17:05:56,345 - INFO - Filename: A30 Women Buyers
2019-07-24 17:05:56,346 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby','Women Bags','Women Clothes','Women Shoes'
2019-07-24 17:05:56,346 - INFO - Last Login: 30
2019-07-24 17:05:56,346 - INFO - Error in get_custom_sql -> cannot concatenate 'str' and 'NoneType' objects
2019-07-24 17:05:56,348 - INFO - Delete all data in sheet: Case 4
2019-07-24 17:05:58,279 - INFO - No value detected on sheet: Case 5
2019-07-24 17:05:59,576 - INFO - No value detected on sheet: Case 6
2019-07-24 17:06:00,854 - INFO - No value detected on sheet: Case 7
2019-07-24 17:06:01,888 - INFO - No value detected on sheet: Case 8
2019-07-24 17:06:02,915 - INFO - No value detected on sheet: Case 9
2019-07-25 10:00:11,517 - INFO - Report date: 20190725 10.00
2019-07-25 10:00:16,703 - INFO - Download sheet..
2019-07-25 10:00:16,703 - INFO - Change directory to script path
2019-07-25 10:00:17,601 - INFO - Spreadsheet downloaded
2019-07-25 10:00:17,601 - INFO - Checking sheet..
2019-07-25 10:00:19,428 - INFO - Value detected - use sheet: Case 1
2019-07-25 10:00:19,430 - INFO - Reading Data From Google Sheet...
2019-07-25 10:00:20,165 - INFO - Get custom SQL..
2019-07-25 10:00:20,167 - INFO - USING CASE 1
2019-07-25 10:00:22,329 - INFO - Row 1
2019-07-25 10:00:22,331 - INFO - Filename: A30 HE, EL, HL Buyers
2019-07-25 10:00:22,331 - INFO - Category: '30'
2019-07-25 10:00:22,332 - INFO - Last Login: 30
2019-07-25 10:00:22,332 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('30')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-25 10:00:22,334 - INFO - Start Running query A30 HE, EL, HL Buyers
2019-07-25 10:00:44,075 - INFO - Running A30 HE, EL, HL Buyers Done
2019-07-25 10:00:44,078 - INFO - CSV file path: A30 HE, EL, HL Buyers
2019-07-25 10:00:44,085 - INFO - Starting save the query results
2019-07-25 10:00:44,086 - INFO - Total Rows : 0
2019-07-25 10:00:44,088 - INFO - Will split into : 0.0 files
2019-07-25 10:00:44,088 - INFO - ERROR -> number sections must be larger than 0.
2019-07-25 10:00:47,095 - INFO - Row 2
2019-07-25 10:00:47,095 - INFO - Filename: A30 MA Buyers
2019-07-25 10:00:47,098 - INFO - Category: 'Mobile & Accessories'
2019-07-25 10:00:47,098 - INFO - Last Login: 30
2019-07-25 10:00:47,098 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-25 10:00:47,099 - INFO - Start Running query A30 MA Buyers
2019-07-25 10:03:57,559 - INFO - Running A30 MA Buyers Done
2019-07-25 10:03:57,561 - INFO - CSV file path: A30 MA Buyers
2019-07-25 10:03:57,862 - INFO - Starting save the query results
2019-07-25 10:03:57,862 - INFO - Total Rows : 7184155
2019-07-25 10:03:57,864 - INFO - Will split into : 8.0 files
2019-07-25 10:04:02,177 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 MA Buyers_1.csv
2019-07-25 10:04:02,177 - INFO - , with total : 898020 rows
2019-07-25 10:04:06,737 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 MA Buyers_2.csv
2019-07-25 10:04:06,739 - INFO - , with total : 898020 rows
2019-07-25 10:04:11,467 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 MA Buyers_3.csv
2019-07-25 10:04:11,467 - INFO - , with total : 898020 rows
2019-07-25 10:04:16,223 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 MA Buyers_4.csv
2019-07-25 10:04:16,223 - INFO - , with total : 898019 rows
2019-07-25 10:04:20,993 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 MA Buyers_5.csv
2019-07-25 10:04:20,993 - INFO - , with total : 898019 rows
2019-07-25 10:04:25,851 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 MA Buyers_6.csv
2019-07-25 10:04:25,852 - INFO - , with total : 898019 rows
2019-07-25 10:04:30,663 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 MA Buyers_7.csv
2019-07-25 10:04:30,664 - INFO - , with total : 898019 rows
2019-07-25 10:04:35,664 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 MA Buyers_8.csv
2019-07-25 10:04:35,664 - INFO - , with total : 898019 rows
2019-07-25 10:04:39,072 - INFO - Row 3
2019-07-25 10:04:39,072 - INFO - Filename: A30 EL Buyers
2019-07-25 10:04:39,072 - INFO - Category: 'Electronics'
2019-07-25 10:04:39,073 - INFO - Last Login: 30
2019-07-25 10:04:39,073 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-25 10:04:39,075 - INFO - Start Running query A30 EL Buyers
2019-07-25 10:06:47,516 - INFO - Running A30 EL Buyers Done
2019-07-25 10:06:47,516 - INFO - CSV file path: A30 EL Buyers
2019-07-25 10:06:47,688 - INFO - Starting save the query results
2019-07-25 10:06:47,690 - INFO - Total Rows : 4520411
2019-07-25 10:06:47,690 - INFO - Will split into : 5.0 files
2019-07-25 10:06:51,979 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 EL Buyers_1.csv
2019-07-25 10:06:51,980 - INFO - , with total : 904083 rows
2019-07-25 10:06:56,690 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 EL Buyers_2.csv
2019-07-25 10:06:56,690 - INFO - , with total : 904082 rows
2019-07-25 10:07:01,499 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 EL Buyers_3.csv
2019-07-25 10:07:01,500 - INFO - , with total : 904082 rows
2019-07-25 10:07:06,451 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 EL Buyers_4.csv
2019-07-25 10:07:06,453 - INFO - , with total : 904082 rows
2019-07-25 10:07:11,451 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 10.00/A30 EL Buyers_5.csv
2019-07-25 10:07:11,453 - INFO - , with total : 904082 rows
2019-07-25 10:07:13,022 - INFO - Delete all data in sheet: Case 1
2019-07-25 10:07:14,915 - INFO - No value detected on sheet: Case 2
2019-07-25 10:07:16,414 - INFO - No value detected on sheet: Case 3
2019-07-25 10:07:17,878 - INFO - No value detected on sheet: Case 4
2019-07-25 10:07:19,023 - INFO - No value detected on sheet: Case 5
2019-07-25 10:07:20,470 - INFO - No value detected on sheet: Case 6
2019-07-25 10:07:21,585 - INFO - No value detected on sheet: Case 7
2019-07-25 10:07:22,726 - INFO - No value detected on sheet: Case 8
2019-07-25 10:07:24,302 - INFO - No value detected on sheet: Case 9
2019-07-25 14:00:02,543 - INFO - Report date: 20190725 14.00
2019-07-25 14:00:07,210 - INFO - Download sheet..
2019-07-25 14:00:07,210 - INFO - Change directory to script path
2019-07-25 14:00:08,492 - INFO - Spreadsheet downloaded
2019-07-25 14:00:08,493 - INFO - Checking sheet..
2019-07-25 14:00:10,448 - INFO - No value detected on sheet: Case 1
2019-07-25 14:00:11,930 - INFO - No value detected on sheet: Case 2
2019-07-25 14:00:13,492 - INFO - No value detected on sheet: Case 3
2019-07-25 14:00:14,948 - INFO - Value detected - use sheet: Case 4
2019-07-25 14:00:14,950 - INFO - Reading Data From Google Sheet...
2019-07-25 14:00:15,681 - INFO - Get custom SQL..
2019-07-25 14:00:15,683 - INFO - USING CASE 4
2019-07-25 14:00:19,058 - INFO - Row 1
2019-07-25 14:00:19,059 - INFO - Filename: A30 Female HBC Buyers
2019-07-25 14:00:19,059 - INFO - Category: 'Health','Beauty'
2019-07-25 14:00:19,059 - INFO - Last Login: 30
2019-07-25 14:00:19,059 - INFO - Gender: 2,4
2019-07-25 14:00:19,059 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Health','Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-25 14:00:19,061 - INFO - Start Running query A30 Female HBC Buyers
2019-07-25 14:03:36,687 - INFO - Running A30 Female HBC Buyers Done
2019-07-25 14:03:36,687 - INFO - CSV file path: A30 Female HBC Buyers
2019-07-25 14:03:36,947 - INFO - Starting save the query results
2019-07-25 14:03:36,948 - INFO - Total Rows : 6584520
2019-07-25 14:03:36,950 - INFO - Will split into : 7.0 files
2019-07-25 14:03:41,503 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 14.00/A30 Female HBC Buyers_1.csv
2019-07-25 14:03:41,505 - INFO - , with total : 940646 rows
2019-07-25 14:03:46,733 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 14.00/A30 Female HBC Buyers_2.csv
2019-07-25 14:03:46,734 - INFO - , with total : 940646 rows
2019-07-25 14:03:51,688 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 14.00/A30 Female HBC Buyers_3.csv
2019-07-25 14:03:51,690 - INFO - , with total : 940646 rows
2019-07-25 14:03:57,368 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 14.00/A30 Female HBC Buyers_4.csv
2019-07-25 14:03:57,368 - INFO - , with total : 940646 rows
2019-07-25 14:04:02,683 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 14.00/A30 Female HBC Buyers_5.csv
2019-07-25 14:04:02,684 - INFO - , with total : 940646 rows
2019-07-25 14:04:07,657 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 14.00/A30 Female HBC Buyers_6.csv
2019-07-25 14:04:07,658 - INFO - , with total : 940645 rows
2019-07-25 14:04:12,970 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 14.00/A30 Female HBC Buyers_7.csv
2019-07-25 14:04:12,970 - INFO - , with total : 940645 rows
2019-07-25 14:04:15,871 - INFO - Delete all data in sheet: Case 4
2019-07-25 14:04:18,078 - INFO - No value detected on sheet: Case 5
2019-07-25 14:04:19,540 - INFO - No value detected on sheet: Case 6
2019-07-25 14:04:20,631 - INFO - No value detected on sheet: Case 7
2019-07-25 14:04:21,775 - INFO - No value detected on sheet: Case 8
2019-07-25 14:04:23,217 - INFO - No value detected on sheet: Case 9
2019-07-25 17:00:01,592 - INFO - Report date: 20190725 17.00
2019-07-25 17:00:07,979 - INFO - Download sheet..
2019-07-25 17:00:07,980 - INFO - Change directory to script path
2019-07-25 17:00:09,043 - INFO - Spreadsheet downloaded
2019-07-25 17:00:09,043 - INFO - Checking sheet..
2019-07-25 17:00:10,878 - INFO - Value detected - use sheet: Case 1
2019-07-25 17:00:10,878 - INFO - Reading Data From Google Sheet...
2019-07-25 17:00:11,601 - INFO - Get custom SQL..
2019-07-25 17:00:11,602 - INFO - USING CASE 1
2019-07-25 17:00:13,970 - INFO - Row 1
2019-07-25 17:00:13,971 - INFO - Filename:  A30 Automotive
2019-07-25 17:00:13,973 - INFO - Category: 'Automotive Care','Automotive Tools','Car','Car Exterior Accessories','Car Interior Accessories','Car Spare Parts','Motorcycle','Motorcycle Accessories','Motorcycle Rider Accessories','Motorcycle Spare parts','Oil & Lube'
2019-07-25 17:00:13,973 - INFO - Last Login: 30
2019-07-25 17:00:13,974 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Automotive Care','Automotive Tools','Car','Car Exterior Accessories','Car Interior Accessories','Car Spare Parts','Motorcycle','Motorcycle Accessories','Motorcycle Rider Accessories','Motorcycle Spare parts','Oil & Lube')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-25 17:00:13,976 - INFO - Start Running query  A30 Automotive
2019-07-25 17:01:08,496 - INFO - Running  A30 Automotive Done
2019-07-25 17:01:08,496 - INFO - CSV file path:  A30 Automotive
2019-07-25 17:01:08,506 - INFO - Starting save the query results
2019-07-25 17:01:08,507 - INFO - Total Rows : 0
2019-07-25 17:01:08,507 - INFO - Will split into : 0.0 files
2019-07-25 17:01:08,509 - INFO - ERROR -> number sections must be larger than 0.
2019-07-25 17:01:11,105 - INFO - Row 2
2019-07-25 17:01:11,105 - INFO - Filename:  A30 Hobby & Toys
2019-07-25 17:01:11,107 - INFO - Category: 'Agate & Precious Stone','Diecast','Fan Collectible Items','Figure','Handicrafts','Model Kit','Music','Other Hob','Others Hobbies','Pet Care','Puzzle & Board Game','Radio Control','Squishy','Video Games'
2019-07-25 17:01:11,108 - INFO - Last Login: 30
2019-07-25 17:01:11,108 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Agate & Precious Stone','Diecast','Fan Collectible Items','Figure','Handicrafts','Model Kit','Music','Other Hob','Others Hobbies','Pet Care','Puzzle & Board Game','Radio Control','Squishy','Video Games')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-25 17:01:11,108 - INFO - Start Running query  A30 Hobby & Toys
2019-07-25 17:02:01,006 - INFO - Running  A30 Hobby & Toys Done
2019-07-25 17:02:01,007 - INFO - CSV file path:  A30 Hobby & Toys
2019-07-25 17:02:01,009 - INFO - Starting save the query results
2019-07-25 17:02:01,010 - INFO - Total Rows : 0
2019-07-25 17:02:01,010 - INFO - Will split into : 0.0 files
2019-07-25 17:02:01,012 - INFO - ERROR -> number sections must be larger than 0.
2019-07-25 17:02:03,151 - INFO - Row 3
2019-07-25 17:02:03,153 - INFO - Filename: A30 HE, EL & HL (Digital Day)
2019-07-25 17:02:03,153 - INFO - Category: 'Home & Living','Electronics'
2019-07-25 17:02:03,154 - INFO - Last Login: 30
2019-07-25 17:02:03,154 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living','Electronics')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-25 17:02:03,154 - INFO - Start Running query A30 HE, EL & HL (Digital Day)
2019-07-25 17:05:27,740 - INFO - Running A30 HE, EL & HL (Digital Day) Done
2019-07-25 17:05:27,740 - INFO - CSV file path: A30 HE, EL & HL (Digital Day)
2019-07-25 17:05:28,025 - INFO - Starting save the query results
2019-07-25 17:05:28,026 - INFO - Total Rows : 7582702
2019-07-25 17:05:28,026 - INFO - Will split into : 8.0 files
2019-07-25 17:05:32,375 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 17.00/A30 HE, EL & HL (Digital Day)_1.csv
2019-07-25 17:05:32,377 - INFO - , with total : 947838 rows
2019-07-25 17:05:37,377 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 17.00/A30 HE, EL & HL (Digital Day)_2.csv
2019-07-25 17:05:37,378 - INFO - , with total : 947838 rows
2019-07-25 17:05:42,348 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 17.00/A30 HE, EL & HL (Digital Day)_3.csv
2019-07-25 17:05:42,349 - INFO - , with total : 947838 rows
2019-07-25 17:05:47,471 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 17.00/A30 HE, EL & HL (Digital Day)_4.csv
2019-07-25 17:05:47,473 - INFO - , with total : 947838 rows
2019-07-25 17:05:52,529 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 17.00/A30 HE, EL & HL (Digital Day)_5.csv
2019-07-25 17:05:52,530 - INFO - , with total : 947838 rows
2019-07-25 17:05:57,720 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 17.00/A30 HE, EL & HL (Digital Day)_6.csv
2019-07-25 17:05:57,720 - INFO - , with total : 947838 rows
2019-07-25 17:06:02,789 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 17.00/A30 HE, EL & HL (Digital Day)_7.csv
2019-07-25 17:06:02,789 - INFO - , with total : 947837 rows
2019-07-25 17:06:07,815 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190725 17.00/A30 HE, EL & HL (Digital Day)_8.csv
2019-07-25 17:06:07,816 - INFO - , with total : 947837 rows
2019-07-25 17:06:09,569 - INFO - Delete all data in sheet: Case 1
2019-07-25 17:06:11,828 - INFO - No value detected on sheet: Case 2
2019-07-25 17:06:13,351 - INFO - No value detected on sheet: Case 3
2019-07-25 17:06:14,809 - INFO - No value detected on sheet: Case 4
2019-07-25 17:06:16,250 - INFO - No value detected on sheet: Case 5
2019-07-25 17:06:17,688 - INFO - No value detected on sheet: Case 6
2019-07-25 17:06:19,154 - INFO - No value detected on sheet: Case 7
2019-07-25 17:06:20,618 - INFO - No value detected on sheet: Case 8
2019-07-25 17:06:22,069 - INFO - No value detected on sheet: Case 9
2019-07-26 10:00:12,408 - INFO - Report date: 20190726 10.00
2019-07-26 10:00:16,762 - INFO - Download sheet..
2019-07-26 10:00:16,762 - INFO - Change directory to script path
2019-07-26 10:00:18,184 - INFO - Spreadsheet downloaded
2019-07-26 10:00:18,186 - INFO - Checking sheet..
2019-07-26 10:00:19,848 - INFO - No value detected on sheet: Case 1
2019-07-26 10:00:21,138 - INFO - No value detected on sheet: Case 2
2019-07-26 10:00:22,427 - INFO - No value detected on sheet: Case 3
2019-07-26 10:00:23,736 - INFO - No value detected on sheet: Case 4
2019-07-26 10:00:25,020 - INFO - Value detected - use sheet: Case 5
2019-07-26 10:00:25,022 - INFO - Reading Data From Google Sheet...
2019-07-26 10:00:25,716 - INFO - Get custom SQL..
2019-07-26 10:00:25,717 - INFO - USING CASE 5
2019-07-26 10:00:27,671 - INFO - Row 1
2019-07-26 10:00:27,673 - INFO - Filename: A30 Automotive
2019-07-26 10:00:27,673 - INFO - Sub-category: 'Automotive Care','Automotive Tools','Car','Car Exterior Accessories','Car Interior Accessories','Car Spare Parts','Motorcycle','Motorcycle Accessories','Motorcycle Rider Accessories','Motorcycle Spare parts','Oil & Lube'
2019-07-26 10:00:27,674 - INFO - Last Login: 30
2019-07-26 10:00:27,674 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Automotive Care','Automotive Tools','Car','Car Exterior Accessories','Car Interior Accessories','Car Spare Parts','Motorcycle','Motorcycle Accessories','Motorcycle Rider Accessories','Motorcycle Spare parts','Oil & Lube')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-26 10:00:27,676 - INFO - Start Running query A30 Automotive
2019-07-26 10:02:48,381 - INFO - Running A30 Automotive Done
2019-07-26 10:02:48,382 - INFO - CSV file path: A30 Automotive
2019-07-26 10:02:48,486 - INFO - Starting save the query results
2019-07-26 10:02:48,486 - INFO - Total Rows : 2736622
2019-07-26 10:02:48,487 - INFO - Will split into : 3.0 files
2019-07-26 10:02:52,680 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 10.00/A30 Automotive_1.csv
2019-07-26 10:02:52,681 - INFO - , with total : 912208 rows
2019-07-26 10:02:57,213 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 10.00/A30 Automotive_2.csv
2019-07-26 10:02:57,213 - INFO - , with total : 912207 rows
2019-07-26 10:03:01,835 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 10.00/A30 Automotive_3.csv
2019-07-26 10:03:01,836 - INFO - , with total : 912207 rows
2019-07-26 10:03:04,835 - INFO - Row 2
2019-07-26 10:03:04,836 - INFO - Filename: A30 Hobby & Toys
2019-07-26 10:03:04,836 - INFO - Sub-category: 'Agate & Precious Stone','Diecast','Fan Collectible Items','Figure','Handicrafts','Model Kit','Music','Other Hob','Others Hobbies','Pet Care','Puzzle & Board Game','Radio Control','Squishy','Video Games'
2019-07-26 10:03:04,838 - INFO - Last Login: 30
2019-07-26 10:03:04,838 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Agate & Precious Stone','Diecast','Fan Collectible Items','Figure','Handicrafts','Model Kit','Music','Other Hob','Others Hobbies','Pet Care','Puzzle & Board Game','Radio Control','Squishy','Video Games')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-26 10:03:04,839 - INFO - Start Running query A30 Hobby & Toys
2019-07-26 10:05:05,724 - INFO - Running A30 Hobby & Toys Done
2019-07-26 10:05:05,726 - INFO - CSV file path: A30 Hobby & Toys
2019-07-26 10:05:05,821 - INFO - Starting save the query results
2019-07-26 10:05:05,822 - INFO - Total Rows : 2443531
2019-07-26 10:05:05,822 - INFO - Will split into : 3.0 files
2019-07-26 10:05:10,654 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 10.00/A30 Hobby & Toys_1.csv
2019-07-26 10:05:10,654 - INFO - , with total : 814511 rows
2019-07-26 10:05:15,381 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 10.00/A30 Hobby & Toys_2.csv
2019-07-26 10:05:15,382 - INFO - , with total : 814510 rows
2019-07-26 10:05:20,395 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 10.00/A30 Hobby & Toys_3.csv
2019-07-26 10:05:20,397 - INFO - , with total : 814510 rows
2019-07-26 10:05:21,963 - INFO - Delete all data in sheet: Case 5
2019-07-26 10:05:23,404 - INFO - No value detected on sheet: Case 6
2019-07-26 10:05:24,526 - INFO - No value detected on sheet: Case 7
2019-07-26 10:05:25,559 - INFO - No value detected on sheet: Case 8
2019-07-26 10:05:26,296 - INFO - No value detected on sheet: Case 9
2019-07-26 14:00:02,888 - INFO - Report date: 20190726 14.00
2019-07-26 14:00:07,831 - INFO - Download sheet..
2019-07-26 14:00:07,832 - INFO - Change directory to script path
2019-07-26 14:00:08,815 - INFO - Spreadsheet downloaded
2019-07-26 14:00:08,815 - INFO - Checking sheet..
2019-07-26 14:00:10,512 - INFO - No value detected on sheet: Case 1
2019-07-26 14:00:11,805 - INFO - No value detected on sheet: Case 2
2019-07-26 14:00:13,101 - INFO - No value detected on sheet: Case 3
2019-07-26 14:00:14,380 - INFO - No value detected on sheet: Case 4
2019-07-26 14:00:15,667 - INFO - No value detected on sheet: Case 5
2019-07-26 14:00:16,957 - INFO - No value detected on sheet: Case 6
2019-07-26 14:00:18,243 - INFO - No value detected on sheet: Case 7
2019-07-26 14:00:19,507 - INFO - No value detected on sheet: Case 8
2019-07-26 14:00:20,790 - INFO - No value detected on sheet: Case 9
2019-07-26 17:00:02,469 - INFO - Report date: 20190726 17.00
2019-07-26 17:00:06,342 - INFO - Download sheet..
2019-07-26 17:00:06,342 - INFO - Change directory to script path
2019-07-26 17:00:07,344 - INFO - Spreadsheet downloaded
2019-07-26 17:00:07,345 - INFO - Checking sheet..
2019-07-26 17:00:09,055 - INFO - No value detected on sheet: Case 1
2019-07-26 17:00:10,335 - INFO - No value detected on sheet: Case 2
2019-07-26 17:00:11,641 - INFO - No value detected on sheet: Case 3
2019-07-26 17:00:12,941 - INFO - No value detected on sheet: Case 4
2019-07-26 17:00:14,234 - INFO - No value detected on sheet: Case 5
2019-07-26 17:00:15,513 - INFO - No value detected on sheet: Case 6
2019-07-26 17:00:16,845 - INFO - No value detected on sheet: Case 7
2019-07-26 17:00:18,130 - INFO - Value detected - use sheet: Case 8
2019-07-26 17:00:18,131 - INFO - Reading Data From Google Sheet...
2019-07-26 17:00:18,766 - INFO - Get custom SQL..
2019-07-26 17:00:18,766 - INFO - USING CASE 8
2019-07-26 17:00:20,069 - INFO - Row 1
2019-07-26 17:00:20,069 - INFO - Filename: A1 DP buyers
2019-07-26 17:00:20,069 - INFO - Last Login: 1
2019-07-26 17:00:20,071 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar))
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-07-26 17:00:20,071 - INFO - Start Running query A1 DP buyers
2019-07-26 17:00:59,905 - INFO - Running A1 DP buyers Done
2019-07-26 17:00:59,905 - INFO - CSV file path: A1 DP buyers
2019-07-26 17:00:59,963 - INFO - Starting save the query results
2019-07-26 17:00:59,963 - INFO - Total Rows : 1392546
2019-07-26 17:00:59,963 - INFO - Will split into : 2.0 files
2019-07-26 17:01:03,279 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 DP buyers_1.csv
2019-07-26 17:01:03,279 - INFO - , with total : 696273 rows
2019-07-26 17:01:06,882 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 DP buyers_2.csv
2019-07-26 17:01:06,882 - INFO - , with total : 696273 rows
2019-07-26 17:01:08,061 - INFO - Delete all data in sheet: Case 8
2019-07-26 17:01:09,611 - INFO - Value detected - use sheet: Case 9
2019-07-26 17:01:09,611 - INFO - Reading Data From Google Sheet...
2019-07-26 17:01:10,246 - INFO - Get custom SQL..
2019-07-26 17:01:10,247 - INFO - USING CASE 9
2019-07-26 17:01:11,734 - INFO - Row 1
2019-07-26 17:01:11,736 - INFO - Filename: A1 Fashion buyers who haven't shopped DP
2019-07-26 17:01:11,736 - INFO - Last Login: 1
2019-07-26 17:01:11,736 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes') 
                                    and
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-26 17:01:11,737 - INFO - Start Running query A1 Fashion buyers who haven't shopped DP
2019-07-26 17:05:32,806 - INFO - Running A1 Fashion buyers who haven't shopped DP Done
2019-07-26 17:05:32,808 - INFO - CSV file path: A1 Fashion buyers who haven't shopped DP
2019-07-26 17:05:33,029 - INFO - Starting save the query results
2019-07-26 17:05:33,029 - INFO - Total Rows : 4313274
2019-07-26 17:05:33,030 - INFO - Will split into : 5.0 files
2019-07-26 17:05:37,132 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 Fashion buyers who haven't shopped DP_1.csv
2019-07-26 17:05:37,134 - INFO - , with total : 862655 rows
2019-07-26 17:05:41,923 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 Fashion buyers who haven't shopped DP_2.csv
2019-07-26 17:05:41,924 - INFO - , with total : 862655 rows
2019-07-26 17:05:46,578 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 Fashion buyers who haven't shopped DP_3.csv
2019-07-26 17:05:46,579 - INFO - , with total : 862655 rows
2019-07-26 17:05:51,665 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 Fashion buyers who haven't shopped DP_4.csv
2019-07-26 17:05:51,667 - INFO - , with total : 862655 rows
2019-07-26 17:05:56,690 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 Fashion buyers who haven't shopped DP_5.csv
2019-07-26 17:05:56,690 - INFO - , with total : 862654 rows
2019-07-26 17:06:02,644 - INFO - Row 2
2019-07-26 17:06:02,645 - INFO - Filename: A1 FMCG buyers who haven't shopped DP 
2019-07-26 17:06:02,647 - INFO - Last Login: 1
2019-07-26 17:06:02,648 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby') 
                                    and
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-07-26 17:06:02,648 - INFO - Start Running query A1 FMCG buyers who haven't shopped DP 
2019-07-26 17:09:57,108 - INFO - Running A1 FMCG buyers who haven't shopped DP  Done
2019-07-26 17:09:57,109 - INFO - CSV file path: A1 FMCG buyers who haven't shopped DP 
2019-07-26 17:09:57,242 - INFO - Starting save the query results
2019-07-26 17:09:57,243 - INFO - Total Rows : 3465293
2019-07-26 17:09:57,243 - INFO - Will split into : 4.0 files
2019-07-26 17:10:01,186 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 FMCG buyers who haven't shopped DP _1.csv
2019-07-26 17:10:01,187 - INFO - , with total : 866324 rows
2019-07-26 17:10:05,566 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 FMCG buyers who haven't shopped DP _2.csv
2019-07-26 17:10:05,568 - INFO - , with total : 866323 rows
2019-07-26 17:10:10,042 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 FMCG buyers who haven't shopped DP _3.csv
2019-07-26 17:10:10,042 - INFO - , with total : 866323 rows
2019-07-26 17:10:14,621 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190726 17.00/A1 FMCG buyers who haven't shopped DP _4.csv
2019-07-26 17:10:14,622 - INFO - , with total : 866323 rows
2019-07-26 17:10:16,030 - INFO - Delete all data in sheet: Case 9
2019-07-27 10:00:06,878 - INFO - Report date: 20190727 10.00
2019-07-27 10:00:10,877 - INFO - Download sheet..
2019-07-27 10:00:10,877 - INFO - Change directory to script path
2019-07-27 10:00:12,338 - INFO - Spreadsheet downloaded
2019-07-27 10:00:12,338 - INFO - Checking sheet..
2019-07-27 10:00:14,582 - INFO - No value detected on sheet: Case 1
2019-07-27 10:00:15,904 - INFO - No value detected on sheet: Case 2
2019-07-27 10:00:17,227 - INFO - No value detected on sheet: Case 3
2019-07-27 10:00:18,525 - INFO - No value detected on sheet: Case 4
2019-07-27 10:00:19,851 - INFO - No value detected on sheet: Case 5
2019-07-27 10:00:21,150 - INFO - No value detected on sheet: Case 6
2019-07-27 10:00:22,493 - INFO - No value detected on sheet: Case 7
2019-07-27 10:00:23,808 - INFO - No value detected on sheet: Case 8
2019-07-27 10:00:25,177 - INFO - No value detected on sheet: Case 9
2019-07-27 14:00:06,127 - INFO - Report date: 20190727 14.00
2019-07-27 14:00:10,025 - INFO - Download sheet..
2019-07-27 14:00:10,025 - INFO - Change directory to script path
2019-07-27 14:00:11,306 - INFO - Spreadsheet downloaded
2019-07-27 14:00:11,308 - INFO - Checking sheet..
2019-07-27 14:00:13,131 - INFO - No value detected on sheet: Case 1
2019-07-27 14:00:14,605 - INFO - No value detected on sheet: Case 2
2019-07-27 14:00:16,036 - INFO - No value detected on sheet: Case 3
2019-07-27 14:00:17,480 - INFO - No value detected on sheet: Case 4
2019-07-27 14:00:18,943 - INFO - No value detected on sheet: Case 5
2019-07-27 14:00:20,372 - INFO - No value detected on sheet: Case 6
2019-07-27 14:00:21,828 - INFO - No value detected on sheet: Case 7
2019-07-27 14:00:23,338 - INFO - No value detected on sheet: Case 8
2019-07-27 14:00:24,795 - INFO - No value detected on sheet: Case 9
2019-07-27 17:00:01,969 - INFO - Report date: 20190727 17.00
2019-07-27 17:00:07,017 - INFO - Download sheet..
2019-07-27 17:00:07,019 - INFO - Change directory to script path
2019-07-27 17:00:08,441 - INFO - Spreadsheet downloaded
2019-07-27 17:00:08,443 - INFO - Checking sheet..
2019-07-27 17:00:10,111 - INFO - No value detected on sheet: Case 1
2019-07-27 17:00:11,388 - INFO - No value detected on sheet: Case 2
2019-07-27 17:00:12,667 - INFO - No value detected on sheet: Case 3
2019-07-27 17:00:13,944 - INFO - No value detected on sheet: Case 4
2019-07-27 17:00:15,226 - INFO - No value detected on sheet: Case 5
2019-07-27 17:00:16,523 - INFO - No value detected on sheet: Case 6
2019-07-27 17:00:17,835 - INFO - No value detected on sheet: Case 7
2019-07-27 17:00:19,115 - INFO - No value detected on sheet: Case 8
2019-07-27 17:00:20,401 - INFO - No value detected on sheet: Case 9
2019-07-28 10:00:10,128 - INFO - Report date: 20190728 10.00
2019-07-28 10:00:14,803 - INFO - Download sheet..
2019-07-28 10:00:14,805 - INFO - Change directory to script path
2019-07-28 10:00:16,272 - INFO - Spreadsheet downloaded
2019-07-28 10:00:16,272 - INFO - Checking sheet..
2019-07-28 10:00:17,950 - INFO - No value detected on sheet: Case 1
2019-07-28 10:00:19,237 - INFO - No value detected on sheet: Case 2
2019-07-28 10:00:20,552 - INFO - No value detected on sheet: Case 3
2019-07-28 10:00:21,832 - INFO - No value detected on sheet: Case 4
2019-07-28 10:00:23,305 - INFO - No value detected on sheet: Case 5
2019-07-28 10:00:24,601 - INFO - No value detected on sheet: Case 6
2019-07-28 10:00:25,898 - INFO - No value detected on sheet: Case 7
2019-07-28 10:00:27,187 - INFO - No value detected on sheet: Case 8
2019-07-28 10:00:28,528 - INFO - No value detected on sheet: Case 9
2019-07-28 14:00:06,180 - INFO - Report date: 20190728 14.00
2019-07-28 14:00:10,632 - INFO - Download sheet..
2019-07-28 14:00:10,634 - INFO - Change directory to script path
2019-07-28 14:00:12,246 - INFO - Spreadsheet downloaded
2019-07-28 14:00:12,247 - INFO - Checking sheet..
2019-07-28 14:00:14,012 - INFO - No value detected on sheet: Case 1
2019-07-28 14:00:15,328 - INFO - No value detected on sheet: Case 2
2019-07-28 14:00:16,615 - INFO - No value detected on sheet: Case 3
2019-07-28 14:00:17,921 - INFO - No value detected on sheet: Case 4
2019-07-28 14:00:19,217 - INFO - No value detected on sheet: Case 5
2019-07-28 14:00:20,528 - INFO - No value detected on sheet: Case 6
2019-07-28 14:00:21,845 - INFO - No value detected on sheet: Case 7
2019-07-28 14:00:23,167 - INFO - No value detected on sheet: Case 8
2019-07-28 14:00:24,499 - INFO - No value detected on sheet: Case 9
2019-07-28 17:00:01,562 - INFO - Report date: 20190728 17.00
2019-07-28 17:00:05,375 - INFO - Download sheet..
2019-07-28 17:00:05,377 - INFO - Change directory to script path
2019-07-28 17:00:06,821 - INFO - Spreadsheet downloaded
2019-07-28 17:00:06,822 - INFO - Checking sheet..
2019-07-28 17:00:08,510 - INFO - No value detected on sheet: Case 1
2019-07-28 17:00:09,970 - INFO - No value detected on sheet: Case 2
2019-07-28 17:00:11,232 - INFO - No value detected on sheet: Case 3
2019-07-28 17:00:12,516 - INFO - No value detected on sheet: Case 4
2019-07-28 17:00:13,789 - INFO - No value detected on sheet: Case 5
2019-07-28 17:00:15,072 - INFO - No value detected on sheet: Case 6
2019-07-28 17:00:16,378 - INFO - No value detected on sheet: Case 7
2019-07-28 17:00:17,653 - INFO - No value detected on sheet: Case 8
2019-07-28 17:00:18,940 - INFO - No value detected on sheet: Case 9
2019-07-29 10:00:13,375 - INFO - Report date: 20190729 10.00
2019-07-29 10:00:17,582 - INFO - Download sheet..
2019-07-29 10:00:17,582 - INFO - Change directory to script path
2019-07-29 10:00:18,505 - INFO - Spreadsheet downloaded
2019-07-29 10:00:18,506 - INFO - Checking sheet..
2019-07-29 10:00:20,453 - INFO - Value detected - use sheet: Case 1
2019-07-29 10:00:20,453 - INFO - Reading Data From Google Sheet...
2019-07-29 10:00:21,161 - INFO - Get custom SQL..
2019-07-29 10:00:21,161 - INFO - USING CASE 1
2019-07-29 10:00:23,338 - INFO - Row 1
2019-07-29 10:00:23,339 - INFO - Filename: A7 EL Buyers
2019-07-29 10:00:23,339 - INFO - Category: 'Computer & Accessories'
2019-07-29 10:00:23,341 - INFO - Last Login: 7
2019-07-29 10:00:23,341 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Computer & Accessories')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-29 10:00:23,342 - INFO - Start Running query A7 EL Buyers
2019-07-29 10:02:18,868 - INFO - Running A7 EL Buyers Done
2019-07-29 10:02:18,868 - INFO - CSV file path: A7 EL Buyers
2019-07-29 10:02:18,947 - INFO - Starting save the query results
2019-07-29 10:02:18,948 - INFO - Total Rows : 2161743
2019-07-29 10:02:18,950 - INFO - Will split into : 3.0 files
2019-07-29 10:02:22,190 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190729 10.00/A7 EL Buyers_1.csv
2019-07-29 10:02:22,191 - INFO - , with total : 720581 rows
2019-07-29 10:02:25,799 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190729 10.00/A7 EL Buyers_2.csv
2019-07-29 10:02:25,799 - INFO - , with total : 720581 rows
2019-07-29 10:02:29,378 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190729 10.00/A7 EL Buyers_3.csv
2019-07-29 10:02:29,378 - INFO - , with total : 720581 rows
2019-07-29 10:02:30,575 - INFO - Delete all data in sheet: Case 1
2019-07-29 10:02:32,463 - INFO - No value detected on sheet: Case 2
2019-07-29 10:02:33,927 - INFO - No value detected on sheet: Case 3
2019-07-29 10:02:35,029 - INFO - No value detected on sheet: Case 4
2019-07-29 10:02:36,440 - INFO - No value detected on sheet: Case 5
2019-07-29 10:02:37,892 - INFO - No value detected on sheet: Case 6
2019-07-29 10:02:39,339 - INFO - No value detected on sheet: Case 7
2019-07-29 10:02:40,799 - INFO - No value detected on sheet: Case 8
2019-07-29 10:02:41,894 - INFO - No value detected on sheet: Case 9
2019-07-29 14:00:09,813 - INFO - Report date: 20190729 14.00
2019-07-29 14:00:13,806 - INFO - Download sheet..
2019-07-29 14:00:13,808 - INFO - Change directory to script path
2019-07-29 14:00:14,816 - INFO - Spreadsheet downloaded
2019-07-29 14:00:14,818 - INFO - Checking sheet..
2019-07-29 14:00:16,871 - INFO - Value detected - use sheet: Case 1
2019-07-29 14:00:16,872 - INFO - Reading Data From Google Sheet...
2019-07-29 14:00:17,440 - INFO - Get custom SQL..
2019-07-29 14:00:17,440 - INFO - USING CASE 1
2019-07-29 14:00:19,492 - INFO - Row 1
2019-07-29 14:00:19,493 - INFO - Filename: A30 F&B Buyers
2019-07-29 14:00:19,493 - INFO - Category: 'Food & Beverages'
2019-07-29 14:00:19,496 - INFO - Last Login: 30
2019-07-29 14:00:19,496 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-29 14:00:19,496 - INFO - Start Running query A30 F&B Buyers
2019-07-29 14:03:59,579 - INFO - Running A30 F&B Buyers Done
2019-07-29 14:03:59,581 - INFO - CSV file path: A30 F&B Buyers
2019-07-29 14:03:59,746 - INFO - Starting save the query results
2019-07-29 14:03:59,746 - INFO - Total Rows : 2903847
2019-07-29 14:03:59,746 - INFO - Will split into : 3.0 files
2019-07-29 14:04:04,665 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190729 14.00/A30 F&B Buyers_1.csv
2019-07-29 14:04:04,667 - INFO - , with total : 967949 rows
2019-07-29 14:04:09,654 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190729 14.00/A30 F&B Buyers_2.csv
2019-07-29 14:04:09,654 - INFO - , with total : 967949 rows
2019-07-29 14:04:14,947 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190729 14.00/A30 F&B Buyers_3.csv
2019-07-29 14:04:14,947 - INFO - , with total : 967949 rows
2019-07-29 14:04:16,450 - INFO - Delete all data in sheet: Case 1
2019-07-29 14:04:18,263 - INFO - No value detected on sheet: Case 2
2019-07-29 14:04:19,436 - INFO - No value detected on sheet: Case 3
2019-07-29 14:04:20,596 - INFO - No value detected on sheet: Case 4
2019-07-29 14:04:21,798 - INFO - No value detected on sheet: Case 5
2019-07-29 14:04:23,058 - INFO - No value detected on sheet: Case 6
2019-07-29 14:04:24,210 - INFO - Value detected - use sheet: Case 7
2019-07-29 14:04:24,210 - INFO - Reading Data From Google Sheet...
2019-07-29 14:04:24,796 - INFO - Get custom SQL..
2019-07-29 14:04:24,798 - INFO - USING CASE 7
2019-07-29 14:04:25,611 - INFO - Row 1
2019-07-29 14:04:25,612 - INFO - Filename: Xiaomi Official Shop Followers
2019-07-29 14:04:25,614 - INFO - Shop ID: 51925611
2019-07-29 14:04:25,614 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 51925611 
                                and status = 1
                                
2019-07-29 14:04:25,615 - INFO - Start Running query Xiaomi Official Shop Followers
2019-07-29 14:04:42,727 - INFO - Running Xiaomi Official Shop Followers Done
2019-07-29 14:04:42,729 - INFO - CSV file path: Xiaomi Official Shop Followers
2019-07-29 14:04:42,750 - INFO - Starting save the query results
2019-07-29 14:04:42,752 - INFO - Total Rows : 512841
2019-07-29 14:04:42,757 - INFO - Will split into : 1.0 files
2019-07-29 14:04:45,260 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190729 14.00/Xiaomi Official Shop Followers_1.csv
2019-07-29 14:04:45,262 - INFO - , with total : 512841 rows
2019-07-29 14:04:46,279 - INFO - Delete all data in sheet: Case 7
2019-07-29 14:04:47,582 - INFO - No value detected on sheet: Case 8
2019-07-29 14:04:48,753 - INFO - No value detected on sheet: Case 9
2019-07-29 17:00:02,089 - INFO - Report date: 20190729 17.00
2019-07-29 17:00:05,289 - INFO - Download sheet..
2019-07-29 17:00:05,289 - INFO - Change directory to script path
2019-07-29 17:00:06,325 - INFO - Spreadsheet downloaded
2019-07-29 17:00:06,326 - INFO - Checking sheet..
2019-07-29 17:00:07,872 - INFO - No value detected on sheet: Case 1
2019-07-29 17:00:09,045 - INFO - No value detected on sheet: Case 2
2019-07-29 17:00:10,566 - INFO - No value detected on sheet: Case 3
2019-07-29 17:00:12,128 - INFO - No value detected on sheet: Case 4
2019-07-29 17:00:13,239 - INFO - No value detected on sheet: Case 5
2019-07-29 17:00:14,829 - INFO - No value detected on sheet: Case 6
2019-07-29 17:00:16,013 - INFO - No value detected on sheet: Case 7
2019-07-29 17:00:17,174 - INFO - No value detected on sheet: Case 8
2019-07-29 17:00:18,359 - INFO - No value detected on sheet: Case 9
2019-07-30 10:00:12,026 - INFO - Report date: 20190730 10.00
2019-07-30 10:00:15,950 - INFO - Download sheet..
2019-07-30 10:00:15,950 - INFO - Change directory to script path
2019-07-30 10:00:17,084 - INFO - Spreadsheet downloaded
2019-07-30 10:00:17,085 - INFO - Checking sheet..
2019-07-30 10:00:18,957 - INFO - No value detected on sheet: Case 1
2019-07-30 10:00:20,434 - INFO - No value detected on sheet: Case 2
2019-07-30 10:00:21,877 - INFO - No value detected on sheet: Case 3
2019-07-30 10:00:23,342 - INFO - No value detected on sheet: Case 4
2019-07-30 10:00:24,785 - INFO - No value detected on sheet: Case 5
2019-07-30 10:00:26,240 - INFO - No value detected on sheet: Case 6
2019-07-30 10:00:27,703 - INFO - No value detected on sheet: Case 7
2019-07-30 10:00:29,157 - INFO - No value detected on sheet: Case 8
2019-07-30 10:00:30,614 - INFO - No value detected on sheet: Case 9
2019-07-30 14:00:07,746 - INFO - Report date: 20190730 14.00
2019-07-30 14:00:11,736 - INFO - Download sheet..
2019-07-30 14:00:11,736 - INFO - Change directory to script path
2019-07-30 14:00:13,042 - INFO - Spreadsheet downloaded
2019-07-30 14:00:13,042 - INFO - Checking sheet..
2019-07-30 14:00:15,134 - INFO - Value detected - use sheet: Case 1
2019-07-30 14:00:15,134 - INFO - Reading Data From Google Sheet...
2019-07-30 14:00:15,891 - INFO - Get custom SQL..
2019-07-30 14:00:15,891 - INFO - USING CASE 1
2019-07-30 14:00:18,403 - INFO - Row 1
2019-07-30 14:00:18,405 - INFO - Filename: A1 FMCG Buyers
2019-07-30 14:00:18,407 - INFO - Category: 'Mom & Baby'
2019-07-30 14:00:18,408 - INFO - Last Login: 1
2019-07-30 14:00:18,408 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mom & Baby')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-30 14:00:18,413 - INFO - Start Running query A1 FMCG Buyers
2019-07-30 14:01:40,137 - INFO - Running A1 FMCG Buyers Done
2019-07-30 14:01:40,141 - INFO - CSV file path: A1 FMCG Buyers
2019-07-30 14:01:40,243 - INFO - Starting save the query results
2019-07-30 14:01:40,243 - INFO - Total Rows : 2060577
2019-07-30 14:01:40,246 - INFO - Will split into : 3.0 files
2019-07-30 14:01:43,858 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 14.00/A1 FMCG Buyers_1.csv
2019-07-30 14:01:43,859 - INFO - , with total : 686859 rows
2019-07-30 14:01:47,381 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 14.00/A1 FMCG Buyers_2.csv
2019-07-30 14:01:47,381 - INFO - , with total : 686859 rows
2019-07-30 14:01:51,002 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 14.00/A1 FMCG Buyers_3.csv
2019-07-30 14:01:51,003 - INFO - , with total : 686859 rows
2019-07-30 14:01:52,280 - INFO - Delete all data in sheet: Case 1
2019-07-30 14:01:55,000 - INFO - No value detected on sheet: Case 2
2019-07-30 14:01:56,569 - INFO - No value detected on sheet: Case 3
2019-07-30 14:01:58,163 - INFO - No value detected on sheet: Case 4
2019-07-30 14:01:59,674 - INFO - No value detected on sheet: Case 5
2019-07-30 14:02:01,210 - INFO - No value detected on sheet: Case 6
2019-07-30 14:02:02,832 - INFO - No value detected on sheet: Case 7
2019-07-30 14:02:03,862 - INFO - No value detected on sheet: Case 8
2019-07-30 14:02:05,737 - INFO - No value detected on sheet: Case 9
2019-07-30 15:12:55,759 - INFO - Report date: 20190730 15.12
2019-07-30 15:12:56,581 - INFO - Download sheet..
2019-07-30 15:12:56,581 - INFO - Change directory to script path
2019-07-30 15:12:58,529 - INFO - Spreadsheet downloaded
2019-07-30 15:12:58,529 - INFO - Checking sheet..
2019-07-30 15:13:00,674 - INFO - No value detected on sheet: Case 1
2019-07-30 15:13:02,273 - INFO - No value detected on sheet: Case 2
2019-07-30 15:13:03,759 - INFO - No value detected on sheet: Case 3
2019-07-30 15:13:05,275 - INFO - No value detected on sheet: Case 4
2019-07-30 15:13:06,737 - INFO - No value detected on sheet: Case 5
2019-07-30 15:13:08,227 - INFO - Value detected - use sheet: Case 6
2019-07-30 15:13:08,229 - INFO - Reading Data From Google Sheet...
2019-07-30 15:13:08,957 - INFO - Get custom SQL..
2019-07-30 15:13:08,959 - INFO - USING CASE 6
2019-07-30 15:13:11,253 - INFO - Row 1
2019-07-30 15:13:11,253 - INFO - Filename: A7 GAME BUYERS
2019-07-30 15:13:11,256 - INFO - Sub-category: 'Video Games','Gaming'
2019-07-30 15:13:11,256 - INFO - Last Login: 7
2019-07-30 15:13:11,256 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Video Games','Gaming')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-30 15:13:11,259 - INFO - Start Running query A7 GAME BUYERS
2019-07-30 15:14:00,280 - INFO - Running A7 GAME BUYERS Done
2019-07-30 15:14:00,282 - INFO - CSV file path: A7 GAME BUYERS
2019-07-30 15:14:00,332 - INFO - Starting save the query results
2019-07-30 15:14:00,332 - INFO - Total Rows : 599492
2019-07-30 15:14:00,334 - INFO - Will split into : 1.0 files
2019-07-30 15:14:03,694 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.12/A7 GAME BUYERS_1.csv
2019-07-30 15:14:03,696 - INFO - , with total : 599492 rows
2019-07-30 15:14:04,539 - INFO - Delete all data in sheet: Case 6
2019-07-30 15:14:06,543 - INFO - No value detected on sheet: Case 7
2019-07-30 15:14:08,039 - INFO - Value detected - use sheet: Case 8
2019-07-30 15:14:08,040 - INFO - Reading Data From Google Sheet...
2019-07-30 15:14:08,765 - INFO - Get custom SQL..
2019-07-30 15:14:08,766 - INFO - USING CASE 8
2019-07-30 15:14:09,591 - INFO - Row 1
2019-07-30 15:14:09,592 - INFO - Filename: ASUS and HP Official shop followers
2019-07-30 15:14:09,592 - INFO - Shop ID: 54873248,92611640
2019-07-30 15:14:09,594 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 54873248,92611640 
                                and status = 1
                                
2019-07-30 15:14:09,595 - INFO - Start Running query ASUS and HP Official shop followers
2019-07-30 15:14:09,684 - INFO - java.sql.SQLException: Query failed (#20190730_081415_18508_us6nu): line 5:56: mismatched input ','. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', '[', '||', <EOF>
2019-07-30 15:14:09,763 - INFO - java.sql.SQLException: Query failed (#20190730_081415_18509_us6nu): line 5:56: mismatched input ','. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', '[', '||', <EOF>
2019-07-30 15:14:09,849 - INFO - java.sql.SQLException: Query failed (#20190730_081415_18510_us6nu): line 5:56: mismatched input ','. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', '[', '||', <EOF>
2019-07-30 15:14:09,934 - INFO - java.sql.SQLException: Query failed (#20190730_081416_18511_us6nu): line 5:56: mismatched input ','. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', '[', '||', <EOF>
2019-07-30 15:14:10,032 - INFO - java.sql.SQLException: Query failed (#20190730_081416_18512_us6nu): line 5:56: mismatched input ','. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OR', 'ORDER', 'UNION', '[', '||', <EOF>
2019-07-30 15:14:10,033 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-07-30 15:14:10,433 - INFO - Delete all data in sheet: Case 8
2019-07-30 15:14:12,391 - INFO - No value detected on sheet: Case 9
2019-07-30 15:14:13,211 - INFO - No value detected on sheet: Case 10
2019-07-30 15:14:14,049 - INFO - Value detected - use sheet: Case 11
2019-07-30 15:14:14,049 - INFO - Reading Data From Google Sheet...
2019-07-30 15:14:14,453 - INFO - Get custom SQL..
2019-07-30 15:14:14,453 - INFO - USING CASE 11
2019-07-30 15:14:16,125 - INFO - Row 1
2019-07-30 15:14:16,125 - INFO - Filename: HP printer buyer
2019-07-30 15:14:16,127 - INFO - Item ID: 1564262367
2019-07-30 15:14:16,128 - INFO - Date 1: 2019-04-29
2019-07-30 15:14:16,128 - INFO - Date 2: 2019-07-29
2019-07-30 15:14:16,130 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(p.userid as varchar)) as list_userid
                                from order_mart__order_item_profile as p
                                where itemid in (1564262367)
                                and grass_date between date'2019-04-29' and date'2019-07-29'
                                
2019-07-30 15:14:16,131 - INFO - Start Running query HP printer buyer
2019-07-30 15:14:20,688 - INFO - Running HP printer buyer Done
2019-07-30 15:14:20,690 - INFO - CSV file path: HP printer buyer
2019-07-30 15:14:20,690 - INFO - Starting save the query results
2019-07-30 15:14:20,691 - INFO - Total Rows : 254
2019-07-30 15:14:20,693 - INFO - Will split into : 1.0 files
2019-07-30 15:14:20,709 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.12/HP printer buyer_1.csv
2019-07-30 15:14:20,710 - INFO - , with total : 254 rows
2019-07-30 15:14:21,453 - INFO - Delete all data in sheet: Case 11
2019-07-30 15:14:22,713 - INFO - Value detected - use sheet: Case 12
2019-07-30 15:14:22,713 - INFO - Reading Data From Google Sheet...
2019-07-30 15:14:23,111 - INFO - Get custom SQL..
2019-07-30 15:14:23,111 - INFO - USING CASE 12
2019-07-30 15:14:24,657 - INFO - Row 1
2019-07-30 15:14:24,657 - INFO - Filename: Goyang Shopee user
2019-07-30 15:14:24,660 - INFO - Date 1: 2019-07-10
2019-07-30 15:14:24,661 - INFO - Date 2: 2019-07-20
2019-07-30 15:14:24,661 - INFO - Error in get_custom_sql -> float argument required, not unicode
2019-07-30 15:14:24,663 - INFO - Delete all data in sheet: Case 12
2019-07-30 15:14:26,206 - INFO - Value detected - use sheet: Case 13
2019-07-30 15:14:26,207 - INFO - Reading Data From Google Sheet...
2019-07-30 15:14:26,605 - INFO - Get custom SQL..
2019-07-30 15:14:26,607 - INFO - USING CASE 13
2019-07-30 15:14:27,953 - INFO - Row 1
2019-07-30 15:14:27,954 - INFO - Filename: Quiz Shopee user
2019-07-30 15:14:27,956 - INFO - Date 1: 2019-07-10
2019-07-30 15:14:27,957 - INFO - Date 2: 2019-07-20
2019-07-30 15:14:27,957 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from shopee_id_bi_team__kuis_players as a
                                join shopee_gamehq_id_db__hq_sessions_tab as b 
                                on a.session_id = cast(b.id as varchar)
                                join shopee_gamehq_id_db__hq_events_tab as c 
                                on a.event_id = cast(c.id as varchar)
                                where date(from_unixtime(b.start,'Asia/Jakarta')) >= date('2019-07-10')
                                and date(from_unixtime(b.start,'Asia/Jakarta')) <= date('2019-07-20')
                                
2019-07-30 15:14:27,960 - INFO - Start Running query Quiz Shopee user
2019-07-30 15:14:35,227 - INFO - Running Quiz Shopee user Done
2019-07-30 15:14:35,229 - INFO - CSV file path: Quiz Shopee user
2019-07-30 15:14:35,239 - INFO - Starting save the query results
2019-07-30 15:14:35,240 - INFO - Total Rows : 113554
2019-07-30 15:14:35,240 - INFO - Will split into : 1.0 files
2019-07-30 15:14:35,792 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.12/Quiz Shopee user_1.csv
2019-07-30 15:14:35,793 - INFO - , with total : 113554 rows
2019-07-30 15:14:36,229 - INFO - Delete all data in sheet: Case 13
2019-07-30 15:14:37,845 - INFO - Value detected - use sheet: Case 14
2019-07-30 15:14:37,846 - INFO - Reading Data From Google Sheet...
2019-07-30 15:14:38,243 - INFO - Get custom SQL..
2019-07-30 15:14:38,244 - INFO - USING CASE 14
2019-07-30 15:14:39,806 - INFO - Row 1
2019-07-30 15:14:39,808 - INFO - Filename: One Dollar Game user
2019-07-30 15:14:39,809 - INFO - Date 1: 2019-07-10
2019-07-30 15:14:39,809 - INFO - Date 2: 2019-07-20
2019-07-30 15:14:39,809 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(p.userid as varchar)) as list_userid, grass_date
                                from order_mart__order_item_profile as p
                                where bi_excluded = 'OneDollarGame'
                                and grass_date between date'2019-07-10' and date'2019-07-20'
                                
2019-07-30 15:14:39,811 - INFO - Start Running query One Dollar Game user
2019-07-30 15:16:07,265 - INFO - Running One Dollar Game user Done
2019-07-30 15:16:07,266 - INFO - CSV file path: One Dollar Game user
2019-07-30 15:16:07,507 - INFO - Starting save the query results
2019-07-30 15:16:07,507 - INFO - Total Rows : 1518880
2019-07-30 15:16:07,509 - INFO - Will split into : 2.0 files
2019-07-30 15:16:11,747 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.12/One Dollar Game user_1.csv
2019-07-30 15:16:11,747 - INFO - , with total : 759440 rows
2019-07-30 15:16:15,934 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.12/One Dollar Game user_2.csv
2019-07-30 15:16:15,934 - INFO - , with total : 759440 rows
2019-07-30 15:16:16,520 - INFO - Delete all data in sheet: Case 14
2019-07-30 15:16:18,157 - INFO - Value detected - use sheet: Case 15
2019-07-30 15:16:18,158 - INFO - Reading Data From Google Sheet...
2019-07-30 15:16:18,562 - INFO - Get custom SQL..
2019-07-30 15:16:18,562 - INFO - USING CASE 15
2019-07-30 15:16:19,819 - INFO - Row 1
2019-07-30 15:16:19,821 - INFO - Filename: Daily Prize user
2019-07-30 15:16:19,822 - INFO - Date 1: 2019-07-10
2019-07-30 15:16:19,823 - INFO - Date 2: 2019-07-20
2019-07-30 15:16:19,823 - INFO - Error in get_custom_sql -> unsupported format character 'Y' (0x59) at index 437
2019-07-30 15:16:19,825 - INFO - Delete all data in sheet: Case 15
2019-07-30 15:34:30,280 - INFO - Report date: 20190730 15.34
2019-07-30 15:34:30,315 - INFO - Download sheet..
2019-07-30 15:34:30,315 - INFO - Change directory to script path
2019-07-30 15:34:32,542 - INFO - Spreadsheet downloaded
2019-07-30 15:34:32,542 - INFO - Checking sheet..
2019-07-30 15:34:35,309 - INFO - No value detected on sheet: Case 1
2019-07-30 15:34:36,851 - INFO - No value detected on sheet: Case 2
2019-07-30 15:34:38,976 - INFO - No value detected on sheet: Case 3
2019-07-30 15:34:40,605 - INFO - No value detected on sheet: Case 4
2019-07-30 15:34:42,138 - INFO - No value detected on sheet: Case 5
2019-07-30 15:34:43,707 - INFO - Value detected - use sheet: Case 6
2019-07-30 15:34:43,709 - INFO - Reading Data From Google Sheet...
2019-07-30 15:34:44,476 - INFO - Get custom SQL..
2019-07-30 15:34:44,477 - INFO - USING CASE 6
2019-07-30 15:34:47,857 - INFO - Row 1
2019-07-30 15:34:47,857 - INFO - Filename: A14 Game Buyers
2019-07-30 15:34:47,858 - INFO - Sub-category: 'Video Games','Gaming'
2019-07-30 15:34:47,858 - INFO - Last Login: 14
2019-07-30 15:34:47,859 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Video Games','Gaming')
                                    and
                                    last_login >= current_date - interval '14' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-30 15:34:47,861 - INFO - Start Running query A14 Game Buyers
2019-07-30 15:35:53,221 - INFO - Running A14 Game Buyers Done
2019-07-30 15:35:53,223 - INFO - CSV file path: A14 Game Buyers
2019-07-30 15:35:53,276 - INFO - Starting save the query results
2019-07-30 15:35:53,278 - INFO - Total Rows : 676459
2019-07-30 15:35:53,279 - INFO - Will split into : 1.0 files
2019-07-30 15:35:56,944 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.34/A14 Game Buyers_1.csv
2019-07-30 15:35:56,944 - INFO - , with total : 676459 rows
2019-07-30 15:35:57,466 - INFO - Delete all data in sheet: Case 6
2019-07-30 15:35:59,536 - INFO - No value detected on sheet: Case 7
2019-07-30 15:36:01,016 - INFO - Value detected - use sheet: Case 8
2019-07-30 15:36:01,016 - INFO - Reading Data From Google Sheet...
2019-07-30 15:36:01,743 - INFO - Get custom SQL..
2019-07-30 15:36:01,743 - INFO - USING CASE 8
2019-07-30 15:36:03,038 - INFO - Row 1
2019-07-30 15:36:03,039 - INFO - Filename: ASUS and HP Official shop followers
2019-07-30 15:36:03,039 - INFO - Shop ID: 54873248,92611640
2019-07-30 15:36:03,039 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (54873248,92611640) 
                                and status = 1
                                
2019-07-30 15:36:03,042 - INFO - Start Running query ASUS and HP Official shop followers
2019-07-30 15:36:23,151 - INFO - Running ASUS and HP Official shop followers Done
2019-07-30 15:36:23,151 - INFO - CSV file path: ASUS and HP Official shop followers
2019-07-30 15:36:23,167 - INFO - Starting save the query results
2019-07-30 15:36:23,167 - INFO - Total Rows : 138965
2019-07-30 15:36:23,167 - INFO - Will split into : 1.0 files
2019-07-30 15:36:23,907 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.34/ASUS and HP Official shop followers_1.csv
2019-07-30 15:36:23,908 - INFO - , with total : 138965 rows
2019-07-30 15:36:24,660 - INFO - Delete all data in sheet: Case 8
2019-07-30 15:36:26,292 - INFO - No value detected on sheet: Case 9
2019-07-30 15:36:27,766 - INFO - No value detected on sheet: Case 10
2019-07-30 15:36:29,273 - INFO - Value detected - use sheet: Case 11
2019-07-30 15:36:29,275 - INFO - Reading Data From Google Sheet...
2019-07-30 15:36:30,005 - INFO - Get custom SQL..
2019-07-30 15:36:30,006 - INFO - USING CASE 11
2019-07-30 15:36:33,234 - INFO - Row 1
2019-07-30 15:36:33,236 - INFO - Filename: TOTOLINK buyer
2019-07-30 15:36:33,236 - INFO - Item ID: 1966428653
2019-07-30 15:36:33,237 - INFO - Date 1: 2019-04-29
2019-07-30 15:36:33,239 - INFO - Date 2: 2019-07-29
2019-07-30 15:36:33,240 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(p.userid as varchar)) as list_userid
                                from order_mart__order_item_profile as p
                                where itemid in (1966428653)
                                and grass_date between date'2019-04-29' and date'2019-07-29'
                                
2019-07-30 15:36:33,240 - INFO - Start Running query TOTOLINK buyer
2019-07-30 15:36:41,441 - INFO - Running TOTOLINK buyer Done
2019-07-30 15:36:41,444 - INFO - CSV file path: TOTOLINK buyer
2019-07-30 15:36:41,446 - INFO - Starting save the query results
2019-07-30 15:36:41,446 - INFO - Total Rows : 2
2019-07-30 15:36:41,447 - INFO - Will split into : 1.0 files
2019-07-30 15:36:41,460 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.34/TOTOLINK buyer_1.csv
2019-07-30 15:36:41,463 - INFO - , with total : 2 rows
2019-07-30 15:36:41,930 - INFO - Delete all data in sheet: Case 11
2019-07-30 15:36:43,930 - INFO - Value detected - use sheet: Case 12
2019-07-30 15:36:43,931 - INFO - Reading Data From Google Sheet...
2019-07-30 15:36:44,671 - INFO - Get custom SQL..
2019-07-30 15:36:44,671 - INFO - USING CASE 12
2019-07-30 15:36:46,381 - INFO - Row 1
2019-07-30 15:36:46,381 - INFO - Filename: Goyang Shopee user
2019-07-30 15:36:46,381 - INFO - Date 1: 2019-07-10
2019-07-30 15:36:46,382 - INFO - Date 2: 2019-07-20
2019-07-30 15:36:46,384 - INFO - Error in get_custom_sql -> unsupported format character ''' (0x27) at index 513
2019-07-30 15:36:46,387 - INFO - Delete all data in sheet: Case 12
2019-07-30 15:36:48,069 - INFO - Value detected - use sheet: Case 13
2019-07-30 15:36:48,072 - INFO - Reading Data From Google Sheet...
2019-07-30 15:36:48,815 - INFO - Get custom SQL..
2019-07-30 15:36:48,815 - INFO - USING CASE 13
2019-07-30 15:36:50,128 - INFO - Row 1
2019-07-30 15:36:50,128 - INFO - Filename: Quiz Shopee user
2019-07-30 15:36:50,130 - INFO - Date 1: 2019-07-10
2019-07-30 15:36:50,130 - INFO - Date 2: 2019-07-20
2019-07-30 15:36:50,131 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from shopee_id_bi_team__kuis_players as a
                                join shopee_gamehq_id_db__hq_sessions_tab as b 
                                on a.session_id = cast(b.id as varchar)
                                join shopee_gamehq_id_db__hq_events_tab as c 
                                on a.event_id = cast(c.id as varchar)
                                where date(from_unixtime(b.start,'Asia/Jakarta')) >= date('2019-07-10')
                                and date(from_unixtime(b.start,'Asia/Jakarta')) <= date('2019-07-20')
                                
2019-07-30 15:36:50,131 - INFO - Start Running query Quiz Shopee user
2019-07-30 15:37:11,753 - INFO - Running Quiz Shopee user Done
2019-07-30 15:37:11,753 - INFO - CSV file path: Quiz Shopee user
2019-07-30 15:37:11,766 - INFO - Starting save the query results
2019-07-30 15:37:11,766 - INFO - Total Rows : 113554
2019-07-30 15:37:11,766 - INFO - Will split into : 1.0 files
2019-07-30 15:37:12,378 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.34/Quiz Shopee user_1.csv
2019-07-30 15:37:12,385 - INFO - , with total : 113554 rows
2019-07-30 15:37:12,881 - INFO - Delete all data in sheet: Case 13
2019-07-30 15:37:14,528 - INFO - Value detected - use sheet: Case 14
2019-07-30 15:37:14,529 - INFO - Reading Data From Google Sheet...
2019-07-30 15:37:14,937 - INFO - Get custom SQL..
2019-07-30 15:37:14,938 - INFO - USING CASE 14
2019-07-30 15:37:16,239 - INFO - Row 1
2019-07-30 15:37:16,240 - INFO - Filename: One Dollar Game user
2019-07-30 15:37:16,240 - INFO - Date 1: 2019-07-02
2019-07-30 15:37:16,242 - INFO - Date 2: 2019-07-20
2019-07-30 15:37:16,242 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(p.userid as varchar)) as list_userid, grass_date
                                from order_mart__order_item_profile as p
                                where bi_excluded = 'OneDollarGame'
                                and grass_date between date'2019-07-02' and date'2019-07-20'
                                
2019-07-30 15:37:16,243 - INFO - Start Running query One Dollar Game user
2019-07-30 15:39:58,960 - INFO - Running One Dollar Game user Done
2019-07-30 15:39:58,960 - INFO - CSV file path: One Dollar Game user
2019-07-30 15:39:59,401 - INFO - Starting save the query results
2019-07-30 15:39:59,403 - INFO - Total Rows : 2870113
2019-07-30 15:39:59,404 - INFO - Will split into : 3.0 files
2019-07-30 15:40:05,069 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.34/One Dollar Game user_1.csv
2019-07-30 15:40:05,071 - INFO - , with total : 956705 rows
2019-07-30 15:40:11,204 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.34/One Dollar Game user_2.csv
2019-07-30 15:40:11,206 - INFO - , with total : 956704 rows
2019-07-30 15:40:17,236 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 15.34/One Dollar Game user_3.csv
2019-07-30 15:40:17,236 - INFO - , with total : 956704 rows
2019-07-30 15:40:18,374 - INFO - Delete all data in sheet: Case 14
2019-07-30 15:40:20,240 - INFO - Value detected - use sheet: Case 15
2019-07-30 15:40:20,240 - INFO - Reading Data From Google Sheet...
2019-07-30 15:40:20,987 - INFO - Get custom SQL..
2019-07-30 15:40:20,989 - INFO - USING CASE 15
2019-07-30 15:40:22,825 - INFO - Row 1
2019-07-30 15:40:22,825 - INFO - Filename: Daily Prize user
2019-07-30 15:40:22,826 - INFO - Date 1: 2019-07-10
2019-07-30 15:40:22,828 - INFO - Date 2: 2019-07-20
2019-07-30 15:40:22,828 - INFO - Error in get_custom_sql -> not all arguments converted during string formatting
2019-07-30 15:40:22,829 - INFO - Delete all data in sheet: Case 15
2019-07-30 15:48:28,943 - INFO - Report date: 20190730 15.48
2019-07-30 15:48:28,977 - INFO - Download sheet..
2019-07-30 15:48:28,977 - INFO - Change directory to script path
2019-07-30 15:48:31,171 - INFO - Spreadsheet downloaded
2019-07-30 15:48:31,173 - INFO - Checking sheet..
2019-07-30 15:48:33,684 - INFO - No value detected on sheet: Case 1
2019-07-30 15:48:35,216 - INFO - No value detected on sheet: Case 2
2019-07-30 15:48:36,747 - INFO - No value detected on sheet: Case 3
2019-07-30 15:48:37,990 - INFO - No value detected on sheet: Case 4
2019-07-30 15:48:39,540 - INFO - No value detected on sheet: Case 5
2019-07-30 15:48:40,765 - INFO - No value detected on sheet: Case 6
2019-07-30 15:48:41,983 - INFO - No value detected on sheet: Case 7
2019-07-30 15:48:43,229 - INFO - No value detected on sheet: Case 8
2019-07-30 15:48:44,450 - INFO - No value detected on sheet: Case 9
2019-07-30 15:48:46,009 - INFO - No value detected on sheet: Case 10
2019-07-30 15:48:47,624 - INFO - No value detected on sheet: Case 11
2019-07-30 15:48:48,865 - INFO - Value detected - use sheet: Case 12
2019-07-30 15:48:48,867 - INFO - Reading Data From Google Sheet...
2019-07-30 15:48:49,654 - INFO - Get custom SQL..
2019-07-30 15:48:49,655 - INFO - USING CASE 12
2019-07-30 15:48:51,704 - INFO - Row 1
2019-07-30 15:48:51,706 - INFO - Filename: Goyang Shopee user
2019-07-30 15:48:51,707 - INFO - Date 1: 2019-07-10
2019-07-30 15:48:51,707 - INFO - Date 2: 2019-07-20
2019-07-30 15:48:51,707 - INFO - Error in get_custom_sql -> not enough arguments for format string
2019-07-30 15:48:51,709 - INFO - Delete all data in sheet: Case 12
2019-07-30 15:48:53,604 - INFO - No value detected on sheet: Case 13
2019-07-30 15:48:54,951 - INFO - No value detected on sheet: Case 14
2019-07-30 15:48:56,223 - INFO - Value detected - use sheet: Case 15
2019-07-30 15:48:56,223 - INFO - Reading Data From Google Sheet...
2019-07-30 15:48:56,664 - INFO - Get custom SQL..
2019-07-30 15:48:56,664 - INFO - USING CASE 15
2019-07-30 15:48:58,641 - INFO - Row 1
2019-07-30 15:48:58,642 - INFO - Filename: Daily Prize user
2019-07-30 15:48:58,644 - INFO - Date 1: 2019-07-10
2019-07-30 15:48:58,644 - INFO - Date 2: 2019-07-20
2019-07-30 15:48:58,645 - INFO - Error in get_custom_sql -> unsupported format character 'Y' (0x59) at index 437
2019-07-30 15:48:58,647 - INFO - Delete all data in sheet: Case 15
2019-07-30 16:08:57,211 - INFO - Report date: 20190730 16.08
2019-07-30 16:08:57,243 - INFO - Download sheet..
2019-07-30 16:08:57,244 - INFO - Change directory to script path
2019-07-30 16:08:59,451 - INFO - Spreadsheet downloaded
2019-07-30 16:08:59,453 - INFO - Checking sheet..
2019-07-30 16:09:02,039 - INFO - No value detected on sheet: Case 1
2019-07-30 16:09:03,588 - INFO - No value detected on sheet: Case 2
2019-07-30 16:09:05,134 - INFO - No value detected on sheet: Case 3
2019-07-30 16:09:06,665 - INFO - No value detected on sheet: Case 4
2019-07-30 16:09:08,283 - INFO - No value detected on sheet: Case 5
2019-07-30 16:09:09,857 - INFO - No value detected on sheet: Case 6
2019-07-30 16:09:11,671 - INFO - No value detected on sheet: Case 7
2019-07-30 16:09:13,223 - INFO - No value detected on sheet: Case 8
2019-07-30 16:09:14,783 - INFO - No value detected on sheet: Case 9
2019-07-30 16:09:16,371 - INFO - No value detected on sheet: Case 10
2019-07-30 16:09:17,944 - INFO - No value detected on sheet: Case 11
2019-07-30 16:09:19,555 - INFO - Value detected - use sheet: Case 12
2019-07-30 16:09:19,555 - INFO - Reading Data From Google Sheet...
2019-07-30 16:09:20,032 - INFO - Get custom SQL..
2019-07-30 16:09:20,032 - INFO - USING CASE 12
2019-07-30 16:09:22,112 - INFO - Row 1
2019-07-30 16:09:22,114 - INFO - Filename: Goyang Shopee user
2019-07-30 16:09:22,115 - INFO - Date 1: 2019-07-10
2019-07-30 16:09:22,115 - INFO - Date 2: 2019-07-20
2019-07-30 16:09:22,117 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(a1.userid as varchar)) as list_userid
                                from user_login_record_id_db__user_login_record_tab as a1
                                where a1.grass_date between date'2019-07-10' and date'2019-07-20'
                                and a1.userid in (select distinct userid from shopee_coins_id_db__coin_transaction_tab where lower(from_utf8(from_base64(info))) like '%goyang shopee%')
                                
2019-07-30 16:09:22,118 - INFO - Start Running query Goyang Shopee user
2019-07-30 16:13:41,803 - INFO - Running Goyang Shopee user Done
2019-07-30 16:13:41,805 - INFO - CSV file path: Goyang Shopee user
2019-07-30 16:13:42,207 - INFO - Starting save the query results
2019-07-30 16:13:42,207 - INFO - Total Rows : 5201105
2019-07-30 16:13:42,207 - INFO - Will split into : 6.0 files
2019-07-30 16:13:49,632 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user_1.csv
2019-07-30 16:13:49,634 - INFO - , with total : 866851 rows
2019-07-30 16:13:55,280 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user_2.csv
2019-07-30 16:13:55,282 - INFO - , with total : 866851 rows
2019-07-30 16:14:00,394 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user_3.csv
2019-07-30 16:14:00,394 - INFO - , with total : 866851 rows
2019-07-30 16:14:05,359 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user_4.csv
2019-07-30 16:14:05,361 - INFO - , with total : 866851 rows
2019-07-30 16:14:10,927 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user_5.csv
2019-07-30 16:14:10,927 - INFO - , with total : 866851 rows
2019-07-30 16:14:15,836 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user_6.csv
2019-07-30 16:14:15,838 - INFO - , with total : 866850 rows
2019-07-30 16:14:20,151 - INFO - Row 2
2019-07-30 16:14:20,151 - INFO - Filename: Goyang Shopee user 2
2019-07-30 16:14:20,153 - INFO - Date 1: 2019-06-10
2019-07-30 16:14:20,154 - INFO - Date 2: 2019-06-25
2019-07-30 16:14:20,154 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(a1.userid as varchar)) as list_userid
                                from user_login_record_id_db__user_login_record_tab as a1
                                where a1.grass_date between date'2019-06-10' and date'2019-06-25'
                                and a1.userid in (select distinct userid from shopee_coins_id_db__coin_transaction_tab where lower(from_utf8(from_base64(info))) like '%goyang shopee%')
                                
2019-07-30 16:14:20,155 - INFO - Start Running query Goyang Shopee user 2
2019-07-30 16:17:30,723 - INFO - Running Goyang Shopee user 2 Done
2019-07-30 16:17:30,723 - INFO - CSV file path: Goyang Shopee user 2
2019-07-30 16:17:31,145 - INFO - Starting save the query results
2019-07-30 16:17:31,145 - INFO - Total Rows : 5660159
2019-07-30 16:17:31,147 - INFO - Will split into : 6.0 files
2019-07-30 16:17:35,891 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user 2_1.csv
2019-07-30 16:17:35,891 - INFO - , with total : 943360 rows
2019-07-30 16:17:40,772 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user 2_2.csv
2019-07-30 16:17:40,773 - INFO - , with total : 943360 rows
2019-07-30 16:17:49,147 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user 2_3.csv
2019-07-30 16:17:49,148 - INFO - , with total : 943360 rows
2019-07-30 16:17:55,960 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user 2_4.csv
2019-07-30 16:17:55,961 - INFO - , with total : 943360 rows
2019-07-30 16:18:01,151 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user 2_5.csv
2019-07-30 16:18:01,153 - INFO - , with total : 943360 rows
2019-07-30 16:18:07,088 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Goyang Shopee user 2_6.csv
2019-07-30 16:18:07,089 - INFO - , with total : 943359 rows
2019-07-30 16:18:08,275 - INFO - Delete all data in sheet: Case 12
2019-07-30 16:18:10,818 - INFO - No value detected on sheet: Case 13
2019-07-30 16:18:11,667 - INFO - No value detected on sheet: Case 14
2019-07-30 16:18:13,164 - INFO - Value detected - use sheet: Case 15
2019-07-30 16:18:13,165 - INFO - Reading Data From Google Sheet...
2019-07-30 16:18:14,243 - INFO - Get custom SQL..
2019-07-30 16:18:14,243 - INFO - USING CASE 15
2019-07-30 16:18:16,513 - INFO - Row 1
2019-07-30 16:18:16,515 - INFO - Filename: Daily Prize user
2019-07-30 16:18:16,516 - INFO - Date 1: 2019-07-10
2019-07-30 16:18:16,516 - INFO - Date 2: 2019-07-20
2019-07-30 16:18:16,516 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(dp.user_id as varchar)) as list_userid
                                from shopee_id_mk_team__daily_prize_vfive as dp
                                left join user_profile as u 
                                on u.userid = cast(dp.user_id as int)
                                where date(date_parse(cast(dp.datte as varchar), '%Y-%m-%d %H:%i:%s')) >= date('2019-07-10')
                                and date(date_parse(cast(dp.datte as varchar), '%Y-%m-%d %H:%i:%s')) <= date('2019-07-20')                                
                                
2019-07-30 16:18:16,519 - INFO - Start Running query Daily Prize user
2019-07-30 16:19:24,059 - INFO - Running Daily Prize user Done
2019-07-30 16:19:24,059 - INFO - CSV file path: Daily Prize user
2019-07-30 16:19:24,203 - INFO - Starting save the query results
2019-07-30 16:19:24,204 - INFO - Total Rows : 1410515
2019-07-30 16:19:24,209 - INFO - Will split into : 2.0 files
2019-07-30 16:19:29,752 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Daily Prize user_1.csv
2019-07-30 16:19:29,753 - INFO - , with total : 705258 rows
2019-07-30 16:19:34,724 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Daily Prize user_2.csv
2019-07-30 16:19:34,726 - INFO - , with total : 705257 rows
2019-07-30 16:19:38,176 - INFO - Row 2
2019-07-30 16:19:38,177 - INFO - Filename: Daily Prize user 2
2019-07-30 16:19:38,177 - INFO - Date 1: 2019-06-10
2019-07-30 16:19:38,177 - INFO - Date 2: 2019-06-25
2019-07-30 16:19:38,178 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(dp.user_id as varchar)) as list_userid
                                from shopee_id_mk_team__daily_prize_vfive as dp
                                left join user_profile as u 
                                on u.userid = cast(dp.user_id as int)
                                where date(date_parse(cast(dp.datte as varchar), '%Y-%m-%d %H:%i:%s')) >= date('2019-06-10')
                                and date(date_parse(cast(dp.datte as varchar), '%Y-%m-%d %H:%i:%s')) <= date('2019-06-25')                                
                                
2019-07-30 16:19:38,180 - INFO - Start Running query Daily Prize user 2
2019-07-30 16:20:35,963 - INFO - Running Daily Prize user 2 Done
2019-07-30 16:20:35,963 - INFO - CSV file path: Daily Prize user 2
2019-07-30 16:20:35,990 - INFO - Starting save the query results
2019-07-30 16:20:35,990 - INFO - Total Rows : 333366
2019-07-30 16:20:35,990 - INFO - Will split into : 1.0 files
2019-07-30 16:20:37,552 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190730 16.08/Daily Prize user 2_1.csv
2019-07-30 16:20:37,552 - INFO - , with total : 333366 rows
2019-07-30 16:20:38,358 - INFO - Delete all data in sheet: Case 15
2019-07-30 17:00:01,598 - INFO - Report date: 20190730 17.00
2019-07-30 17:00:09,404 - INFO - Download sheet..
2019-07-30 17:00:09,405 - INFO - Change directory to script path
2019-07-30 17:00:10,799 - INFO - Spreadsheet downloaded
2019-07-30 17:00:10,801 - INFO - Checking sheet..
2019-07-30 17:00:12,884 - INFO - No value detected on sheet: Case 1
2019-07-30 17:00:14,361 - INFO - No value detected on sheet: Case 2
2019-07-30 17:00:15,858 - INFO - No value detected on sheet: Case 3
2019-07-30 17:00:17,377 - INFO - No value detected on sheet: Case 4
2019-07-30 17:00:18,865 - INFO - No value detected on sheet: Case 5
2019-07-30 17:00:20,403 - INFO - No value detected on sheet: Case 6
2019-07-30 17:00:21,924 - INFO - No value detected on sheet: Case 7
2019-07-30 17:00:23,410 - INFO - No value detected on sheet: Case 8
2019-07-30 17:00:25,032 - INFO - No value detected on sheet: Case 9
2019-07-31 10:00:12,321 - INFO - Report date: 20190731 10.00
2019-07-31 10:00:16,519 - INFO - Download sheet..
2019-07-31 10:00:16,519 - INFO - Change directory to script path
2019-07-31 10:00:18,344 - INFO - Spreadsheet downloaded
2019-07-31 10:00:18,344 - INFO - Checking sheet..
2019-07-31 10:00:20,115 - INFO - No value detected on sheet: Case 1
2019-07-31 10:00:21,407 - INFO - No value detected on sheet: Case 2
2019-07-31 10:00:22,683 - INFO - No value detected on sheet: Case 3
2019-07-31 10:00:24,339 - INFO - No value detected on sheet: Case 4
2019-07-31 10:00:25,683 - INFO - No value detected on sheet: Case 5
2019-07-31 10:00:26,878 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%206%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-07-31 10:00:28,107 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%207%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-07-31 10:00:29,345 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%208%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-07-31 10:00:30,582 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%209%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-07-31 14:00:15,223 - INFO - Report date: 20190731 14.00
2019-07-31 14:00:19,492 - INFO - Download sheet..
2019-07-31 14:00:19,493 - INFO - Change directory to script path
2019-07-31 14:00:21,371 - INFO - Spreadsheet downloaded
2019-07-31 14:00:21,372 - INFO - Checking sheet..
2019-07-31 14:00:23,313 - INFO - No value detected on sheet: Case 1
2019-07-31 14:00:24,806 - INFO - No value detected on sheet: Case 2
2019-07-31 14:00:26,308 - INFO - No value detected on sheet: Case 3
2019-07-31 14:00:27,818 - INFO - No value detected on sheet: Case 4
2019-07-31 14:00:29,326 - INFO - No value detected on sheet: Case 5
2019-07-31 14:00:30,907 - INFO - No value detected on sheet: Case 6
2019-07-31 14:00:32,384 - INFO - Value detected - use sheet: Case 7
2019-07-31 14:00:32,385 - INFO - Reading Data From Google Sheet...
2019-07-31 14:00:33,105 - INFO - Get custom SQL..
2019-07-31 14:00:33,105 - INFO - USING CASE 7
2019-07-31 14:00:34,716 - INFO - Row 1
2019-07-31 14:00:34,717 - INFO - Filename: Wardah Official Shop Followers
2019-07-31 14:00:34,717 - INFO - Shop ID: 59763733
2019-07-31 14:00:34,717 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 59763733 
                                and status = 1
                                
2019-07-31 14:00:34,719 - INFO - Start Running query Wardah Official Shop Followers
2019-07-31 14:00:54,134 - INFO - Running Wardah Official Shop Followers Done
2019-07-31 14:00:54,134 - INFO - CSV file path: Wardah Official Shop Followers
2019-07-31 14:00:54,154 - INFO - Starting save the query results
2019-07-31 14:00:54,154 - INFO - Total Rows : 455474
2019-07-31 14:00:54,155 - INFO - Will split into : 1.0 files
2019-07-31 14:00:56,441 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 14.00/Wardah Official Shop Followers_1.csv
2019-07-31 14:00:56,450 - INFO - , with total : 455474 rows
2019-07-31 14:00:58,289 - INFO - Row 2
2019-07-31 14:00:58,292 - INFO - Filename: Emina Official Shop Followers
2019-07-31 14:00:58,292 - INFO - Shop ID: 63983008
2019-07-31 14:00:58,292 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 63983008 
                                and status = 1
                                
2019-07-31 14:00:58,295 - INFO - Start Running query Emina Official Shop Followers
2019-07-31 14:01:17,940 - INFO - Running Emina Official Shop Followers Done
2019-07-31 14:01:17,940 - INFO - CSV file path: Emina Official Shop Followers
2019-07-31 14:01:17,963 - INFO - Starting save the query results
2019-07-31 14:01:17,964 - INFO - Total Rows : 478158
2019-07-31 14:01:17,967 - INFO - Will split into : 1.0 files
2019-07-31 14:01:20,414 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 14.00/Emina Official Shop Followers_1.csv
2019-07-31 14:01:20,415 - INFO - , with total : 478158 rows
2019-07-31 14:01:21,414 - INFO - Error in get_custom_sql -> <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%207%21A4%3AA4?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-07-31 14:01:21,417 - INFO - Delete all data in sheet: Case 7
2019-07-31 14:01:23,855 - INFO - No value detected on sheet: Case 8
2019-07-31 14:01:25,342 - INFO - No value detected on sheet: Case 9
2019-07-31 17:01:00,140 - INFO - Report date: 20190731 17.01
2019-07-31 17:01:04,278 - INFO - Download sheet..
2019-07-31 17:01:04,279 - INFO - Change directory to script path
2019-07-31 17:01:07,591 - INFO - Spreadsheet downloaded
2019-07-31 17:01:07,592 - INFO - Checking sheet..
2019-07-31 17:01:11,032 - INFO - No value detected on sheet: Case 1
2019-07-31 17:01:12,536 - INFO - No value detected on sheet: Case 2
2019-07-31 17:01:14,058 - INFO - No value detected on sheet: Case 3
2019-07-31 17:01:15,555 - INFO - Value detected - use sheet: Case 4
2019-07-31 17:01:15,555 - INFO - Reading Data From Google Sheet...
2019-07-31 17:01:16,292 - INFO - Get custom SQL..
2019-07-31 17:01:16,295 - INFO - USING CASE 4
2019-07-31 17:01:19,921 - INFO - Row 1
2019-07-31 17:01:19,921 - INFO - Filename: A30 Men's Fashion & Grooming buyers
2019-07-31 17:01:19,923 - INFO - Category: 'Fashion','Health & Beauty','Beauty'
2019-07-31 17:01:19,923 - INFO - Last Login: 30
2019-07-31 17:01:19,924 - INFO - Gender: 1,3
2019-07-31 17:01:19,924 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Health & Beauty','Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-07-31 17:01:19,926 - INFO - Start Running query A30 Men's Fashion & Grooming buyers
2019-07-31 17:02:06,940 - INFO - Running A30 Men's Fashion & Grooming buyers Done
2019-07-31 17:02:06,940 - INFO - CSV file path: A30 Men's Fashion & Grooming buyers
2019-07-31 17:02:06,984 - INFO - Starting save the query results
2019-07-31 17:02:06,986 - INFO - Total Rows : 1144116
2019-07-31 17:02:06,986 - INFO - Will split into : 2.0 files
2019-07-31 17:02:09,721 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 Men's Fashion & Grooming buyers_1.csv
2019-07-31 17:02:09,723 - INFO - , with total : 572058 rows
2019-07-31 17:02:12,798 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 Men's Fashion & Grooming buyers_2.csv
2019-07-31 17:02:12,799 - INFO - , with total : 572058 rows
2019-07-31 17:02:16,266 - INFO - Row 2
2019-07-31 17:02:16,267 - INFO - Filename: A30 Female Muslim Fashion
2019-07-31 17:02:16,269 - INFO - Category: 'Muslim Fashion'
2019-07-31 17:02:16,269 - INFO - Last Login: 30
2019-07-31 17:02:16,269 - INFO - Gender: 2,4
2019-07-31 17:02:16,269 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Muslim Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-31 17:02:16,270 - INFO - Start Running query A30 Female Muslim Fashion
2019-07-31 17:04:37,786 - INFO - Running A30 Female Muslim Fashion Done
2019-07-31 17:04:37,788 - INFO - CSV file path: A30 Female Muslim Fashion
2019-07-31 17:04:37,983 - INFO - Starting save the query results
2019-07-31 17:04:37,983 - INFO - Total Rows : 4817482
2019-07-31 17:04:37,984 - INFO - Will split into : 5.0 files
2019-07-31 17:04:42,674 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 Female Muslim Fashion_1.csv
2019-07-31 17:04:42,674 - INFO - , with total : 963497 rows
2019-07-31 17:04:48,713 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 Female Muslim Fashion_2.csv
2019-07-31 17:04:48,714 - INFO - , with total : 963497 rows
2019-07-31 17:04:53,990 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 Female Muslim Fashion_3.csv
2019-07-31 17:04:53,990 - INFO - , with total : 963496 rows
2019-07-31 17:04:59,460 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 Female Muslim Fashion_4.csv
2019-07-31 17:04:59,460 - INFO - , with total : 963496 rows
2019-07-31 17:05:04,819 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 Female Muslim Fashion_5.csv
2019-07-31 17:05:04,821 - INFO - , with total : 963496 rows
2019-07-31 17:05:08,977 - INFO - Row 3
2019-07-31 17:05:08,979 - INFO - Filename: A7 Female Fashion Buyers
2019-07-31 17:05:08,979 - INFO - Category: 'Women Bags','Women Clothes','Women Shoes','Fashion Accessories'
2019-07-31 17:05:08,980 - INFO - Last Login: 7
2019-07-31 17:05:08,980 - INFO - Gender: 2,4
2019-07-31 17:05:08,980 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Bags','Women Clothes','Women Shoes','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-07-31 17:05:08,982 - INFO - Start Running query A7 Female Fashion Buyers
2019-07-31 17:07:59,780 - INFO - Running A7 Female Fashion Buyers Done
2019-07-31 17:07:59,782 - INFO - CSV file path: A7 Female Fashion Buyers
2019-07-31 17:08:00,036 - INFO - Starting save the query results
2019-07-31 17:08:00,036 - INFO - Total Rows : 6465987
2019-07-31 17:08:00,038 - INFO - Will split into : 7.0 files
2019-07-31 17:08:04,415 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A7 Female Fashion Buyers_1.csv
2019-07-31 17:08:04,417 - INFO - , with total : 923713 rows
2019-07-31 17:08:09,273 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A7 Female Fashion Buyers_2.csv
2019-07-31 17:08:09,273 - INFO - , with total : 923713 rows
2019-07-31 17:08:14,315 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A7 Female Fashion Buyers_3.csv
2019-07-31 17:08:14,315 - INFO - , with total : 923713 rows
2019-07-31 17:08:19,497 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A7 Female Fashion Buyers_4.csv
2019-07-31 17:08:19,499 - INFO - , with total : 923712 rows
2019-07-31 17:08:24,614 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A7 Female Fashion Buyers_5.csv
2019-07-31 17:08:24,614 - INFO - , with total : 923712 rows
2019-07-31 17:08:30,029 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A7 Female Fashion Buyers_6.csv
2019-07-31 17:08:30,029 - INFO - , with total : 923712 rows
2019-07-31 17:08:34,880 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A7 Female Fashion Buyers_7.csv
2019-07-31 17:08:34,881 - INFO - , with total : 923712 rows
2019-07-31 17:08:36,365 - INFO - Delete all data in sheet: Case 4
2019-07-31 17:08:38,698 - INFO - Value detected - use sheet: Case 5
2019-07-31 17:08:38,700 - INFO - Reading Data From Google Sheet...
2019-07-31 17:08:39,114 - INFO - Get custom SQL..
2019-07-31 17:08:39,115 - INFO - USING CASE 5
2019-07-31 17:08:42,496 - INFO - Row 1
2019-07-31 17:08:42,497 - INFO - Filename: A30 MA Buyers_SBD Realme
2019-07-31 17:08:42,499 - INFO - Sub-category: 'Bluetooth & Headset','Cable & Charger','Casing & Covers','Handphone Docking','Handphone Keychain','Memory Card','Mobile & Tablet','Powerbank & Batteries','Screen Protectors','Simcard'
2019-07-31 17:08:42,500 - INFO - Last Login: 30
2019-07-31 17:08:42,500 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bluetooth & Headset','Cable & Charger','Casing & Covers','Handphone Docking','Handphone Keychain','Memory Card','Mobile & Tablet','Powerbank & Batteries','Screen Protectors','Simcard')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-07-31 17:08:42,503 - INFO - Start Running query A30 MA Buyers_SBD Realme
2019-07-31 17:12:01,072 - INFO - Running A30 MA Buyers_SBD Realme Done
2019-07-31 17:12:01,073 - INFO - CSV file path: A30 MA Buyers_SBD Realme
2019-07-31 17:12:01,357 - INFO - Starting save the query results
2019-07-31 17:12:01,358 - INFO - Total Rows : 6635675
2019-07-31 17:12:01,358 - INFO - Will split into : 7.0 files
2019-07-31 17:12:05,871 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 MA Buyers_SBD Realme_1.csv
2019-07-31 17:12:05,871 - INFO - , with total : 947954 rows
2019-07-31 17:12:11,061 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 MA Buyers_SBD Realme_2.csv
2019-07-31 17:12:11,062 - INFO - , with total : 947954 rows
2019-07-31 17:12:16,161 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 MA Buyers_SBD Realme_3.csv
2019-07-31 17:12:16,161 - INFO - , with total : 947954 rows
2019-07-31 17:12:21,591 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 MA Buyers_SBD Realme_4.csv
2019-07-31 17:12:21,592 - INFO - , with total : 947954 rows
2019-07-31 17:12:27,311 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 MA Buyers_SBD Realme_5.csv
2019-07-31 17:12:27,312 - INFO - , with total : 947953 rows
2019-07-31 17:12:32,546 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 MA Buyers_SBD Realme_6.csv
2019-07-31 17:12:32,546 - INFO - , with total : 947953 rows
2019-07-31 17:12:37,721 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190731 17.01/A30 MA Buyers_SBD Realme_7.csv
2019-07-31 17:12:37,723 - INFO - , with total : 947953 rows
2019-07-31 17:12:54,096 - INFO - Delete all data in sheet: Case 5
2019-07-31 17:12:58,506 - INFO - No value detected on sheet: Case 6
2019-07-31 17:13:01,398 - INFO - No value detected on sheet: Case 7
2019-07-31 17:13:03,079 - INFO - No value detected on sheet: Case 8
2019-07-31 17:13:04,361 - INFO - No value detected on sheet: Case 9
2019-08-01 10:00:14,203 - INFO - Report date: 20190801 10.00
2019-08-01 10:00:18,453 - INFO - Download sheet..
2019-08-01 10:00:18,453 - INFO - Change directory to script path
2019-08-01 10:00:19,678 - INFO - Spreadsheet downloaded
2019-08-01 10:00:19,680 - INFO - Checking sheet..
2019-08-01 10:00:21,486 - INFO - No value detected on sheet: Case 1
2019-08-01 10:00:23,213 - INFO - No value detected on sheet: Case 2
2019-08-01 10:00:24,571 - INFO - No value detected on sheet: Case 3
2019-08-01 10:00:25,865 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%204%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-01 10:00:27,158 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%205%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-01 10:00:28,720 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-01 10:00:29,309 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-01 10:00:29,918 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-01 10:00:30,513 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-01 14:00:02,776 - INFO - Report date: 20190801 14.00
2019-08-01 14:00:05,948 - INFO - Download sheet..
2019-08-01 14:00:05,948 - INFO - Change directory to script path
2019-08-01 14:00:07,332 - INFO - Spreadsheet downloaded
2019-08-01 14:00:07,332 - INFO - Checking sheet..
2019-08-01 14:00:09,099 - INFO - Value detected - use sheet: Case 1
2019-08-01 14:00:09,101 - INFO - Reading Data From Google Sheet...
2019-08-01 14:00:09,790 - INFO - Get custom SQL..
2019-08-01 14:00:09,792 - INFO - USING CASE 1
2019-08-01 14:00:11,878 - INFO - Row 1
2019-08-01 14:00:11,880 - INFO - Filename: A30 CA Buyers
2019-08-01 14:00:11,881 - INFO - Category: 'Computer & Accessories'
2019-08-01 14:00:11,881 - INFO - Last Login: 30
2019-08-01 14:00:11,881 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Computer & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-01 14:00:11,884 - INFO - Start Running query A30 CA Buyers
2019-08-01 14:01:59,496 - INFO - Running A30 CA Buyers Done
2019-08-01 14:01:59,496 - INFO - CSV file path: A30 CA Buyers
2019-08-01 14:01:59,609 - INFO - Starting save the query results
2019-08-01 14:01:59,611 - INFO - Total Rows : 2617180
2019-08-01 14:01:59,611 - INFO - Will split into : 3.0 files
2019-08-01 14:02:03,966 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A30 CA Buyers_1.csv
2019-08-01 14:02:03,967 - INFO - , with total : 872394 rows
2019-08-01 14:02:08,555 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A30 CA Buyers_2.csv
2019-08-01 14:02:08,556 - INFO - , with total : 872393 rows
2019-08-01 14:02:13,111 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A30 CA Buyers_3.csv
2019-08-01 14:02:13,112 - INFO - , with total : 872393 rows
2019-08-01 14:02:14,496 - INFO - Delete all data in sheet: Case 1
2019-08-01 14:02:16,954 - INFO - No value detected on sheet: Case 2
2019-08-01 14:02:18,305 - INFO - No value detected on sheet: Case 3
2019-08-01 14:02:19,776 - INFO - Value detected - use sheet: Case 4
2019-08-01 14:02:19,779 - INFO - Reading Data From Google Sheet...
2019-08-01 14:02:20,190 - INFO - Get custom SQL..
2019-08-01 14:02:20,190 - INFO - USING CASE 4
2019-08-01 14:02:22,947 - INFO - Row 1
2019-08-01 14:02:22,948 - INFO - Filename: A30 Fashion & Men's Care Buyers
2019-08-01 14:02:22,950 - INFO - Category: 'Fashion','Fashion Accessories','Health & Beauty','Beauty'
2019-08-01 14:02:22,950 - INFO - Last Login: 30
2019-08-01 14:02:22,950 - INFO - Gender: 1,3
2019-08-01 14:02:22,950 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Fashion Accessories','Health & Beauty','Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-01 14:02:22,951 - INFO - Start Running query A30 Fashion & Men's Care Buyers
2019-08-01 14:03:24,227 - INFO - Running A30 Fashion & Men's Care Buyers Done
2019-08-01 14:03:24,229 - INFO - CSV file path: A30 Fashion & Men's Care Buyers
2019-08-01 14:03:24,296 - INFO - Starting save the query results
2019-08-01 14:03:24,298 - INFO - Total Rows : 1611206
2019-08-01 14:03:24,298 - INFO - Will split into : 2.0 files
2019-08-01 14:03:27,970 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A30 Fashion & Men's Care Buyers_1.csv
2019-08-01 14:03:27,971 - INFO - , with total : 805603 rows
2019-08-01 14:03:32,280 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A30 Fashion & Men's Care Buyers_2.csv
2019-08-01 14:03:32,282 - INFO - , with total : 805603 rows
2019-08-01 14:03:35,894 - INFO - Row 2
2019-08-01 14:03:35,895 - INFO - Filename: A30 Male Buyers
2019-08-01 14:03:35,897 - INFO - Category: 'Automotive','Baby & Kids Fashion','Beauty','Computer & Accessories','Cosmetics','Electronics','Fashion Accessories','Food & Beverages','Health','Health & Beauty','Hobby & Collection','Home & Living','Men Bags','Men','Clothes','Men Shoes','Mobile & Accessories','Mom & Baby','Muslim Fashion','Others','Photography','Souvenir & Party Supplies','Sports & Outdoor','Stationery & Books','Vouchers','Watches'
2019-08-01 14:03:35,898 - INFO - Last Login: 30
2019-08-01 14:03:35,898 - INFO - Gender: 1,3
2019-08-01 14:03:35,898 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Automotive','Baby & Kids Fashion','Beauty','Computer & Accessories','Cosmetics','Electronics','Fashion Accessories','Food & Beverages','Health','Health & Beauty','Hobby & Collection','Home & Living','Men Bags','Men','Clothes','Men Shoes','Mobile & Accessories','Mom & Baby','Muslim Fashion','Others','Photography','Souvenir & Party Supplies','Sports & Outdoor','Stationery & Books','Vouchers','Watches')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-01 14:03:35,898 - INFO - Start Running query A30 Male Buyers
2019-08-01 14:05:59,368 - INFO - Running A30 Male Buyers Done
2019-08-01 14:05:59,368 - INFO - CSV file path: A30 Male Buyers
2019-08-01 14:05:59,546 - INFO - Starting save the query results
2019-08-01 14:05:59,546 - INFO - Total Rows : 4330778
2019-08-01 14:05:59,548 - INFO - Will split into : 5.0 files
2019-08-01 14:06:03,601 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A30 Male Buyers_1.csv
2019-08-01 14:06:03,602 - INFO - , with total : 866156 rows
2019-08-01 14:06:07,927 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A30 Male Buyers_2.csv
2019-08-01 14:06:07,928 - INFO - , with total : 866156 rows
2019-08-01 14:06:12,819 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A30 Male Buyers_3.csv
2019-08-01 14:06:12,819 - INFO - , with total : 866156 rows
2019-08-01 14:06:17,937 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A30 Male Buyers_4.csv
2019-08-01 14:06:17,938 - INFO - , with total : 866155 rows
2019-08-01 14:06:22,533 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A30 Male Buyers_5.csv
2019-08-01 14:06:22,535 - INFO - , with total : 866155 rows
2019-08-01 14:06:23,903 - INFO - Delete all data in sheet: Case 4
2019-08-01 14:06:25,494 - INFO - No value detected on sheet: Case 5
2019-08-01 14:06:26,980 - INFO - No value detected on sheet: Case 6
2019-08-01 14:06:28,345 - INFO - Value detected - use sheet: Case 7
2019-08-01 14:06:28,345 - INFO - Reading Data From Google Sheet...
2019-08-01 14:06:29,023 - INFO - Get custom SQL..
2019-08-01 14:06:29,023 - INFO - USING CASE 7
2019-08-01 14:06:30,144 - INFO - Row 1
2019-08-01 14:06:30,144 - INFO - Filename: Wardah Official Shop Followers
2019-08-01 14:06:30,145 - INFO - Shop ID: 59763733
2019-08-01 14:06:30,145 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 59763733 
                                and status = 1
                                
2019-08-01 14:06:30,147 - INFO - Start Running query Wardah Official Shop Followers
2019-08-01 14:06:47,617 - INFO - Running Wardah Official Shop Followers Done
2019-08-01 14:06:47,618 - INFO - CSV file path: Wardah Official Shop Followers
2019-08-01 14:06:47,635 - INFO - Starting save the query results
2019-08-01 14:06:47,637 - INFO - Total Rows : 456497
2019-08-01 14:06:47,638 - INFO - Will split into : 1.0 files
2019-08-01 14:06:49,740 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/Wardah Official Shop Followers_1.csv
2019-08-01 14:06:49,742 - INFO - , with total : 456497 rows
2019-08-01 14:06:51,552 - INFO - Row 2
2019-08-01 14:06:51,552 - INFO - Filename: Make Over Official Shop Followers
2019-08-01 14:06:51,553 - INFO - Shop ID: 63984475
2019-08-01 14:06:51,555 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 63984475 
                                and status = 1
                                
2019-08-01 14:06:51,555 - INFO - Start Running query Make Over Official Shop Followers
2019-08-01 14:07:29,654 - INFO - Running Make Over Official Shop Followers Done
2019-08-01 14:07:29,657 - INFO - CSV file path: Make Over Official Shop Followers
2019-08-01 14:07:29,676 - INFO - Starting save the query results
2019-08-01 14:07:29,677 - INFO - Total Rows : 435509
2019-08-01 14:07:29,677 - INFO - Will split into : 1.0 files
2019-08-01 14:07:31,667 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/Make Over Official Shop Followers_1.csv
2019-08-01 14:07:31,670 - INFO - , with total : 435509 rows
2019-08-01 14:07:34,053 - INFO - Row 3
2019-08-01 14:07:34,055 - INFO - Filename: Delcell Official Shop Followers
2019-08-01 14:07:34,055 - INFO - Shop ID: 15386019
2019-08-01 14:07:34,055 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 15386019 
                                and status = 1
                                
2019-08-01 14:07:34,056 - INFO - Start Running query Delcell Official Shop Followers
2019-08-01 14:07:41,786 - INFO - Running Delcell Official Shop Followers Done
2019-08-01 14:07:41,788 - INFO - CSV file path: Delcell Official Shop Followers
2019-08-01 14:07:41,789 - INFO - Starting save the query results
2019-08-01 14:07:41,790 - INFO - Total Rows : 24615
2019-08-01 14:07:41,790 - INFO - Will split into : 1.0 files
2019-08-01 14:07:41,917 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/Delcell Official Shop Followers_1.csv
2019-08-01 14:07:41,917 - INFO - , with total : 24615 rows
2019-08-01 14:07:44,025 - INFO - Row 4
2019-08-01 14:07:44,026 - INFO - Filename: Aceboutique Shop Followers
2019-08-01 14:07:44,026 - INFO - Shop ID: 10221730
2019-08-01 14:07:44,026 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 10221730 
                                and status = 1
                                
2019-08-01 14:07:44,028 - INFO - Start Running query Aceboutique Shop Followers
2019-08-01 14:08:02,029 - INFO - Running Aceboutique Shop Followers Done
2019-08-01 14:08:02,030 - INFO - CSV file path: Aceboutique Shop Followers
2019-08-01 14:08:02,059 - INFO - Starting save the query results
2019-08-01 14:08:02,061 - INFO - Total Rows : 683791
2019-08-01 14:08:02,062 - INFO - Will split into : 1.0 files
2019-08-01 14:08:05,257 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/Aceboutique Shop Followers_1.csv
2019-08-01 14:08:05,259 - INFO - , with total : 683791 rows
2019-08-01 14:08:08,255 - INFO - Row 5
2019-08-01 14:08:08,256 - INFO - Filename: Fygalery Shop Followers
2019-08-01 14:08:08,256 - INFO - Shop ID: 11184349
2019-08-01 14:08:08,256 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid = 11184349 
                                and status = 1
                                
2019-08-01 14:08:08,257 - INFO - Start Running query Fygalery Shop Followers
2019-08-01 14:08:29,506 - INFO - Running Fygalery Shop Followers Done
2019-08-01 14:08:29,507 - INFO - CSV file path: Fygalery Shop Followers
2019-08-01 14:08:29,540 - INFO - Starting save the query results
2019-08-01 14:08:29,542 - INFO - Total Rows : 859252
2019-08-01 14:08:29,542 - INFO - Will split into : 1.0 files
2019-08-01 14:08:33,572 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/Fygalery Shop Followers_1.csv
2019-08-01 14:08:33,572 - INFO - , with total : 859252 rows
2019-08-01 14:08:34,473 - INFO - Delete all data in sheet: Case 7
2019-08-01 14:08:36,305 - INFO - Value detected - use sheet: Case 8
2019-08-01 14:08:36,305 - INFO - Reading Data From Google Sheet...
2019-08-01 14:08:36,750 - INFO - Get custom SQL..
2019-08-01 14:08:36,750 - INFO - USING CASE 8
2019-08-01 14:08:37,885 - INFO - Row 1
2019-08-01 14:08:37,887 - INFO - Filename: A7 DP buyers
2019-08-01 14:08:37,888 - INFO - Last Login: 7
2019-08-01 14:08:37,888 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar))
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-01 14:08:37,890 - INFO - Start Running query A7 DP buyers
2019-08-01 14:09:27,874 - INFO - Running A7 DP buyers Done
2019-08-01 14:09:27,875 - INFO - CSV file path: A7 DP buyers
2019-08-01 14:09:27,950 - INFO - Starting save the query results
2019-08-01 14:09:27,950 - INFO - Total Rows : 2017213
2019-08-01 14:09:27,951 - INFO - Will split into : 3.0 files
2019-08-01 14:09:31,167 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A7 DP buyers_1.csv
2019-08-01 14:09:31,168 - INFO - , with total : 672405 rows
2019-08-01 14:09:34,713 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A7 DP buyers_2.csv
2019-08-01 14:09:34,714 - INFO - , with total : 672404 rows
2019-08-01 14:09:38,453 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A7 DP buyers_3.csv
2019-08-01 14:09:38,453 - INFO - , with total : 672404 rows
2019-08-01 14:09:39,671 - INFO - Delete all data in sheet: Case 8
2019-08-01 14:09:41,433 - INFO - Value detected - use sheet: Case 9
2019-08-01 14:09:41,434 - INFO - Reading Data From Google Sheet...
2019-08-01 14:09:42,108 - INFO - Get custom SQL..
2019-08-01 14:09:42,108 - INFO - USING CASE 9
2019-08-01 14:09:43,614 - INFO - Row 1
2019-08-01 14:09:43,615 - INFO - Filename: A3 Fashion buyers who haven't shopped DP
2019-08-01 14:09:43,615 - INFO - Last Login: 3
2019-08-01 14:09:43,617 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches
Women Bags','Women Clothes','Women Shoes') 
                                    and
                                    last_login >= current_date - interval '3' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-01 14:09:43,618 - INFO - Start Running query A3 Fashion buyers who haven't shopped DP
2019-08-01 14:12:22,194 - INFO - Running A3 Fashion buyers who haven't shopped DP Done
2019-08-01 14:12:22,196 - INFO - CSV file path: A3 Fashion buyers who haven't shopped DP
2019-08-01 14:12:22,434 - INFO - Starting save the query results
2019-08-01 14:12:22,436 - INFO - Total Rows : 6212426
2019-08-01 14:12:22,436 - INFO - Will split into : 7.0 files
2019-08-01 14:12:26,677 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A3 Fashion buyers who haven't shopped DP_1.csv
2019-08-01 14:12:26,678 - INFO - , with total : 887490 rows
2019-08-01 14:12:31,490 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A3 Fashion buyers who haven't shopped DP_2.csv
2019-08-01 14:12:31,490 - INFO - , with total : 887490 rows
2019-08-01 14:12:36,811 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A3 Fashion buyers who haven't shopped DP_3.csv
2019-08-01 14:12:36,812 - INFO - , with total : 887490 rows
2019-08-01 14:12:41,756 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A3 Fashion buyers who haven't shopped DP_4.csv
2019-08-01 14:12:41,756 - INFO - , with total : 887489 rows
2019-08-01 14:12:47,384 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A3 Fashion buyers who haven't shopped DP_5.csv
2019-08-01 14:12:47,384 - INFO - , with total : 887489 rows
2019-08-01 14:12:52,132 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A3 Fashion buyers who haven't shopped DP_6.csv
2019-08-01 14:12:52,134 - INFO - , with total : 887489 rows
2019-08-01 14:12:56,954 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A3 Fashion buyers who haven't shopped DP_7.csv
2019-08-01 14:12:56,956 - INFO - , with total : 887489 rows
2019-08-01 14:13:00,176 - INFO - Row 2
2019-08-01 14:13:00,177 - INFO - Filename: A3 FMCG buyers who haven't shopped DP
2019-08-01 14:13:00,177 - INFO - Last Login: 3
2019-08-01 14:13:00,178 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mom & Baby') 
                                    and
                                    last_login >= current_date - interval '3' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-01 14:13:00,180 - INFO - Start Running query A3 FMCG buyers who haven't shopped DP
2019-08-01 14:14:24,407 - INFO - Running A3 FMCG buyers who haven't shopped DP Done
2019-08-01 14:14:24,407 - INFO - CSV file path: A3 FMCG buyers who haven't shopped DP
2019-08-01 14:14:24,483 - INFO - Starting save the query results
2019-08-01 14:14:24,484 - INFO - Total Rows : 2008757
2019-08-01 14:14:24,484 - INFO - Will split into : 3.0 files
2019-08-01 14:14:27,552 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A3 FMCG buyers who haven't shopped DP_1.csv
2019-08-01 14:14:27,553 - INFO - , with total : 669586 rows
2019-08-01 14:14:31,131 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A3 FMCG buyers who haven't shopped DP_2.csv
2019-08-01 14:14:31,132 - INFO - , with total : 669586 rows
2019-08-01 14:14:34,540 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190801 14.00/A3 FMCG buyers who haven't shopped DP_3.csv
2019-08-01 14:14:34,542 - INFO - , with total : 669585 rows
2019-08-01 14:14:35,869 - INFO - Delete all data in sheet: Case 9
2019-08-01 17:00:01,506 - INFO - Report date: 20190801 17.00
2019-08-01 17:00:06,293 - INFO - Download sheet..
2019-08-01 17:00:06,293 - INFO - Change directory to script path
2019-08-01 17:00:07,736 - INFO - Spreadsheet downloaded
2019-08-01 17:00:07,737 - INFO - Checking sheet..
2019-08-01 17:00:09,464 - INFO - No value detected on sheet: Case 1
2019-08-01 17:00:10,806 - INFO - No value detected on sheet: Case 2
2019-08-01 17:00:12,153 - INFO - No value detected on sheet: Case 3
2019-08-01 17:00:13,525 - INFO - No value detected on sheet: Case 4
2019-08-01 17:00:14,898 - INFO - No value detected on sheet: Case 5
2019-08-01 17:00:16,262 - INFO - No value detected on sheet: Case 6
2019-08-01 17:00:17,589 - INFO - No value detected on sheet: Case 7
2019-08-01 17:00:18,989 - INFO - No value detected on sheet: Case 8
2019-08-01 17:00:20,346 - INFO - No value detected on sheet: Case 9
2019-08-02 10:00:13,619 - INFO - Report date: 20190802 10.00
2019-08-02 10:00:17,410 - INFO - Download sheet..
2019-08-02 10:00:17,411 - INFO - Change directory to script path
2019-08-02 10:00:19,107 - INFO - Spreadsheet downloaded
2019-08-02 10:00:19,108 - INFO - Checking sheet..
2019-08-02 10:00:21,061 - INFO - Value detected - use sheet: Case 1
2019-08-02 10:00:21,062 - INFO - Reading Data From Google Sheet...
2019-08-02 10:00:21,798 - INFO - Get custom SQL..
2019-08-02 10:00:21,799 - INFO - USING CASE 1
2019-08-02 10:00:23,994 - INFO - Row 1
2019-08-02 10:00:23,996 - INFO - Filename: A30 MA, Photography buyers (Headset Day)
2019-08-02 10:00:23,996 - INFO - Category: 'Mobile & Accessories','Computer & Accessories','Photography'
2019-08-02 10:00:23,996 - INFO - Last Login: 30
2019-08-02 10:00:23,996 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-02 10:00:23,997 - INFO - Start Running query A30 MA, Photography buyers (Headset Day)
2019-08-02 10:05:31,732 - INFO - Running A30 MA, Photography buyers (Headset Day) Done
2019-08-02 10:05:31,733 - INFO - CSV file path: A30 MA, Photography buyers (Headset Day)
2019-08-02 10:05:32,121 - INFO - Starting save the query results
2019-08-02 10:05:32,122 - INFO - Total Rows : 7948403
2019-08-02 10:05:32,124 - INFO - Will split into : 8.0 files
2019-08-02 10:05:37,069 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 10.00/A30 MA, Photography buyers (Headset Day)_1.csv
2019-08-02 10:05:37,071 - INFO - , with total : 993551 rows
2019-08-02 10:05:42,819 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 10.00/A30 MA, Photography buyers (Headset Day)_2.csv
2019-08-02 10:05:42,821 - INFO - , with total : 993551 rows
2019-08-02 10:05:48,283 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 10.00/A30 MA, Photography buyers (Headset Day)_3.csv
2019-08-02 10:05:48,283 - INFO - , with total : 993551 rows
2019-08-02 10:05:53,734 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 10.00/A30 MA, Photography buyers (Headset Day)_4.csv
2019-08-02 10:05:53,736 - INFO - , with total : 993550 rows
2019-08-02 10:05:59,696 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 10.00/A30 MA, Photography buyers (Headset Day)_5.csv
2019-08-02 10:05:59,697 - INFO - , with total : 993550 rows
2019-08-02 10:06:06,782 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 10.00/A30 MA, Photography buyers (Headset Day)_6.csv
2019-08-02 10:06:06,782 - INFO - , with total : 993550 rows
2019-08-02 10:06:12,075 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 10.00/A30 MA, Photography buyers (Headset Day)_7.csv
2019-08-02 10:06:12,075 - INFO - , with total : 993550 rows
2019-08-02 10:06:17,316 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 10.00/A30 MA, Photography buyers (Headset Day)_8.csv
2019-08-02 10:06:17,318 - INFO - , with total : 993550 rows
2019-08-02 10:06:19,398 - INFO - Delete all data in sheet: Case 1
2019-08-02 10:06:22,088 - INFO - No value detected on sheet: Case 2
2019-08-02 10:06:23,542 - INFO - No value detected on sheet: Case 3
2019-08-02 10:06:25,026 - INFO - No value detected on sheet: Case 4
2019-08-02 10:06:26,506 - INFO - No value detected on sheet: Case 5
2019-08-02 10:06:27,999 - INFO - No value detected on sheet: Case 6
2019-08-02 10:06:29,594 - INFO - No value detected on sheet: Case 7
2019-08-02 10:06:31,255 - INFO - No value detected on sheet: Case 8
2019-08-02 10:06:32,973 - INFO - No value detected on sheet: Case 9
2019-08-02 14:00:22,874 - INFO - Report date: 20190802 14.00
2019-08-02 14:00:28,105 - INFO - Download sheet..
2019-08-02 14:00:28,107 - INFO - Change directory to script path
2019-08-02 14:00:29,338 - INFO - Spreadsheet downloaded
2019-08-02 14:00:29,338 - INFO - Checking sheet..
2019-08-02 14:00:31,252 - INFO - No value detected on sheet: Case 1
2019-08-02 14:00:32,734 - INFO - No value detected on sheet: Case 2
2019-08-02 14:00:34,220 - INFO - No value detected on sheet: Case 3
2019-08-02 14:00:35,796 - INFO - No value detected on sheet: Case 4
2019-08-02 14:00:37,280 - INFO - No value detected on sheet: Case 5
2019-08-02 14:00:38,747 - INFO - No value detected on sheet: Case 6
2019-08-02 14:00:40,230 - INFO - Value detected - use sheet: Case 7
2019-08-02 14:00:40,230 - INFO - Reading Data From Google Sheet...
2019-08-02 14:00:41,733 - INFO - Get custom SQL..
2019-08-02 14:00:41,733 - INFO - USING CASE 7
2019-08-02 14:00:43,243 - INFO - Row 1
2019-08-02 14:00:43,244 - INFO - Filename: Cayman.Shopee Shop Followers
2019-08-02 14:00:43,244 - INFO - Shop ID: 27045712
2019-08-02 14:00:43,246 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (27045712) 
                                and status = 1
                                
2019-08-02 14:00:43,246 - INFO - Start Running query Cayman.Shopee Shop Followers
2019-08-02 14:00:53,931 - INFO - Running Cayman.Shopee Shop Followers Done
2019-08-02 14:00:53,933 - INFO - CSV file path: Cayman.Shopee Shop Followers
2019-08-02 14:00:54,039 - INFO - Starting save the query results
2019-08-02 14:00:54,048 - INFO - Total Rows : 114926
2019-08-02 14:00:54,049 - INFO - Will split into : 1.0 files
2019-08-02 14:00:54,760 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 14.00/Cayman.Shopee Shop Followers_1.csv
2019-08-02 14:00:54,762 - INFO - , with total : 114926 rows
2019-08-02 14:00:55,571 - INFO - Delete all data in sheet: Case 7
2019-08-02 14:00:57,198 - INFO - Value detected - use sheet: Case 8
2019-08-02 14:00:57,200 - INFO - Reading Data From Google Sheet...
2019-08-02 14:00:57,928 - INFO - Get custom SQL..
2019-08-02 14:00:57,928 - INFO - USING CASE 8
2019-08-02 14:00:59,184 - INFO - Row 1
2019-08-02 14:00:59,186 - INFO - Filename: A1 DP Buyers
2019-08-02 14:00:59,186 - INFO - Last Login: 1
2019-08-02 14:00:59,187 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar))
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-02 14:00:59,187 - INFO - Start Running query A1 DP Buyers
2019-08-02 14:01:37,861 - INFO - Running A1 DP Buyers Done
2019-08-02 14:01:37,862 - INFO - CSV file path: A1 DP Buyers
2019-08-02 14:01:37,920 - INFO - Starting save the query results
2019-08-02 14:01:37,920 - INFO - Total Rows : 1338640
2019-08-02 14:01:37,921 - INFO - Will split into : 2.0 files
2019-08-02 14:01:41,177 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 14.00/A1 DP Buyers_1.csv
2019-08-02 14:01:41,177 - INFO - , with total : 669320 rows
2019-08-02 14:01:45,392 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 14.00/A1 DP Buyers_2.csv
2019-08-02 14:01:45,394 - INFO - , with total : 669320 rows
2019-08-02 14:01:46,746 - INFO - Delete all data in sheet: Case 8
2019-08-02 14:01:48,653 - INFO - No value detected on sheet: Case 9
2019-08-02 15:47:59,779 - INFO - Report date: 20190802 15.47
2019-08-02 15:48:02,960 - INFO - Download sheet..
2019-08-02 15:48:02,961 - INFO - Change directory to script path
2019-08-02 15:48:04,272 - INFO - Spreadsheet downloaded
2019-08-02 15:48:04,273 - INFO - Checking sheet..
2019-08-02 15:48:06,855 - INFO - Value detected - use sheet: Case 1
2019-08-02 15:48:06,857 - INFO - Reading Data From Google Sheet...
2019-08-02 15:48:07,578 - INFO - Get custom SQL..
2019-08-02 15:48:07,578 - INFO - USING CASE 1
2019-08-02 15:48:09,836 - INFO - Row 1
2019-08-02 15:48:09,838 - INFO - Filename: A3 FMCG + Home Care
2019-08-02 15:48:09,838 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby','Home Care'
2019-08-02 15:48:09,838 - INFO - Last Login: 3
2019-08-02 15:48:09,839 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby','Home Care')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-02 15:48:09,841 - INFO - Start Running query A3 FMCG + Home Care
2019-08-02 15:51:14,697 - INFO - Running A3 FMCG + Home Care Done
2019-08-02 15:51:14,698 - INFO - CSV file path: A3 FMCG + Home Care
2019-08-02 15:51:14,960 - INFO - Starting save the query results
2019-08-02 15:51:14,960 - INFO - Total Rows : 6405570
2019-08-02 15:51:14,960 - INFO - Will split into : 7.0 files
2019-08-02 15:51:19,486 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 15.47/A3 FMCG + Home Care_1.csv
2019-08-02 15:51:19,486 - INFO - , with total : 915082 rows
2019-08-02 15:51:25,207 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 15.47/A3 FMCG + Home Care_2.csv
2019-08-02 15:51:25,207 - INFO - , with total : 915082 rows
2019-08-02 15:51:30,915 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 15.47/A3 FMCG + Home Care_3.csv
2019-08-02 15:51:30,917 - INFO - , with total : 915082 rows
2019-08-02 15:51:36,328 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 15.47/A3 FMCG + Home Care_4.csv
2019-08-02 15:51:36,328 - INFO - , with total : 915081 rows
2019-08-02 15:51:41,823 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 15.47/A3 FMCG + Home Care_5.csv
2019-08-02 15:51:41,828 - INFO - , with total : 915081 rows
2019-08-02 15:51:47,502 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 15.47/A3 FMCG + Home Care_6.csv
2019-08-02 15:51:47,503 - INFO - , with total : 915081 rows
2019-08-02 15:51:53,107 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190802 15.47/A3 FMCG + Home Care_7.csv
2019-08-02 15:51:53,108 - INFO - , with total : 915081 rows
2019-08-02 15:51:56,312 - INFO - Delete all data in sheet: Case 1
2019-08-02 15:51:58,660 - INFO - No value detected on sheet: Case 2
2019-08-02 15:52:00,174 - INFO - No value detected on sheet: Case 3
2019-08-02 15:52:01,677 - INFO - No value detected on sheet: Case 4
2019-08-02 15:52:03,191 - INFO - No value detected on sheet: Case 5
2019-08-02 15:52:04,717 - INFO - No value detected on sheet: Case 6
2019-08-02 15:52:06,302 - INFO - No value detected on sheet: Case 7
2019-08-02 15:52:07,793 - INFO - No value detected on sheet: Case 8
2019-08-02 15:52:09,285 - INFO - No value detected on sheet: Case 9
2019-08-02 17:00:04,624 - INFO - Report date: 20190802 17.00
2019-08-02 17:00:08,608 - INFO - Download sheet..
2019-08-02 17:00:08,608 - INFO - Change directory to script path
2019-08-02 17:00:09,944 - INFO - Spreadsheet downloaded
2019-08-02 17:00:09,944 - INFO - Checking sheet..
2019-08-02 17:00:11,868 - INFO - No value detected on sheet: Case 1
2019-08-02 17:00:13,594 - INFO - No value detected on sheet: Case 2
2019-08-02 17:00:15,062 - INFO - No value detected on sheet: Case 3
2019-08-02 17:00:16,561 - INFO - No value detected on sheet: Case 4
2019-08-02 17:00:18,220 - INFO - No value detected on sheet: Case 5
2019-08-02 17:00:19,868 - INFO - No value detected on sheet: Case 6
2019-08-02 17:00:21,357 - INFO - No value detected on sheet: Case 7
2019-08-02 17:00:22,921 - INFO - No value detected on sheet: Case 8
2019-08-02 17:00:25,052 - INFO - No value detected on sheet: Case 9
2019-08-03 10:00:10,966 - INFO - Report date: 20190803 10.00
2019-08-03 10:00:14,010 - INFO - Download sheet..
2019-08-03 10:00:14,010 - INFO - Change directory to script path
2019-08-03 10:00:15,084 - INFO - Spreadsheet downloaded
2019-08-03 10:00:15,086 - INFO - Checking sheet..
2019-08-03 10:00:17,081 - INFO - No value detected on sheet: Case 1
2019-08-03 10:00:18,619 - INFO - No value detected on sheet: Case 2
2019-08-03 10:00:20,345 - INFO - No value detected on sheet: Case 3
2019-08-03 10:00:21,900 - INFO - No value detected on sheet: Case 4
2019-08-03 10:00:23,831 - INFO - No value detected on sheet: Case 5
2019-08-03 10:00:25,417 - INFO - No value detected on sheet: Case 6
2019-08-03 10:00:26,950 - INFO - No value detected on sheet: Case 7
2019-08-03 10:00:28,180 - INFO - No value detected on sheet: Case 8
2019-08-03 10:00:29,358 - INFO - No value detected on sheet: Case 9
2019-08-03 14:00:05,494 - INFO - Report date: 20190803 14.00
2019-08-03 14:00:09,467 - INFO - Download sheet..
2019-08-03 14:00:09,469 - INFO - Change directory to script path
2019-08-03 14:00:11,846 - INFO - Spreadsheet downloaded
2019-08-03 14:00:11,848 - INFO - Checking sheet..
2019-08-03 14:00:13,806 - INFO - No value detected on sheet: Case 1
2019-08-03 14:00:15,161 - INFO - No value detected on sheet: Case 2
2019-08-03 14:00:16,522 - INFO - No value detected on sheet: Case 3
2019-08-03 14:00:17,884 - INFO - No value detected on sheet: Case 4
2019-08-03 14:00:19,299 - INFO - No value detected on sheet: Case 5
2019-08-03 14:00:20,687 - INFO - No value detected on sheet: Case 6
2019-08-03 14:00:22,039 - INFO - No value detected on sheet: Case 7
2019-08-03 14:00:23,388 - INFO - No value detected on sheet: Case 8
2019-08-03 14:00:24,894 - INFO - No value detected on sheet: Case 9
2019-08-03 17:00:02,072 - INFO - Report date: 20190803 17.00
2019-08-03 17:00:06,614 - INFO - Download sheet..
2019-08-03 17:00:06,615 - INFO - Change directory to script path
2019-08-03 17:00:09,049 - INFO - Spreadsheet downloaded
2019-08-03 17:00:09,052 - INFO - Checking sheet..
2019-08-03 17:00:11,038 - INFO - No value detected on sheet: Case 1
2019-08-03 17:00:12,509 - INFO - No value detected on sheet: Case 2
2019-08-03 17:00:13,967 - INFO - No value detected on sheet: Case 3
2019-08-03 17:00:15,453 - INFO - No value detected on sheet: Case 4
2019-08-03 17:00:16,930 - INFO - No value detected on sheet: Case 5
2019-08-03 17:00:18,437 - INFO - No value detected on sheet: Case 6
2019-08-03 17:00:19,931 - INFO - No value detected on sheet: Case 7
2019-08-03 17:00:21,411 - INFO - No value detected on sheet: Case 8
2019-08-03 17:00:22,907 - INFO - No value detected on sheet: Case 9
2019-08-04 10:00:15,003 - INFO - Report date: 20190804 10.00
2019-08-04 10:00:18,960 - INFO - Download sheet..
2019-08-04 10:00:18,960 - INFO - Change directory to script path
2019-08-04 10:00:21,426 - INFO - Spreadsheet downloaded
2019-08-04 10:00:21,427 - INFO - Checking sheet..
2019-08-04 10:00:23,592 - INFO - No value detected on sheet: Case 1
2019-08-04 10:00:24,951 - INFO - No value detected on sheet: Case 2
2019-08-04 10:00:26,428 - INFO - No value detected on sheet: Case 3
2019-08-04 10:00:27,812 - INFO - No value detected on sheet: Case 4
2019-08-04 10:00:29,176 - INFO - No value detected on sheet: Case 5
2019-08-04 10:00:30,605 - INFO - No value detected on sheet: Case 6
2019-08-04 10:00:31,933 - INFO - No value detected on sheet: Case 7
2019-08-04 10:00:33,532 - INFO - No value detected on sheet: Case 8
2019-08-04 10:00:34,904 - INFO - No value detected on sheet: Case 9
2019-08-05 10:09:41,441 - INFO - Report date: 20190805 10.09
2019-08-05 10:09:48,263 - INFO - Download sheet..
2019-08-05 10:09:48,263 - INFO - Change directory to script path
2019-08-05 10:09:49,515 - INFO - Spreadsheet downloaded
2019-08-05 10:09:49,516 - INFO - Checking sheet..
2019-08-05 10:09:51,434 - INFO - No value detected on sheet: Case 1
2019-08-05 10:09:52,921 - INFO - No value detected on sheet: Case 2
2019-08-05 10:09:54,410 - INFO - No value detected on sheet: Case 3
2019-08-05 10:09:55,907 - INFO - No value detected on sheet: Case 4
2019-08-05 10:09:57,398 - INFO - No value detected on sheet: Case 5
2019-08-05 10:09:58,894 - INFO - No value detected on sheet: Case 6
2019-08-05 10:10:00,371 - INFO - No value detected on sheet: Case 7
2019-08-05 10:10:01,872 - INFO - No value detected on sheet: Case 8
2019-08-05 10:10:03,369 - INFO - No value detected on sheet: Case 9
2019-08-05 14:00:07,473 - INFO - Report date: 20190805 14.00
2019-08-05 14:00:11,121 - INFO - Download sheet..
2019-08-05 14:00:11,122 - INFO - Change directory to script path
2019-08-05 14:00:12,506 - INFO - Spreadsheet downloaded
2019-08-05 14:00:12,507 - INFO - Checking sheet..
2019-08-05 14:00:14,551 - INFO - Value detected - use sheet: Case 1
2019-08-05 14:00:14,552 - INFO - Reading Data From Google Sheet...
2019-08-05 14:00:15,335 - INFO - Get custom SQL..
2019-08-05 14:00:15,335 - INFO - USING CASE 1
2019-08-05 14:00:17,788 - INFO - Row 1
2019-08-05 14:00:17,789 - INFO - Filename: A30 Sports & Outdoor Buyers
2019-08-05 14:00:17,789 - INFO - Category: 'Sports & Outdoor'
2019-08-05 14:00:17,789 - INFO - Last Login: 30
2019-08-05 14:00:17,789 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-05 14:00:17,790 - INFO - Start Running query A30 Sports & Outdoor Buyers
2019-08-05 14:01:37,595 - INFO - Running A30 Sports & Outdoor Buyers Done
2019-08-05 14:01:37,596 - INFO - CSV file path: A30 Sports & Outdoor Buyers
2019-08-05 14:01:37,696 - INFO - Starting save the query results
2019-08-05 14:01:37,697 - INFO - Total Rows : 2628389
2019-08-05 14:01:37,697 - INFO - Will split into : 3.0 files
2019-08-05 14:01:41,549 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Sports & Outdoor Buyers_1.csv
2019-08-05 14:01:41,551 - INFO - , with total : 876130 rows
2019-08-05 14:01:45,999 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Sports & Outdoor Buyers_2.csv
2019-08-05 14:01:46,000 - INFO - , with total : 876130 rows
2019-08-05 14:01:50,375 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Sports & Outdoor Buyers_3.csv
2019-08-05 14:01:50,377 - INFO - , with total : 876129 rows
2019-08-05 14:01:54,088 - INFO - Row 2
2019-08-05 14:01:54,088 - INFO - Filename: A30 FMCG Buyers
2019-08-05 14:01:54,089 - INFO - Category: 'Beauty'
2019-08-05 14:01:54,089 - INFO - Last Login: 30
2019-08-05 14:01:54,089 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-05 14:01:54,091 - INFO - Start Running query A30 FMCG Buyers
2019-08-05 14:08:54,648 - INFO - Running A30 FMCG Buyers Done
2019-08-05 14:08:54,650 - INFO - CSV file path: A30 FMCG Buyers
2019-08-05 14:08:55,017 - INFO - Starting save the query results
2019-08-05 14:08:55,019 - INFO - Total Rows : 7339682
2019-08-05 14:08:55,019 - INFO - Will split into : 8.0 files
2019-08-05 14:08:59,154 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 FMCG Buyers_1.csv
2019-08-05 14:08:59,155 - INFO - , with total : 917461 rows
2019-08-05 14:09:03,619 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 FMCG Buyers_2.csv
2019-08-05 14:09:03,621 - INFO - , with total : 917461 rows
2019-08-05 14:09:08,329 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 FMCG Buyers_3.csv
2019-08-05 14:09:08,332 - INFO - , with total : 917460 rows
2019-08-05 14:09:13,025 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 FMCG Buyers_4.csv
2019-08-05 14:09:13,026 - INFO - , with total : 917460 rows
2019-08-05 14:09:17,795 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 FMCG Buyers_5.csv
2019-08-05 14:09:17,796 - INFO - , with total : 917460 rows
2019-08-05 14:09:22,473 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 FMCG Buyers_6.csv
2019-08-05 14:09:22,473 - INFO - , with total : 917460 rows
2019-08-05 14:09:27,107 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 FMCG Buyers_7.csv
2019-08-05 14:09:27,108 - INFO - , with total : 917460 rows
2019-08-05 14:09:31,854 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 FMCG Buyers_8.csv
2019-08-05 14:09:31,855 - INFO - , with total : 917460 rows
2019-08-05 14:09:36,111 - INFO - Row 3
2019-08-05 14:09:36,112 - INFO - Filename: A30 Hobby & EL Buyers
2019-08-05 14:09:36,112 - INFO - Category: 'Hobby & Collection','Computer & Accessories','Electronics','Mobile & Accessories','Photography'
2019-08-05 14:09:36,114 - INFO - Last Login: 30
2019-08-05 14:09:36,114 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection','Computer & Accessories','Electronics','Mobile & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-05 14:09:36,115 - INFO - Start Running query A30 Hobby & EL Buyers
2019-08-05 14:13:54,588 - INFO - Running A30 Hobby & EL Buyers Done
2019-08-05 14:13:54,589 - INFO - CSV file path: A30 Hobby & EL Buyers
2019-08-05 14:13:54,993 - INFO - Starting save the query results
2019-08-05 14:13:54,994 - INFO - Total Rows : 9393998
2019-08-05 14:13:54,994 - INFO - Will split into : 10.0 files
2019-08-05 14:13:59,275 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Hobby & EL Buyers_1.csv
2019-08-05 14:13:59,276 - INFO - , with total : 939400 rows
2019-08-05 14:14:03,805 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Hobby & EL Buyers_2.csv
2019-08-05 14:14:03,805 - INFO - , with total : 939400 rows
2019-08-05 14:14:08,513 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Hobby & EL Buyers_3.csv
2019-08-05 14:14:08,513 - INFO - , with total : 939400 rows
2019-08-05 14:14:13,364 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Hobby & EL Buyers_4.csv
2019-08-05 14:14:13,365 - INFO - , with total : 939400 rows
2019-08-05 14:14:18,135 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Hobby & EL Buyers_5.csv
2019-08-05 14:14:18,137 - INFO - , with total : 939400 rows
2019-08-05 14:14:22,917 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Hobby & EL Buyers_6.csv
2019-08-05 14:14:22,918 - INFO - , with total : 939400 rows
2019-08-05 14:14:27,890 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Hobby & EL Buyers_7.csv
2019-08-05 14:14:27,891 - INFO - , with total : 939400 rows
2019-08-05 14:14:32,665 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Hobby & EL Buyers_8.csv
2019-08-05 14:14:32,667 - INFO - , with total : 939400 rows
2019-08-05 14:14:37,411 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Hobby & EL Buyers_9.csv
2019-08-05 14:14:37,411 - INFO - , with total : 939399 rows
2019-08-05 14:14:42,155 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Hobby & EL Buyers_10.csv
2019-08-05 14:14:42,157 - INFO - , with total : 939399 rows
2019-08-05 14:14:44,109 - INFO - Delete all data in sheet: Case 1
2019-08-05 14:14:46,506 - INFO - Value detected - use sheet: Case 2
2019-08-05 14:14:46,507 - INFO - Reading Data From Google Sheet...
2019-08-05 14:14:47,249 - INFO - Get custom SQL..
2019-08-05 14:14:47,250 - INFO - USING CASE 2
2019-08-05 14:14:50,200 - INFO - Row 1
2019-08-05 14:14:50,201 - INFO - Filename: A30 Active users who haven't shop the past 30days
2019-08-05 14:14:50,201 - INFO - Last Login: 30
2019-08-05 14:14:50,201 - INFO - Date 1: 2019-07-04
2019-08-05 14:14:50,203 - INFO - Date 2: 2019-07-04
2019-08-05 14:14:50,203 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-04' and date'2019-07-04'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-05 14:14:50,203 - INFO - Start Running query A30 Active users who haven't shop the past 30days
2019-08-05 14:23:45,825 - INFO - Running A30 Active users who haven't shop the past 30days Done
2019-08-05 14:23:45,825 - INFO - CSV file path: A30 Active users who haven't shop the past 30days
2019-08-05 14:23:46,875 - INFO - Starting save the query results
2019-08-05 14:23:46,875 - INFO - Total Rows : 21562002
2019-08-05 14:23:46,875 - INFO - Will split into : 22.0 files
2019-08-05 14:23:51,572 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_1.csv
2019-08-05 14:23:51,572 - INFO - , with total : 980091 rows
2019-08-05 14:23:56,415 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_2.csv
2019-08-05 14:23:56,417 - INFO - , with total : 980091 rows
2019-08-05 14:24:01,312 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_3.csv
2019-08-05 14:24:01,312 - INFO - , with total : 980091 rows
2019-08-05 14:24:06,391 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_4.csv
2019-08-05 14:24:06,391 - INFO - , with total : 980091 rows
2019-08-05 14:24:11,466 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_5.csv
2019-08-05 14:24:11,467 - INFO - , with total : 980091 rows
2019-08-05 14:24:16,642 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_6.csv
2019-08-05 14:24:16,644 - INFO - , with total : 980091 rows
2019-08-05 14:24:21,779 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_7.csv
2019-08-05 14:24:21,779 - INFO - , with total : 980091 rows
2019-08-05 14:24:26,801 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_8.csv
2019-08-05 14:24:26,802 - INFO - , with total : 980091 rows
2019-08-05 14:24:31,832 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_9.csv
2019-08-05 14:24:31,834 - INFO - , with total : 980091 rows
2019-08-05 14:24:36,910 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_10.csv
2019-08-05 14:24:36,911 - INFO - , with total : 980091 rows
2019-08-05 14:24:41,973 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_11.csv
2019-08-05 14:24:41,973 - INFO - , with total : 980091 rows
2019-08-05 14:24:46,986 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_12.csv
2019-08-05 14:24:46,987 - INFO - , with total : 980091 rows
2019-08-05 14:24:52,061 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_13.csv
2019-08-05 14:24:52,061 - INFO - , with total : 980091 rows
2019-08-05 14:24:57,164 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_14.csv
2019-08-05 14:24:57,164 - INFO - , with total : 980091 rows
2019-08-05 14:25:02,197 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_15.csv
2019-08-05 14:25:02,197 - INFO - , with total : 980091 rows
2019-08-05 14:25:07,832 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_16.csv
2019-08-05 14:25:07,832 - INFO - , with total : 980091 rows
2019-08-05 14:25:12,917 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_17.csv
2019-08-05 14:25:12,917 - INFO - , with total : 980091 rows
2019-08-05 14:25:18,142 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_18.csv
2019-08-05 14:25:18,144 - INFO - , with total : 980091 rows
2019-08-05 14:25:23,253 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_19.csv
2019-08-05 14:25:23,255 - INFO - , with total : 980091 rows
2019-08-05 14:25:28,298 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_20.csv
2019-08-05 14:25:28,299 - INFO - , with total : 980091 rows
2019-08-05 14:25:33,414 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_21.csv
2019-08-05 14:25:33,417 - INFO - , with total : 980091 rows
2019-08-05 14:25:38,394 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/A30 Active users who haven't shop the past 30days_22.csv
2019-08-05 14:25:38,398 - INFO - , with total : 980091 rows
2019-08-05 14:25:41,453 - INFO - Delete all data in sheet: Case 2
2019-08-05 14:25:43,778 - INFO - No value detected on sheet: Case 3
2019-08-05 14:25:45,263 - INFO - No value detected on sheet: Case 4
2019-08-05 14:25:46,756 - INFO - No value detected on sheet: Case 5
2019-08-05 14:25:48,295 - INFO - Value detected - use sheet: Case 6
2019-08-05 14:25:48,296 - INFO - Reading Data From Google Sheet...
2019-08-05 14:25:49,039 - INFO - Get custom SQL..
2019-08-05 14:25:49,039 - INFO - USING CASE 6
2019-08-05 14:25:52,065 - INFO - Error in get_custom_sql -> 
2019-08-05 14:25:52,068 - INFO - Delete all data in sheet: Case 6
2019-08-05 14:25:54,332 - INFO - No value detected on sheet: Case 7
2019-08-05 14:25:55,809 - INFO - Value detected - use sheet: Case 8
2019-08-05 14:25:55,811 - INFO - Reading Data From Google Sheet...
2019-08-05 14:25:56,542 - INFO - Get custom SQL..
2019-08-05 14:25:56,542 - INFO - USING CASE 8
2019-08-05 14:25:58,091 - INFO - Row 1
2019-08-05 14:25:58,092 - INFO - Filename: COLAB Dry Shampoo OS Followers
2019-08-05 14:25:58,092 - INFO - Last Login: 73424206
2019-08-05 14:25:58,092 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '73424206' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar))
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-05 14:25:58,094 - INFO - Start Running query COLAB Dry Shampoo OS Followers
2019-08-05 14:27:22,309 - INFO - Running COLAB Dry Shampoo OS Followers Done
2019-08-05 14:27:22,309 - INFO - CSV file path: COLAB Dry Shampoo OS Followers
2019-08-05 14:27:22,426 - INFO - Starting save the query results
2019-08-05 14:27:22,427 - INFO - Total Rows : 3232596
2019-08-05 14:27:22,427 - INFO - Will split into : 4.0 files
2019-08-05 14:27:26,029 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/COLAB Dry Shampoo OS Followers_1.csv
2019-08-05 14:27:26,029 - INFO - , with total : 808149 rows
2019-08-05 14:27:30,020 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/COLAB Dry Shampoo OS Followers_2.csv
2019-08-05 14:27:30,022 - INFO - , with total : 808149 rows
2019-08-05 14:27:34,005 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/COLAB Dry Shampoo OS Followers_3.csv
2019-08-05 14:27:34,006 - INFO - , with total : 808149 rows
2019-08-05 14:27:38,124 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/COLAB Dry Shampoo OS Followers_4.csv
2019-08-05 14:27:38,125 - INFO - , with total : 808149 rows
2019-08-05 14:27:39,927 - INFO - Row 2
2019-08-05 14:27:39,928 - INFO - Filename: godricstore OS Followers
2019-08-05 14:27:39,930 - INFO - Last Login: 1242322
2019-08-05 14:27:39,930 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '1242322' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar))
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-05 14:27:39,930 - INFO - Start Running query godricstore OS Followers
2019-08-05 14:29:15,990 - INFO - Running godricstore OS Followers Done
2019-08-05 14:29:15,990 - INFO - CSV file path: godricstore OS Followers
2019-08-05 14:29:16,108 - INFO - Starting save the query results
2019-08-05 14:29:16,109 - INFO - Total Rows : 3232596
2019-08-05 14:29:16,111 - INFO - Will split into : 4.0 files
2019-08-05 14:29:19,716 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/godricstore OS Followers_1.csv
2019-08-05 14:29:19,717 - INFO - , with total : 808149 rows
2019-08-05 14:29:23,654 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/godricstore OS Followers_2.csv
2019-08-05 14:29:23,654 - INFO - , with total : 808149 rows
2019-08-05 14:29:27,790 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/godricstore OS Followers_3.csv
2019-08-05 14:29:27,792 - INFO - , with total : 808149 rows
2019-08-05 14:29:31,966 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/godricstore OS Followers_4.csv
2019-08-05 14:29:31,967 - INFO - , with total : 808149 rows
2019-08-05 14:29:34,095 - INFO - Row 3
2019-08-05 14:29:34,096 - INFO - Filename: xueweiid OS Followers
2019-08-05 14:29:34,098 - INFO - Last Login: 9291917
2019-08-05 14:29:34,098 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '9291917' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar))
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-05 14:29:34,098 - INFO - Start Running query xueweiid OS Followers
2019-08-05 14:30:59,720 - INFO - Running xueweiid OS Followers Done
2019-08-05 14:30:59,721 - INFO - CSV file path: xueweiid OS Followers
2019-08-05 14:30:59,835 - INFO - Starting save the query results
2019-08-05 14:30:59,835 - INFO - Total Rows : 3232596
2019-08-05 14:30:59,836 - INFO - Will split into : 4.0 files
2019-08-05 14:31:03,477 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/xueweiid OS Followers_1.csv
2019-08-05 14:31:03,479 - INFO - , with total : 808149 rows
2019-08-05 14:31:07,387 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/xueweiid OS Followers_2.csv
2019-08-05 14:31:07,388 - INFO - , with total : 808149 rows
2019-08-05 14:31:11,381 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/xueweiid OS Followers_3.csv
2019-08-05 14:31:11,382 - INFO - , with total : 808149 rows
2019-08-05 14:31:15,650 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.00/xueweiid OS Followers_4.csv
2019-08-05 14:31:15,651 - INFO - , with total : 808149 rows
2019-08-05 14:31:16,733 - INFO - Delete all data in sheet: Case 8
2019-08-05 14:31:18,700 - INFO - No value detected on sheet: Case 9
2019-08-05 14:48:30,668 - INFO - Report date: 20190805 14.48
2019-08-05 14:48:30,710 - INFO - Download sheet..
2019-08-05 14:48:30,710 - INFO - Change directory to script path
2019-08-05 14:48:33,384 - INFO - Spreadsheet downloaded
2019-08-05 14:48:33,388 - INFO - Checking sheet..
2019-08-05 14:48:36,342 - INFO - No value detected on sheet: Case 1
2019-08-05 14:48:37,733 - INFO - No value detected on sheet: Case 2
2019-08-05 14:48:39,226 - INFO - No value detected on sheet: Case 3
2019-08-05 14:48:41,444 - INFO - No value detected on sheet: Case 4
2019-08-05 14:48:43,170 - INFO - No value detected on sheet: Case 5
2019-08-05 14:48:46,157 - INFO - No value detected on sheet: Case 6
2019-08-05 14:49:35,079 - INFO - Report date: 20190805 14.49
2019-08-05 14:49:35,107 - INFO - Download sheet..
2019-08-05 14:49:35,108 - INFO - Change directory to script path
2019-08-05 14:49:38,403 - INFO - Spreadsheet downloaded
2019-08-05 14:49:38,404 - INFO - Checking sheet..
2019-08-05 14:49:44,533 - INFO - Value detected - use sheet: Case 1
2019-08-05 14:49:44,536 - INFO - Reading Data From Google Sheet...
2019-08-05 14:49:45,612 - INFO - Get custom SQL..
2019-08-05 14:49:45,615 - INFO - USING CASE 1
2019-08-05 14:49:48,917 - INFO - Row 1
2019-08-05 14:49:48,921 - INFO - Filename: A30 Sports & Outdoor Buyers
2019-08-05 14:49:48,923 - INFO - Category: 'Sports & Outdoor'
2019-08-05 14:49:48,927 - INFO - Last Login: 30
2019-08-05 14:49:48,933 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-05 14:49:48,948 - INFO - Start Running query A30 Sports & Outdoor Buyers
2019-08-05 14:55:02,354 - INFO - Running A30 Sports & Outdoor Buyers Done
2019-08-05 14:55:02,355 - INFO - CSV file path: A30 Sports & Outdoor Buyers
2019-08-05 14:55:02,585 - INFO - Starting save the query results
2019-08-05 14:55:02,585 - INFO - Total Rows : 2628389
2019-08-05 14:55:02,585 - INFO - Will split into : 3.0 files
2019-08-05 14:55:09,381 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Sports & Outdoor Buyers_1.csv
2019-08-05 14:55:09,382 - INFO - , with total : 876130 rows
2019-08-05 14:55:14,519 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Sports & Outdoor Buyers_2.csv
2019-08-05 14:55:14,519 - INFO - , with total : 876130 rows
2019-08-05 14:55:19,266 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Sports & Outdoor Buyers_3.csv
2019-08-05 14:55:19,266 - INFO - , with total : 876129 rows
2019-08-05 14:55:22,683 - INFO - Row 2
2019-08-05 14:55:22,684 - INFO - Filename: A30 FMCG Buyers
2019-08-05 14:55:22,684 - INFO - Category: 'Beauty'
2019-08-05 14:55:22,687 - INFO - Last Login: 30
2019-08-05 14:55:22,687 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-05 14:55:22,694 - INFO - Start Running query A30 FMCG Buyers
2019-08-05 15:08:41,752 - INFO - Running A30 FMCG Buyers Done
2019-08-05 15:08:41,753 - INFO - CSV file path: A30 FMCG Buyers
2019-08-05 15:08:42,361 - INFO - Starting save the query results
2019-08-05 15:08:42,361 - INFO - Total Rows : 7339682
2019-08-05 15:08:42,361 - INFO - Will split into : 8.0 files
2019-08-05 15:08:47,177 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 FMCG Buyers_1.csv
2019-08-05 15:08:47,177 - INFO - , with total : 917461 rows
2019-08-05 15:08:54,960 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 FMCG Buyers_2.csv
2019-08-05 15:08:54,960 - INFO - , with total : 917461 rows
2019-08-05 15:09:02,253 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 FMCG Buyers_3.csv
2019-08-05 15:09:02,255 - INFO - , with total : 917460 rows
2019-08-05 15:09:11,608 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 FMCG Buyers_4.csv
2019-08-05 15:09:11,609 - INFO - , with total : 917460 rows
2019-08-05 15:09:20,775 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 FMCG Buyers_5.csv
2019-08-05 15:09:20,778 - INFO - , with total : 917460 rows
2019-08-05 15:09:26,658 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 FMCG Buyers_6.csv
2019-08-05 15:09:26,658 - INFO - , with total : 917460 rows
2019-08-05 15:09:32,325 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 FMCG Buyers_7.csv
2019-08-05 15:09:32,326 - INFO - , with total : 917460 rows
2019-08-05 15:09:38,681 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 FMCG Buyers_8.csv
2019-08-05 15:09:38,681 - INFO - , with total : 917460 rows
2019-08-05 15:09:42,506 - INFO - Row 3
2019-08-05 15:09:42,506 - INFO - Filename: A30 Hobby & EL Buyers
2019-08-05 15:09:42,507 - INFO - Category: 'Hobby & Collection','Computer & Accessories','Electronics','Mobile & Accessories','Photography'
2019-08-05 15:09:42,509 - INFO - Last Login: 30
2019-08-05 15:09:42,509 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection','Computer & Accessories','Electronics','Mobile & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-05 15:09:42,510 - INFO - Start Running query A30 Hobby & EL Buyers
2019-08-05 15:29:26,390 - INFO - Running A30 Hobby & EL Buyers Done
2019-08-05 15:29:26,391 - INFO - CSV file path: A30 Hobby & EL Buyers
2019-08-05 15:29:27,407 - INFO - Starting save the query results
2019-08-05 15:29:27,411 - INFO - Total Rows : 9393998
2019-08-05 15:29:27,417 - INFO - Will split into : 10.0 files
2019-08-05 15:29:33,717 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Hobby & EL Buyers_1.csv
2019-08-05 15:29:33,719 - INFO - , with total : 939400 rows
2019-08-05 15:29:38,910 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Hobby & EL Buyers_2.csv
2019-08-05 15:29:38,911 - INFO - , with total : 939400 rows
2019-08-05 15:29:44,354 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Hobby & EL Buyers_3.csv
2019-08-05 15:29:44,355 - INFO - , with total : 939400 rows
2019-08-05 15:29:50,421 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Hobby & EL Buyers_4.csv
2019-08-05 15:29:50,421 - INFO - , with total : 939400 rows
2019-08-05 15:29:56,197 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Hobby & EL Buyers_5.csv
2019-08-05 15:29:56,197 - INFO - , with total : 939400 rows
2019-08-05 15:30:03,713 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Hobby & EL Buyers_6.csv
2019-08-05 15:30:03,713 - INFO - , with total : 939400 rows
2019-08-05 15:30:10,134 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Hobby & EL Buyers_7.csv
2019-08-05 15:30:10,134 - INFO - , with total : 939400 rows
2019-08-05 15:30:19,976 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Hobby & EL Buyers_8.csv
2019-08-05 15:30:19,977 - INFO - , with total : 939400 rows
2019-08-05 15:30:26,289 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Hobby & EL Buyers_9.csv
2019-08-05 15:30:26,289 - INFO - , with total : 939399 rows
2019-08-05 15:30:34,167 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Hobby & EL Buyers_10.csv
2019-08-05 15:30:34,167 - INFO - , with total : 939399 rows
2019-08-05 15:30:36,529 - INFO - Delete all data in sheet: Case 1
2019-08-05 15:30:39,118 - INFO - Value detected - use sheet: Case 2
2019-08-05 15:30:39,118 - INFO - Reading Data From Google Sheet...
2019-08-05 15:30:39,944 - INFO - Get custom SQL..
2019-08-05 15:30:39,947 - INFO - USING CASE 2
2019-08-05 15:30:43,260 - INFO - Row 1
2019-08-05 15:30:43,262 - INFO - Filename: A30 Active users who haven't shop the past 30days
2019-08-05 15:30:43,263 - INFO - Last Login: 30
2019-08-05 15:30:43,265 - INFO - Date 1: 2019-07-04
2019-08-05 15:30:43,266 - INFO - Date 2: 2019-08-04
2019-08-05 15:30:43,266 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-04' and date'2019-08-04'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-05 15:30:43,278 - INFO - Start Running query A30 Active users who haven't shop the past 30days
2019-08-05 15:43:36,638 - INFO - Running A30 Active users who haven't shop the past 30days Done
2019-08-05 15:43:36,640 - INFO - CSV file path: A30 Active users who haven't shop the past 30days
2019-08-05 15:43:37,716 - INFO - Starting save the query results
2019-08-05 15:43:37,717 - INFO - Total Rows : 13463673
2019-08-05 15:43:37,717 - INFO - Will split into : 14.0 files
2019-08-05 15:43:43,142 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_1.csv
2019-08-05 15:43:43,144 - INFO - , with total : 961691 rows
2019-08-05 15:43:48,565 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_2.csv
2019-08-05 15:43:48,565 - INFO - , with total : 961691 rows
2019-08-05 15:43:54,368 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_3.csv
2019-08-05 15:43:54,371 - INFO - , with total : 961691 rows
2019-08-05 15:44:00,256 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_4.csv
2019-08-05 15:44:00,257 - INFO - , with total : 961691 rows
2019-08-05 15:44:06,105 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_5.csv
2019-08-05 15:44:06,107 - INFO - , with total : 961691 rows
2019-08-05 15:44:13,066 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_6.csv
2019-08-05 15:44:13,068 - INFO - , with total : 961691 rows
2019-08-05 15:44:19,046 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_7.csv
2019-08-05 15:44:19,046 - INFO - , with total : 961691 rows
2019-08-05 15:44:24,996 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_8.csv
2019-08-05 15:44:24,996 - INFO - , with total : 961691 rows
2019-08-05 15:44:30,914 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_9.csv
2019-08-05 15:44:30,914 - INFO - , with total : 961691 rows
2019-08-05 15:44:36,729 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_10.csv
2019-08-05 15:44:36,730 - INFO - , with total : 961691 rows
2019-08-05 15:44:42,703 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_11.csv
2019-08-05 15:44:42,704 - INFO - , with total : 961691 rows
2019-08-05 15:44:48,742 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_12.csv
2019-08-05 15:44:48,743 - INFO - , with total : 961691 rows
2019-08-05 15:44:55,220 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_13.csv
2019-08-05 15:44:55,221 - INFO - , with total : 961691 rows
2019-08-05 15:45:01,404 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Active users who haven't shop the past 30days_14.csv
2019-08-05 15:45:01,408 - INFO - , with total : 961690 rows
2019-08-05 15:45:03,467 - INFO - Delete all data in sheet: Case 2
2019-08-05 15:45:06,032 - INFO - No value detected on sheet: Case 3
2019-08-05 15:45:07,592 - INFO - No value detected on sheet: Case 4
2019-08-05 15:45:09,319 - INFO - No value detected on sheet: Case 5
2019-08-05 15:45:10,842 - INFO - Value detected - use sheet: Case 6
2019-08-05 15:45:10,842 - INFO - Reading Data From Google Sheet...
2019-08-05 15:45:11,644 - INFO - Get custom SQL..
2019-08-05 15:45:11,645 - INFO - USING CASE 6
2019-08-05 15:45:14,118 - INFO - Row 1
2019-08-05 15:45:14,121 - INFO - Filename: A30 MA Buyers (Casing)
2019-08-05 15:45:14,121 - INFO - Sub-category: 'Casing & Covers'
2019-08-05 15:45:14,124 - INFO - Last Login: 30
2019-08-05 15:45:14,125 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Casing & Covers')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-05 15:45:14,140 - INFO - Start Running query A30 MA Buyers (Casing)
2019-08-05 15:47:24,783 - INFO - Running A30 MA Buyers (Casing) Done
2019-08-05 15:47:24,785 - INFO - CSV file path: A30 MA Buyers (Casing)
2019-08-05 15:47:25,075 - INFO - Starting save the query results
2019-08-05 15:47:25,076 - INFO - Total Rows : 3237038
2019-08-05 15:47:25,078 - INFO - Will split into : 4.0 files
2019-08-05 15:47:29,924 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 MA Buyers (Casing)_1.csv
2019-08-05 15:47:29,924 - INFO - , with total : 809260 rows
2019-08-05 15:47:34,388 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 MA Buyers (Casing)_2.csv
2019-08-05 15:47:34,390 - INFO - , with total : 809260 rows
2019-08-05 15:47:40,335 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 MA Buyers (Casing)_3.csv
2019-08-05 15:47:40,335 - INFO - , with total : 809259 rows
2019-08-05 15:47:45,509 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 MA Buyers (Casing)_4.csv
2019-08-05 15:47:45,512 - INFO - , with total : 809259 rows
2019-08-05 15:47:46,631 - INFO - Delete all data in sheet: Case 6
2019-08-05 15:47:48,631 - INFO - No value detected on sheet: Case 7
2019-08-05 15:47:49,974 - INFO - Value detected - use sheet: Case 8
2019-08-05 15:47:49,977 - INFO - Reading Data From Google Sheet...
2019-08-05 15:47:50,434 - INFO - Get custom SQL..
2019-08-05 15:47:50,437 - INFO - USING CASE 8
2019-08-05 15:47:52,063 - INFO - Row 1
2019-08-05 15:47:52,065 - INFO - Filename: COLAB Dry Shampoo OS Followers
2019-08-05 15:47:52,069 - INFO - Shop ID: 73424206
2019-08-05 15:47:52,073 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (73424206) 
                                and status = 1
                                
2019-08-05 15:47:52,079 - INFO - Start Running query COLAB Dry Shampoo OS Followers
2019-08-05 15:48:03,971 - INFO - Running COLAB Dry Shampoo OS Followers Done
2019-08-05 15:48:03,973 - INFO - CSV file path: COLAB Dry Shampoo OS Followers
2019-08-05 15:48:03,976 - INFO - Starting save the query results
2019-08-05 15:48:03,977 - INFO - Total Rows : 8222
2019-08-05 15:48:03,979 - INFO - Will split into : 1.0 files
2019-08-05 15:48:04,078 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/COLAB Dry Shampoo OS Followers_1.csv
2019-08-05 15:48:04,078 - INFO - , with total : 8222 rows
2019-08-05 15:48:05,657 - INFO - Row 2
2019-08-05 15:48:05,657 - INFO - Filename: godricstore OS Followers
2019-08-05 15:48:05,658 - INFO - Shop ID: 1242322
2019-08-05 15:48:05,660 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (1242322) 
                                and status = 1
                                
2019-08-05 15:48:05,661 - INFO - Start Running query godricstore OS Followers
2019-08-05 15:48:14,253 - INFO - Running godricstore OS Followers Done
2019-08-05 15:48:14,256 - INFO - CSV file path: godricstore OS Followers
2019-08-05 15:48:14,279 - INFO - Starting save the query results
2019-08-05 15:48:14,282 - INFO - Total Rows : 77867
2019-08-05 15:48:14,285 - INFO - Will split into : 1.0 files
2019-08-05 15:48:14,674 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/godricstore OS Followers_1.csv
2019-08-05 15:48:14,674 - INFO - , with total : 77867 rows
2019-08-05 15:48:16,382 - INFO - Row 3
2019-08-05 15:48:16,387 - INFO - Filename: xueweiid OS Followers
2019-08-05 15:48:16,388 - INFO - Shop ID: 9291917
2019-08-05 15:48:16,391 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (9291917) 
                                and status = 1
                                
2019-08-05 15:48:16,400 - INFO - Start Running query xueweiid OS Followers
2019-08-05 15:48:22,644 - INFO - Running xueweiid OS Followers Done
2019-08-05 15:48:22,648 - INFO - CSV file path: xueweiid OS Followers
2019-08-05 15:48:22,673 - INFO - Starting save the query results
2019-08-05 15:48:22,674 - INFO - Total Rows : 59760
2019-08-05 15:48:22,676 - INFO - Will split into : 1.0 files
2019-08-05 15:48:23,030 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/xueweiid OS Followers_1.csv
2019-08-05 15:48:23,032 - INFO - , with total : 59760 rows
2019-08-05 15:48:24,361 - INFO - Row 4
2019-08-05 15:48:24,361 - INFO - Filename: agenbajuofficial OS Followers
2019-08-05 15:48:24,362 - INFO - Shop ID: 18387484
2019-08-05 15:48:24,365 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (18387484) 
                                and status = 1
                                
2019-08-05 15:48:24,368 - INFO - Start Running query agenbajuofficial OS Followers
2019-08-05 15:48:38,267 - INFO - Running agenbajuofficial OS Followers Done
2019-08-05 15:48:38,269 - INFO - CSV file path: agenbajuofficial OS Followers
2019-08-05 15:48:38,303 - INFO - Starting save the query results
2019-08-05 15:48:38,305 - INFO - Total Rows : 452764
2019-08-05 15:48:38,305 - INFO - Will split into : 1.0 files
2019-08-05 15:48:40,562 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/agenbajuofficial OS Followers_1.csv
2019-08-05 15:48:40,563 - INFO - , with total : 452764 rows
2019-08-05 15:48:42,194 - INFO - Row 5
2019-08-05 15:48:42,197 - INFO - Filename: isabeladelia OS Followers
2019-08-05 15:48:42,198 - INFO - Shop ID: 5351570
2019-08-05 15:48:42,200 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (5351570) 
                                and status = 1
                                
2019-08-05 15:48:42,209 - INFO - Start Running query isabeladelia OS Followers
2019-08-05 15:49:00,443 - INFO - Running isabeladelia OS Followers Done
2019-08-05 15:49:00,444 - INFO - CSV file path: isabeladelia OS Followers
2019-08-05 15:49:00,493 - INFO - Starting save the query results
2019-08-05 15:49:00,493 - INFO - Total Rows : 559237
2019-08-05 15:49:00,494 - INFO - Will split into : 1.0 files
2019-08-05 15:49:03,384 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/isabeladelia OS Followers_1.csv
2019-08-05 15:49:03,394 - INFO - , with total : 559237 rows
2019-08-05 15:49:05,717 - INFO - Row 6
2019-08-05 15:49:05,720 - INFO - Filename: tokogrosirbatam OS Followers
2019-08-05 15:49:05,723 - INFO - Shop ID: 2913507
2019-08-05 15:49:05,724 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (2913507) 
                                and status = 1
                                
2019-08-05 15:49:05,732 - INFO - Start Running query tokogrosirbatam OS Followers
2019-08-05 15:49:22,730 - INFO - Running tokogrosirbatam OS Followers Done
2019-08-05 15:49:22,730 - INFO - CSV file path: tokogrosirbatam OS Followers
2019-08-05 15:49:22,773 - INFO - Starting save the query results
2019-08-05 15:49:22,773 - INFO - Total Rows : 549507
2019-08-05 15:49:22,773 - INFO - Will split into : 1.0 files
2019-08-05 15:49:25,493 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/tokogrosirbatam OS Followers_1.csv
2019-08-05 15:49:25,494 - INFO - , with total : 549507 rows
2019-08-05 15:49:25,940 - INFO - Delete all data in sheet: Case 8
2019-08-05 15:49:27,986 - INFO - No value detected on sheet: Case 9
2019-08-05 15:49:28,845 - INFO - No value detected on sheet: Case 10
2019-08-05 15:49:29,799 - INFO - No value detected on sheet: Case 11
2019-08-05 15:49:31,007 - INFO - No value detected on sheet: Case 12
2019-08-05 15:49:32,210 - INFO - Value detected - use sheet: Case 13
2019-08-05 15:49:32,213 - INFO - Reading Data From Google Sheet...
2019-08-05 15:49:33,019 - INFO - Get custom SQL..
2019-08-05 15:49:33,022 - INFO - USING CASE 13
2019-08-05 15:49:35,026 - INFO - Row 1
2019-08-05 15:49:35,030 - INFO - Filename: A30 Kuis Shopee User
2019-08-05 15:49:35,033 - INFO - Date 1: 2019-07-04
2019-08-05 15:49:35,036 - INFO - Date 2: 2019-08-04
2019-08-05 15:49:35,039 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from shopee_id_bi_team__kuis_players as a
                                join shopee_gamehq_id_db__hq_sessions_tab as b 
                                on a.session_id = cast(b.id as varchar)
                                join shopee_gamehq_id_db__hq_events_tab as c 
                                on a.event_id = cast(c.id as varchar)
                                where date(from_unixtime(b.start,'Asia/Jakarta')) >= date('2019-07-04')
                                and date(from_unixtime(b.start,'Asia/Jakarta')) <= date('2019-08-04')
                                
2019-08-05 15:49:35,049 - INFO - Start Running query A30 Kuis Shopee User
2019-08-05 15:49:47,513 - INFO - Running A30 Kuis Shopee User Done
2019-08-05 15:49:47,513 - INFO - CSV file path: A30 Kuis Shopee User
2019-08-05 15:49:47,538 - INFO - Starting save the query results
2019-08-05 15:49:47,539 - INFO - Total Rows : 276090
2019-08-05 15:49:47,539 - INFO - Will split into : 1.0 files
2019-08-05 15:49:48,944 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190805 14.49/A30 Kuis Shopee User_1.csv
2019-08-05 15:49:48,946 - INFO - , with total : 276090 rows
2019-08-05 15:49:49,710 - INFO - Delete all data in sheet: Case 13
2019-08-05 15:49:51,342 - INFO - No value detected on sheet: Case 14
2019-08-05 15:49:52,217 - INFO - No value detected on sheet: Case 15
2019-08-05 17:00:03,253 - INFO - Report date: 20190805 17.00
2019-08-05 17:00:07,528 - INFO - Download sheet..
2019-08-05 17:00:07,529 - INFO - Change directory to script path
2019-08-05 17:00:08,855 - INFO - Spreadsheet downloaded
2019-08-05 17:00:08,855 - INFO - Checking sheet..
2019-08-05 17:00:10,746 - INFO - No value detected on sheet: Case 1
2019-08-05 17:00:12,230 - INFO - No value detected on sheet: Case 2
2019-08-05 17:00:13,700 - INFO - No value detected on sheet: Case 3
2019-08-05 17:00:15,183 - INFO - No value detected on sheet: Case 4
2019-08-05 17:00:16,680 - INFO - No value detected on sheet: Case 5
2019-08-05 17:00:18,178 - INFO - No value detected on sheet: Case 6
2019-08-05 17:00:19,973 - INFO - No value detected on sheet: Case 7
2019-08-05 17:00:21,460 - INFO - No value detected on sheet: Case 8
2019-08-05 17:00:22,926 - INFO - No value detected on sheet: Case 9
2019-08-05 17:00:24,638 - INFO - No value detected on sheet: Case 10
2019-08-05 17:00:26,174 - INFO - No value detected on sheet: Case 11
2019-08-05 17:00:27,710 - INFO - No value detected on sheet: Case 12
2019-08-05 17:00:28,566 - INFO - No value detected on sheet: Case 13
2019-08-05 17:00:29,714 - INFO - No value detected on sheet: Case 14
2019-08-05 17:00:30,862 - INFO - No value detected on sheet: Case 15
2019-08-06 10:00:12,785 - INFO - Report date: 20190806 10.00
2019-08-06 10:00:16,523 - INFO - Download sheet..
2019-08-06 10:00:16,525 - INFO - Change directory to script path
2019-08-06 10:00:17,951 - INFO - Spreadsheet downloaded
2019-08-06 10:00:17,953 - INFO - Checking sheet..
2019-08-06 10:00:20,737 - INFO - Value detected - use sheet: Case 1
2019-08-06 10:00:20,739 - INFO - Reading Data From Google Sheet...
2019-08-06 10:00:21,507 - INFO - Get custom SQL..
2019-08-06 10:00:21,509 - INFO - USING CASE 1
2019-08-06 10:00:23,500 - INFO - Row 1
2019-08-06 10:00:23,502 - INFO - Filename: A30 Video Games Buyers
2019-08-06 10:00:23,503 - INFO - Category: 'Electronics','Hobby & Collection'
2019-08-06 10:00:23,503 - INFO - Last Login: 30
2019-08-06 10:00:23,503 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-06 10:00:23,503 - INFO - Start Running query A30 Video Games Buyers
2019-08-06 10:03:01,872 - INFO - Running A30 Video Games Buyers Done
2019-08-06 10:03:01,874 - INFO - CSV file path: A30 Video Games Buyers
2019-08-06 10:03:02,084 - INFO - Starting save the query results
2019-08-06 10:03:02,085 - INFO - Total Rows : 5565129
2019-08-06 10:03:02,085 - INFO - Will split into : 6.0 files
2019-08-06 10:03:06,190 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A30 Video Games Buyers_1.csv
2019-08-06 10:03:06,190 - INFO - , with total : 927522 rows
2019-08-06 10:03:11,210 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A30 Video Games Buyers_2.csv
2019-08-06 10:03:11,210 - INFO - , with total : 927522 rows
2019-08-06 10:03:15,924 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A30 Video Games Buyers_3.csv
2019-08-06 10:03:15,924 - INFO - , with total : 927522 rows
2019-08-06 10:03:20,687 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A30 Video Games Buyers_4.csv
2019-08-06 10:03:20,687 - INFO - , with total : 927521 rows
2019-08-06 10:03:25,338 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A30 Video Games Buyers_5.csv
2019-08-06 10:03:25,339 - INFO - , with total : 927521 rows
2019-08-06 10:03:29,984 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A30 Video Games Buyers_6.csv
2019-08-06 10:03:29,986 - INFO - , with total : 927521 rows
2019-08-06 10:03:33,523 - INFO - Row 2
2019-08-06 10:03:33,525 - INFO - Filename: A30 Sports & Outdoor Buyers
2019-08-06 10:03:33,525 - INFO - Category: 'Lifestyle'
2019-08-06 10:03:33,526 - INFO - Last Login: 30
2019-08-06 10:03:33,526 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Lifestyle')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-06 10:03:33,526 - INFO - Start Running query A30 Sports & Outdoor Buyers
2019-08-06 10:03:44,072 - INFO - java.sql.SQLException: Error executing query
2019-08-06 10:06:02,180 - INFO - Running A30 Sports & Outdoor Buyers Done
2019-08-06 10:06:02,181 - INFO - CSV file path: A30 Sports & Outdoor Buyers
2019-08-06 10:06:02,191 - INFO - Starting save the query results
2019-08-06 10:06:02,191 - INFO - Total Rows : 0
2019-08-06 10:06:02,193 - INFO - Will split into : 0.0 files
2019-08-06 10:06:02,194 - INFO - ERROR -> number sections must be larger than 0.
2019-08-06 10:06:02,961 - INFO - Delete all data in sheet: Case 1
2019-08-06 10:06:04,857 - INFO - No value detected on sheet: Case 2
2019-08-06 10:06:05,964 - INFO - No value detected on sheet: Case 3
2019-08-06 10:06:07,289 - INFO - No value detected on sheet: Case 4
2019-08-06 10:06:08,644 - INFO - No value detected on sheet: Case 5
2019-08-06 10:06:10,051 - INFO - No value detected on sheet: Case 6
2019-08-06 10:06:11,151 - INFO - No value detected on sheet: Case 7
2019-08-06 10:06:12,665 - INFO - Value detected - use sheet: Case 8
2019-08-06 10:06:12,667 - INFO - Reading Data From Google Sheet...
2019-08-06 10:06:13,348 - INFO - Get custom SQL..
2019-08-06 10:06:13,348 - INFO - USING CASE 8
2019-08-06 10:06:14,407 - INFO - Row 1
2019-08-06 10:06:14,408 - INFO - Filename: tokolariss88 OS Followers
2019-08-06 10:06:14,408 - INFO - Shop ID: 125824798
2019-08-06 10:06:14,410 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (125824798) 
                                and status = 1
                                
2019-08-06 10:06:14,410 - INFO - Start Running query tokolariss88 OS Followers
2019-08-06 10:08:38,884 - INFO - Running tokolariss88 OS Followers Done
2019-08-06 10:08:38,885 - INFO - CSV file path: tokolariss88 OS Followers
2019-08-06 10:08:38,887 - INFO - Starting save the query results
2019-08-06 10:08:38,888 - INFO - Total Rows : 2365
2019-08-06 10:08:38,888 - INFO - Will split into : 1.0 files
2019-08-06 10:08:38,911 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/tokolariss88 OS Followers_1.csv
2019-08-06 10:08:38,913 - INFO - , with total : 2365 rows
2019-08-06 10:08:39,736 - INFO - Delete all data in sheet: Case 8
2019-08-06 10:08:41,832 - INFO - No value detected on sheet: Case 9
2019-08-06 10:08:42,660 - INFO - Value detected - use sheet: Case 10
2019-08-06 10:08:42,660 - INFO - Reading Data From Google Sheet...
2019-08-06 10:08:43,059 - INFO - Get custom SQL..
2019-08-06 10:08:43,061 - INFO - USING CASE 10
2019-08-06 10:08:45,000 - INFO - Row 1
2019-08-06 10:08:45,000 - INFO - Filename: A1 who have not bought DP
2019-08-06 10:08:45,000 - INFO - Last Login: 1
2019-08-06 10:08:45,002 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Automotive','Baby & Kids Fashion','Beauty','Computer & Accessories','Cosmetics','Electronics','Fashion Accessories','Food & Beverages','Health','Health & Beauty','Hobby & Collection','Home & Living','Men','Bags','Men Clothesm','Men Shoes','Mobile & Accessories','Mom & Baby','Muslim Fashion','Others','Photography','Souvenir & Party Supplies','Sports & Outdoor','Stationery & Books','Vouchers','Watches','Women Bags','Women Clothes','Women Shoes') 
                                    and
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-06 10:08:45,002 - INFO - Start Running query A1 who have not bought DP
2019-08-06 10:12:05,368 - INFO - Running A1 who have not bought DP Done
2019-08-06 10:12:05,371 - INFO - CSV file path: A1 who have not bought DP
2019-08-06 10:12:05,555 - INFO - Starting save the query results
2019-08-06 10:12:05,555 - INFO - Total Rows : 4973401
2019-08-06 10:12:05,555 - INFO - Will split into : 5.0 files
2019-08-06 10:12:09,993 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A1 who have not bought DP_1.csv
2019-08-06 10:12:09,993 - INFO - , with total : 994681 rows
2019-08-06 10:12:14,828 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A1 who have not bought DP_2.csv
2019-08-06 10:12:14,829 - INFO - , with total : 994680 rows
2019-08-06 10:12:19,698 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A1 who have not bought DP_3.csv
2019-08-06 10:12:19,700 - INFO - , with total : 994680 rows
2019-08-06 10:12:25,003 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A1 who have not bought DP_4.csv
2019-08-06 10:12:25,003 - INFO - , with total : 994680 rows
2019-08-06 10:12:30,253 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 10.00/A1 who have not bought DP_5.csv
2019-08-06 10:12:30,255 - INFO - , with total : 994680 rows
2019-08-06 10:12:31,786 - INFO - Delete all data in sheet: Case 10
2019-08-06 10:12:33,775 - INFO - No value detected on sheet: Case 11
2019-08-06 10:12:35,153 - INFO - No value detected on sheet: Case 12
2019-08-06 10:12:36,191 - INFO - No value detected on sheet: Case 13
2019-08-06 10:12:37,276 - INFO - No value detected on sheet: Case 14
2019-08-06 10:12:38,351 - INFO - No value detected on sheet: Case 15
2019-08-06 14:00:02,842 - INFO - Report date: 20190806 14.00
2019-08-06 14:00:09,441 - INFO - Download sheet..
2019-08-06 14:00:09,443 - INFO - Change directory to script path
2019-08-06 14:00:11,035 - INFO - Spreadsheet downloaded
2019-08-06 14:00:11,036 - INFO - Checking sheet..
2019-08-06 14:00:12,937 - INFO - Value detected - use sheet: Case 1
2019-08-06 14:00:12,938 - INFO - Reading Data From Google Sheet...
2019-08-06 14:00:13,640 - INFO - Get custom SQL..
2019-08-06 14:00:13,641 - INFO - USING CASE 1
2019-08-06 14:00:16,089 - INFO - Row 1
2019-08-06 14:00:16,091 - INFO - Filename: A30 Sports & Outdoor Buyers
2019-08-06 14:00:16,092 - INFO - Category: 'Sports & Outdoor'
2019-08-06 14:00:16,092 - INFO - Last Login: 30
2019-08-06 14:00:16,092 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-06 14:00:16,092 - INFO - Start Running query A30 Sports & Outdoor Buyers
2019-08-06 14:02:58,240 - INFO - Running A30 Sports & Outdoor Buyers Done
2019-08-06 14:02:58,240 - INFO - CSV file path: A30 Sports & Outdoor Buyers
2019-08-06 14:02:58,345 - INFO - Starting save the query results
2019-08-06 14:02:58,346 - INFO - Total Rows : 2634548
2019-08-06 14:02:58,348 - INFO - Will split into : 3.0 files
2019-08-06 14:03:02,407 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 14.00/A30 Sports & Outdoor Buyers_1.csv
2019-08-06 14:03:02,407 - INFO - , with total : 878183 rows
2019-08-06 14:03:06,799 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 14.00/A30 Sports & Outdoor Buyers_2.csv
2019-08-06 14:03:06,799 - INFO - , with total : 878183 rows
2019-08-06 14:03:11,318 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 14.00/A30 Sports & Outdoor Buyers_3.csv
2019-08-06 14:03:11,318 - INFO - , with total : 878182 rows
2019-08-06 14:03:12,707 - INFO - Delete all data in sheet: Case 1
2019-08-06 14:03:15,223 - INFO - No value detected on sheet: Case 2
2019-08-06 14:03:16,598 - INFO - No value detected on sheet: Case 3
2019-08-06 14:03:17,721 - INFO - No value detected on sheet: Case 4
2019-08-06 14:03:19,118 - INFO - No value detected on sheet: Case 5
2019-08-06 14:03:20,469 - INFO - Value detected - use sheet: Case 6
2019-08-06 14:03:20,470 - INFO - Reading Data From Google Sheet...
2019-08-06 14:03:21,315 - INFO - Get custom SQL..
2019-08-06 14:03:21,316 - INFO - USING CASE 6
2019-08-06 14:03:23,470 - INFO - Row 1
2019-08-06 14:03:23,470 - INFO - Filename: A30 MA Buyers (Charger & Headset)
2019-08-06 14:03:23,471 - INFO - Sub-category: 'Bluetooth & Headset','Cable & Charger'
2019-08-06 14:03:23,471 - INFO - Last Login: 30
2019-08-06 14:03:23,473 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bluetooth & Headset','Cable & Charger')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-06 14:03:23,473 - INFO - Start Running query A30 MA Buyers (Charger & Headset)
2019-08-06 14:05:05,467 - INFO - Running A30 MA Buyers (Charger & Headset) Done
2019-08-06 14:05:05,469 - INFO - CSV file path: A30 MA Buyers (Charger & Headset)
2019-08-06 14:05:05,575 - INFO - Starting save the query results
2019-08-06 14:05:05,575 - INFO - Total Rows : 2693750
2019-08-06 14:05:05,576 - INFO - Will split into : 3.0 files
2019-08-06 14:05:09,780 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 14.00/A30 MA Buyers (Charger & Headset)_1.csv
2019-08-06 14:05:09,782 - INFO - , with total : 897917 rows
2019-08-06 14:05:14,815 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 14.00/A30 MA Buyers (Charger & Headset)_2.csv
2019-08-06 14:05:14,815 - INFO - , with total : 897917 rows
2019-08-06 14:05:19,408 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 14.00/A30 MA Buyers (Charger & Headset)_3.csv
2019-08-06 14:05:19,410 - INFO - , with total : 897916 rows
2019-08-06 14:05:20,769 - INFO - Delete all data in sheet: Case 6
2019-08-06 14:05:22,786 - INFO - No value detected on sheet: Case 7
2019-08-06 14:05:24,282 - INFO - No value detected on sheet: Case 8
2019-08-06 14:05:25,420 - INFO - No value detected on sheet: Case 9
2019-08-06 14:05:27,161 - INFO - No value detected on sheet: Case 10
2019-08-06 14:05:28,230 - INFO - No value detected on sheet: Case 11
2019-08-06 14:05:29,589 - INFO - No value detected on sheet: Case 12
2019-08-06 14:05:30,937 - INFO - No value detected on sheet: Case 13
2019-08-06 14:05:32,338 - INFO - No value detected on sheet: Case 14
2019-08-06 14:05:33,848 - INFO - No value detected on sheet: Case 15
2019-08-06 17:00:02,505 - INFO - Report date: 20190806 17.00
2019-08-06 17:00:06,026 - INFO - Download sheet..
2019-08-06 17:00:06,026 - INFO - Change directory to script path
2019-08-06 17:00:07,605 - INFO - Spreadsheet downloaded
2019-08-06 17:00:07,607 - INFO - Checking sheet..
2019-08-06 17:00:09,411 - INFO - Value detected - use sheet: Case 1
2019-08-06 17:00:09,411 - INFO - Reading Data From Google Sheet...
2019-08-06 17:00:10,085 - INFO - Get custom SQL..
2019-08-06 17:00:10,085 - INFO - USING CASE 1
2019-08-06 17:00:12,184 - INFO - Row 1
2019-08-06 17:00:12,186 - INFO - Filename: A30 MA Buyers
2019-08-06 17:00:12,186 - INFO - Category: 'Mobile & Accessories'
2019-08-06 17:00:12,187 - INFO - Last Login: 
2019-08-06 17:00:12,187 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories')
                                    and
                                    last_login >= current_date - interval '' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-06 17:00:12,187 - INFO - Start Running query A30 MA Buyers
2019-08-06 17:00:24,119 - INFO - Running A30 MA Buyers Done
2019-08-06 17:00:24,119 - INFO - CSV file path: A30 MA Buyers
2019-08-06 17:00:24,132 - INFO - Starting save the query results
2019-08-06 17:00:24,132 - INFO - Total Rows : 242892
2019-08-06 17:00:24,134 - INFO - Will split into : 1.0 files
2019-08-06 17:00:25,299 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190806 17.00/A30 MA Buyers_1.csv
2019-08-06 17:00:25,301 - INFO - , with total : 242892 rows
2019-08-06 17:00:26,131 - INFO - Delete all data in sheet: Case 1
2019-08-06 17:00:28,447 - INFO - No value detected on sheet: Case 2
2019-08-06 17:00:29,867 - INFO - No value detected on sheet: Case 3
2019-08-06 17:00:31,450 - INFO - No value detected on sheet: Case 4
2019-08-06 17:00:32,825 - INFO - No value detected on sheet: Case 5
2019-08-06 17:00:34,395 - INFO - No value detected on sheet: Case 6
2019-08-06 17:00:35,888 - INFO - No value detected on sheet: Case 7
2019-08-06 17:00:37,463 - INFO - No value detected on sheet: Case 8
2019-08-06 17:00:38,911 - INFO - No value detected on sheet: Case 9
2019-08-06 17:00:40,253 - INFO - No value detected on sheet: Case 10
2019-08-06 17:00:41,595 - INFO - No value detected on sheet: Case 11
2019-08-06 17:00:42,973 - INFO - No value detected on sheet: Case 12
2019-08-06 17:00:44,058 - INFO - No value detected on sheet: Case 13
2019-08-06 17:00:44,882 - INFO - No value detected on sheet: Case 14
2019-08-06 17:00:46,326 - INFO - No value detected on sheet: Case 15
2019-08-07 10:00:13,808 - INFO - Report date: 20190807 10.00
2019-08-07 10:00:17,456 - INFO - Download sheet..
2019-08-07 10:00:17,456 - INFO - Change directory to script path
2019-08-07 10:00:18,809 - INFO - Spreadsheet downloaded
2019-08-07 10:00:18,811 - INFO - Checking sheet..
2019-08-07 10:00:20,575 - INFO - No value detected on sheet: Case 1
2019-08-07 10:00:21,915 - INFO - No value detected on sheet: Case 2
2019-08-07 10:00:23,279 - INFO - No value detected on sheet: Case 3
2019-08-07 10:00:24,598 - INFO - No value detected on sheet: Case 4
2019-08-07 10:00:25,930 - INFO - Value detected - use sheet: Case 5
2019-08-07 10:00:25,931 - INFO - Reading Data From Google Sheet...
2019-08-07 10:00:26,592 - INFO - Get custom SQL..
2019-08-07 10:00:26,592 - INFO - USING CASE 5
2019-08-07 10:00:29,296 - INFO - Row 1
2019-08-07 10:00:29,296 - INFO - Filename: A30 Male Auto & Fashion Buyers
2019-08-07 10:00:29,298 - INFO - Category: 'Fashion','Automotive'
2019-08-07 10:00:29,302 - INFO - Last Login: 30
2019-08-07 10:00:29,302 - INFO - Gender: 1,3
2019-08-07 10:00:29,302 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Automotive')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-07 10:00:29,305 - INFO - Start Running query A30 Male Auto & Fashion Buyers
2019-08-07 10:01:44,052 - INFO - Running A30 Male Auto & Fashion Buyers Done
2019-08-07 10:01:44,053 - INFO - CSV file path: A30 Male Auto & Fashion Buyers
2019-08-07 10:01:44,105 - INFO - Starting save the query results
2019-08-07 10:01:44,108 - INFO - Total Rows : 1350131
2019-08-07 10:01:44,108 - INFO - Will split into : 2.0 files
2019-08-07 10:01:47,206 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 Male Auto & Fashion Buyers_1.csv
2019-08-07 10:01:47,207 - INFO - , with total : 675066 rows
2019-08-07 10:01:50,687 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 Male Auto & Fashion Buyers_2.csv
2019-08-07 10:01:50,687 - INFO - , with total : 675065 rows
2019-08-07 10:01:51,881 - INFO - Delete all data in sheet: Case 5
2019-08-07 10:01:53,553 - INFO - Value detected - use sheet: Case 6
2019-08-07 10:01:53,553 - INFO - Reading Data From Google Sheet...
2019-08-07 10:01:54,226 - INFO - Get custom SQL..
2019-08-07 10:01:54,226 - INFO - USING CASE 6
2019-08-07 10:01:55,756 - INFO - Row 1
2019-08-07 10:01:55,756 - INFO - Filename: A30 MA Buyers ComicCon
2019-08-07 10:01:55,756 - INFO - Sub-category: 'Bluetooth & Headset','Cable & Charger','Casing & Covers','Handphone Docking','Handphone Keychain','Memory Card','Mobile & Tablet','Mobile Lens','Others','Powerbank & Batteries','Screen Protectors','Simcard','Smartwatch','Spare Parts'
2019-08-07 10:01:55,757 - INFO - Last Login: 30
2019-08-07 10:01:55,757 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bluetooth & Headset','Cable & Charger','Casing & Covers','Handphone Docking','Handphone Keychain','Memory Card','Mobile & Tablet','Mobile Lens','Others','Powerbank & Batteries','Screen Protectors','Simcard','Smartwatch','Spare Parts')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-07 10:01:55,757 - INFO - Start Running query A30 MA Buyers ComicCon
2019-08-07 10:06:08,608 - INFO - Running A30 MA Buyers ComicCon Done
2019-08-07 10:06:08,609 - INFO - CSV file path: A30 MA Buyers ComicCon
2019-08-07 10:06:08,980 - INFO - Starting save the query results
2019-08-07 10:06:08,980 - INFO - Total Rows : 9093834
2019-08-07 10:06:08,980 - INFO - Will split into : 10.0 files
2019-08-07 10:06:13,180 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 MA Buyers ComicCon_1.csv
2019-08-07 10:06:13,181 - INFO - , with total : 909384 rows
2019-08-07 10:06:17,868 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 MA Buyers ComicCon_2.csv
2019-08-07 10:06:17,869 - INFO - , with total : 909384 rows
2019-08-07 10:06:23,029 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 MA Buyers ComicCon_3.csv
2019-08-07 10:06:23,030 - INFO - , with total : 909384 rows
2019-08-07 10:06:27,905 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 MA Buyers ComicCon_4.csv
2019-08-07 10:06:27,907 - INFO - , with total : 909384 rows
2019-08-07 10:06:32,727 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 MA Buyers ComicCon_5.csv
2019-08-07 10:06:32,730 - INFO - , with total : 909383 rows
2019-08-07 10:06:37,430 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 MA Buyers ComicCon_6.csv
2019-08-07 10:06:37,431 - INFO - , with total : 909383 rows
2019-08-07 10:06:42,148 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 MA Buyers ComicCon_7.csv
2019-08-07 10:06:42,148 - INFO - , with total : 909383 rows
2019-08-07 10:06:47,092 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 MA Buyers ComicCon_8.csv
2019-08-07 10:06:47,092 - INFO - , with total : 909383 rows
2019-08-07 10:06:52,062 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 MA Buyers ComicCon_9.csv
2019-08-07 10:06:52,062 - INFO - , with total : 909383 rows
2019-08-07 10:06:56,714 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 10.00/A30 MA Buyers ComicCon_10.csv
2019-08-07 10:06:56,716 - INFO - , with total : 909383 rows
2019-08-07 10:06:58,451 - INFO - Delete all data in sheet: Case 6
2019-08-07 10:07:00,575 - INFO - No value detected on sheet: Case 7
2019-08-07 10:07:01,907 - INFO - No value detected on sheet: Case 8
2019-08-07 10:07:03,260 - INFO - No value detected on sheet: Case 9
2019-08-07 10:07:04,599 - INFO - No value detected on sheet: Case 10
2019-08-07 10:07:05,973 - INFO - No value detected on sheet: Case 11
2019-08-07 10:07:07,342 - INFO - No value detected on sheet: Case 12
2019-08-07 10:07:08,694 - INFO - No value detected on sheet: Case 13
2019-08-07 10:07:10,082 - INFO - No value detected on sheet: Case 14
2019-08-07 10:07:11,622 - INFO - No value detected on sheet: Case 15
2019-08-07 14:00:06,736 - INFO - Report date: 20190807 14.00
2019-08-07 14:00:10,242 - INFO - Download sheet..
2019-08-07 14:00:10,243 - INFO - Change directory to script path
2019-08-07 14:00:11,994 - INFO - Spreadsheet downloaded
2019-08-07 14:00:11,996 - INFO - Checking sheet..
2019-08-07 14:00:13,871 - INFO - No value detected on sheet: Case 1
2019-08-07 14:00:15,474 - INFO - No value detected on sheet: Case 2
2019-08-07 14:00:17,086 - INFO - No value detected on sheet: Case 3
2019-08-07 14:00:18,421 - INFO - No value detected on sheet: Case 4
2019-08-07 14:00:19,789 - INFO - No value detected on sheet: Case 5
2019-08-07 14:00:21,289 - INFO - No value detected on sheet: Case 6
2019-08-07 14:00:22,628 - INFO - No value detected on sheet: Case 7
2019-08-07 14:00:23,997 - INFO - No value detected on sheet: Case 8
2019-08-07 14:00:25,355 - INFO - No value detected on sheet: Case 9
2019-08-07 14:00:26,690 - INFO - No value detected on sheet: Case 10
2019-08-07 14:00:28,029 - INFO - No value detected on sheet: Case 11
2019-08-07 14:00:29,355 - INFO - No value detected on sheet: Case 12
2019-08-07 14:00:30,760 - INFO - No value detected on sheet: Case 13
2019-08-07 14:00:31,342 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-07 14:00:31,684 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-07 17:00:02,325 - INFO - Report date: 20190807 17.00
2019-08-07 17:00:06,131 - INFO - Download sheet..
2019-08-07 17:00:06,131 - INFO - Change directory to script path
2019-08-07 17:00:08,421 - INFO - Spreadsheet downloaded
2019-08-07 17:00:08,424 - INFO - Checking sheet..
2019-08-07 17:00:10,243 - INFO - Value detected - use sheet: Case 1
2019-08-07 17:00:10,244 - INFO - Reading Data From Google Sheet...
2019-08-07 17:00:10,960 - INFO - Get custom SQL..
2019-08-07 17:00:10,960 - INFO - USING CASE 1
2019-08-07 17:00:13,125 - INFO - Row 1
2019-08-07 17:00:13,125 - INFO - Filename: A30 MA Buyers
2019-08-07 17:00:13,127 - INFO - Category: 'Mobile & Accessories','Photography'
2019-08-07 17:00:13,127 - INFO - Last Login: 30
2019-08-07 17:00:13,127 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-07 17:00:13,128 - INFO - Start Running query A30 MA Buyers
2019-08-07 17:03:16,484 - INFO - Running A30 MA Buyers Done
2019-08-07 17:03:16,486 - INFO - CSV file path: A30 MA Buyers
2019-08-07 17:03:16,773 - INFO - Starting save the query results
2019-08-07 17:03:16,773 - INFO - Total Rows : 7559992
2019-08-07 17:03:16,775 - INFO - Will split into : 8.0 files
2019-08-07 17:03:21,073 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 MA Buyers_1.csv
2019-08-07 17:03:21,075 - INFO - , with total : 944999 rows
2019-08-07 17:03:25,743 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 MA Buyers_2.csv
2019-08-07 17:03:25,743 - INFO - , with total : 944999 rows
2019-08-07 17:03:30,605 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 MA Buyers_3.csv
2019-08-07 17:03:30,607 - INFO - , with total : 944999 rows
2019-08-07 17:03:35,410 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 MA Buyers_4.csv
2019-08-07 17:03:35,411 - INFO - , with total : 944999 rows
2019-08-07 17:03:40,246 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 MA Buyers_5.csv
2019-08-07 17:03:40,247 - INFO - , with total : 944999 rows
2019-08-07 17:03:45,539 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 MA Buyers_6.csv
2019-08-07 17:03:45,540 - INFO - , with total : 944999 rows
2019-08-07 17:03:50,342 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 MA Buyers_7.csv
2019-08-07 17:03:50,342 - INFO - , with total : 944999 rows
2019-08-07 17:03:55,134 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 MA Buyers_8.csv
2019-08-07 17:03:55,135 - INFO - , with total : 944999 rows
2019-08-07 17:03:58,933 - INFO - Row 2
2019-08-07 17:03:58,934 - INFO - Filename: A30 Lifestylye Buyers
2019-08-07 17:03:58,934 - INFO - Category: 'Sports & Outdoor'
2019-08-07 17:03:58,934 - INFO - Last Login: 30
2019-08-07 17:03:58,934 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-07 17:03:58,936 - INFO - Start Running query A30 Lifestylye Buyers
2019-08-07 17:05:15,630 - INFO - Running A30 Lifestylye Buyers Done
2019-08-07 17:05:15,631 - INFO - CSV file path: A30 Lifestylye Buyers
2019-08-07 17:05:15,727 - INFO - Starting save the query results
2019-08-07 17:05:15,729 - INFO - Total Rows : 2641005
2019-08-07 17:05:15,730 - INFO - Will split into : 3.0 files
2019-08-07 17:05:19,828 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Lifestylye Buyers_1.csv
2019-08-07 17:05:19,831 - INFO - , with total : 880335 rows
2019-08-07 17:05:24,290 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Lifestylye Buyers_2.csv
2019-08-07 17:05:24,292 - INFO - , with total : 880335 rows
2019-08-07 17:05:28,809 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Lifestylye Buyers_3.csv
2019-08-07 17:05:28,811 - INFO - , with total : 880335 rows
2019-08-07 17:05:30,206 - INFO - Delete all data in sheet: Case 1
2019-08-07 17:05:32,673 - INFO - No value detected on sheet: Case 2
2019-08-07 17:05:34,085 - INFO - No value detected on sheet: Case 3
2019-08-07 17:05:35,477 - INFO - No value detected on sheet: Case 4
2019-08-07 17:05:36,874 - INFO - Value detected - use sheet: Case 5
2019-08-07 17:05:36,875 - INFO - Reading Data From Google Sheet...
2019-08-07 17:05:37,563 - INFO - Get custom SQL..
2019-08-07 17:05:37,563 - INFO - USING CASE 5
2019-08-07 17:05:40,171 - INFO - Row 1
2019-08-07 17:05:40,171 - INFO - Filename: A30 Auto & Male Fashion Buyers (Flash Sale)
2019-08-07 17:05:40,171 - INFO - Category: 'Automotive','Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches'
2019-08-07 17:05:40,173 - INFO - Last Login: 30
2019-08-07 17:05:40,173 - INFO - Gender: 1,3
2019-08-07 17:05:40,173 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Automotive','Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-07 17:05:40,174 - INFO - Start Running query A30 Auto & Male Fashion Buyers (Flash Sale)
2019-08-07 17:07:07,976 - INFO - Running A30 Auto & Male Fashion Buyers (Flash Sale) Done
2019-08-07 17:07:07,977 - INFO - CSV file path: A30 Auto & Male Fashion Buyers (Flash Sale)
2019-08-07 17:07:08,102 - INFO - Starting save the query results
2019-08-07 17:07:08,104 - INFO - Total Rows : 3278133
2019-08-07 17:07:08,105 - INFO - Will split into : 4.0 files
2019-08-07 17:07:11,974 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Auto & Male Fashion Buyers (Flash Sale)_1.csv
2019-08-07 17:07:11,976 - INFO - , with total : 819534 rows
2019-08-07 17:07:16,608 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Auto & Male Fashion Buyers (Flash Sale)_2.csv
2019-08-07 17:07:16,609 - INFO - , with total : 819533 rows
2019-08-07 17:07:21,035 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Auto & Male Fashion Buyers (Flash Sale)_3.csv
2019-08-07 17:07:21,036 - INFO - , with total : 819533 rows
2019-08-07 17:07:25,253 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Auto & Male Fashion Buyers (Flash Sale)_4.csv
2019-08-07 17:07:25,255 - INFO - , with total : 819533 rows
2019-08-07 17:07:26,766 - INFO - Delete all data in sheet: Case 5
2019-08-07 17:07:28,691 - INFO - Value detected - use sheet: Case 6
2019-08-07 17:07:28,693 - INFO - Reading Data From Google Sheet...
2019-08-07 17:07:29,394 - INFO - Get custom SQL..
2019-08-07 17:07:29,395 - INFO - USING CASE 6
2019-08-07 17:07:31,256 - INFO - Row 1
2019-08-07 17:07:31,257 - INFO - Filename: A30 Video Games Buyers
2019-08-07 17:07:31,257 - INFO - Sub-category: 'Video Games','Gaming','Figure'
2019-08-07 17:07:31,259 - INFO - Last Login: 30
2019-08-07 17:07:31,259 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Video Games','Gaming','Figure')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-07 17:07:31,259 - INFO - Start Running query A30 Video Games Buyers
2019-08-07 17:08:02,334 - INFO - Running A30 Video Games Buyers Done
2019-08-07 17:08:02,335 - INFO - CSV file path: A30 Video Games Buyers
2019-08-07 17:08:02,371 - INFO - Starting save the query results
2019-08-07 17:08:02,372 - INFO - Total Rows : 969509
2019-08-07 17:08:02,374 - INFO - Will split into : 1.0 files
2019-08-07 17:08:06,842 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Video Games Buyers_1.csv
2019-08-07 17:08:06,842 - INFO - , with total : 969509 rows
2019-08-07 17:08:08,247 - INFO - Delete all data in sheet: Case 6
2019-08-07 17:08:09,908 - INFO - No value detected on sheet: Case 7
2019-08-07 17:08:11,089 - INFO - No value detected on sheet: Case 8
2019-08-07 17:08:12,492 - INFO - Value detected - use sheet: Case 9
2019-08-07 17:08:12,493 - INFO - Reading Data From Google Sheet...
2019-08-07 17:08:13,267 - INFO - Get custom SQL..
2019-08-07 17:08:13,269 - INFO - USING CASE 9
2019-08-07 17:08:14,706 - INFO - Row 1
2019-08-07 17:08:14,707 - INFO - Filename: A30 Digital Product buyers
2019-08-07 17:08:14,707 - INFO - Last Login: 30
2019-08-07 17:08:14,709 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-07 17:08:14,710 - INFO - Start Running query A30 Digital Product buyers
2019-08-07 17:09:14,292 - INFO - Running A30 Digital Product buyers Done
2019-08-07 17:09:14,293 - INFO - CSV file path: A30 Digital Product buyers
2019-08-07 17:09:14,394 - INFO - Starting save the query results
2019-08-07 17:09:14,395 - INFO - Total Rows : 2439651
2019-08-07 17:09:14,395 - INFO - Will split into : 3.0 files
2019-08-07 17:09:18,174 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Digital Product buyers_1.csv
2019-08-07 17:09:18,174 - INFO - , with total : 813217 rows
2019-08-07 17:09:22,842 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Digital Product buyers_2.csv
2019-08-07 17:09:22,844 - INFO - , with total : 813217 rows
2019-08-07 17:09:27,055 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/A30 Digital Product buyers_3.csv
2019-08-07 17:09:27,056 - INFO - , with total : 813217 rows
2019-08-07 17:09:28,019 - INFO - Delete all data in sheet: Case 9
2019-08-07 17:09:29,415 - INFO - No value detected on sheet: Case 10
2019-08-07 17:09:30,819 - INFO - Value detected - use sheet: Case 11
2019-08-07 17:09:30,819 - INFO - Reading Data From Google Sheet...
2019-08-07 17:09:31,253 - INFO - Get custom SQL..
2019-08-07 17:09:31,253 - INFO - USING CASE 11
2019-08-07 17:09:33,292 - INFO - Row 1
2019-08-07 17:09:33,292 - INFO - Filename: User that shopped Comic Con Tickets
2019-08-07 17:09:33,293 - INFO - Item ID: 2391297605,2391307616,2391315135,2457591454,2457602838
2019-08-07 17:09:33,295 - INFO - Date 1: 2019-07-05
2019-08-07 17:09:33,295 - INFO - Date 2: 2019-08-07
2019-08-07 17:09:33,295 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(p.userid as varchar)) as list_userid
                                from order_mart__order_item_profile as p
                                where itemid in (2391297605,2391307616,2391315135,2457591454,2457602838)
                                and grass_date between date'2019-07-05' and date'2019-08-07'
                                
2019-08-07 17:09:33,296 - INFO - Start Running query User that shopped Comic Con Tickets
2019-08-07 17:09:35,329 - INFO - Running User that shopped Comic Con Tickets Done
2019-08-07 17:09:35,331 - INFO - CSV file path: User that shopped Comic Con Tickets
2019-08-07 17:09:35,332 - INFO - Starting save the query results
2019-08-07 17:09:35,332 - INFO - Total Rows : 450
2019-08-07 17:09:35,334 - INFO - Will split into : 1.0 files
2019-08-07 17:09:35,361 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190807 17.00/User that shopped Comic Con Tickets_1.csv
2019-08-07 17:09:35,362 - INFO - , with total : 450 rows
2019-08-07 17:09:36,088 - INFO - Delete all data in sheet: Case 11
2019-08-07 17:09:38,299 - INFO - No value detected on sheet: Case 12
2019-08-07 17:09:39,444 - INFO - No value detected on sheet: Case 13
2019-08-07 17:09:40,677 - INFO - No value detected on sheet: Case 14
2019-08-07 17:09:42,085 - INFO - No value detected on sheet: Case 15
2019-08-08 10:00:13,963 - INFO - Report date: 20190808 10.00
2019-08-08 10:00:18,836 - INFO - Download sheet..
2019-08-08 10:00:18,836 - INFO - Change directory to script path
2019-08-08 10:00:19,992 - INFO - Spreadsheet downloaded
2019-08-08 10:00:19,993 - INFO - Checking sheet..
2019-08-08 10:00:21,908 - INFO - No value detected on sheet: Case 1
2019-08-08 10:00:23,506 - INFO - No value detected on sheet: Case 2
2019-08-08 10:00:24,982 - INFO - No value detected on sheet: Case 3
2019-08-08 10:00:26,463 - INFO - No value detected on sheet: Case 4
2019-08-08 10:00:27,941 - INFO - No value detected on sheet: Case 5
2019-08-08 10:00:29,431 - INFO - No value detected on sheet: Case 6
2019-08-08 10:00:30,924 - INFO - No value detected on sheet: Case 7
2019-08-08 10:00:32,381 - INFO - No value detected on sheet: Case 8
2019-08-08 10:00:33,838 - INFO - No value detected on sheet: Case 9
2019-08-08 10:00:35,315 - INFO - No value detected on sheet: Case 10
2019-08-08 10:00:36,786 - INFO - No value detected on sheet: Case 11
2019-08-08 10:00:38,246 - INFO - No value detected on sheet: Case 12
2019-08-08 10:00:39,861 - INFO - No value detected on sheet: Case 13
2019-08-08 10:00:41,348 - INFO - No value detected on sheet: Case 14
2019-08-08 10:00:42,818 - INFO - No value detected on sheet: Case 15
2019-08-08 14:00:07,915 - INFO - Report date: 20190808 14.00
2019-08-08 14:00:11,677 - INFO - Download sheet..
2019-08-08 14:00:11,677 - INFO - Change directory to script path
2019-08-08 14:00:12,819 - INFO - Spreadsheet downloaded
2019-08-08 14:00:12,819 - INFO - Checking sheet..
2019-08-08 14:00:14,752 - INFO - Value detected - use sheet: Case 1
2019-08-08 14:00:14,753 - INFO - Reading Data From Google Sheet...
2019-08-08 14:00:15,493 - INFO - Get custom SQL..
2019-08-08 14:00:15,493 - INFO - USING CASE 1
2019-08-08 14:00:17,848 - INFO - Row 1
2019-08-08 14:00:17,848 - INFO - Filename: A30 Beauty, Fashion, Hobby Buyers
2019-08-08 14:00:17,849 - INFO - Category: 'Beauty','Fashion','Hobby & Collection'
2019-08-08 14:00:17,851 - INFO - Last Login: 30
2019-08-08 14:00:17,851 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty','Fashion','Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-08 14:00:17,851 - INFO - Start Running query A30 Beauty, Fashion, Hobby Buyers
2019-08-08 14:04:48,075 - INFO - Running A30 Beauty, Fashion, Hobby Buyers Done
2019-08-08 14:04:48,076 - INFO - CSV file path: A30 Beauty, Fashion, Hobby Buyers
2019-08-08 14:04:48,421 - INFO - Starting save the query results
2019-08-08 14:04:48,423 - INFO - Total Rows : 8038726
2019-08-08 14:04:48,424 - INFO - Will split into : 9.0 files
2019-08-08 14:04:52,418 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 Beauty, Fashion, Hobby Buyers_1.csv
2019-08-08 14:04:52,420 - INFO - , with total : 893192 rows
2019-08-08 14:04:56,970 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 Beauty, Fashion, Hobby Buyers_2.csv
2019-08-08 14:04:56,971 - INFO - , with total : 893192 rows
2019-08-08 14:05:01,828 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 Beauty, Fashion, Hobby Buyers_3.csv
2019-08-08 14:05:01,829 - INFO - , with total : 893192 rows
2019-08-08 14:05:06,377 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 Beauty, Fashion, Hobby Buyers_4.csv
2019-08-08 14:05:06,378 - INFO - , with total : 893192 rows
2019-08-08 14:05:11,246 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 Beauty, Fashion, Hobby Buyers_5.csv
2019-08-08 14:05:11,249 - INFO - , with total : 893192 rows
2019-08-08 14:05:16,621 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 Beauty, Fashion, Hobby Buyers_6.csv
2019-08-08 14:05:16,622 - INFO - , with total : 893192 rows
2019-08-08 14:05:21,119 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 Beauty, Fashion, Hobby Buyers_7.csv
2019-08-08 14:05:21,121 - INFO - , with total : 893192 rows
2019-08-08 14:05:25,844 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 Beauty, Fashion, Hobby Buyers_8.csv
2019-08-08 14:05:25,844 - INFO - , with total : 893191 rows
2019-08-08 14:05:30,867 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 Beauty, Fashion, Hobby Buyers_9.csv
2019-08-08 14:05:30,868 - INFO - , with total : 893191 rows
2019-08-08 14:05:32,903 - INFO - Delete all data in sheet: Case 1
2019-08-08 14:05:35,221 - INFO - No value detected on sheet: Case 2
2019-08-08 14:05:36,714 - INFO - No value detected on sheet: Case 3
2019-08-08 14:05:38,257 - INFO - No value detected on sheet: Case 4
2019-08-08 14:05:39,744 - INFO - No value detected on sheet: Case 5
2019-08-08 14:05:41,306 - INFO - Value detected - use sheet: Case 6
2019-08-08 14:05:41,308 - INFO - Reading Data From Google Sheet...
2019-08-08 14:05:42,062 - INFO - Get custom SQL..
2019-08-08 14:05:42,062 - INFO - USING CASE 6
2019-08-08 14:05:44,401 - INFO - Row 1
2019-08-08 14:05:44,403 - INFO - Filename: A30 HL Buyers
2019-08-08 14:05:44,403 - INFO - Sub-category: 'Bathroom','Bedroom','Decoration','Dining Room','Equipments','Furniture','Gardening','Home Care','Home Care Tools','Kitchen & Cookware','Others','Party Supplies','Storage'
2019-08-08 14:05:44,404 - INFO - Last Login: 30
2019-08-08 14:05:44,404 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bathroom','Bedroom','Decoration','Dining Room','Equipments','Furniture','Gardening','Home Care','Home Care Tools','Kitchen & Cookware','Others','Party Supplies','Storage')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-08 14:05:44,404 - INFO - Start Running query A30 HL Buyers
2019-08-08 14:10:30,401 - INFO - Running A30 HL Buyers Done
2019-08-08 14:10:30,403 - INFO - CSV file path: A30 HL Buyers
2019-08-08 14:10:30,753 - INFO - Starting save the query results
2019-08-08 14:10:30,755 - INFO - Total Rows : 8392693
2019-08-08 14:10:30,756 - INFO - Will split into : 9.0 files
2019-08-08 14:10:35,190 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 HL Buyers_1.csv
2019-08-08 14:10:35,190 - INFO - , with total : 932522 rows
2019-08-08 14:10:40,311 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 HL Buyers_2.csv
2019-08-08 14:10:40,312 - INFO - , with total : 932522 rows
2019-08-08 14:10:45,684 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 HL Buyers_3.csv
2019-08-08 14:10:45,684 - INFO - , with total : 932522 rows
2019-08-08 14:10:50,815 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 HL Buyers_4.csv
2019-08-08 14:10:50,815 - INFO - , with total : 932522 rows
2019-08-08 14:10:58,042 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 HL Buyers_5.csv
2019-08-08 14:10:58,042 - INFO - , with total : 932521 rows
2019-08-08 14:11:03,671 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 HL Buyers_6.csv
2019-08-08 14:11:03,671 - INFO - , with total : 932521 rows
2019-08-08 14:11:08,947 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 HL Buyers_7.csv
2019-08-08 14:11:08,948 - INFO - , with total : 932521 rows
2019-08-08 14:11:14,201 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 HL Buyers_8.csv
2019-08-08 14:11:14,203 - INFO - , with total : 932521 rows
2019-08-08 14:11:19,211 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/A30 HL Buyers_9.csv
2019-08-08 14:11:19,213 - INFO - , with total : 932521 rows
2019-08-08 14:11:21,102 - INFO - Delete all data in sheet: Case 6
2019-08-08 14:11:23,448 - INFO - No value detected on sheet: Case 7
2019-08-08 14:11:25,053 - INFO - Value detected - use sheet: Case 8
2019-08-08 14:11:25,055 - INFO - Reading Data From Google Sheet...
2019-08-08 14:11:25,783 - INFO - Get custom SQL..
2019-08-08 14:11:25,786 - INFO - USING CASE 8
2019-08-08 14:11:27,299 - INFO - Row 1
2019-08-08 14:11:27,299 - INFO - Filename: Samsung Official Shop Followers
2019-08-08 14:11:27,301 - INFO - Shop ID: 52635036
2019-08-08 14:11:27,301 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (52635036) 
                                and status = 1
                                
2019-08-08 14:11:27,302 - INFO - Start Running query Samsung Official Shop Followers
2019-08-08 14:11:48,391 - INFO - Running Samsung Official Shop Followers Done
2019-08-08 14:11:48,391 - INFO - CSV file path: Samsung Official Shop Followers
2019-08-08 14:11:48,403 - INFO - Starting save the query results
2019-08-08 14:11:48,404 - INFO - Total Rows : 302429
2019-08-08 14:11:48,404 - INFO - Will split into : 1.0 files
2019-08-08 14:11:49,888 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/Samsung Official Shop Followers_1.csv
2019-08-08 14:11:49,890 - INFO - , with total : 302429 rows
2019-08-08 14:11:52,342 - INFO - Row 2
2019-08-08 14:11:52,342 - INFO - Filename: Huawei Official Shop Followers
2019-08-08 14:11:52,344 - INFO - Shop ID: 39372120
2019-08-08 14:11:52,344 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (39372120) 
                                and status = 1
                                
2019-08-08 14:11:52,345 - INFO - Start Running query Huawei Official Shop Followers
2019-08-08 14:12:17,454 - INFO - Running Huawei Official Shop Followers Done
2019-08-08 14:12:17,454 - INFO - CSV file path: Huawei Official Shop Followers
2019-08-08 14:12:17,454 - INFO - Starting save the query results
2019-08-08 14:12:17,454 - INFO - Total Rows : 25153
2019-08-08 14:12:17,454 - INFO - Will split into : 1.0 files
2019-08-08 14:12:17,599 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 14.00/Huawei Official Shop Followers_1.csv
2019-08-08 14:12:17,601 - INFO - , with total : 25153 rows
2019-08-08 14:12:18,530 - INFO - Delete all data in sheet: Case 8
2019-08-08 14:12:20,542 - INFO - No value detected on sheet: Case 9
2019-08-08 14:12:22,006 - INFO - No value detected on sheet: Case 10
2019-08-08 14:12:23,148 - INFO - No value detected on sheet: Case 11
2019-08-08 14:12:24,282 - INFO - No value detected on sheet: Case 12
2019-08-08 14:12:25,410 - INFO - No value detected on sheet: Case 13
2019-08-08 14:12:26,898 - INFO - No value detected on sheet: Case 14
2019-08-08 14:12:28,375 - INFO - No value detected on sheet: Case 15
2019-08-08 17:00:05,655 - INFO - Report date: 20190808 17.00
2019-08-08 17:00:09,874 - INFO - Download sheet..
2019-08-08 17:00:09,874 - INFO - Change directory to script path
2019-08-08 17:00:11,109 - INFO - Spreadsheet downloaded
2019-08-08 17:00:11,109 - INFO - Checking sheet..
2019-08-08 17:00:13,069 - INFO - No value detected on sheet: Case 1
2019-08-08 17:00:14,937 - INFO - No value detected on sheet: Case 2
2019-08-08 17:00:16,453 - INFO - No value detected on sheet: Case 3
2019-08-08 17:00:17,951 - INFO - No value detected on sheet: Case 4
2019-08-08 17:00:19,441 - INFO - Value detected - use sheet: Case 5
2019-08-08 17:00:19,441 - INFO - Reading Data From Google Sheet...
2019-08-08 17:00:20,184 - INFO - Get custom SQL..
2019-08-08 17:00:20,184 - INFO - USING CASE 5
2019-08-08 17:00:26,207 - INFO - Row 1
2019-08-08 17:00:26,207 - INFO - Filename: Female users bought Hobby & Collection
2019-08-08 17:00:26,209 - INFO - Category: 'Hobby & Collection'
2019-08-08 17:00:26,209 - INFO - Last Login: 30
2019-08-08 17:00:26,209 - INFO - Gender: 2,4
2019-08-08 17:00:26,209 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-08 17:00:26,210 - INFO - Start Running query Female users bought Hobby & Collection
2019-08-08 17:01:12,569 - INFO - Running Female users bought Hobby & Collection Done
2019-08-08 17:01:12,569 - INFO - CSV file path: Female users bought Hobby & Collection
2019-08-08 17:01:12,631 - INFO - Starting save the query results
2019-08-08 17:01:12,631 - INFO - Total Rows : 1541692
2019-08-08 17:01:12,631 - INFO - Will split into : 2.0 files
2019-08-08 17:01:15,953 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/Female users bought Hobby & Collection_1.csv
2019-08-08 17:01:15,953 - INFO - , with total : 770846 rows
2019-08-08 17:01:19,680 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/Female users bought Hobby & Collection_2.csv
2019-08-08 17:01:19,680 - INFO - , with total : 770846 rows
2019-08-08 17:01:21,036 - INFO - Delete all data in sheet: Case 5
2019-08-08 17:01:22,444 - INFO - Value detected - use sheet: Case 6
2019-08-08 17:01:22,444 - INFO - Reading Data From Google Sheet...
2019-08-08 17:01:22,842 - INFO - Get custom SQL..
2019-08-08 17:01:22,842 - INFO - USING CASE 6
2019-08-08 17:01:24,752 - INFO - Row 1
2019-08-08 17:01:24,753 - INFO - Filename: A14 Beauty Buyers (Everwhite)
2019-08-08 17:01:24,753 - INFO - Sub-category: 'Beauty Package','Beauty Tools','Body Care','Eye Cosmetics','Face Cosmetics','Facial Care','Lips Cosmetics','Nail Care','Others Beauty','Skin Care'
2019-08-08 17:01:24,753 - INFO - Last Login: 14
2019-08-08 17:01:24,753 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Beauty Package','Beauty Tools','Body Care','Eye Cosmetics','Face Cosmetics','Facial Care','Lips Cosmetics','Nail Care','Others Beauty','Skin Care')
                                    and
                                    last_login >= current_date - interval '14' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-08 17:01:24,755 - INFO - Start Running query A14 Beauty Buyers (Everwhite)
2019-08-08 17:04:18,823 - INFO - Running A14 Beauty Buyers (Everwhite) Done
2019-08-08 17:04:18,825 - INFO - CSV file path: A14 Beauty Buyers (Everwhite)
2019-08-08 17:04:19,068 - INFO - Starting save the query results
2019-08-08 17:04:19,069 - INFO - Total Rows : 6462442
2019-08-08 17:04:19,069 - INFO - Will split into : 7.0 files
2019-08-08 17:04:23,085 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 Beauty Buyers (Everwhite)_1.csv
2019-08-08 17:04:23,085 - INFO - , with total : 923206 rows
2019-08-08 17:04:27,450 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 Beauty Buyers (Everwhite)_2.csv
2019-08-08 17:04:27,450 - INFO - , with total : 923206 rows
2019-08-08 17:04:32,076 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 Beauty Buyers (Everwhite)_3.csv
2019-08-08 17:04:32,078 - INFO - , with total : 923206 rows
2019-08-08 17:04:36,750 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 Beauty Buyers (Everwhite)_4.csv
2019-08-08 17:04:36,752 - INFO - , with total : 923206 rows
2019-08-08 17:04:41,454 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 Beauty Buyers (Everwhite)_5.csv
2019-08-08 17:04:41,456 - INFO - , with total : 923206 rows
2019-08-08 17:04:46,061 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 Beauty Buyers (Everwhite)_6.csv
2019-08-08 17:04:46,062 - INFO - , with total : 923206 rows
2019-08-08 17:04:50,700 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 Beauty Buyers (Everwhite)_7.csv
2019-08-08 17:04:50,701 - INFO - , with total : 923206 rows
2019-08-08 17:04:52,693 - INFO - Delete all data in sheet: Case 6
2019-08-08 17:04:54,711 - INFO - No value detected on sheet: Case 7
2019-08-08 17:04:56,434 - INFO - No value detected on sheet: Case 8
2019-08-08 17:04:57,836 - INFO - Value detected - use sheet: Case 9
2019-08-08 17:04:57,838 - INFO - Reading Data From Google Sheet...
2019-08-08 17:04:58,582 - INFO - Get custom SQL..
2019-08-08 17:04:58,585 - INFO - USING CASE 9
2019-08-08 17:04:59,737 - INFO - Row 1
2019-08-08 17:04:59,739 - INFO - Filename: A14 DP buyers
2019-08-08 17:04:59,739 - INFO - Last Login: 14
2019-08-08 17:04:59,740 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '14' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-08 17:04:59,740 - INFO - Start Running query A14 DP buyers
2019-08-08 17:06:14,075 - INFO - Running A14 DP buyers Done
2019-08-08 17:06:14,075 - INFO - CSV file path: A14 DP buyers
2019-08-08 17:06:14,154 - INFO - Starting save the query results
2019-08-08 17:06:14,154 - INFO - Total Rows : 2215443
2019-08-08 17:06:14,154 - INFO - Will split into : 3.0 files
2019-08-08 17:06:17,368 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 DP buyers_1.csv
2019-08-08 17:06:17,369 - INFO - , with total : 738481 rows
2019-08-08 17:06:20,915 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 DP buyers_2.csv
2019-08-08 17:06:20,915 - INFO - , with total : 738481 rows
2019-08-08 17:06:24,532 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 DP buyers_3.csv
2019-08-08 17:06:24,532 - INFO - , with total : 738481 rows
2019-08-08 17:06:28,325 - INFO - Delete all data in sheet: Case 9
2019-08-08 17:06:30,112 - INFO - Value detected - use sheet: Case 10
2019-08-08 17:06:30,114 - INFO - Reading Data From Google Sheet...
2019-08-08 17:06:30,509 - INFO - Get custom SQL..
2019-08-08 17:06:30,510 - INFO - USING CASE 10
2019-08-08 17:06:32,463 - INFO - Row 1
2019-08-08 17:06:32,463 - INFO - Filename: A14 who haven't bought DP
2019-08-08 17:06:32,463 - INFO - Last Login: 14
2019-08-08 17:06:32,464 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Automotive','Baby & Kids Fashion','Beauty','Computer & Accessories','Cosmetics','Electronics','Fashion Accessories','Food & Beverages','Health','Health & Beauty','Hobby & Collection','Home & Living','Men','Bags','Men Clothes','Men Shoes','Mobile & Accessories','Mom & Baby','Muslim Fashion','Others','Photography','Souvenir & Party Supplies','Sports & Outdoor','Stationery & Books','Vouchers','Watches','Women Bags','Women ClothesWomen Shoes') 
                                    and
                                    last_login >= current_date - interval '14' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-08 17:06:32,464 - INFO - Start Running query A14 who haven't bought DP
2019-08-08 17:17:16,486 - INFO - Running A14 who haven't bought DP Done
2019-08-08 17:17:16,486 - INFO - CSV file path: A14 who haven't bought DP
2019-08-08 17:17:17,065 - INFO - Starting save the query results
2019-08-08 17:17:17,065 - INFO - Total Rows : 11414676
2019-08-08 17:17:17,065 - INFO - Will split into : 12.0 files
2019-08-08 17:17:21,349 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_1.csv
2019-08-08 17:17:21,349 - INFO - , with total : 951223 rows
2019-08-08 17:17:25,983 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_2.csv
2019-08-08 17:17:25,983 - INFO - , with total : 951223 rows
2019-08-08 17:17:30,687 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_3.csv
2019-08-08 17:17:30,690 - INFO - , with total : 951223 rows
2019-08-08 17:17:35,466 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_4.csv
2019-08-08 17:17:35,467 - INFO - , with total : 951223 rows
2019-08-08 17:17:40,265 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_5.csv
2019-08-08 17:17:40,266 - INFO - , with total : 951223 rows
2019-08-08 17:17:45,082 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_6.csv
2019-08-08 17:17:45,082 - INFO - , with total : 951223 rows
2019-08-08 17:17:49,839 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_7.csv
2019-08-08 17:17:49,841 - INFO - , with total : 951223 rows
2019-08-08 17:17:54,707 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_8.csv
2019-08-08 17:17:54,709 - INFO - , with total : 951223 rows
2019-08-08 17:17:59,486 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_9.csv
2019-08-08 17:17:59,487 - INFO - , with total : 951223 rows
2019-08-08 17:18:04,344 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_10.csv
2019-08-08 17:18:04,345 - INFO - , with total : 951223 rows
2019-08-08 17:18:09,127 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_11.csv
2019-08-08 17:18:09,127 - INFO - , with total : 951223 rows
2019-08-08 17:18:13,930 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190808 17.00/A14 who haven't bought DP_12.csv
2019-08-08 17:18:13,930 - INFO - , with total : 951223 rows
2019-08-08 17:18:16,157 - INFO - Delete all data in sheet: Case 10
2019-08-08 17:18:18,540 - INFO - No value detected on sheet: Case 11
2019-08-08 17:18:20,071 - INFO - No value detected on sheet: Case 12
2019-08-08 17:18:21,549 - INFO - No value detected on sheet: Case 13
2019-08-08 17:18:23,043 - INFO - No value detected on sheet: Case 14
2019-08-08 17:18:24,658 - INFO - No value detected on sheet: Case 15
2019-08-09 10:00:13,474 - INFO - Report date: 20190809 10.00
2019-08-09 10:00:17,046 - INFO - Download sheet..
2019-08-09 10:00:17,046 - INFO - Change directory to script path
2019-08-09 10:00:18,119 - INFO - Spreadsheet downloaded
2019-08-09 10:00:18,119 - INFO - Checking sheet..
2019-08-09 10:00:19,806 - INFO - No value detected on sheet: Case 1
2019-08-09 10:00:21,000 - INFO - No value detected on sheet: Case 2
2019-08-09 10:00:22,220 - INFO - No value detected on sheet: Case 3
2019-08-09 10:00:23,420 - INFO - No value detected on sheet: Case 4
2019-08-09 10:00:24,661 - INFO - No value detected on sheet: Case 5
2019-08-09 10:00:25,890 - INFO - No value detected on sheet: Case 6
2019-08-09 10:00:27,117 - INFO - No value detected on sheet: Case 7
2019-08-09 10:00:28,540 - INFO - No value detected on sheet: Case 8
2019-08-09 10:00:29,825 - INFO - No value detected on sheet: Case 9
2019-08-09 10:00:31,098 - INFO - No value detected on sheet: Case 10
2019-08-09 10:00:32,315 - INFO - Value detected - use sheet: Case 11
2019-08-09 10:00:32,316 - INFO - Reading Data From Google Sheet...
2019-08-09 10:00:32,697 - INFO - Get custom SQL..
2019-08-09 10:00:32,698 - INFO - USING CASE 11
2019-08-09 10:00:35,538 - INFO - Row 1
2019-08-09 10:00:35,539 - INFO - Filename: User that shopped Comic Con Tickets
2019-08-09 10:00:35,539 - INFO - Item ID: 2391297605,2391307616,2391315135,2457591454,2457602838
2019-08-09 10:00:35,539 - INFO - Date 1: 2019-07-05
2019-08-09 10:00:35,539 - INFO - Date 2: 2019-08-08
2019-08-09 10:00:35,540 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(p.userid as varchar)) as list_userid
                                from order_mart__order_item_profile as p
                                where itemid in (2391297605,2391307616,2391315135,2457591454,2457602838)
                                and grass_date between date'2019-07-05' and date'2019-08-08'
                                
2019-08-09 10:00:35,540 - INFO - Start Running query User that shopped Comic Con Tickets
2019-08-09 10:00:42,650 - INFO - Running User that shopped Comic Con Tickets Done
2019-08-09 10:00:42,650 - INFO - CSV file path: User that shopped Comic Con Tickets
2019-08-09 10:00:42,651 - INFO - Starting save the query results
2019-08-09 10:00:42,651 - INFO - Total Rows : 544
2019-08-09 10:00:42,651 - INFO - Will split into : 1.0 files
2019-08-09 10:00:42,681 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 10.00/User that shopped Comic Con Tickets_1.csv
2019-08-09 10:00:42,683 - INFO - , with total : 544 rows
2019-08-09 10:00:43,756 - INFO - Delete all data in sheet: Case 11
2019-08-09 10:00:45,262 - INFO - No value detected on sheet: Case 12
2019-08-09 10:00:46,227 - INFO - No value detected on sheet: Case 13
2019-08-09 10:00:48,049 - INFO - No value detected on sheet: Case 14
2019-08-09 10:00:48,846 - INFO - No value detected on sheet: Case 15
2019-08-09 14:04:45,805 - INFO - Report date: 20190809 14.04
2019-08-09 14:04:50,088 - INFO - Download sheet..
2019-08-09 14:04:50,089 - INFO - Change directory to script path
2019-08-09 14:04:53,392 - INFO - Spreadsheet downloaded
2019-08-09 14:04:53,394 - INFO - Checking sheet..
2019-08-09 14:04:55,151 - INFO - Value detected - use sheet: Case 1
2019-08-09 14:04:55,151 - INFO - Reading Data From Google Sheet...
2019-08-09 14:04:55,729 - INFO - Get custom SQL..
2019-08-09 14:04:55,730 - INFO - USING CASE 1
2019-08-09 14:04:57,874 - INFO - Row 1
2019-08-09 14:04:57,875 - INFO - Filename: A30 Lifestyle
2019-08-09 14:04:57,875 - INFO - Category: 'Home & Living'
2019-08-09 14:04:57,875 - INFO - Last Login: 30
2019-08-09 14:04:57,877 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-09 14:04:57,878 - INFO - Start Running query A30 Lifestyle
2019-08-09 14:09:56,713 - INFO - Running A30 Lifestyle Done
2019-08-09 14:09:56,714 - INFO - CSV file path: A30 Lifestyle
2019-08-09 14:09:56,999 - INFO - Starting save the query results
2019-08-09 14:09:57,000 - INFO - Total Rows : 6388407
2019-08-09 14:09:57,000 - INFO - Will split into : 7.0 files
2019-08-09 14:10:02,082 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Lifestyle_1.csv
2019-08-09 14:10:02,082 - INFO - , with total : 912630 rows
2019-08-09 14:10:07,526 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Lifestyle_2.csv
2019-08-09 14:10:07,528 - INFO - , with total : 912630 rows
2019-08-09 14:10:12,924 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Lifestyle_3.csv
2019-08-09 14:10:12,926 - INFO - , with total : 912630 rows
2019-08-09 14:10:22,503 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Lifestyle_4.csv
2019-08-09 14:10:22,503 - INFO - , with total : 912630 rows
2019-08-09 14:10:29,107 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Lifestyle_5.csv
2019-08-09 14:10:29,108 - INFO - , with total : 912629 rows
2019-08-09 14:10:36,351 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Lifestyle_6.csv
2019-08-09 14:10:36,351 - INFO - , with total : 912629 rows
2019-08-09 14:10:41,673 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Lifestyle_7.csv
2019-08-09 14:10:41,674 - INFO - , with total : 912629 rows
2019-08-09 14:10:52,448 - INFO - Row 2
2019-08-09 14:10:52,450 - INFO - Filename: A30 FMCG Buyers
2019-08-09 14:10:52,450 - INFO - Category: 'Mom & Baby','Beauty'
2019-08-09 14:10:52,451 - INFO - Last Login: 30
2019-08-09 14:10:52,453 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mom & Baby','Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-09 14:10:52,453 - INFO - Start Running query A30 FMCG Buyers
2019-08-09 14:17:16,707 - INFO - Running A30 FMCG Buyers Done
2019-08-09 14:17:29,549 - INFO - CSV file path: A30 FMCG Buyers
2019-08-09 14:18:24,615 - INFO - Starting save the query results
2019-08-09 14:18:29,009 - INFO - Total Rows : 8564319
2019-08-09 14:18:34,319 - INFO - Will split into : 9.0 files
2019-08-09 14:19:33,897 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 FMCG Buyers_1.csv
2019-08-09 14:19:33,967 - INFO - , with total : 951591 rows
2019-08-09 14:19:43,826 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 FMCG Buyers_2.csv
2019-08-09 14:19:43,829 - INFO - , with total : 951591 rows
2019-08-09 14:19:51,299 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 FMCG Buyers_3.csv
2019-08-09 14:19:51,301 - INFO - , with total : 951591 rows
2019-08-09 14:20:02,236 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 FMCG Buyers_4.csv
2019-08-09 14:20:04,454 - INFO - , with total : 951591 rows
2019-08-09 14:20:12,371 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 FMCG Buyers_5.csv
2019-08-09 14:20:12,371 - INFO - , with total : 951591 rows
2019-08-09 14:20:24,404 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 FMCG Buyers_6.csv
2019-08-09 14:20:24,407 - INFO - , with total : 951591 rows
2019-08-09 14:20:32,431 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 FMCG Buyers_7.csv
2019-08-09 14:20:32,431 - INFO - , with total : 951591 rows
2019-08-09 14:20:37,627 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 FMCG Buyers_8.csv
2019-08-09 14:20:37,628 - INFO - , with total : 951591 rows
2019-08-09 14:20:44,982 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 FMCG Buyers_9.csv
2019-08-09 14:20:44,983 - INFO - , with total : 951591 rows
2019-08-09 14:21:00,490 - INFO - Row 3
2019-08-09 14:21:00,503 - INFO - Filename: A30 EL Buyers
2019-08-09 14:21:00,503 - INFO - Category: 'Electronics'
2019-08-09 14:21:00,505 - INFO - Last Login: 30
2019-08-09 14:21:00,528 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-09 14:21:00,529 - INFO - Start Running query A30 EL Buyers
2019-08-09 14:23:53,390 - INFO - Running A30 EL Buyers Done
2019-08-09 14:23:53,391 - INFO - CSV file path: A30 EL Buyers
2019-08-09 14:23:53,927 - INFO - Starting save the query results
2019-08-09 14:23:53,930 - INFO - Total Rows : 4655764
2019-08-09 14:23:53,930 - INFO - Will split into : 5.0 files
2019-08-09 14:23:58,601 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_1.csv
2019-08-09 14:23:58,601 - INFO - , with total : 931153 rows
2019-08-09 14:24:05,374 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_2.csv
2019-08-09 14:24:05,375 - INFO - , with total : 931153 rows
2019-08-09 14:24:10,430 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_3.csv
2019-08-09 14:24:10,430 - INFO - , with total : 931153 rows
2019-08-09 14:24:15,710 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_4.csv
2019-08-09 14:24:15,710 - INFO - , with total : 931153 rows
2019-08-09 14:24:21,052 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_5.csv
2019-08-09 14:24:21,053 - INFO - , with total : 931152 rows
2019-08-09 14:24:22,456 - INFO - Delete all data in sheet: Case 1
2019-08-09 14:24:24,819 - INFO - No value detected on sheet: Case 2
2019-08-09 14:24:26,351 - INFO - No value detected on sheet: Case 3
2019-08-09 14:24:27,611 - INFO - Value detected - use sheet: Case 4
2019-08-09 14:24:27,611 - INFO - Reading Data From Google Sheet...
2019-08-09 14:24:28,246 - INFO - Get custom SQL..
2019-08-09 14:24:28,246 - INFO - USING CASE 4
2019-08-09 14:24:30,107 - INFO - Row 1
2019-08-09 14:24:30,108 - INFO - Filename: A30 Female Fashion Buyers
2019-08-09 14:24:30,108 - INFO - Last Login: 30
2019-08-09 14:24:30,109 - INFO - Gender: 2,4
2019-08-09 14:24:30,111 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid 
                                    where
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-09 14:24:30,111 - INFO - Start Running query A30 Female Fashion Buyers
2019-08-09 14:30:23,217 - INFO - Running A30 Female Fashion Buyers Done
2019-08-09 14:30:24,111 - INFO - CSV file path: A30 Female Fashion Buyers
2019-08-09 14:31:15,773 - INFO - Starting save the query results
2019-08-09 14:31:15,948 - INFO - Total Rows : 10886162
2019-08-09 14:31:16,026 - INFO - Will split into : 11.0 files
2019-08-09 14:31:22,653 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_1.csv
2019-08-09 14:31:22,654 - INFO - , with total : 989652 rows
2019-08-09 14:31:38,709 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_2.csv
2019-08-09 14:31:38,710 - INFO - , with total : 989651 rows
2019-08-09 14:31:46,221 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_3.csv
2019-08-09 14:31:46,223 - INFO - , with total : 989651 rows
2019-08-09 14:31:52,265 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_4.csv
2019-08-09 14:31:52,265 - INFO - , with total : 989651 rows
2019-08-09 14:31:58,313 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_5.csv
2019-08-09 14:31:58,315 - INFO - , with total : 989651 rows
2019-08-09 14:32:04,510 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_6.csv
2019-08-09 14:32:04,513 - INFO - , with total : 989651 rows
2019-08-09 14:32:10,875 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_7.csv
2019-08-09 14:32:10,877 - INFO - , with total : 989651 rows
2019-08-09 14:32:16,519 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_8.csv
2019-08-09 14:32:16,520 - INFO - , with total : 989651 rows
2019-08-09 14:32:23,111 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_9.csv
2019-08-09 14:32:23,112 - INFO - , with total : 989651 rows
2019-08-09 14:32:29,272 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_10.csv
2019-08-09 14:32:29,302 - INFO - , with total : 989651 rows
2019-08-09 14:32:50,865 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 Female Fashion Buyers_11.csv
2019-08-09 14:32:50,867 - INFO - , with total : 989651 rows
2019-08-09 14:33:35,289 - INFO - Delete all data in sheet: Case 4
2019-08-09 14:33:37,875 - INFO - No value detected on sheet: Case 5
2019-08-09 14:33:39,250 - INFO - Value detected - use sheet: Case 6
2019-08-09 14:33:39,250 - INFO - Reading Data From Google Sheet...
2019-08-09 14:33:39,947 - INFO - Get custom SQL..
2019-08-09 14:33:39,947 - INFO - USING CASE 6
2019-08-09 14:33:48,487 - INFO - Row 1
2019-08-09 14:33:52,828 - INFO - Filename: A30 EL Buyers
2019-08-09 14:33:52,829 - INFO - Sub-category: 'Cable & Spareparts','Electricity','Home','Lighting','Media Player','Others','Speaker & Microphone','Surveillance Camera','Telephone','TV','Video Games'
2019-08-09 14:33:52,831 - INFO - Last Login: 30
2019-08-09 14:33:52,845 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Cable & Spareparts','Electricity','Home','Lighting','Media Player','Others','Speaker & Microphone','Surveillance Camera','Telephone','TV','Video Games')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-09 14:33:52,858 - INFO - Start Running query A30 EL Buyers
2019-08-09 14:37:00,780 - INFO - Running A30 EL Buyers Done
2019-08-09 14:37:05,565 - INFO - CSV file path: A30 EL Buyers
2019-08-09 14:37:05,842 - INFO - Starting save the query results
2019-08-09 14:37:05,842 - INFO - Total Rows : 6840450
2019-08-09 14:37:05,844 - INFO - Will split into : 7.0 files
2019-08-09 14:37:10,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_1.csv
2019-08-09 14:37:10,967 - INFO - , with total : 977208 rows
2019-08-09 14:37:16,894 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_2.csv
2019-08-09 14:37:16,897 - INFO - , with total : 977207 rows
2019-08-09 14:37:31,857 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_3.csv
2019-08-09 14:37:31,858 - INFO - , with total : 977207 rows
2019-08-09 14:37:37,612 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_4.csv
2019-08-09 14:37:37,614 - INFO - , with total : 977207 rows
2019-08-09 14:37:44,243 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_5.csv
2019-08-09 14:37:44,243 - INFO - , with total : 977207 rows
2019-08-09 14:37:58,930 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_6.csv
2019-08-09 14:37:58,933 - INFO - , with total : 977207 rows
2019-08-09 14:38:04,365 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 EL Buyers_7.csv
2019-08-09 14:38:04,367 - INFO - , with total : 977207 rows
2019-08-09 14:38:09,677 - INFO - Row 2
2019-08-09 14:38:09,677 - INFO - Filename: A30 HL Buyers
2019-08-09 14:38:09,677 - INFO - Sub-category: 'Bathroom','Bedroom','Decoration','Dining Room','Equipments','Furniture','Gardening
Home Care','Home Care Tools','Kitchen & Cookware','Party Supplies','Storage'
2019-08-09 14:38:09,694 - INFO - Last Login: 30
2019-08-09 14:38:09,694 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bathroom','Bedroom','Decoration','Dining Room','Equipments','Furniture','Gardening
Home Care','Home Care Tools','Kitchen & Cookware','Party Supplies','Storage')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-09 14:38:09,696 - INFO - Start Running query A30 HL Buyers
2019-08-09 14:41:01,461 - INFO - Running A30 HL Buyers Done
2019-08-09 14:41:01,463 - INFO - CSV file path: A30 HL Buyers
2019-08-09 14:41:01,729 - INFO - Starting save the query results
2019-08-09 14:41:01,730 - INFO - Total Rows : 6201086
2019-08-09 14:41:01,730 - INFO - Will split into : 7.0 files
2019-08-09 14:41:06,234 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 HL Buyers_1.csv
2019-08-09 14:41:06,236 - INFO - , with total : 885870 rows
2019-08-09 14:41:10,740 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 HL Buyers_2.csv
2019-08-09 14:41:10,742 - INFO - , with total : 885870 rows
2019-08-09 14:41:15,851 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 HL Buyers_3.csv
2019-08-09 14:41:15,855 - INFO - , with total : 885870 rows
2019-08-09 14:41:20,993 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 HL Buyers_4.csv
2019-08-09 14:41:20,994 - INFO - , with total : 885869 rows
2019-08-09 14:41:27,470 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 HL Buyers_5.csv
2019-08-09 14:41:27,470 - INFO - , with total : 885869 rows
2019-08-09 14:41:33,071 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 HL Buyers_6.csv
2019-08-09 14:41:33,078 - INFO - , with total : 885869 rows
2019-08-09 14:41:38,082 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/A30 HL Buyers_7.csv
2019-08-09 14:41:38,084 - INFO - , with total : 885869 rows
2019-08-09 14:41:39,778 - INFO - Delete all data in sheet: Case 6
2019-08-09 14:41:41,851 - INFO - No value detected on sheet: Case 7
2019-08-09 14:41:43,371 - INFO - Value detected - use sheet: Case 8
2019-08-09 14:41:43,372 - INFO - Reading Data From Google Sheet...
2019-08-09 14:41:43,960 - INFO - Get custom SQL..
2019-08-09 14:41:43,961 - INFO - USING CASE 8
2019-08-09 14:41:45,150 - INFO - Row 1
2019-08-09 14:41:45,151 - INFO - Filename: Queenbangs89 Followers
2019-08-09 14:41:45,153 - INFO - Shop ID: 17800584
2019-08-09 14:41:45,153 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (17800584) 
                                and status = 1
                                
2019-08-09 14:41:45,154 - INFO - Start Running query Queenbangs89 Followers
2019-08-09 14:41:55,549 - INFO - Running Queenbangs89 Followers Done
2019-08-09 14:41:55,551 - INFO - CSV file path: Queenbangs89 Followers
2019-08-09 14:41:55,562 - INFO - Starting save the query results
2019-08-09 14:41:55,562 - INFO - Total Rows : 163374
2019-08-09 14:41:55,562 - INFO - Will split into : 1.0 files
2019-08-09 14:41:56,444 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/Queenbangs89 Followers_1.csv
2019-08-09 14:41:56,446 - INFO - , with total : 163374 rows
2019-08-09 14:41:58,519 - INFO - Row 2
2019-08-09 14:41:58,520 - INFO - Filename: Nicoletasbatam Followers
2019-08-09 14:41:58,522 - INFO - Shop ID: 16921925
2019-08-09 14:41:58,522 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (16921925) 
                                and status = 1
                                
2019-08-09 14:41:58,523 - INFO - Start Running query Nicoletasbatam Followers
2019-08-09 14:42:07,848 - INFO - Running Nicoletasbatam Followers Done
2019-08-09 14:42:07,849 - INFO - CSV file path: Nicoletasbatam Followers
2019-08-09 14:42:07,858 - INFO - Starting save the query results
2019-08-09 14:42:07,858 - INFO - Total Rows : 212975
2019-08-09 14:42:07,859 - INFO - Will split into : 1.0 files
2019-08-09 14:42:09,164 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/Nicoletasbatam Followers_1.csv
2019-08-09 14:42:09,164 - INFO - , with total : 212975 rows
2019-08-09 14:42:12,375 - INFO - Row 3
2019-08-09 14:42:12,375 - INFO - Filename: Monochromestuff OS Followers
2019-08-09 14:42:12,375 - INFO - Shop ID: 4002227
2019-08-09 14:42:12,375 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (4002227) 
                                and status = 1
                                
2019-08-09 14:42:12,394 - INFO - Start Running query Monochromestuff OS Followers
2019-08-09 14:42:19,437 - INFO - Running Monochromestuff OS Followers Done
2019-08-09 14:42:19,437 - INFO - CSV file path: Monochromestuff OS Followers
2019-08-09 14:42:19,444 - INFO - Starting save the query results
2019-08-09 14:42:19,446 - INFO - Total Rows : 135617
2019-08-09 14:42:19,447 - INFO - Will split into : 1.0 files
2019-08-09 14:42:22,088 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/Monochromestuff OS Followers_1.csv
2019-08-09 14:42:22,088 - INFO - , with total : 135617 rows
2019-08-09 14:42:24,240 - INFO - Row 4
2019-08-09 14:42:24,240 - INFO - Filename: Hotselling OS Followers
2019-08-09 14:42:24,240 - INFO - Shop ID: 28274024
2019-08-09 14:42:24,242 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (28274024) 
                                and status = 1
                                
2019-08-09 14:42:24,243 - INFO - Start Running query Hotselling OS Followers
2019-08-09 14:42:32,403 - INFO - Running Hotselling OS Followers Done
2019-08-09 14:42:32,404 - INFO - CSV file path: Hotselling OS Followers
2019-08-09 14:42:32,405 - INFO - Starting save the query results
2019-08-09 14:42:32,407 - INFO - Total Rows : 13662
2019-08-09 14:42:32,407 - INFO - Will split into : 1.0 files
2019-08-09 14:42:32,533 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 14.04/Hotselling OS Followers_1.csv
2019-08-09 14:42:32,535 - INFO - , with total : 13662 rows
2019-08-09 14:42:33,249 - INFO - Delete all data in sheet: Case 8
2019-08-09 14:42:35,375 - INFO - No value detected on sheet: Case 9
2019-08-09 14:42:36,729 - INFO - No value detected on sheet: Case 10
2019-08-09 14:42:38,348 - INFO - No value detected on sheet: Case 11
2019-08-09 14:42:39,532 - INFO - No value detected on sheet: Case 12
2019-08-09 14:42:41,131 - INFO - No value detected on sheet: Case 13
2019-08-09 14:42:42,588 - INFO - No value detected on sheet: Case 14
2019-08-09 14:42:44,246 - INFO - No value detected on sheet: Case 15
2019-08-09 17:00:06,471 - INFO - Report date: 20190809 17.00
2019-08-09 17:00:10,923 - INFO - Download sheet..
2019-08-09 17:00:10,923 - INFO - Change directory to script path
2019-08-09 17:00:12,107 - INFO - Spreadsheet downloaded
2019-08-09 17:00:12,107 - INFO - Checking sheet..
2019-08-09 17:00:13,782 - INFO - No value detected on sheet: Case 1
2019-08-09 17:00:14,956 - INFO - No value detected on sheet: Case 2
2019-08-09 17:00:16,282 - INFO - No value detected on sheet: Case 3
2019-08-09 17:00:17,505 - INFO - No value detected on sheet: Case 4
2019-08-09 17:00:18,710 - INFO - No value detected on sheet: Case 5
2019-08-09 17:00:19,915 - INFO - No value detected on sheet: Case 6
2019-08-09 17:00:21,144 - INFO - No value detected on sheet: Case 7
2019-08-09 17:00:22,322 - INFO - Value detected - use sheet: Case 8
2019-08-09 17:00:22,322 - INFO - Reading Data From Google Sheet...
2019-08-09 17:00:22,943 - INFO - Get custom SQL..
2019-08-09 17:00:22,944 - INFO - USING CASE 8
2019-08-09 17:00:24,138 - INFO - Row 1
2019-08-09 17:00:24,138 - INFO - Filename: Monochromestuff OS Followers
2019-08-09 17:00:24,138 - INFO - Shop ID: 4002227
2019-08-09 17:00:24,138 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (4002227) 
                                and status = 1
                                
2019-08-09 17:00:24,140 - INFO - Start Running query Monochromestuff OS Followers
2019-08-09 17:00:32,117 - INFO - Running Monochromestuff OS Followers Done
2019-08-09 17:00:32,118 - INFO - CSV file path: Monochromestuff OS Followers
2019-08-09 17:00:32,125 - INFO - Starting save the query results
2019-08-09 17:00:32,125 - INFO - Total Rows : 135617
2019-08-09 17:00:32,128 - INFO - Will split into : 1.0 files
2019-08-09 17:00:32,796 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 17.00/Monochromestuff OS Followers_1.csv
2019-08-09 17:00:32,798 - INFO - , with total : 135617 rows
2019-08-09 17:00:34,851 - INFO - Row 2
2019-08-09 17:00:34,852 - INFO - Filename: Obambacomp OS Followers
2019-08-09 17:00:34,852 - INFO - Shop ID: 876630
2019-08-09 17:00:34,854 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (876630) 
                                and status = 1
                                
2019-08-09 17:00:34,854 - INFO - Start Running query Obambacomp OS Followers
2019-08-09 17:00:45,072 - INFO - Running Obambacomp OS Followers Done
2019-08-09 17:00:45,073 - INFO - CSV file path: Obambacomp OS Followers
2019-08-09 17:00:45,076 - INFO - Starting save the query results
2019-08-09 17:00:45,078 - INFO - Total Rows : 60960
2019-08-09 17:00:45,078 - INFO - Will split into : 1.0 files
2019-08-09 17:00:45,374 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190809 17.00/Obambacomp OS Followers_1.csv
2019-08-09 17:00:45,375 - INFO - , with total : 60960 rows
2019-08-09 17:00:46,032 - INFO - Delete all data in sheet: Case 8
2019-08-09 17:00:48,381 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%209%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-09 17:00:49,707 - INFO - No value detected on sheet: Case 10
2019-08-09 17:00:50,920 - INFO - No value detected on sheet: Case 11
2019-08-09 17:00:52,161 - INFO - No value detected on sheet: Case 12
2019-08-09 17:00:53,421 - INFO - No value detected on sheet: Case 13
2019-08-09 17:00:54,674 - INFO - No value detected on sheet: Case 14
2019-08-09 17:00:55,878 - INFO - No value detected on sheet: Case 15
2019-08-10 10:00:13,355 - INFO - Report date: 20190810 10.00
2019-08-10 10:00:15,752 - INFO - Download sheet..
2019-08-10 10:00:15,753 - INFO - Change directory to script path
2019-08-10 10:00:18,121 - INFO - Spreadsheet downloaded
2019-08-10 10:00:18,121 - INFO - Checking sheet..
2019-08-10 10:00:21,122 - INFO - No value detected on sheet: Case 1
2019-08-10 10:00:22,525 - INFO - No value detected on sheet: Case 2
2019-08-10 10:00:23,894 - INFO - No value detected on sheet: Case 3
2019-08-10 10:00:25,358 - INFO - No value detected on sheet: Case 4
2019-08-10 10:00:26,736 - INFO - No value detected on sheet: Case 5
2019-08-10 10:00:28,091 - INFO - No value detected on sheet: Case 6
2019-08-10 10:00:29,438 - INFO - No value detected on sheet: Case 7
2019-08-10 10:00:30,795 - INFO - No value detected on sheet: Case 8
2019-08-10 10:00:32,415 - INFO - No value detected on sheet: Case 9
2019-08-10 10:00:33,871 - INFO - No value detected on sheet: Case 10
2019-08-10 10:00:35,246 - INFO - No value detected on sheet: Case 11
2019-08-10 10:00:36,516 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%2012%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-10 10:00:37,105 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-10 10:00:37,694 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-10 10:00:38,273 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-10 14:00:03,262 - INFO - Report date: 20190810 14.00
2019-08-10 14:00:07,739 - INFO - Download sheet..
2019-08-10 14:00:07,739 - INFO - Change directory to script path
2019-08-10 14:00:10,384 - INFO - Spreadsheet downloaded
2019-08-10 14:00:10,384 - INFO - Checking sheet..
2019-08-10 14:00:12,160 - INFO - No value detected on sheet: Case 1
2019-08-10 14:00:13,644 - INFO - No value detected on sheet: Case 2
2019-08-10 14:00:14,963 - INFO - No value detected on sheet: Case 3
2019-08-10 14:00:16,272 - INFO - No value detected on sheet: Case 4
2019-08-10 14:00:17,575 - INFO - No value detected on sheet: Case 5
2019-08-10 14:00:18,875 - INFO - No value detected on sheet: Case 6
2019-08-10 14:00:20,220 - INFO - No value detected on sheet: Case 7
2019-08-10 14:00:21,523 - INFO - No value detected on sheet: Case 8
2019-08-10 14:00:23,015 - INFO - No value detected on sheet: Case 9
2019-08-10 14:00:24,312 - INFO - No value detected on sheet: Case 10
2019-08-10 14:00:25,631 - INFO - No value detected on sheet: Case 11
2019-08-10 14:00:26,926 - INFO - No value detected on sheet: Case 12
2019-08-10 14:00:28,226 - INFO - No value detected on sheet: Case 13
2019-08-10 14:00:29,559 - INFO - No value detected on sheet: Case 14
2019-08-10 14:00:30,842 - INFO - No value detected on sheet: Case 15
2019-08-10 17:00:02,440 - INFO - Report date: 20190810 17.00
2019-08-10 17:00:06,588 - INFO - Download sheet..
2019-08-10 17:00:06,589 - INFO - Change directory to script path
2019-08-10 17:00:08,596 - INFO - Spreadsheet downloaded
2019-08-10 17:00:08,598 - INFO - Checking sheet..
2019-08-10 17:00:10,345 - INFO - No value detected on sheet: Case 1
2019-08-10 17:00:11,641 - INFO - No value detected on sheet: Case 2
2019-08-10 17:00:13,119 - INFO - No value detected on sheet: Case 3
2019-08-10 17:00:14,464 - INFO - No value detected on sheet: Case 4
2019-08-10 17:00:15,783 - INFO - No value detected on sheet: Case 5
2019-08-10 17:00:18,069 - INFO - No value detected on sheet: Case 6
2019-08-10 17:00:19,461 - INFO - No value detected on sheet: Case 7
2019-08-10 17:00:20,765 - INFO - No value detected on sheet: Case 8
2019-08-10 17:00:22,056 - INFO - No value detected on sheet: Case 9
2019-08-10 17:00:23,352 - INFO - No value detected on sheet: Case 10
2019-08-10 17:00:24,661 - INFO - No value detected on sheet: Case 11
2019-08-10 17:00:25,993 - INFO - No value detected on sheet: Case 12
2019-08-10 17:00:27,315 - INFO - No value detected on sheet: Case 13
2019-08-10 17:00:28,670 - INFO - No value detected on sheet: Case 14
2019-08-10 17:00:30,013 - INFO - No value detected on sheet: Case 15
2019-08-11 10:00:07,256 - INFO - Report date: 20190811 10.00
2019-08-11 10:00:10,729 - INFO - Download sheet..
2019-08-11 10:00:10,730 - INFO - Change directory to script path
2019-08-11 10:00:12,585 - INFO - Spreadsheet downloaded
2019-08-11 10:00:12,585 - INFO - Checking sheet..
2019-08-11 10:00:14,440 - INFO - No value detected on sheet: Case 1
2019-08-11 10:00:15,780 - INFO - No value detected on sheet: Case 2
2019-08-11 10:00:17,134 - INFO - No value detected on sheet: Case 3
2019-08-11 10:00:18,457 - INFO - No value detected on sheet: Case 4
2019-08-11 10:00:19,785 - INFO - No value detected on sheet: Case 5
2019-08-11 10:00:21,128 - INFO - No value detected on sheet: Case 6
2019-08-11 10:00:22,470 - INFO - No value detected on sheet: Case 7
2019-08-11 10:00:23,796 - INFO - No value detected on sheet: Case 8
2019-08-11 10:00:25,119 - INFO - No value detected on sheet: Case 9
2019-08-11 10:00:26,463 - INFO - No value detected on sheet: Case 10
2019-08-11 10:00:27,780 - INFO - No value detected on sheet: Case 11
2019-08-11 10:00:29,150 - INFO - No value detected on sheet: Case 12
2019-08-11 10:00:30,469 - INFO - No value detected on sheet: Case 13
2019-08-11 10:00:31,806 - INFO - No value detected on sheet: Case 14
2019-08-11 10:00:33,122 - INFO - No value detected on sheet: Case 15
2019-08-11 14:00:03,841 - INFO - Report date: 20190811 14.00
2019-08-11 14:00:07,648 - INFO - Download sheet..
2019-08-11 14:00:07,648 - INFO - Change directory to script path
2019-08-11 14:00:09,908 - INFO - Spreadsheet downloaded
2019-08-11 14:00:09,908 - INFO - Checking sheet..
2019-08-11 14:00:11,812 - INFO - No value detected on sheet: Case 1
2019-08-11 14:00:13,167 - INFO - No value detected on sheet: Case 2
2019-08-11 14:00:14,529 - INFO - No value detected on sheet: Case 3
2019-08-11 14:00:15,903 - INFO - No value detected on sheet: Case 4
2019-08-11 14:00:17,290 - INFO - No value detected on sheet: Case 5
2019-08-11 14:00:18,684 - INFO - No value detected on sheet: Case 6
2019-08-11 14:00:20,035 - INFO - No value detected on sheet: Case 7
2019-08-11 14:00:21,381 - INFO - No value detected on sheet: Case 8
2019-08-11 14:00:22,835 - INFO - No value detected on sheet: Case 9
2019-08-11 14:00:24,190 - INFO - No value detected on sheet: Case 10
2019-08-11 14:00:25,538 - INFO - No value detected on sheet: Case 11
2019-08-11 14:00:26,901 - INFO - No value detected on sheet: Case 12
2019-08-11 14:00:28,289 - INFO - No value detected on sheet: Case 13
2019-08-11 14:00:29,960 - INFO - No value detected on sheet: Case 14
2019-08-11 14:00:31,303 - INFO - No value detected on sheet: Case 15
2019-08-11 17:00:02,431 - INFO - Report date: 20190811 17.00
2019-08-11 17:00:05,825 - INFO - Download sheet..
2019-08-11 17:00:05,826 - INFO - Change directory to script path
2019-08-11 17:00:08,072 - INFO - Spreadsheet downloaded
2019-08-11 17:00:08,072 - INFO - Checking sheet..
2019-08-11 17:00:09,855 - INFO - No value detected on sheet: Case 1
2019-08-11 17:00:11,188 - INFO - No value detected on sheet: Case 2
2019-08-11 17:00:12,513 - INFO - No value detected on sheet: Case 3
2019-08-11 17:00:13,846 - INFO - No value detected on sheet: Case 4
2019-08-11 17:00:15,181 - INFO - No value detected on sheet: Case 5
2019-08-11 17:00:16,525 - INFO - No value detected on sheet: Case 6
2019-08-11 17:00:17,888 - INFO - No value detected on sheet: Case 7
2019-08-11 17:00:19,226 - INFO - No value detected on sheet: Case 8
2019-08-11 17:00:20,552 - INFO - No value detected on sheet: Case 9
2019-08-11 17:00:21,901 - INFO - No value detected on sheet: Case 10
2019-08-11 17:00:23,243 - INFO - No value detected on sheet: Case 11
2019-08-11 17:00:24,585 - INFO - No value detected on sheet: Case 12
2019-08-11 17:00:25,655 - INFO - No value detected on sheet: Case 13
2019-08-11 17:00:26,460 - INFO - No value detected on sheet: Case 14
2019-08-11 17:00:27,612 - INFO - No value detected on sheet: Case 15
2019-08-12 10:00:16,154 - INFO - Report date: 20190812 10.00
2019-08-12 10:00:19,723 - INFO - Download sheet..
2019-08-12 10:00:19,724 - INFO - Change directory to script path
2019-08-12 10:00:21,153 - INFO - Spreadsheet downloaded
2019-08-12 10:00:21,153 - INFO - Checking sheet..
2019-08-12 10:00:23,292 - INFO - No value detected on sheet: Case 1
2019-08-12 10:00:24,736 - INFO - No value detected on sheet: Case 2
2019-08-12 10:00:26,131 - INFO - No value detected on sheet: Case 3
2019-08-12 10:00:27,658 - INFO - No value detected on sheet: Case 4
2019-08-12 10:00:29,255 - INFO - No value detected on sheet: Case 5
2019-08-12 10:00:30,690 - INFO - No value detected on sheet: Case 6
2019-08-12 10:00:32,108 - INFO - No value detected on sheet: Case 7
2019-08-12 10:00:33,503 - INFO - No value detected on sheet: Case 8
2019-08-12 10:00:35,348 - INFO - No value detected on sheet: Case 9
2019-08-12 10:00:37,437 - INFO - No value detected on sheet: Case 10
2019-08-12 10:00:39,040 - INFO - No value detected on sheet: Case 11
2019-08-12 10:00:40,420 - INFO - No value detected on sheet: Case 12
2019-08-12 10:00:41,921 - INFO - No value detected on sheet: Case 13
2019-08-12 10:00:43,326 - INFO - No value detected on sheet: Case 14
2019-08-12 10:00:44,703 - INFO - Value detected - use sheet: Case 15
2019-08-12 10:00:44,704 - INFO - Reading Data From Google Sheet...
2019-08-12 10:00:45,582 - INFO - Get custom SQL..
2019-08-12 10:00:45,584 - INFO - USING CASE 15
2019-08-12 10:00:47,206 - INFO - Row 1
2019-08-12 10:00:47,207 - INFO - Filename: Daily Prize User 13 Aug
2019-08-12 10:00:47,207 - INFO - Date 1: 2019-08-01
2019-08-12 10:00:47,209 - INFO - Date 2: 2019-08-11
2019-08-12 10:00:47,209 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(dp.user_id as varchar)) as list_userid
                                from shopee_id_mk_team__daily_prize_vfive as dp
                                left join user_profile as u 
                                on u.userid = cast(dp.user_id as int)
                                where date(date_parse(cast(dp.datte as varchar), '%Y-%m-%d %H:%i:%s')) >= date('2019-08-01')
                                and date(date_parse(cast(dp.datte as varchar), '%Y-%m-%d %H:%i:%s')) <= date('2019-08-11')                                
                                
2019-08-12 10:00:47,210 - INFO - Start Running query Daily Prize User 13 Aug
2019-08-12 10:02:24,292 - INFO - Running Daily Prize User 13 Aug Done
2019-08-12 10:02:24,292 - INFO - CSV file path: Daily Prize User 13 Aug
2019-08-12 10:02:24,325 - INFO - Starting save the query results
2019-08-12 10:02:24,325 - INFO - Total Rows : 860226
2019-08-12 10:02:24,325 - INFO - Will split into : 1.0 files
2019-08-12 10:02:28,183 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 10.00/Daily Prize User 13 Aug_1.csv
2019-08-12 10:02:28,183 - INFO - , with total : 860226 rows
2019-08-12 10:02:29,355 - INFO - Delete all data in sheet: Case 15
2019-08-12 14:00:08,828 - INFO - Report date: 20190812 14.00
2019-08-12 14:00:12,628 - INFO - Download sheet..
2019-08-12 14:00:12,628 - INFO - Change directory to script path
2019-08-12 14:00:16,815 - INFO - Spreadsheet downloaded
2019-08-12 14:00:16,816 - INFO - Checking sheet..
2019-08-12 14:00:18,627 - INFO - No value detected on sheet: Case 1
2019-08-12 14:00:20,173 - INFO - No value detected on sheet: Case 2
2019-08-12 14:00:21,401 - INFO - No value detected on sheet: Case 3
2019-08-12 14:00:22,638 - INFO - No value detected on sheet: Case 4
2019-08-12 14:00:24,089 - INFO - No value detected on sheet: Case 5
2019-08-12 14:00:25,371 - INFO - Value detected - use sheet: Case 6
2019-08-12 14:00:25,371 - INFO - Reading Data From Google Sheet...
2019-08-12 14:00:25,993 - INFO - Get custom SQL..
2019-08-12 14:00:25,993 - INFO - USING CASE 6
2019-08-12 14:00:28,210 - INFO - Row 1
2019-08-12 14:00:28,210 - INFO - Filename: A30 MA Buyers (Samsung)
2019-08-12 14:00:28,211 - INFO - Sub-category: 'Bluetooth & Headset','Cable & Charger','Casing & Covers','Memory Card','Mobile & Tablet','Powerbank & Batteries'
2019-08-12 14:00:28,211 - INFO - Last Login: 30
2019-08-12 14:00:28,213 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bluetooth & Headset','Cable & Charger','Casing & Covers','Memory Card','Mobile & Tablet','Powerbank & Batteries')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-12 14:00:28,213 - INFO - Start Running query A30 MA Buyers (Samsung)
2019-08-12 14:05:21,434 - INFO - Running A30 MA Buyers (Samsung) Done
2019-08-12 14:05:21,434 - INFO - CSV file path: A30 MA Buyers (Samsung)
2019-08-12 14:05:21,829 - INFO - Starting save the query results
2019-08-12 14:05:21,829 - INFO - Total Rows : 6550903
2019-08-12 14:05:21,831 - INFO - Will split into : 7.0 files
2019-08-12 14:05:26,296 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/A30 MA Buyers (Samsung)_1.csv
2019-08-12 14:05:26,296 - INFO - , with total : 935844 rows
2019-08-12 14:05:31,078 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/A30 MA Buyers (Samsung)_2.csv
2019-08-12 14:05:31,079 - INFO - , with total : 935844 rows
2019-08-12 14:05:37,793 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/A30 MA Buyers (Samsung)_3.csv
2019-08-12 14:05:37,795 - INFO - , with total : 935843 rows
2019-08-12 14:05:42,775 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/A30 MA Buyers (Samsung)_4.csv
2019-08-12 14:05:42,776 - INFO - , with total : 935843 rows
2019-08-12 14:05:47,855 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/A30 MA Buyers (Samsung)_5.csv
2019-08-12 14:05:47,855 - INFO - , with total : 935843 rows
2019-08-12 14:05:53,349 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/A30 MA Buyers (Samsung)_6.csv
2019-08-12 14:05:53,351 - INFO - , with total : 935843 rows
2019-08-12 14:05:58,359 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/A30 MA Buyers (Samsung)_7.csv
2019-08-12 14:05:58,361 - INFO - , with total : 935843 rows
2019-08-12 14:06:00,342 - INFO - Delete all data in sheet: Case 6
2019-08-12 14:06:02,542 - INFO - No value detected on sheet: Case 7
2019-08-12 14:06:03,801 - INFO - Value detected - use sheet: Case 8
2019-08-12 14:06:03,802 - INFO - Reading Data From Google Sheet...
2019-08-12 14:06:04,401 - INFO - Get custom SQL..
2019-08-12 14:06:04,401 - INFO - USING CASE 8
2019-08-12 14:06:05,667 - INFO - Row 1
2019-08-12 14:06:05,667 - INFO - Filename: Baellerry Followers
2019-08-12 14:06:05,668 - INFO - Shop ID: 74295506
2019-08-12 14:06:05,670 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (74295506) 
                                and status = 1
                                
2019-08-12 14:06:05,670 - INFO - Start Running query Baellerry Followers
2019-08-12 14:06:10,548 - INFO - Running Baellerry Followers Done
2019-08-12 14:06:10,549 - INFO - CSV file path: Baellerry Followers
2019-08-12 14:06:10,552 - INFO - Starting save the query results
2019-08-12 14:06:10,552 - INFO - Total Rows : 24586
2019-08-12 14:06:10,552 - INFO - Will split into : 1.0 files
2019-08-12 14:06:10,694 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/Baellerry Followers_1.csv
2019-08-12 14:06:10,694 - INFO - , with total : 24586 rows
2019-08-12 14:06:12,736 - INFO - Row 2
2019-08-12 14:06:12,737 - INFO - Filename: Gracia Import Followers
2019-08-12 14:06:12,739 - INFO - Shop ID: 31399198
2019-08-12 14:06:12,739 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (31399198) 
                                and status = 1
                                
2019-08-12 14:06:12,740 - INFO - Start Running query Gracia Import Followers
2019-08-12 14:06:15,891 - INFO - Running Gracia Import Followers Done
2019-08-12 14:06:15,892 - INFO - CSV file path: Gracia Import Followers
2019-08-12 14:06:15,897 - INFO - Starting save the query results
2019-08-12 14:06:15,898 - INFO - Total Rows : 63531
2019-08-12 14:06:15,898 - INFO - Will split into : 1.0 files
2019-08-12 14:06:16,312 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/Gracia Import Followers_1.csv
2019-08-12 14:06:16,312 - INFO - , with total : 63531 rows
2019-08-12 14:06:18,342 - INFO - Row 3
2019-08-12 14:06:18,342 - INFO - Filename: Louvre.id Followers
2019-08-12 14:06:18,344 - INFO - Shop ID: 28779146
2019-08-12 14:06:18,345 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (28779146) 
                                and status = 1
                                
2019-08-12 14:06:18,345 - INFO - Start Running query Louvre.id Followers
2019-08-12 14:06:21,812 - INFO - Running Louvre.id Followers Done
2019-08-12 14:06:21,813 - INFO - CSV file path: Louvre.id Followers
2019-08-12 14:06:21,815 - INFO - Starting save the query results
2019-08-12 14:06:21,815 - INFO - Total Rows : 15572
2019-08-12 14:06:21,816 - INFO - Will split into : 1.0 files
2019-08-12 14:06:21,944 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/Louvre.id Followers_1.csv
2019-08-12 14:06:21,946 - INFO - , with total : 15572 rows
2019-08-12 14:06:23,846 - INFO - Row 4
2019-08-12 14:06:23,848 - INFO - Filename: Bayer Followers
2019-08-12 14:06:23,848 - INFO - Shop ID: 58696021
2019-08-12 14:06:23,849 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (58696021) 
                                and status = 1
                                
2019-08-12 14:06:23,851 - INFO - Start Running query Bayer Followers
2019-08-12 14:06:26,509 - INFO - Running Bayer Followers Done
2019-08-12 14:06:26,510 - INFO - CSV file path: Bayer Followers
2019-08-12 14:06:26,513 - INFO - Starting save the query results
2019-08-12 14:06:26,513 - INFO - Total Rows : 12860
2019-08-12 14:06:26,513 - INFO - Will split into : 1.0 files
2019-08-12 14:06:26,591 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/Bayer Followers_1.csv
2019-08-12 14:06:26,592 - INFO - , with total : 12860 rows
2019-08-12 14:06:28,651 - INFO - Row 5
2019-08-12 14:06:28,653 - INFO - Filename: Maybelline Followers
2019-08-12 14:06:28,653 - INFO - Shop ID: 62582411
2019-08-12 14:06:28,654 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (62582411) 
                                and status = 1
                                
2019-08-12 14:06:28,654 - INFO - Start Running query Maybelline Followers
2019-08-12 14:06:44,891 - INFO - Running Maybelline Followers Done
2019-08-12 14:06:44,891 - INFO - CSV file path: Maybelline Followers
2019-08-12 14:06:44,917 - INFO - Starting save the query results
2019-08-12 14:06:44,917 - INFO - Total Rows : 622197
2019-08-12 14:06:44,918 - INFO - Will split into : 1.0 files
2019-08-12 14:06:48,296 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/Maybelline Followers_1.csv
2019-08-12 14:06:48,296 - INFO - , with total : 622197 rows
2019-08-12 14:06:50,619 - INFO - Row 6
2019-08-12 14:06:50,621 - INFO - Filename: Make Over Followers
2019-08-12 14:06:50,621 - INFO - Shop ID: 63984475
2019-08-12 14:06:50,621 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (63984475) 
                                and status = 1
                                
2019-08-12 14:06:50,622 - INFO - Start Running query Make Over Followers
2019-08-12 14:07:02,861 - INFO - Running Make Over Followers Done
2019-08-12 14:07:02,861 - INFO - CSV file path: Make Over Followers
2019-08-12 14:07:02,881 - INFO - Starting save the query results
2019-08-12 14:07:02,881 - INFO - Total Rows : 470333
2019-08-12 14:07:02,882 - INFO - Will split into : 1.0 files
2019-08-12 14:07:05,101 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/Make Over Followers_1.csv
2019-08-12 14:07:05,101 - INFO - , with total : 470333 rows
2019-08-12 14:07:07,460 - INFO - Row 7
2019-08-12 14:07:07,460 - INFO - Filename: Abbott Followers
2019-08-12 14:07:07,461 - INFO - Shop ID: 27475286
2019-08-12 14:07:07,461 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (27475286) 
                                and status = 1
                                
2019-08-12 14:07:07,463 - INFO - Start Running query Abbott Followers
2019-08-12 14:07:15,953 - INFO - Running Abbott Followers Done
2019-08-12 14:07:15,954 - INFO - CSV file path: Abbott Followers
2019-08-12 14:07:15,956 - INFO - Starting save the query results
2019-08-12 14:07:15,957 - INFO - Total Rows : 10398
2019-08-12 14:07:15,957 - INFO - Will split into : 1.0 files
2019-08-12 14:07:16,691 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/Abbott Followers_1.csv
2019-08-12 14:07:16,694 - INFO - , with total : 10398 rows
2019-08-12 14:07:18,306 - INFO - Row 8
2019-08-12 14:07:18,309 - INFO - Filename: Yuk.masak Followers
2019-08-12 14:07:18,309 - INFO - Shop ID: 3467987
2019-08-12 14:07:18,311 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (3467987) 
                                and status = 1
                                
2019-08-12 14:07:18,312 - INFO - Start Running query Yuk.masak Followers
2019-08-12 14:07:27,552 - INFO - Running Yuk.masak Followers Done
2019-08-12 14:07:27,552 - INFO - CSV file path: Yuk.masak Followers
2019-08-12 14:07:27,555 - INFO - Starting save the query results
2019-08-12 14:07:27,556 - INFO - Total Rows : 36700
2019-08-12 14:07:27,558 - INFO - Will split into : 1.0 files
2019-08-12 14:07:27,740 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/Yuk.masak Followers_1.csv
2019-08-12 14:07:27,742 - INFO - , with total : 36700 rows
2019-08-12 14:07:29,306 - INFO - Row 9
2019-08-12 14:07:29,308 - INFO - Filename: Ramayana Followers
2019-08-12 14:07:29,308 - INFO - Shop ID: 60755826
2019-08-12 14:07:29,309 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (60755826) 
                                and status = 1
                                
2019-08-12 14:07:29,309 - INFO - Start Running query Ramayana Followers
2019-08-12 14:07:45,855 - INFO - Running Ramayana Followers Done
2019-08-12 14:07:45,855 - INFO - CSV file path: Ramayana Followers
2019-08-12 14:07:45,868 - INFO - Starting save the query results
2019-08-12 14:07:45,869 - INFO - Total Rows : 314103
2019-08-12 14:07:45,871 - INFO - Will split into : 1.0 files
2019-08-12 14:07:47,388 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190812 14.00/Ramayana Followers_1.csv
2019-08-12 14:07:47,388 - INFO - , with total : 314103 rows
2019-08-12 14:07:48,266 - INFO - Error in get_custom_sql -> 
2019-08-12 14:07:48,266 - INFO - Start sending...
2019-08-12 14:07:56,403 - INFO - Message sent successfully
2019-08-12 14:07:56,404 - INFO - Delete all data in sheet: Case 8
2019-08-12 14:07:57,766 - INFO - No value detected on sheet: Case 9
2019-08-12 14:07:58,953 - INFO - No value detected on sheet: Case 10
2019-08-12 14:08:00,048 - INFO - No value detected on sheet: Case 11
2019-08-12 14:08:00,947 - INFO - No value detected on sheet: Case 12
2019-08-12 14:08:02,345 - INFO - No value detected on sheet: Case 13
2019-08-12 14:08:03,448 - INFO - No value detected on sheet: Case 14
2019-08-12 14:08:05,426 - INFO - No value detected on sheet: Case 15
2019-08-12 17:00:02,799 - INFO - Report date: 20190812 17.00
2019-08-12 17:00:06,976 - INFO - Download sheet..
2019-08-12 17:00:06,977 - INFO - Change directory to script path
2019-08-12 17:00:08,207 - INFO - Spreadsheet downloaded
2019-08-12 17:00:08,209 - INFO - Checking sheet..
2019-08-12 17:00:10,204 - INFO - No value detected on sheet: Case 1
2019-08-12 17:00:11,460 - INFO - No value detected on sheet: Case 2
2019-08-12 17:00:12,683 - INFO - No value detected on sheet: Case 3
2019-08-12 17:00:14,187 - INFO - No value detected on sheet: Case 4
2019-08-12 17:00:15,405 - INFO - No value detected on sheet: Case 5
2019-08-12 17:00:16,661 - INFO - No value detected on sheet: Case 6
2019-08-12 17:00:17,865 - INFO - No value detected on sheet: Case 7
2019-08-12 17:00:19,364 - INFO - No value detected on sheet: Case 8
2019-08-12 17:00:20,638 - INFO - No value detected on sheet: Case 9
2019-08-12 17:00:21,832 - INFO - No value detected on sheet: Case 10
2019-08-12 17:00:23,072 - INFO - No value detected on sheet: Case 11
2019-08-12 17:00:24,457 - INFO - No value detected on sheet: Case 12
2019-08-12 17:00:26,036 - INFO - No value detected on sheet: Case 13
2019-08-12 17:00:27,079 - INFO - No value detected on sheet: Case 14
2019-08-12 17:00:28,138 - INFO - No value detected on sheet: Case 15
2019-08-13 10:00:15,749 - INFO - Report date: 20190813 10.00
2019-08-13 10:00:19,533 - INFO - Download sheet..
2019-08-13 10:00:19,535 - INFO - Change directory to script path
2019-08-13 10:00:20,848 - INFO - Spreadsheet downloaded
2019-08-13 10:00:20,848 - INFO - Checking sheet..
2019-08-13 10:00:23,121 - INFO - No value detected on sheet: Case 1
2019-08-13 10:00:24,510 - INFO - No value detected on sheet: Case 2
2019-08-13 10:00:25,869 - INFO - No value detected on sheet: Case 3
2019-08-13 10:00:27,490 - INFO - No value detected on sheet: Case 4
2019-08-13 10:00:28,819 - INFO - No value detected on sheet: Case 5
2019-08-13 10:00:30,134 - INFO - No value detected on sheet: Case 6
2019-08-13 10:00:31,517 - INFO - No value detected on sheet: Case 7
2019-08-13 10:00:32,819 - INFO - Value detected - use sheet: Case 8
2019-08-13 10:00:32,819 - INFO - Reading Data From Google Sheet...
2019-08-13 10:00:33,470 - INFO - Get custom SQL..
2019-08-13 10:00:33,473 - INFO - USING CASE 8
2019-08-13 10:00:34,878 - INFO - Row 1
2019-08-13 10:00:34,878 - INFO - Filename: Online Shopping Mall Followers
2019-08-13 10:00:34,878 - INFO - Shop ID: 26616655
2019-08-13 10:00:34,880 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (26616655) 
                                and status = 1
                                
2019-08-13 10:00:34,881 - INFO - Start Running query Online Shopping Mall Followers
2019-08-13 10:01:14,249 - INFO - Running Online Shopping Mall Followers Done
2019-08-13 10:01:14,249 - INFO - CSV file path: Online Shopping Mall Followers
2019-08-13 10:01:14,260 - INFO - Starting save the query results
2019-08-13 10:01:14,262 - INFO - Total Rows : 281849
2019-08-13 10:01:14,263 - INFO - Will split into : 1.0 files
2019-08-13 10:01:15,671 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 10.00/Online Shopping Mall Followers_1.csv
2019-08-13 10:01:15,671 - INFO - , with total : 281849 rows
2019-08-13 10:01:18,388 - INFO - Row 2
2019-08-13 10:01:18,388 - INFO - Filename: Sepatu Bandung Followers
2019-08-13 10:01:18,388 - INFO - Shop ID: 5544507
2019-08-13 10:01:18,390 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (5544507) 
                                and status = 1
                                
2019-08-13 10:01:18,391 - INFO - Start Running query Sepatu Bandung Followers
2019-08-13 10:01:58,198 - INFO - Running Sepatu Bandung Followers Done
2019-08-13 10:01:58,198 - INFO - CSV file path: Sepatu Bandung Followers
2019-08-13 10:01:58,236 - INFO - Starting save the query results
2019-08-13 10:01:58,244 - INFO - Total Rows : 818029
2019-08-13 10:01:58,246 - INFO - Will split into : 1.0 files
2019-08-13 10:02:02,137 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 10.00/Sepatu Bandung Followers_1.csv
2019-08-13 10:02:02,138 - INFO - , with total : 818029 rows
2019-08-13 10:02:03,252 - INFO - Delete all data in sheet: Case 8
2019-08-13 10:02:05,338 - INFO - No value detected on sheet: Case 9
2019-08-13 10:02:06,661 - INFO - No value detected on sheet: Case 10
2019-08-13 10:02:07,963 - INFO - No value detected on sheet: Case 11
2019-08-13 10:02:09,276 - INFO - No value detected on sheet: Case 12
2019-08-13 10:02:10,588 - INFO - No value detected on sheet: Case 13
2019-08-13 10:02:11,920 - INFO - No value detected on sheet: Case 14
2019-08-13 10:02:13,255 - INFO - No value detected on sheet: Case 15
2019-08-13 14:00:03,391 - INFO - Report date: 20190813 14.00
2019-08-13 14:00:06,776 - INFO - Download sheet..
2019-08-13 14:00:06,778 - INFO - Change directory to script path
2019-08-13 14:00:13,598 - INFO - Spreadsheet downloaded
2019-08-13 14:00:13,599 - INFO - Checking sheet..
2019-08-13 14:00:14,834 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-13 14:00:15,451 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-13 14:00:16,270 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-13 14:00:16,914 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-13 14:00:19,953 - INFO - No value detected on sheet: Case 5
2019-08-13 14:00:20,589 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-13 14:00:21,260 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-13 14:00:21,877 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-13 14:00:23,617 - INFO - No value detected on sheet: Case 9
2019-08-13 14:00:25,499 - INFO - No value detected on sheet: Case 10
2019-08-13 14:00:27,362 - INFO - No value detected on sheet: Case 11
2019-08-13 14:00:29,378 - INFO - No value detected on sheet: Case 12
2019-08-13 14:00:31,602 - INFO - No value detected on sheet: Case 13
2019-08-13 14:00:32,188 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-13 14:00:33,012 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-13 16:05:02,240 - INFO - Report date: 20190813 16.05
2019-08-13 16:05:02,279 - INFO - Download sheet..
2019-08-13 16:05:02,282 - INFO - Change directory to script path
2019-08-13 16:05:04,927 - INFO - Spreadsheet downloaded
2019-08-13 16:05:04,928 - INFO - Checking sheet..
2019-08-13 16:05:07,410 - INFO - Value detected - use sheet: Case 1
2019-08-13 16:05:07,414 - INFO - Reading Data From Google Sheet...
2019-08-13 16:05:08,144 - INFO - Get custom SQL..
2019-08-13 16:05:08,144 - INFO - USING CASE 1
2019-08-13 16:05:10,325 - INFO - Row 1
2019-08-13 16:05:10,328 - INFO - Filename: A30 EL CA Buyers
2019-08-13 16:05:10,331 - INFO - Category: 'Computer & Accessories'
2019-08-13 16:05:10,335 - INFO - Last Login: 30
2019-08-13 16:05:10,338 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Computer & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-13 16:05:10,344 - INFO - Start Running query A30 EL CA Buyers
2019-08-13 17:00:02,997 - INFO - Report date: 20190813 17.00
2019-08-13 17:00:06,674 - INFO - Download sheet..
2019-08-13 17:00:06,674 - INFO - Change directory to script path
2019-08-13 17:00:08,089 - INFO - Spreadsheet downloaded
2019-08-13 17:00:08,091 - INFO - Checking sheet..
2019-08-13 17:00:09,838 - INFO - Value detected - use sheet: Case 1
2019-08-13 17:00:09,838 - INFO - Reading Data From Google Sheet...
2019-08-13 17:00:10,493 - INFO - Get custom SQL..
2019-08-13 17:00:10,493 - INFO - USING CASE 1
2019-08-13 17:00:12,519 - INFO - Row 1
2019-08-13 17:00:12,519 - INFO - Filename: A30 EL CA Buyers
2019-08-13 17:00:12,519 - INFO - Category: 'Computer & Accessories'
2019-08-13 17:00:12,520 - INFO - Last Login: 30
2019-08-13 17:00:12,520 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Computer & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-13 17:00:12,522 - INFO - Start Running query A30 EL CA Buyers
2019-08-13 17:01:18,240 - INFO - Running A30 EL CA Buyers Done
2019-08-13 17:01:18,242 - INFO - CSV file path: A30 EL CA Buyers
2019-08-13 17:01:18,342 - INFO - Starting save the query results
2019-08-13 17:01:18,344 - INFO - Total Rows : 2644409
2019-08-13 17:01:18,344 - INFO - Will split into : 3.0 files
2019-08-13 17:01:22,265 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 EL CA Buyers_1.csv
2019-08-13 17:01:22,266 - INFO - , with total : 881470 rows
2019-08-13 17:01:26,115 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 EL CA Buyers_2.csv
2019-08-13 17:01:26,118 - INFO - , with total : 881470 rows
2019-08-13 17:01:30,003 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 EL CA Buyers_3.csv
2019-08-13 17:01:30,005 - INFO - , with total : 881469 rows
2019-08-13 17:01:30,846 - INFO - Delete all data in sheet: Case 1
2019-08-13 17:01:33,250 - INFO - No value detected on sheet: Case 2
2019-08-13 17:01:34,589 - INFO - No value detected on sheet: Case 3
2019-08-13 17:01:35,917 - INFO - No value detected on sheet: Case 4
2019-08-13 17:01:37,446 - INFO - No value detected on sheet: Case 5
2019-08-13 17:01:39,130 - INFO - Value detected - use sheet: Case 6
2019-08-13 17:01:39,131 - INFO - Reading Data From Google Sheet...
2019-08-13 17:01:39,796 - INFO - Get custom SQL..
2019-08-13 17:01:39,796 - INFO - USING CASE 6
2019-08-13 17:01:41,865 - INFO - Row 1
2019-08-13 17:01:41,867 - INFO - Filename: A30 Perlengkepan Tidur & Mandi
2019-08-13 17:01:41,867 - INFO - Sub-category: 'Furniture','Decoration','Bedroom','Bathroom','Baby & Kids Toys','Baby Accessories','Baby Care','Baby Clothes','Baby Diapers','Baby Eating Essentials','Baby Food','Baby Shower Essentials','Baby Sleeping Essentials','Baby Travel Essentials','Boy Clothes','Girl Clothes','Mother Essentials','Others','Shoes & Socks','Body Care','Facial care','Hair Care','Others','Supplement & Vitamin','Tools and Kits'
2019-08-13 17:01:41,868 - INFO - Last Login: 30
2019-08-13 17:01:41,868 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Furniture','Decoration','Bedroom','Bathroom','Baby & Kids Toys','Baby Accessories','Baby Care','Baby Clothes','Baby Diapers','Baby Eating Essentials','Baby Food','Baby Shower Essentials','Baby Sleeping Essentials','Baby Travel Essentials','Boy Clothes','Girl Clothes','Mother Essentials','Others','Shoes & Socks','Body Care','Facial care','Hair Care','Others','Supplement & Vitamin','Tools and Kits')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-13 17:01:41,868 - INFO - Start Running query A30 Perlengkepan Tidur & Mandi
2019-08-13 17:05:35,864 - INFO - Running A30 Perlengkepan Tidur & Mandi Done
2019-08-13 17:05:35,865 - INFO - CSV file path: A30 Perlengkepan Tidur & Mandi
2019-08-13 17:05:36,279 - INFO - Starting save the query results
2019-08-13 17:05:36,279 - INFO - Total Rows : 9245928
2019-08-13 17:05:36,280 - INFO - Will split into : 10.0 files
2019-08-13 17:05:40,582 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkepan Tidur & Mandi_1.csv
2019-08-13 17:05:40,582 - INFO - , with total : 924593 rows
2019-08-13 17:05:44,726 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkepan Tidur & Mandi_2.csv
2019-08-13 17:05:44,727 - INFO - , with total : 924593 rows
2019-08-13 17:05:49,085 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkepan Tidur & Mandi_3.csv
2019-08-13 17:05:49,085 - INFO - , with total : 924593 rows
2019-08-13 17:05:53,520 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkepan Tidur & Mandi_4.csv
2019-08-13 17:05:53,522 - INFO - , with total : 924593 rows
2019-08-13 17:05:57,938 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkepan Tidur & Mandi_5.csv
2019-08-13 17:05:57,940 - INFO - , with total : 924593 rows
2019-08-13 17:06:02,424 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkepan Tidur & Mandi_6.csv
2019-08-13 17:06:02,426 - INFO - , with total : 924593 rows
2019-08-13 17:06:06,888 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkepan Tidur & Mandi_7.csv
2019-08-13 17:06:06,890 - INFO - , with total : 924593 rows
2019-08-13 17:06:11,500 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkepan Tidur & Mandi_8.csv
2019-08-13 17:06:11,502 - INFO - , with total : 924593 rows
2019-08-13 17:06:15,900 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkepan Tidur & Mandi_9.csv
2019-08-13 17:06:15,901 - INFO - , with total : 924592 rows
2019-08-13 17:06:20,232 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkepan Tidur & Mandi_10.csv
2019-08-13 17:06:20,233 - INFO - , with total : 924592 rows
2019-08-13 17:06:23,802 - INFO - Row 2
2019-08-13 17:06:23,802 - INFO - Filename: A30 Perlengkapan Masak & Makan
2019-08-13 17:06:23,803 - INFO - Sub-category: 'Kitchen & Cookware','Dining Room','Bread & Pastry','Breakfast Menu','Can Food','Confectionery','Dairy Food','Drinks','Fresh Food','Frozen Food','Instant Food','Others Food & Beverage','Pre Ready Food','Snacks','Staple Food'
2019-08-13 17:06:23,803 - INFO - Last Login: 30
2019-08-13 17:06:23,803 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Kitchen & Cookware','Dining Room','Bread & Pastry','Breakfast Menu','Can Food','Confectionery','Dairy Food','Drinks','Fresh Food','Frozen Food','Instant Food','Others Food & Beverage','Pre Ready Food','Snacks','Staple Food')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-13 17:06:23,805 - INFO - Start Running query A30 Perlengkapan Masak & Makan
2019-08-13 17:08:31,792 - INFO - Running A30 Perlengkapan Masak & Makan Done
2019-08-13 17:08:31,796 - INFO - CSV file path: A30 Perlengkapan Masak & Makan
2019-08-13 17:08:31,967 - INFO - Starting save the query results
2019-08-13 17:08:31,967 - INFO - Total Rows : 4842838
2019-08-13 17:08:31,970 - INFO - Will split into : 5.0 files
2019-08-13 17:08:36,312 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkapan Masak & Makan_1.csv
2019-08-13 17:08:36,312 - INFO - , with total : 968568 rows
2019-08-13 17:08:40,608 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkapan Masak & Makan_2.csv
2019-08-13 17:08:40,608 - INFO - , with total : 968568 rows
2019-08-13 17:08:44,963 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkapan Masak & Makan_3.csv
2019-08-13 17:08:44,964 - INFO - , with total : 968568 rows
2019-08-13 17:08:49,586 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkapan Masak & Makan_4.csv
2019-08-13 17:08:49,588 - INFO - , with total : 968567 rows
2019-08-13 17:08:56,194 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/A30 Perlengkapan Masak & Makan_5.csv
2019-08-13 17:08:56,194 - INFO - , with total : 968567 rows
2019-08-13 17:08:57,184 - INFO - Delete all data in sheet: Case 6
2019-08-13 17:08:59,344 - INFO - No value detected on sheet: Case 7
2019-08-13 17:09:00,117 - INFO - Value detected - use sheet: Case 8
2019-08-13 17:09:00,118 - INFO - Reading Data From Google Sheet...
2019-08-13 17:09:00,776 - INFO - Get custom SQL..
2019-08-13 17:09:00,778 - INFO - USING CASE 8
2019-08-13 17:09:02,098 - INFO - Row 1
2019-08-13 17:09:02,098 - INFO - Filename: Loreal Followers
2019-08-13 17:09:02,099 - INFO - Shop ID: 62579622
2019-08-13 17:09:02,104 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (62579622) 
                                and status = 1
                                
2019-08-13 17:09:02,105 - INFO - Start Running query Loreal Followers
2019-08-13 17:09:08,717 - INFO - Running Loreal Followers Done
2019-08-13 17:09:08,719 - INFO - CSV file path: Loreal Followers
2019-08-13 17:09:08,730 - INFO - Starting save the query results
2019-08-13 17:09:08,730 - INFO - Total Rows : 209733
2019-08-13 17:09:08,730 - INFO - Will split into : 1.0 files
2019-08-13 17:09:09,937 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/Loreal Followers_1.csv
2019-08-13 17:09:09,937 - INFO - , with total : 209733 rows
2019-08-13 17:09:11,993 - INFO - Row 2
2019-08-13 17:09:11,993 - INFO - Filename: P&G Followers
2019-08-13 17:09:11,994 - INFO - Shop ID: 11487927
2019-08-13 17:09:11,994 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (11487927) 
                                and status = 1
                                
2019-08-13 17:09:11,996 - INFO - Start Running query P&G Followers
2019-08-13 17:09:19,223 - INFO - Running P&G Followers Done
2019-08-13 17:09:19,224 - INFO - CSV file path: P&G Followers
2019-08-13 17:09:19,236 - INFO - Starting save the query results
2019-08-13 17:09:19,236 - INFO - Total Rows : 237776
2019-08-13 17:09:19,236 - INFO - Will split into : 1.0 files
2019-08-13 17:09:21,322 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/P&G Followers_1.csv
2019-08-13 17:09:21,323 - INFO - , with total : 237776 rows
2019-08-13 17:09:23,365 - INFO - Row 3
2019-08-13 17:09:23,367 - INFO - Filename: Unilever Followers
2019-08-13 17:09:23,368 - INFO - Shop ID: 14318452
2019-08-13 17:09:23,368 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (14318452) 
                                and status = 1
                                
2019-08-13 17:09:23,368 - INFO - Start Running query Unilever Followers
2019-08-13 17:10:25,259 - INFO - Running Unilever Followers Done
2019-08-13 17:10:25,260 - INFO - CSV file path: Unilever Followers
2019-08-13 17:10:25,279 - INFO - Starting save the query results
2019-08-13 17:10:25,279 - INFO - Total Rows : 458151
2019-08-13 17:10:25,279 - INFO - Will split into : 1.0 files
2019-08-13 17:10:27,381 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/Unilever Followers_1.csv
2019-08-13 17:10:27,381 - INFO - , with total : 458151 rows
2019-08-13 17:10:28,882 - INFO - Row 4
2019-08-13 17:10:28,884 - INFO - Filename: Senka Followers
2019-08-13 17:10:28,884 - INFO - Shop ID: 138850166
2019-08-13 17:10:28,884 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (138850166) 
                                and status = 1
                                
2019-08-13 17:10:28,885 - INFO - Start Running query Senka Followers
2019-08-13 17:10:49,263 - INFO - Running Senka Followers Done
2019-08-13 17:10:49,265 - INFO - CSV file path: Senka Followers
2019-08-13 17:10:49,266 - INFO - Starting save the query results
2019-08-13 17:10:49,266 - INFO - Total Rows : 9515
2019-08-13 17:10:49,266 - INFO - Will split into : 1.0 files
2019-08-13 17:10:49,346 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/Senka Followers_1.csv
2019-08-13 17:10:49,348 - INFO - , with total : 9515 rows
2019-08-13 17:10:50,556 - INFO - Row 5
2019-08-13 17:10:50,558 - INFO - Filename: HP Followers
2019-08-13 17:10:50,559 - INFO - Shop ID: 92611640
2019-08-13 17:10:50,559 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (92611640) 
                                and status = 1
                                
2019-08-13 17:10:50,559 - INFO - Start Running query HP Followers
2019-08-13 17:11:12,163 - INFO - Running HP Followers Done
2019-08-13 17:11:12,164 - INFO - CSV file path: HP Followers
2019-08-13 17:11:12,167 - INFO - Starting save the query results
2019-08-13 17:11:12,167 - INFO - Total Rows : 59075
2019-08-13 17:11:12,168 - INFO - Will split into : 1.0 files
2019-08-13 17:11:12,473 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/HP Followers_1.csv
2019-08-13 17:11:12,473 - INFO - , with total : 59075 rows
2019-08-13 17:11:14,240 - INFO - Row 6
2019-08-13 17:11:14,242 - INFO - Filename: Oppo Followers
2019-08-13 17:11:14,243 - INFO - Shop ID: 13140292
2019-08-13 17:11:14,243 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (13140292) 
                                and status = 1
                                
2019-08-13 17:11:14,243 - INFO - Start Running query Oppo Followers
2019-08-13 17:11:30,453 - INFO - Running Oppo Followers Done
2019-08-13 17:11:30,453 - INFO - CSV file path: Oppo Followers
2019-08-13 17:11:30,470 - INFO - Starting save the query results
2019-08-13 17:11:30,471 - INFO - Total Rows : 357991
2019-08-13 17:11:30,473 - INFO - Will split into : 1.0 files
2019-08-13 17:11:32,413 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/Oppo Followers_1.csv
2019-08-13 17:11:32,413 - INFO - , with total : 357991 rows
2019-08-13 17:11:34,186 - INFO - Row 7
2019-08-13 17:11:34,187 - INFO - Filename: Nutrimart Followers
2019-08-13 17:11:34,187 - INFO - Shop ID: 12656836
2019-08-13 17:11:34,188 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (12656836) 
                                and status = 1
                                
2019-08-13 17:11:34,191 - INFO - Start Running query Nutrimart Followers
2019-08-13 17:11:42,831 - INFO - Running Nutrimart Followers Done
2019-08-13 17:11:42,832 - INFO - CSV file path: Nutrimart Followers
2019-08-13 17:11:42,835 - INFO - Starting save the query results
2019-08-13 17:11:42,836 - INFO - Total Rows : 83070
2019-08-13 17:11:42,836 - INFO - Will split into : 1.0 files
2019-08-13 17:11:43,224 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/Nutrimart Followers_1.csv
2019-08-13 17:11:43,224 - INFO - , with total : 83070 rows
2019-08-13 17:11:44,983 - INFO - Row 8
2019-08-13 17:11:44,993 - INFO - Filename: Unicharm Followers
2019-08-13 17:11:44,994 - INFO - Shop ID: 65901744
2019-08-13 17:11:44,997 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (65901744) 
                                and status = 1
                                
2019-08-13 17:11:44,999 - INFO - Start Running query Unicharm Followers
2019-08-13 17:11:52,395 - INFO - Running Unicharm Followers Done
2019-08-13 17:11:52,397 - INFO - CSV file path: Unicharm Followers
2019-08-13 17:11:52,401 - INFO - Starting save the query results
2019-08-13 17:11:52,401 - INFO - Total Rows : 70085
2019-08-13 17:11:52,401 - INFO - Will split into : 1.0 files
2019-08-13 17:11:52,750 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/Unicharm Followers_1.csv
2019-08-13 17:11:52,753 - INFO - , with total : 70085 rows
2019-08-13 17:11:54,334 - INFO - Row 9
2019-08-13 17:11:54,335 - INFO - Filename: Nivea Followers
2019-08-13 17:11:54,335 - INFO - Shop ID: 39283823
2019-08-13 17:11:54,335 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (39283823) 
                                and status = 1
                                
2019-08-13 17:11:54,335 - INFO - Start Running query Nivea Followers
2019-08-13 17:12:03,957 - INFO - Running Nivea Followers Done
2019-08-13 17:12:03,957 - INFO - CSV file path: Nivea Followers
2019-08-13 17:12:03,966 - INFO - Starting save the query results
2019-08-13 17:12:03,967 - INFO - Total Rows : 201280
2019-08-13 17:12:03,967 - INFO - Will split into : 1.0 files
2019-08-13 17:12:04,923 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190813 17.00/Nivea Followers_1.csv
2019-08-13 17:12:04,924 - INFO - , with total : 201280 rows
2019-08-13 17:12:05,377 - INFO - Error in get_custom_sql -> 
2019-08-13 17:12:05,378 - INFO - Start sending...
2019-08-13 17:12:13,210 - INFO - Message sent successfully
2019-08-13 17:12:13,211 - INFO - Delete all data in sheet: Case 8
2019-08-13 17:12:14,703 - INFO - No value detected on sheet: Case 9
2019-08-13 17:12:16,048 - INFO - No value detected on sheet: Case 10
2019-08-13 17:12:16,819 - INFO - No value detected on sheet: Case 11
2019-08-13 17:12:18,145 - INFO - No value detected on sheet: Case 12
2019-08-13 17:12:19,210 - INFO - No value detected on sheet: Case 13
2019-08-13 17:12:20,322 - INFO - No value detected on sheet: Case 14
2019-08-13 17:12:21,374 - INFO - No value detected on sheet: Case 15
2019-08-14 10:00:08,257 - INFO - Report date: 20190814 10.00
2019-08-14 10:00:17,342 - INFO - Download sheet..
2019-08-14 10:00:17,342 - INFO - Change directory to script path
2019-08-14 10:00:18,650 - INFO - Spreadsheet downloaded
2019-08-14 10:00:18,651 - INFO - Checking sheet..
2019-08-14 14:00:03,993 - INFO - Report date: 20190814 14.00
2019-08-14 14:00:07,091 - INFO - Download sheet..
2019-08-14 14:00:07,092 - INFO - Change directory to script path
2019-08-14 14:00:08,747 - INFO - Spreadsheet downloaded
2019-08-14 14:00:08,747 - INFO - Checking sheet..
2019-08-14 15:12:41,987 - INFO - Report date: 20190814 15.12
2019-08-14 15:12:46,703 - INFO - Download sheet..
2019-08-14 15:12:46,703 - INFO - Change directory to script path
2019-08-14 15:12:48,334 - INFO - Spreadsheet downloaded
2019-08-14 15:12:48,335 - INFO - Checking sheet..
2019-08-14 15:14:08,176 - INFO - Report date: 20190814 15.14
2019-08-14 15:14:11,953 - INFO - Download sheet..
2019-08-14 15:14:11,953 - INFO - Change directory to script path
2019-08-14 15:14:13,904 - INFO - Spreadsheet downloaded
2019-08-14 15:14:13,905 - INFO - Checking sheet..
2019-08-14 15:14:15,558 - INFO - Value detected - use sheet: Case 1
2019-08-14 15:14:15,559 - INFO - Reading Data From Google Sheet...
2019-08-14 15:14:16,161 - INFO - Get custom SQL..
2019-08-14 15:14:16,161 - INFO - USING CASE 1
2019-08-14 15:14:18,092 - INFO - Row 1
2019-08-14 15:14:18,094 - INFO - Filename: A30 EL Fair Peak Day
2019-08-14 15:14:18,094 - INFO - Category: 'Electronics','Computer & Accessories','Mobile & Accessories','Photography','Hobby & Collection'
2019-08-14 15:14:18,094 - INFO - Last Login: 30
2019-08-14 15:14:18,095 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Computer & Accessories','Mobile & Accessories','Photography','Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-14 15:14:18,095 - INFO - Start Running query A30 EL Fair Peak Day
2019-08-14 15:18:46,434 - INFO - Running A30 EL Fair Peak Day Done
2019-08-14 15:18:46,434 - INFO - CSV file path: A30 EL Fair Peak Day
2019-08-14 15:18:46,803 - INFO - Starting save the query results
2019-08-14 15:18:46,805 - INFO - Total Rows : 9508191
2019-08-14 15:18:46,805 - INFO - Will split into : 10.0 files
2019-08-14 15:18:51,273 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/A30 EL Fair Peak Day_1.csv
2019-08-14 15:18:51,273 - INFO - , with total : 950820 rows
2019-08-14 15:18:55,605 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/A30 EL Fair Peak Day_2.csv
2019-08-14 15:18:55,607 - INFO - , with total : 950819 rows
2019-08-14 15:19:00,052 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/A30 EL Fair Peak Day_3.csv
2019-08-14 15:19:00,053 - INFO - , with total : 950819 rows
2019-08-14 15:19:04,502 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/A30 EL Fair Peak Day_4.csv
2019-08-14 15:19:04,503 - INFO - , with total : 950819 rows
2019-08-14 15:19:09,052 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/A30 EL Fair Peak Day_5.csv
2019-08-14 15:19:09,053 - INFO - , with total : 950819 rows
2019-08-14 15:19:13,530 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/A30 EL Fair Peak Day_6.csv
2019-08-14 15:19:13,532 - INFO - , with total : 950819 rows
2019-08-14 15:19:18,033 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/A30 EL Fair Peak Day_7.csv
2019-08-14 15:19:18,035 - INFO - , with total : 950819 rows
2019-08-14 15:19:22,545 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/A30 EL Fair Peak Day_8.csv
2019-08-14 15:19:22,546 - INFO - , with total : 950819 rows
2019-08-14 15:19:27,608 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/A30 EL Fair Peak Day_9.csv
2019-08-14 15:19:27,608 - INFO - , with total : 950819 rows
2019-08-14 15:19:32,273 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/A30 EL Fair Peak Day_10.csv
2019-08-14 15:19:32,275 - INFO - , with total : 950819 rows
2019-08-14 15:19:33,838 - INFO - Delete all data in sheet: Case 1
2019-08-14 15:19:35,937 - INFO - No value detected on sheet: Case 2
2019-08-14 15:19:37,121 - INFO - No value detected on sheet: Case 3
2019-08-14 15:19:38,401 - INFO - No value detected on sheet: Case 4
2019-08-14 15:19:39,638 - INFO - No value detected on sheet: Case 5
2019-08-14 15:19:40,901 - INFO - No value detected on sheet: Case 6
2019-08-14 15:19:42,315 - INFO - Value detected - use sheet: Case 7
2019-08-14 15:19:42,316 - INFO - Reading Data From Google Sheet...
2019-08-14 15:19:42,976 - INFO - Get custom SQL..
2019-08-14 15:19:42,976 - INFO - USING CASE 7
2019-08-14 15:19:46,740 - INFO - Row 1
2019-08-14 15:19:46,742 - INFO - Filename: A3 HL+HE who haven't shopped
2019-08-14 15:19:46,742 - INFO - Sub-category: 'Cable & Spareparts','Cooling','Electricity','Garment Care','Home','Kitchen','Lighting','Media Player','Outdoor Devices','Speaker & Microphone','Surveillance Camera','Telephone','TV','Vacum Cleaner','Vaporizer','Video','Games','Bathroom','Bedroom','Decoration','Dining Room','Equipments','Furniture','Gardening','Home Care','Home Care Tools','Kitchen & Cookware','Others','Party','Supplies','Storage'
2019-08-14 15:19:46,742 - INFO - Last Login: 3
2019-08-14 15:19:46,743 - INFO - Date 1: 2019-08-12
2019-08-14 15:19:46,743 - INFO - Date 2: 2019-08-14
2019-08-14 15:19:46,743 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Cable & Spareparts','Cooling','Electricity','Garment Care','Home','Kitchen','Lighting','Media Player','Outdoor Devices','Speaker & Microphone','Surveillance Camera','Telephone','TV','Vacum Cleaner','Vaporizer','Video','Games','Bathroom','Bedroom','Decoration','Dining Room','Equipments','Furniture','Gardening','Home Care','Home Care Tools','Kitchen & Cookware','Others','Party','Supplies','Storage'))
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-08-12' and date'2019-08-14'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-14 15:19:46,743 - INFO - Start Running query A3 HL+HE who haven't shopped
2019-08-14 15:19:46,941 - INFO - java.sql.SQLException: Query failed (#20190814_082003_19924_zs749): line 10:37: mismatched input 'and'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'
2019-08-14 15:19:47,030 - INFO - java.sql.SQLException: Query failed (#20190814_082003_19925_zs749): line 10:37: mismatched input 'and'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'
2019-08-14 15:19:47,115 - INFO - java.sql.SQLException: Query failed (#20190814_082003_19926_zs749): line 10:37: mismatched input 'and'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'
2019-08-14 15:19:47,198 - INFO - java.sql.SQLException: Query failed (#20190814_082004_19927_zs749): line 10:37: mismatched input 'and'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'
2019-08-14 15:19:47,283 - INFO - java.sql.SQLException: Query failed (#20190814_082004_19928_zs749): line 10:37: mismatched input 'and'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'
2019-08-14 15:19:47,285 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-08-14 15:19:47,286 - INFO - Start sending...
2019-08-14 15:19:56,450 - INFO - Message sent successfully
2019-08-14 15:19:57,124 - INFO - Delete all data in sheet: Case 7
2019-08-14 15:19:58,625 - INFO - Value detected - use sheet: Case 8
2019-08-14 15:19:58,627 - INFO - Reading Data From Google Sheet...
2019-08-14 15:19:59,365 - INFO - Get custom SQL..
2019-08-14 15:19:59,365 - INFO - USING CASE 8
2019-08-14 15:20:00,190 - INFO - Row 1
2019-08-14 15:20:00,190 - INFO - Filename: Official Shop followers MacBear
2019-08-14 15:20:00,190 - INFO - Shop ID: 15431941
2019-08-14 15:20:00,190 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (15431941) 
                                and status = 1
                                
2019-08-14 15:20:00,191 - INFO - Start Running query Official Shop followers MacBear
2019-08-14 15:20:10,628 - INFO - Running Official Shop followers MacBear Done
2019-08-14 15:20:10,630 - INFO - CSV file path: Official Shop followers MacBear
2019-08-14 15:20:10,641 - INFO - Starting save the query results
2019-08-14 15:20:10,641 - INFO - Total Rows : 203742
2019-08-14 15:20:10,641 - INFO - Will split into : 1.0 files
2019-08-14 15:20:11,654 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/Official Shop followers MacBear_1.csv
2019-08-14 15:20:11,655 - INFO - , with total : 203742 rows
2019-08-14 15:20:13,680 - INFO - Row 2
2019-08-14 15:20:13,680 - INFO - Filename: Toko Grosir Batam followers
2019-08-14 15:20:13,680 - INFO - Shop ID: 2913507
2019-08-14 15:20:13,681 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (2913507) 
                                and status = 1
                                
2019-08-14 15:20:13,681 - INFO - Start Running query Toko Grosir Batam followers
2019-08-14 15:20:28,881 - INFO - Running Toko Grosir Batam followers Done
2019-08-14 15:20:28,881 - INFO - CSV file path: Toko Grosir Batam followers
2019-08-14 15:20:28,904 - INFO - Starting save the query results
2019-08-14 15:20:28,904 - INFO - Total Rows : 557296
2019-08-14 15:20:28,904 - INFO - Will split into : 1.0 files
2019-08-14 15:20:31,542 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/Toko Grosir Batam followers_1.csv
2019-08-14 15:20:31,542 - INFO - , with total : 557296 rows
2019-08-14 15:20:32,990 - INFO - Row 3
2019-08-14 15:20:32,990 - INFO - Filename: Sepatuafa Followers
2019-08-14 15:20:32,990 - INFO - Shop ID: 9356782
2019-08-14 15:20:32,990 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (9356782) 
                                and status = 1
                                
2019-08-14 15:20:32,992 - INFO - Start Running query Sepatuafa Followers
2019-08-14 15:20:41,489 - INFO - Running Sepatuafa Followers Done
2019-08-14 15:20:41,490 - INFO - CSV file path: Sepatuafa Followers
2019-08-14 15:20:41,502 - INFO - Starting save the query results
2019-08-14 15:20:41,503 - INFO - Total Rows : 242612
2019-08-14 15:20:41,503 - INFO - Will split into : 1.0 files
2019-08-14 15:20:42,684 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 15.14/Sepatuafa Followers_1.csv
2019-08-14 15:20:42,687 - INFO - , with total : 242612 rows
2019-08-14 15:20:43,144 - INFO - Delete all data in sheet: Case 8
2019-08-14 15:20:44,572 - INFO - No value detected on sheet: Case 9
2019-08-14 15:20:46,075 - INFO - No value detected on sheet: Case 10
2019-08-14 15:20:47,101 - INFO - No value detected on sheet: Case 11
2019-08-14 15:20:48,397 - INFO - No value detected on sheet: Case 12
2019-08-14 15:20:49,617 - INFO - No value detected on sheet: Case 13
2019-08-14 15:20:50,819 - INFO - No value detected on sheet: Case 14
2019-08-14 15:20:51,615 - INFO - No value detected on sheet: Case 15
2019-08-14 17:00:01,828 - INFO - Report date: 20190814 17.00
2019-08-14 17:00:05,010 - INFO - Download sheet..
2019-08-14 17:00:05,010 - INFO - Change directory to script path
2019-08-14 17:00:06,690 - INFO - Spreadsheet downloaded
2019-08-14 17:00:06,690 - INFO - Checking sheet..
2019-08-14 17:00:08,447 - INFO - No value detected on sheet: Case 1
2019-08-14 17:00:09,717 - INFO - No value detected on sheet: Case 2
2019-08-14 17:00:11,013 - INFO - No value detected on sheet: Case 3
2019-08-14 17:00:12,407 - INFO - No value detected on sheet: Case 4
2019-08-14 17:00:13,650 - INFO - No value detected on sheet: Case 5
2019-08-14 17:00:14,924 - INFO - No value detected on sheet: Case 6
2019-08-14 17:00:16,515 - INFO - No value detected on sheet: Case 7
2019-08-14 17:00:17,812 - INFO - Value detected - use sheet: Case 8
2019-08-14 17:00:17,812 - INFO - Reading Data From Google Sheet...
2019-08-14 17:00:18,415 - INFO - Get custom SQL..
2019-08-14 17:00:18,415 - INFO - USING CASE 8
2019-08-14 17:00:19,703 - INFO - Row 1
2019-08-14 17:00:19,704 - INFO - Filename: Macbear Official Shop Followers
2019-08-14 17:00:19,704 - INFO - Shop ID: 15431941
2019-08-14 17:00:19,704 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (15431941) 
                                and status = 1
                                
2019-08-14 17:00:19,706 - INFO - Start Running query Macbear Official Shop Followers
2019-08-14 17:00:32,760 - INFO - Running Macbear Official Shop Followers Done
2019-08-14 17:00:32,762 - INFO - CSV file path: Macbear Official Shop Followers
2019-08-14 17:00:32,772 - INFO - Starting save the query results
2019-08-14 17:00:32,772 - INFO - Total Rows : 203742
2019-08-14 17:00:32,773 - INFO - Will split into : 1.0 files
2019-08-14 17:00:34,114 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 17.00/Macbear Official Shop Followers_1.csv
2019-08-14 17:00:34,115 - INFO - , with total : 203742 rows
2019-08-14 17:00:34,825 - INFO - Delete all data in sheet: Case 8
2019-08-14 17:00:36,897 - INFO - No value detected on sheet: Case 9
2019-08-14 17:00:38,397 - INFO - No value detected on sheet: Case 10
2019-08-14 17:00:39,621 - INFO - No value detected on sheet: Case 11
2019-08-14 17:00:40,855 - INFO - No value detected on sheet: Case 12
2019-08-14 17:00:42,144 - INFO - No value detected on sheet: Case 13
2019-08-14 17:00:43,381 - INFO - No value detected on sheet: Case 14
2019-08-14 17:00:44,592 - INFO - No value detected on sheet: Case 15
2019-08-14 17:25:49,275 - INFO - Report date: 20190814 17.25
2019-08-14 17:25:50,174 - INFO - Download sheet..
2019-08-14 17:25:50,174 - INFO - Change directory to script path
2019-08-14 17:25:52,387 - INFO - Spreadsheet downloaded
2019-08-14 17:25:52,398 - INFO - Checking sheet..
2019-08-14 17:25:54,509 - INFO - No value detected on sheet: Case 1
2019-08-14 17:25:55,755 - INFO - No value detected on sheet: Case 2
2019-08-14 17:25:57,032 - INFO - No value detected on sheet: Case 3
2019-08-14 17:25:58,295 - INFO - No value detected on sheet: Case 4
2019-08-14 17:25:59,562 - INFO - No value detected on sheet: Case 5
2019-08-14 17:26:00,895 - INFO - No value detected on sheet: Case 6
2019-08-14 17:26:02,210 - INFO - Value detected - use sheet: Case 7
2019-08-14 17:26:02,211 - INFO - Reading Data From Google Sheet...
2019-08-14 17:26:02,832 - INFO - Get custom SQL..
2019-08-14 17:26:02,832 - INFO - USING CASE 7
2019-08-14 17:26:05,994 - INFO - Row 1
2019-08-14 17:26:05,997 - INFO - Filename: A3 HL+HE who haven't shopped
2019-08-14 17:26:06,000 - INFO - Sub-category: 'Cable & Spareparts','Cooling','Electricity','Garment Care','Home','Kitchen','Lighting','Media Player','Outdoor Devices','Speaker & Microphone','Surveillance Camera','Telephone','TV','Vacum Cleaner','Vaporizer','Video','Games','Bathroom','Bedroom','Decoration','Dining Room','Equipments','Furniture','Gardening','Home Care','Home Care Tools','Kitchen & Cookware','Others','Party','Supplies','Storage'
2019-08-14 17:26:06,005 - INFO - Last Login: 3
2019-08-14 17:26:06,009 - INFO - Date 1: 2019-08-12
2019-08-14 17:26:06,012 - INFO - Date 2: 2019-08-14
2019-08-14 17:26:06,015 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Cable & Spareparts','Cooling','Electricity','Garment Care','Home','Kitchen','Lighting','Media Player','Outdoor Devices','Speaker & Microphone','Surveillance Camera','Telephone','TV','Vacum Cleaner','Vaporizer','Video','Games','Bathroom','Bedroom','Decoration','Dining Room','Equipments','Furniture','Gardening','Home Care','Home Care Tools','Kitchen & Cookware','Others','Party','Supplies','Storage')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-08-12' and date'2019-08-14'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-14 17:26:06,025 - INFO - Start Running query A3 HL+HE who haven't shopped
2019-08-14 17:28:46,239 - INFO - Running A3 HL+HE who haven't shopped Done
2019-08-14 17:28:46,240 - INFO - CSV file path: A3 HL+HE who haven't shopped
2019-08-14 17:28:46,631 - INFO - Starting save the query results
2019-08-14 17:28:46,631 - INFO - Total Rows : 4787616
2019-08-14 17:28:46,631 - INFO - Will split into : 5.0 files
2019-08-14 17:28:51,548 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 17.25/A3 HL+HE who haven't shopped_1.csv
2019-08-14 17:28:51,549 - INFO - , with total : 957524 rows
2019-08-14 17:28:56,332 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 17.25/A3 HL+HE who haven't shopped_2.csv
2019-08-14 17:28:56,334 - INFO - , with total : 957523 rows
2019-08-14 17:29:01,845 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 17.25/A3 HL+HE who haven't shopped_3.csv
2019-08-14 17:29:01,846 - INFO - , with total : 957523 rows
2019-08-14 17:29:07,367 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 17.25/A3 HL+HE who haven't shopped_4.csv
2019-08-14 17:29:07,368 - INFO - , with total : 957523 rows
2019-08-14 17:29:12,822 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190814 17.25/A3 HL+HE who haven't shopped_5.csv
2019-08-14 17:29:12,823 - INFO - , with total : 957523 rows
2019-08-14 17:29:13,542 - INFO - Delete all data in sheet: Case 7
2019-08-14 17:29:15,519 - INFO - No value detected on sheet: Case 8
2019-08-14 17:29:17,250 - INFO - No value detected on sheet: Case 9
2019-08-14 17:29:18,372 - INFO - No value detected on sheet: Case 10
2019-08-14 17:29:19,711 - INFO - No value detected on sheet: Case 11
2019-08-14 17:29:20,862 - INFO - No value detected on sheet: Case 12
2019-08-14 17:29:22,171 - INFO - No value detected on sheet: Case 13
2019-08-14 17:29:23,420 - INFO - No value detected on sheet: Case 14
2019-08-14 17:29:24,786 - INFO - No value detected on sheet: Case 15
2019-08-15 10:00:07,332 - INFO - Report date: 20190815 10.00
2019-08-15 10:00:12,121 - INFO - Download sheet..
2019-08-15 10:00:12,121 - INFO - Change directory to script path
2019-08-15 10:00:20,568 - INFO - Spreadsheet downloaded
2019-08-15 10:00:20,569 - INFO - Checking sheet..
2019-08-15 10:00:22,585 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%201%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:23,670 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%202%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:24,844 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%203%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:25,371 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:25,862 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:26,403 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:26,897 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:27,398 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:27,941 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:28,461 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:28,983 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:29,497 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:30,020 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:30,517 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:00:31,048 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-15 10:27:15,780 - INFO - Report date: 20190815 10.27
2019-08-15 10:27:18,217 - INFO - Download sheet..
2019-08-15 10:27:18,217 - INFO - Change directory to script path
2019-08-15 10:27:19,394 - INFO - Spreadsheet downloaded
2019-08-15 10:27:19,394 - INFO - Checking sheet..
2019-08-15 10:27:21,066 - INFO - No value detected on sheet: Case 1
2019-08-15 10:27:22,280 - INFO - No value detected on sheet: Case 2
2019-08-15 10:27:23,585 - INFO - No value detected on sheet: Case 3
2019-08-15 10:27:24,799 - INFO - No value detected on sheet: Case 4
2019-08-15 10:27:26,002 - INFO - No value detected on sheet: Case 5
2019-08-15 10:27:27,181 - INFO - Value detected - use sheet: Case 6
2019-08-15 10:27:27,183 - INFO - Reading Data From Google Sheet...
2019-08-15 10:27:27,805 - INFO - Get custom SQL..
2019-08-15 10:27:27,805 - INFO - USING CASE 6
2019-08-15 10:27:29,681 - INFO - Row 1
2019-08-15 10:27:29,683 - INFO - Filename: SBD Gramedia Teaser (Dita Soedardjo)
2019-08-15 10:27:29,684 - INFO - Sub-category: 'Batik & Kebaya','Costume.Dress','Jeans','Jumpsuit & Overall','Maternity wear','Others','Outerwear','Pants Set','Skirt','Sleepwear & Pajama','Top','Underwear','Accessories & Jewelry Set','Belt','Bracelet','Bros','Contact Lenses','Earring','Glasses','Gloves','Hair Accessories','Hat & Cap','Jewelry Set','Necklace','Precious Metals','Ring','Shawl'
2019-08-15 10:27:29,684 - INFO - Last Login: 30
2019-08-15 10:27:29,684 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Batik & Kebaya','Costume.Dress','Jeans','Jumpsuit & Overall','Maternity wear','Others','Outerwear','Pants Set','Skirt','Sleepwear & Pajama','Top','Underwear','Accessories & Jewelry Set','Belt','Bracelet','Bros','Contact Lenses','Earring','Glasses','Gloves','Hair Accessories','Hat & Cap','Jewelry Set','Necklace','Precious Metals','Ring','Shawl')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 10:27:29,684 - INFO - Start Running query SBD Gramedia Teaser (Dita Soedardjo)
2019-08-15 10:43:47,187 - INFO - Running SBD Gramedia Teaser (Dita Soedardjo) Done
2019-08-15 10:43:47,190 - INFO - CSV file path: SBD Gramedia Teaser (Dita Soedardjo)
2019-08-15 10:43:47,569 - INFO - Starting save the query results
2019-08-15 10:43:47,571 - INFO - Total Rows : 10389282
2019-08-15 10:43:47,571 - INFO - Will split into : 11.0 files
2019-08-15 10:43:52,049 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_1.csv
2019-08-15 10:43:52,051 - INFO - , with total : 944481 rows
2019-08-15 10:43:56,255 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_2.csv
2019-08-15 10:43:56,256 - INFO - , with total : 944481 rows
2019-08-15 10:44:00,604 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_3.csv
2019-08-15 10:44:00,608 - INFO - , with total : 944480 rows
2019-08-15 10:44:05,076 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_4.csv
2019-08-15 10:44:05,078 - INFO - , with total : 944480 rows
2019-08-15 10:44:09,578 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_5.csv
2019-08-15 10:44:09,579 - INFO - , with total : 944480 rows
2019-08-15 10:44:13,977 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_6.csv
2019-08-15 10:44:13,980 - INFO - , with total : 944480 rows
2019-08-15 10:44:18,318 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_7.csv
2019-08-15 10:44:18,321 - INFO - , with total : 944480 rows
2019-08-15 10:44:22,552 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_8.csv
2019-08-15 10:44:22,555 - INFO - , with total : 944480 rows
2019-08-15 10:44:26,871 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_9.csv
2019-08-15 10:44:26,872 - INFO - , with total : 944480 rows
2019-08-15 10:44:31,582 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_10.csv
2019-08-15 10:44:31,585 - INFO - , with total : 944480 rows
2019-08-15 10:44:35,966 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Dita Soedardjo)_11.csv
2019-08-15 10:44:35,967 - INFO - , with total : 944480 rows
2019-08-15 10:44:39,611 - INFO - Row 2
2019-08-15 10:44:39,611 - INFO - Filename: SBD Gramedia Teaser (Resep & Fiksi)
2019-08-15 10:44:39,612 - INFO - Sub-category: 'Bread & Pastry','Breakfast Menu','Can Food','Confectionery','Dairy Food','Drinks','Fresh Food','Frozen Food','Instant Food','Pre Ready Food','Snacks','Books','Books & Papers'
2019-08-15 10:44:39,612 - INFO - Last Login: 30
2019-08-15 10:44:39,612 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bread & Pastry','Breakfast Menu','Can Food','Confectionery','Dairy Food','Drinks','Fresh Food','Frozen Food','Instant Food','Pre Ready Food','Snacks','Books','Books & Papers')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 10:44:39,614 - INFO - Start Running query SBD Gramedia Teaser (Resep & Fiksi)
2019-08-15 10:49:38,065 - INFO - Running SBD Gramedia Teaser (Resep & Fiksi) Done
2019-08-15 10:49:38,065 - INFO - CSV file path: SBD Gramedia Teaser (Resep & Fiksi)
2019-08-15 10:49:38,197 - INFO - Starting save the query results
2019-08-15 10:49:38,197 - INFO - Total Rows : 3665341
2019-08-15 10:49:38,197 - INFO - Will split into : 4.0 files
2019-08-15 10:49:42,279 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Resep & Fiksi)_1.csv
2019-08-15 10:49:42,280 - INFO - , with total : 916336 rows
2019-08-15 10:49:46,313 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Resep & Fiksi)_2.csv
2019-08-15 10:49:46,313 - INFO - , with total : 916335 rows
2019-08-15 10:49:50,391 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Resep & Fiksi)_3.csv
2019-08-15 10:49:50,392 - INFO - , with total : 916335 rows
2019-08-15 10:49:54,565 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/SBD Gramedia Teaser (Resep & Fiksi)_4.csv
2019-08-15 10:49:54,565 - INFO - , with total : 916335 rows
2019-08-15 10:49:55,618 - INFO - Delete all data in sheet: Case 6
2019-08-15 10:49:57,832 - INFO - No value detected on sheet: Case 7
2019-08-15 10:49:59,374 - INFO - Value detected - use sheet: Case 8
2019-08-15 10:49:59,375 - INFO - Reading Data From Google Sheet...
2019-08-15 10:50:00,125 - INFO - Get custom SQL..
2019-08-15 10:50:00,125 - INFO - USING CASE 8
2019-08-15 10:50:01,496 - INFO - Row 1
2019-08-15 10:50:01,496 - INFO - Filename: Official Shop Followers
2019-08-15 10:50:01,496 - INFO - Shop ID: 15431941
2019-08-15 10:50:01,497 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (15431941) 
                                and status = 1
                                
2019-08-15 10:50:01,497 - INFO - Start Running query Official Shop Followers
2019-08-15 10:54:10,792 - INFO - Running Official Shop Followers Done
2019-08-15 10:54:10,792 - INFO - CSV file path: Official Shop Followers
2019-08-15 10:54:10,801 - INFO - Starting save the query results
2019-08-15 10:54:10,802 - INFO - Total Rows : 203904
2019-08-15 10:54:10,802 - INFO - Will split into : 1.0 files
2019-08-15 10:54:11,832 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/Official Shop Followers_1.csv
2019-08-15 10:54:11,834 - INFO - , with total : 203904 rows
2019-08-15 10:54:12,826 - INFO - Delete all data in sheet: Case 8
2019-08-15 10:54:15,469 - INFO - Value detected - use sheet: Case 9
2019-08-15 10:54:15,470 - INFO - Reading Data From Google Sheet...
2019-08-15 10:54:16,217 - INFO - Get custom SQL..
2019-08-15 10:54:16,217 - INFO - USING CASE 9
2019-08-15 10:54:17,750 - INFO - Row 1
2019-08-15 10:54:17,750 - INFO - Filename: A7 DP Buyers
2019-08-15 10:54:17,750 - INFO - Last Login: 7
2019-08-15 10:54:17,750 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-15 10:54:17,752 - INFO - Start Running query A7 DP Buyers
2019-08-15 10:58:49,335 - INFO - Running A7 DP Buyers Done
2019-08-15 10:58:49,335 - INFO - CSV file path: A7 DP Buyers
2019-08-15 10:58:49,410 - INFO - Starting save the query results
2019-08-15 10:58:49,411 - INFO - Total Rows : 2058530
2019-08-15 10:58:49,411 - INFO - Will split into : 3.0 files
2019-08-15 10:58:52,552 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A7 DP Buyers_1.csv
2019-08-15 10:58:52,552 - INFO - , with total : 686177 rows
2019-08-15 10:58:55,594 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A7 DP Buyers_2.csv
2019-08-15 10:58:55,595 - INFO - , with total : 686177 rows
2019-08-15 10:58:58,825 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A7 DP Buyers_3.csv
2019-08-15 10:58:58,825 - INFO - , with total : 686176 rows
2019-08-15 10:59:00,325 - INFO - Delete all data in sheet: Case 9
2019-08-15 10:59:02,947 - INFO - Value detected - use sheet: Case 10
2019-08-15 10:59:02,948 - INFO - Reading Data From Google Sheet...
2019-08-15 10:59:03,776 - INFO - Get custom SQL..
2019-08-15 10:59:03,776 - INFO - USING CASE 10
2019-08-15 10:59:06,513 - INFO - Row 1
2019-08-15 10:59:06,515 - INFO - Filename: A3 Fashion Buyers who haven't shopped DP
2019-08-15 10:59:06,515 - INFO - Last Login: 3
2019-08-15 10:59:06,516 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches
Women Bags','Women Clothes','Women Shoes') 
                                    and
                                    last_login >= current_date - interval '3' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-15 10:59:06,516 - INFO - Start Running query A3 Fashion Buyers who haven't shopped DP
2019-08-15 11:06:07,220 - INFO - Running A3 Fashion Buyers who haven't shopped DP Done
2019-08-15 11:06:07,220 - INFO - CSV file path: A3 Fashion Buyers who haven't shopped DP
2019-08-15 11:06:07,451 - INFO - Starting save the query results
2019-08-15 11:06:07,453 - INFO - Total Rows : 6097763
2019-08-15 11:06:07,453 - INFO - Will split into : 7.0 files
2019-08-15 11:06:11,473 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 Fashion Buyers who haven't shopped DP_1.csv
2019-08-15 11:06:11,473 - INFO - , with total : 871109 rows
2019-08-15 11:06:15,463 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 Fashion Buyers who haven't shopped DP_2.csv
2019-08-15 11:06:15,463 - INFO - , with total : 871109 rows
2019-08-15 11:06:19,734 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 Fashion Buyers who haven't shopped DP_3.csv
2019-08-15 11:06:19,736 - INFO - , with total : 871109 rows
2019-08-15 11:06:23,750 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 Fashion Buyers who haven't shopped DP_4.csv
2019-08-15 11:06:23,750 - INFO - , with total : 871109 rows
2019-08-15 11:06:27,868 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 Fashion Buyers who haven't shopped DP_5.csv
2019-08-15 11:06:27,868 - INFO - , with total : 871109 rows
2019-08-15 11:06:32,473 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 Fashion Buyers who haven't shopped DP_6.csv
2019-08-15 11:06:32,474 - INFO - , with total : 871109 rows
2019-08-15 11:06:36,716 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 Fashion Buyers who haven't shopped DP_7.csv
2019-08-15 11:06:36,717 - INFO - , with total : 871109 rows
2019-08-15 11:06:40,638 - INFO - Row 2
2019-08-15 11:06:40,638 - INFO - Filename: A3 FMCG buyers who haven't shopped DP 
2019-08-15 11:06:40,638 - INFO - Last Login: 3
2019-08-15 11:06:40,638 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty','Cosmetics','Food & Beverages','Health','Health & Beauty','Mom & Baby') 
                                    and
                                    last_login >= current_date - interval '3' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-15 11:06:40,640 - INFO - Start Running query A3 FMCG buyers who haven't shopped DP 
2019-08-15 11:12:22,365 - INFO - Running A3 FMCG buyers who haven't shopped DP  Done
2019-08-15 11:12:22,365 - INFO - CSV file path: A3 FMCG buyers who haven't shopped DP 
2019-08-15 11:12:22,559 - INFO - Starting save the query results
2019-08-15 11:12:22,559 - INFO - Total Rows : 5101271
2019-08-15 11:12:22,559 - INFO - Will split into : 6.0 files
2019-08-15 11:12:26,862 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 FMCG buyers who haven't shopped DP _1.csv
2019-08-15 11:12:26,864 - INFO - , with total : 850212 rows
2019-08-15 11:12:30,756 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 FMCG buyers who haven't shopped DP _2.csv
2019-08-15 11:12:30,756 - INFO - , with total : 850212 rows
2019-08-15 11:12:34,868 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 FMCG buyers who haven't shopped DP _3.csv
2019-08-15 11:12:34,868 - INFO - , with total : 850212 rows
2019-08-15 11:12:38,963 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 FMCG buyers who haven't shopped DP _4.csv
2019-08-15 11:12:38,963 - INFO - , with total : 850212 rows
2019-08-15 11:12:43,063 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 FMCG buyers who haven't shopped DP _5.csv
2019-08-15 11:12:43,065 - INFO - , with total : 850212 rows
2019-08-15 11:12:49,404 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 10.27/A3 FMCG buyers who haven't shopped DP _6.csv
2019-08-15 11:12:49,404 - INFO - , with total : 850211 rows
2019-08-15 11:12:50,536 - INFO - Delete all data in sheet: Case 10
2019-08-15 11:12:52,762 - INFO - No value detected on sheet: Case 11
2019-08-15 11:12:54,365 - INFO - No value detected on sheet: Case 12
2019-08-15 11:12:55,661 - INFO - No value detected on sheet: Case 13
2019-08-15 11:12:57,002 - INFO - No value detected on sheet: Case 14
2019-08-15 11:12:58,257 - INFO - No value detected on sheet: Case 15
2019-08-15 14:11:56,061 - INFO - Report date: 20190815 14.11
2019-08-15 14:11:56,135 - INFO - Download sheet..
2019-08-15 14:11:56,135 - INFO - Change directory to script path
2019-08-15 14:11:58,657 - INFO - Spreadsheet downloaded
2019-08-15 14:11:58,658 - INFO - Checking sheet..
2019-08-15 14:12:01,167 - INFO - Value detected - use sheet: Case 1
2019-08-15 14:12:01,167 - INFO - Reading Data From Google Sheet...
2019-08-15 14:12:03,447 - INFO - Get custom SQL..
2019-08-15 14:12:03,450 - INFO - USING CASE 1
2019-08-15 14:12:06,506 - INFO - Row 1
2019-08-15 14:12:06,506 - INFO - Filename: A30 FMCG Cosmetics
2019-08-15 14:12:06,507 - INFO - Category: 'Cosmetics'
2019-08-15 14:12:06,509 - INFO - Last Login: 30
2019-08-15 14:12:06,509 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Cosmetics')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:12:06,513 - INFO - Start Running query A30 FMCG Cosmetics
2019-08-15 14:13:31,196 - INFO - Running A30 FMCG Cosmetics Done
2019-08-15 14:13:31,197 - INFO - CSV file path: A30 FMCG Cosmetics
2019-08-15 14:13:31,421 - INFO - Starting save the query results
2019-08-15 14:13:31,423 - INFO - Total Rows : 1171552
2019-08-15 14:13:31,424 - INFO - Will split into : 2.0 files
2019-08-15 14:13:37,279 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 FMCG Cosmetics_1.csv
2019-08-15 14:13:37,282 - INFO - , with total : 585776 rows
2019-08-15 14:13:40,851 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 FMCG Cosmetics_2.csv
2019-08-15 14:13:40,855 - INFO - , with total : 585776 rows
2019-08-15 14:13:44,973 - INFO - Row 2
2019-08-15 14:13:44,974 - INFO - Filename: A30 Food & Beverages
2019-08-15 14:13:44,976 - INFO - Category: 'Food & Beverages'
2019-08-15 14:13:44,979 - INFO - Last Login: 30
2019-08-15 14:13:44,982 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:13:44,992 - INFO - Start Running query A30 Food & Beverages
2019-08-15 14:16:31,155 - INFO - Running A30 Food & Beverages Done
2019-08-15 14:16:31,157 - INFO - CSV file path: A30 Food & Beverages
2019-08-15 14:16:31,615 - INFO - Starting save the query results
2019-08-15 14:16:31,617 - INFO - Total Rows : 2994916
2019-08-15 14:16:31,618 - INFO - Will split into : 3.0 files
2019-08-15 14:16:43,933 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Food & Beverages_1.csv
2019-08-15 14:16:43,934 - INFO - , with total : 998306 rows
2019-08-15 14:16:52,101 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Food & Beverages_2.csv
2019-08-15 14:16:52,102 - INFO - , with total : 998305 rows
2019-08-15 14:16:57,380 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Food & Beverages_3.csv
2019-08-15 14:16:57,385 - INFO - , with total : 998305 rows
2019-08-15 14:17:00,503 - INFO - Row 3
2019-08-15 14:17:00,506 - INFO - Filename: A30 FMC H&B
2019-08-15 14:17:00,509 - INFO - Category: 'Health & Beauty'
2019-08-15 14:17:00,510 - INFO - Last Login: 30
2019-08-15 14:17:00,513 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Health & Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:17:00,517 - INFO - Start Running query A30 FMC H&B
2019-08-15 14:18:13,490 - INFO - Running A30 FMC H&B Done
2019-08-15 14:18:13,494 - INFO - CSV file path: A30 FMC H&B
2019-08-15 14:18:13,644 - INFO - Starting save the query results
2019-08-15 14:18:13,648 - INFO - Total Rows : 1547915
2019-08-15 14:18:13,648 - INFO - Will split into : 2.0 files
2019-08-15 14:18:17,961 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 FMC H&B_1.csv
2019-08-15 14:18:17,961 - INFO - , with total : 773958 rows
2019-08-15 14:18:22,769 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 FMC H&B_2.csv
2019-08-15 14:18:22,772 - INFO - , with total : 773957 rows
2019-08-15 14:18:25,605 - INFO - Row 4
2019-08-15 14:18:25,608 - INFO - Filename: A30 Fashion BKF
2019-08-15 14:18:25,611 - INFO - Category: 'Baby & Kids Fashion'
2019-08-15 14:18:25,612 - INFO - Last Login: 30
2019-08-15 14:18:25,615 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:18:25,624 - INFO - Start Running query A30 Fashion BKF
2019-08-15 14:20:33,736 - INFO - Running A30 Fashion BKF Done
2019-08-15 14:20:33,739 - INFO - CSV file path: A30 Fashion BKF
2019-08-15 14:20:34,005 - INFO - Starting save the query results
2019-08-15 14:20:34,009 - INFO - Total Rows : 3498516
2019-08-15 14:20:34,009 - INFO - Will split into : 4.0 files
2019-08-15 14:20:39,078 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Fashion BKF_1.csv
2019-08-15 14:20:39,082 - INFO - , with total : 874629 rows
2019-08-15 14:20:43,802 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Fashion BKF_2.csv
2019-08-15 14:20:43,802 - INFO - , with total : 874629 rows
2019-08-15 14:20:48,989 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Fashion BKF_3.csv
2019-08-15 14:20:48,990 - INFO - , with total : 874629 rows
2019-08-15 14:20:53,964 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Fashion BKF_4.csv
2019-08-15 14:20:53,966 - INFO - , with total : 874629 rows
2019-08-15 14:20:56,463 - INFO - Row 5
2019-08-15 14:20:56,464 - INFO - Filename: A30 FMCG MomBaby
2019-08-15 14:20:56,466 - INFO - Category: 'Mom & Baby'
2019-08-15 14:20:56,467 - INFO - Last Login: 30
2019-08-15 14:20:56,467 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:20:56,470 - INFO - Start Running query A30 FMCG MomBaby
2019-08-15 14:23:25,223 - INFO - Running A30 FMCG MomBaby Done
2019-08-15 14:23:25,226 - INFO - CSV file path: A30 FMCG MomBaby
2019-08-15 14:23:25,519 - INFO - Starting save the query results
2019-08-15 14:23:25,520 - INFO - Total Rows : 3714321
2019-08-15 14:23:25,522 - INFO - Will split into : 4.0 files
2019-08-15 14:23:31,344 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 FMCG MomBaby_1.csv
2019-08-15 14:23:31,348 - INFO - , with total : 928581 rows
2019-08-15 14:23:36,453 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 FMCG MomBaby_2.csv
2019-08-15 14:23:36,453 - INFO - , with total : 928580 rows
2019-08-15 14:23:41,871 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 FMCG MomBaby_3.csv
2019-08-15 14:23:41,875 - INFO - , with total : 928580 rows
2019-08-15 14:23:47,246 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 FMCG MomBaby_4.csv
2019-08-15 14:23:47,246 - INFO - , with total : 928580 rows
2019-08-15 14:23:50,566 - INFO - Row 6
2019-08-15 14:23:50,569 - INFO - Filename: A30 Health Buyers
2019-08-15 14:23:50,569 - INFO - Category: 'Health'
2019-08-15 14:23:50,572 - INFO - Last Login: 30
2019-08-15 14:23:50,572 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Health')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:23:50,576 - INFO - Start Running query A30 Health Buyers
2019-08-15 14:26:24,385 - INFO - Running A30 Health Buyers Done
2019-08-15 14:26:24,388 - INFO - CSV file path: A30 Health Buyers
2019-08-15 14:26:24,653 - INFO - Starting save the query results
2019-08-15 14:26:24,654 - INFO - Total Rows : 3609585
2019-08-15 14:26:24,654 - INFO - Will split into : 4.0 files
2019-08-15 14:26:29,019 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Health Buyers_1.csv
2019-08-15 14:26:29,020 - INFO - , with total : 902397 rows
2019-08-15 14:26:33,332 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Health Buyers_2.csv
2019-08-15 14:26:33,334 - INFO - , with total : 902396 rows
2019-08-15 14:26:38,229 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Health Buyers_3.csv
2019-08-15 14:26:38,230 - INFO - , with total : 902396 rows
2019-08-15 14:26:44,148 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Health Buyers_4.csv
2019-08-15 14:26:44,150 - INFO - , with total : 902396 rows
2019-08-15 14:26:46,891 - INFO - Row 7
2019-08-15 14:26:46,891 - INFO - Filename: A30 Health & Beauty Buyers
2019-08-15 14:26:46,892 - INFO - Category: 'Health & Beauty'
2019-08-15 14:26:46,892 - INFO - Last Login: 30
2019-08-15 14:26:46,894 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Health & Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:26:46,895 - INFO - Start Running query A30 Health & Beauty Buyers
2019-08-15 14:27:58,822 - INFO - Running A30 Health & Beauty Buyers Done
2019-08-15 14:27:58,823 - INFO - CSV file path: A30 Health & Beauty Buyers
2019-08-15 14:27:58,940 - INFO - Starting save the query results
2019-08-15 14:27:58,940 - INFO - Total Rows : 1547915
2019-08-15 14:27:58,940 - INFO - Will split into : 2.0 files
2019-08-15 14:28:03,420 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Health & Beauty Buyers_1.csv
2019-08-15 14:28:03,421 - INFO - , with total : 773958 rows
2019-08-15 14:28:07,457 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Health & Beauty Buyers_2.csv
2019-08-15 14:28:07,459 - INFO - , with total : 773957 rows
2019-08-15 14:28:10,276 - INFO - Row 8
2019-08-15 14:28:10,278 - INFO - Filename: A30 Fashion Accessories Buyers
2019-08-15 14:28:10,279 - INFO - Category: 'Fashion Accessories'
2019-08-15 14:28:10,279 - INFO - Last Login: 30
2019-08-15 14:28:10,280 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:28:10,282 - INFO - Start Running query A30 Fashion Accessories Buyers
2019-08-15 14:30:29,138 - INFO - Running A30 Fashion Accessories Buyers Done
2019-08-15 14:30:29,141 - INFO - CSV file path: A30 Fashion Accessories Buyers
2019-08-15 14:30:29,467 - INFO - Starting save the query results
2019-08-15 14:30:29,469 - INFO - Total Rows : 4551291
2019-08-15 14:30:29,469 - INFO - Will split into : 5.0 files
2019-08-15 14:30:33,848 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Fashion Accessories Buyers_1.csv
2019-08-15 14:30:33,848 - INFO - , with total : 910259 rows
2019-08-15 14:30:38,200 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Fashion Accessories Buyers_2.csv
2019-08-15 14:30:38,200 - INFO - , with total : 910258 rows
2019-08-15 14:30:43,104 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Fashion Accessories Buyers_3.csv
2019-08-15 14:30:43,105 - INFO - , with total : 910258 rows
2019-08-15 14:30:48,763 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Fashion Accessories Buyers_4.csv
2019-08-15 14:30:48,765 - INFO - , with total : 910258 rows
2019-08-15 14:30:53,948 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Fashion Accessories Buyers_5.csv
2019-08-15 14:30:53,950 - INFO - , with total : 910258 rows
2019-08-15 14:30:56,801 - INFO - Row 9
2019-08-15 14:30:56,802 - INFO - Filename: A30 Women Clothes Buyers
2019-08-15 14:30:56,802 - INFO - Category: 'Women Clothes'
2019-08-15 14:30:56,802 - INFO - Last Login: 30
2019-08-15 14:30:56,802 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Clothes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:30:56,803 - INFO - Start Running query A30 Women Clothes Buyers
2019-08-15 14:34:27,625 - INFO - Running A30 Women Clothes Buyers Done
2019-08-15 14:34:27,627 - INFO - CSV file path: A30 Women Clothes Buyers
2019-08-15 14:34:28,460 - INFO - Starting save the query results
2019-08-15 14:34:28,460 - INFO - Total Rows : 7112626
2019-08-15 14:34:28,461 - INFO - Will split into : 8.0 files
2019-08-15 14:34:33,957 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Clothes Buyers_1.csv
2019-08-15 14:34:33,957 - INFO - , with total : 889079 rows
2019-08-15 14:34:39,260 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Clothes Buyers_2.csv
2019-08-15 14:34:39,262 - INFO - , with total : 889079 rows
2019-08-15 14:34:44,453 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Clothes Buyers_3.csv
2019-08-15 14:34:44,453 - INFO - , with total : 889078 rows
2019-08-15 14:34:50,332 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Clothes Buyers_4.csv
2019-08-15 14:34:50,332 - INFO - , with total : 889078 rows
2019-08-15 14:34:56,779 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Clothes Buyers_5.csv
2019-08-15 14:34:56,779 - INFO - , with total : 889078 rows
2019-08-15 14:35:05,907 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Clothes Buyers_6.csv
2019-08-15 14:35:05,908 - INFO - , with total : 889078 rows
2019-08-15 14:35:13,367 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Clothes Buyers_7.csv
2019-08-15 14:35:13,368 - INFO - , with total : 889078 rows
2019-08-15 14:35:21,548 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Clothes Buyers_8.csv
2019-08-15 14:35:21,549 - INFO - , with total : 889078 rows
2019-08-15 14:35:27,072 - INFO - Row 10
2019-08-15 14:35:27,072 - INFO - Filename: A30 Women Shoes Buyers
2019-08-15 14:35:27,072 - INFO - Category: 'Women Shoes'
2019-08-15 14:35:27,073 - INFO - Last Login: 30
2019-08-15 14:35:27,075 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:35:27,075 - INFO - Start Running query A30 Women Shoes Buyers
2019-08-15 14:37:44,740 - INFO - Running A30 Women Shoes Buyers Done
2019-08-15 14:37:44,742 - INFO - CSV file path: A30 Women Shoes Buyers
2019-08-15 14:37:45,059 - INFO - Starting save the query results
2019-08-15 14:37:45,059 - INFO - Total Rows : 4171381
2019-08-15 14:37:45,059 - INFO - Will split into : 5.0 files
2019-08-15 14:37:49,697 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Shoes Buyers_1.csv
2019-08-15 14:37:49,697 - INFO - , with total : 834277 rows
2019-08-15 14:37:56,418 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Shoes Buyers_2.csv
2019-08-15 14:37:56,420 - INFO - , with total : 834276 rows
2019-08-15 14:38:01,174 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Shoes Buyers_3.csv
2019-08-15 14:38:01,176 - INFO - , with total : 834276 rows
2019-08-15 14:38:06,158 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Shoes Buyers_4.csv
2019-08-15 14:38:06,160 - INFO - , with total : 834276 rows
2019-08-15 14:38:14,585 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Shoes Buyers_5.csv
2019-08-15 14:38:14,586 - INFO - , with total : 834276 rows
2019-08-15 14:38:17,756 - INFO - Row 11
2019-08-15 14:38:17,756 - INFO - Filename: A30 Women Bags Buyers
2019-08-15 14:38:17,757 - INFO - Category: 'Women Bags'
2019-08-15 14:38:17,759 - INFO - Last Login: 30
2019-08-15 14:38:17,759 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Bags')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:38:17,760 - INFO - Start Running query A30 Women Bags Buyers
2019-08-15 14:40:52,028 - INFO - Running A30 Women Bags Buyers Done
2019-08-15 14:40:52,028 - INFO - CSV file path: A30 Women Bags Buyers
2019-08-15 14:40:52,443 - INFO - Starting save the query results
2019-08-15 14:40:52,444 - INFO - Total Rows : 5613366
2019-08-15 14:40:52,444 - INFO - Will split into : 6.0 files
2019-08-15 14:40:56,957 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Bags Buyers_1.csv
2019-08-15 14:40:56,957 - INFO - , with total : 935561 rows
2019-08-15 14:41:01,470 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Bags Buyers_2.csv
2019-08-15 14:41:01,473 - INFO - , with total : 935561 rows
2019-08-15 14:41:06,414 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Bags Buyers_3.csv
2019-08-15 14:41:06,415 - INFO - , with total : 935561 rows
2019-08-15 14:41:11,686 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Bags Buyers_4.csv
2019-08-15 14:41:11,688 - INFO - , with total : 935561 rows
2019-08-15 14:41:17,565 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Bags Buyers_5.csv
2019-08-15 14:41:17,569 - INFO - , with total : 935561 rows
2019-08-15 14:41:23,071 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Women Bags Buyers_6.csv
2019-08-15 14:41:23,072 - INFO - , with total : 935561 rows
2019-08-15 14:41:26,431 - INFO - Row 12
2019-08-15 14:41:26,434 - INFO - Filename: A30 Beauty Buyers
2019-08-15 14:41:26,436 - INFO - Category: 'Beauty'
2019-08-15 14:41:26,437 - INFO - Last Login: 30
2019-08-15 14:41:26,440 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:41:26,446 - INFO - Start Running query A30 Beauty Buyers
2019-08-15 14:46:14,663 - INFO - Running A30 Beauty Buyers Done
2019-08-15 14:46:14,664 - INFO - CSV file path: A30 Beauty Buyers
2019-08-15 14:46:15,315 - INFO - Starting save the query results
2019-08-15 14:46:15,315 - INFO - Total Rows : 7463352
2019-08-15 14:46:15,316 - INFO - Will split into : 8.0 files
2019-08-15 14:46:20,589 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Beauty Buyers_1.csv
2019-08-15 14:46:20,591 - INFO - , with total : 932919 rows
2019-08-15 14:46:33,198 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Beauty Buyers_2.csv
2019-08-15 14:46:33,201 - INFO - , with total : 932919 rows
2019-08-15 14:46:42,388 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Beauty Buyers_3.csv
2019-08-15 14:46:42,390 - INFO - , with total : 932919 rows
2019-08-15 14:46:48,418 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Beauty Buyers_4.csv
2019-08-15 14:46:48,420 - INFO - , with total : 932919 rows
2019-08-15 14:46:53,546 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Beauty Buyers_5.csv
2019-08-15 14:46:53,548 - INFO - , with total : 932919 rows
2019-08-15 14:46:59,197 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Beauty Buyers_6.csv
2019-08-15 14:46:59,198 - INFO - , with total : 932919 rows
2019-08-15 14:47:04,532 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Beauty Buyers_7.csv
2019-08-15 14:47:04,533 - INFO - , with total : 932919 rows
2019-08-15 14:47:10,109 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Beauty Buyers_8.csv
2019-08-15 14:47:10,111 - INFO - , with total : 932919 rows
2019-08-15 14:47:13,351 - INFO - Row 13
2019-08-15 14:47:13,351 - INFO - Filename: A30 Muslim Fashion Buyers
2019-08-15 14:47:13,351 - INFO - Category: 'Muslim Fashion'
2019-08-15 14:47:13,354 - INFO - Last Login: 30
2019-08-15 14:47:13,355 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Muslim Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:47:13,357 - INFO - Start Running query A30 Muslim Fashion Buyers
2019-08-15 14:50:40,529 - INFO - Running A30 Muslim Fashion Buyers Done
2019-08-15 14:50:40,529 - INFO - CSV file path: A30 Muslim Fashion Buyers
2019-08-15 14:50:40,974 - INFO - Starting save the query results
2019-08-15 14:50:40,976 - INFO - Total Rows : 5690020
2019-08-15 14:50:40,976 - INFO - Will split into : 6.0 files
2019-08-15 14:50:45,716 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Muslim Fashion Buyers_1.csv
2019-08-15 14:50:45,716 - INFO - , with total : 948337 rows
2019-08-15 14:50:52,388 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Muslim Fashion Buyers_2.csv
2019-08-15 14:50:52,390 - INFO - , with total : 948337 rows
2019-08-15 14:51:00,871 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Muslim Fashion Buyers_3.csv
2019-08-15 14:51:00,872 - INFO - , with total : 948337 rows
2019-08-15 14:51:10,670 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Muslim Fashion Buyers_4.csv
2019-08-15 14:51:10,673 - INFO - , with total : 948337 rows
2019-08-15 14:51:19,674 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Muslim Fashion Buyers_5.csv
2019-08-15 14:51:19,676 - INFO - , with total : 948336 rows
2019-08-15 14:51:25,461 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Muslim Fashion Buyers_6.csv
2019-08-15 14:51:25,463 - INFO - , with total : 948336 rows
2019-08-15 14:51:31,200 - INFO - Row 14
2019-08-15 14:51:31,200 - INFO - Filename: A30 Men Clothes Buyers
2019-08-15 14:51:31,200 - INFO - Category: 'Men Clothes'
2019-08-15 14:51:31,201 - INFO - Last Login: 30
2019-08-15 14:51:31,203 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Men Clothes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:51:31,206 - INFO - Start Running query A30 Men Clothes Buyers
2019-08-15 14:54:23,759 - INFO - Running A30 Men Clothes Buyers Done
2019-08-15 14:54:23,760 - INFO - CSV file path: A30 Men Clothes Buyers
2019-08-15 14:54:24,082 - INFO - Starting save the query results
2019-08-15 14:54:24,084 - INFO - Total Rows : 4424417
2019-08-15 14:54:24,084 - INFO - Will split into : 5.0 files
2019-08-15 14:54:28,338 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Clothes Buyers_1.csv
2019-08-15 14:54:28,338 - INFO - , with total : 884884 rows
2019-08-15 14:54:32,548 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Clothes Buyers_2.csv
2019-08-15 14:54:32,549 - INFO - , with total : 884884 rows
2019-08-15 14:54:37,042 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Clothes Buyers_3.csv
2019-08-15 14:54:37,042 - INFO - , with total : 884883 rows
2019-08-15 14:54:41,611 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Clothes Buyers_4.csv
2019-08-15 14:54:41,614 - INFO - , with total : 884883 rows
2019-08-15 14:54:47,098 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Clothes Buyers_5.csv
2019-08-15 14:54:47,098 - INFO - , with total : 884883 rows
2019-08-15 14:54:49,982 - INFO - Row 15
2019-08-15 14:54:49,982 - INFO - Filename: A30 Men Bags Buyers
2019-08-15 14:54:49,983 - INFO - Category: 'Men Bags'
2019-08-15 14:54:49,983 - INFO - Last Login: 30
2019-08-15 14:54:49,984 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Men Bags')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:54:49,986 - INFO - Start Running query A30 Men Bags Buyers
2019-08-15 14:56:24,558 - INFO - Running A30 Men Bags Buyers Done
2019-08-15 14:56:24,559 - INFO - CSV file path: A30 Men Bags Buyers
2019-08-15 14:56:24,779 - INFO - Starting save the query results
2019-08-15 14:56:24,779 - INFO - Total Rows : 2487928
2019-08-15 14:56:24,779 - INFO - Will split into : 3.0 files
2019-08-15 14:56:30,351 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Bags Buyers_1.csv
2019-08-15 14:56:30,354 - INFO - , with total : 829310 rows
2019-08-15 14:56:34,398 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Bags Buyers_2.csv
2019-08-15 14:56:34,398 - INFO - , with total : 829309 rows
2019-08-15 14:56:38,913 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Bags Buyers_3.csv
2019-08-15 14:56:38,913 - INFO - , with total : 829309 rows
2019-08-15 14:56:42,315 - INFO - Row 16
2019-08-15 14:56:42,315 - INFO - Filename: A30 Men Shoes Buyers
2019-08-15 14:56:42,316 - INFO - Category: 'Men Shoes'
2019-08-15 14:56:42,318 - INFO - Last Login: 30
2019-08-15 14:56:42,319 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Men Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:56:42,321 - INFO - Start Running query A30 Men Shoes Buyers
2019-08-15 14:58:31,174 - INFO - Running A30 Men Shoes Buyers Done
2019-08-15 14:58:31,176 - INFO - CSV file path: A30 Men Shoes Buyers
2019-08-15 14:58:31,381 - INFO - Starting save the query results
2019-08-15 14:58:31,382 - INFO - Total Rows : 2852360
2019-08-15 14:58:31,382 - INFO - Will split into : 3.0 files
2019-08-15 14:58:35,898 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Shoes Buyers_1.csv
2019-08-15 14:58:35,898 - INFO - , with total : 950787 rows
2019-08-15 14:58:40,447 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Shoes Buyers_2.csv
2019-08-15 14:58:40,447 - INFO - , with total : 950787 rows
2019-08-15 14:58:45,299 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Men Shoes Buyers_3.csv
2019-08-15 14:58:45,299 - INFO - , with total : 950786 rows
2019-08-15 14:58:48,063 - INFO - Row 17
2019-08-15 14:58:48,065 - INFO - Filename: A3 FMCG + Home Care Buyers
2019-08-15 14:58:48,065 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby','Home Care'
2019-08-15 14:58:48,065 - INFO - Last Login: 3
2019-08-15 14:58:48,066 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby','Home Care')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 14:58:48,069 - INFO - Start Running query A3 FMCG + Home Care Buyers
2019-08-15 15:02:03,918 - INFO - Running A3 FMCG + Home Care Buyers Done
2019-08-15 15:02:03,920 - INFO - CSV file path: A3 FMCG + Home Care Buyers
2019-08-15 15:02:04,380 - INFO - Starting save the query results
2019-08-15 15:02:04,380 - INFO - Total Rows : 6356821
2019-08-15 15:02:04,381 - INFO - Will split into : 7.0 files
2019-08-15 15:02:08,779 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A3 FMCG + Home Care Buyers_1.csv
2019-08-15 15:02:08,780 - INFO - , with total : 908118 rows
2019-08-15 15:02:13,161 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A3 FMCG + Home Care Buyers_2.csv
2019-08-15 15:02:13,161 - INFO - , with total : 908118 rows
2019-08-15 15:02:18,089 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A3 FMCG + Home Care Buyers_3.csv
2019-08-15 15:02:18,091 - INFO - , with total : 908117 rows
2019-08-15 15:02:23,194 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A3 FMCG + Home Care Buyers_4.csv
2019-08-15 15:02:23,196 - INFO - , with total : 908117 rows
2019-08-15 15:02:28,194 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A3 FMCG + Home Care Buyers_5.csv
2019-08-15 15:02:28,194 - INFO - , with total : 908117 rows
2019-08-15 15:02:33,401 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A3 FMCG + Home Care Buyers_6.csv
2019-08-15 15:02:33,401 - INFO - , with total : 908117 rows
2019-08-15 15:02:38,655 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A3 FMCG + Home Care Buyers_7.csv
2019-08-15 15:02:38,655 - INFO - , with total : 908117 rows
2019-08-15 15:02:39,749 - INFO - Delete all data in sheet: Case 1
2019-08-15 15:02:42,015 - INFO - No value detected on sheet: Case 2
2019-08-15 15:02:43,423 - INFO - Value detected - use sheet: Case 3
2019-08-15 15:02:43,424 - INFO - Reading Data From Google Sheet...
2019-08-15 15:02:44,134 - INFO - Get custom SQL..
2019-08-15 15:02:44,135 - INFO - USING CASE 3
2019-08-15 15:02:47,589 - INFO - Row 1
2019-08-15 15:02:47,592 - INFO - Filename: Clothing & FACC Buyers who haven't shopped L30D
2019-08-15 15:02:47,595 - INFO - Category: 'Men Clothes','Women Clothes','Fashion Accessories'
2019-08-15 15:02:47,596 - INFO - Last Login: 30
2019-08-15 15:02:47,598 - INFO - Date 1: 2019-07-14
2019-08-15 15:02:47,601 - INFO - Date 2: 2019-08-14
2019-08-15 15:02:47,602 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Men Clothes','Women Clothes','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-14' and date'2019-08-14'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-15 15:02:47,615 - INFO - Start Running query Clothing & FACC Buyers who haven't shopped L30D
2019-08-15 15:05:03,174 - INFO - Running Clothing & FACC Buyers who haven't shopped L30D Done
2019-08-15 15:05:03,174 - INFO - CSV file path: Clothing & FACC Buyers who haven't shopped L30D
2019-08-15 15:05:03,433 - INFO - Starting save the query results
2019-08-15 15:05:03,434 - INFO - Total Rows : 3374697
2019-08-15 15:05:03,434 - INFO - Will split into : 4.0 files
2019-08-15 15:05:07,509 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/Clothing & FACC Buyers who haven't shopped L30D_1.csv
2019-08-15 15:05:07,509 - INFO - , with total : 843675 rows
2019-08-15 15:05:11,792 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/Clothing & FACC Buyers who haven't shopped L30D_2.csv
2019-08-15 15:05:11,792 - INFO - , with total : 843674 rows
2019-08-15 15:05:17,528 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/Clothing & FACC Buyers who haven't shopped L30D_3.csv
2019-08-15 15:05:17,529 - INFO - , with total : 843674 rows
2019-08-15 15:05:23,290 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/Clothing & FACC Buyers who haven't shopped L30D_4.csv
2019-08-15 15:05:23,296 - INFO - , with total : 843674 rows
2019-08-15 15:05:26,473 - INFO - Row 2
2019-08-15 15:05:26,474 - INFO - Filename: A30 Food & Beverages buyers who haven't shopped L30D
2019-08-15 15:05:26,474 - INFO - Category: 'Food & Beverages'
2019-08-15 15:05:26,476 - INFO - Last Login: 30
2019-08-15 15:05:26,476 - INFO - Date 1: 2019-07-14
2019-08-15 15:05:26,477 - INFO - Date 2: 2019-08-14
2019-08-15 15:05:26,479 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-14' and date'2019-08-14'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-15 15:05:26,482 - INFO - Start Running query A30 Food & Beverages buyers who haven't shopped L30D
2019-08-15 15:06:25,049 - INFO - Running A30 Food & Beverages buyers who haven't shopped L30D Done
2019-08-15 15:06:25,049 - INFO - CSV file path: A30 Food & Beverages buyers who haven't shopped L30D
2019-08-15 15:06:25,105 - INFO - Starting save the query results
2019-08-15 15:06:25,105 - INFO - Total Rows : 721128
2019-08-15 15:06:25,105 - INFO - Will split into : 1.0 files
2019-08-15 15:06:28,505 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Food & Beverages buyers who haven't shopped L30D_1.csv
2019-08-15 15:06:28,506 - INFO - , with total : 721128 rows
2019-08-15 15:06:29,253 - INFO - Delete all data in sheet: Case 3
2019-08-15 15:06:30,967 - INFO - Value detected - use sheet: Case 4
2019-08-15 15:06:30,970 - INFO - Reading Data From Google Sheet...
2019-08-15 15:06:31,424 - INFO - Get custom SQL..
2019-08-15 15:06:31,426 - INFO - USING CASE 4
2019-08-15 15:06:33,220 - INFO - Row 1
2019-08-15 15:06:33,223 - INFO - Filename: A30 Male Buyers
2019-08-15 15:06:33,223 - INFO - Last Login: 30
2019-08-15 15:06:33,226 - INFO - Gender: 1,3
2019-08-15 15:06:33,229 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid 
                                    where
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-15 15:06:33,236 - INFO - Start Running query A30 Male Buyers
2019-08-15 15:09:07,651 - INFO - Running A30 Male Buyers Done
2019-08-15 15:09:07,651 - INFO - CSV file path: A30 Male Buyers
2019-08-15 15:09:07,983 - INFO - Starting save the query results
2019-08-15 15:09:07,984 - INFO - Total Rows : 4562069
2019-08-15 15:09:07,984 - INFO - Will split into : 5.0 files
2019-08-15 15:09:12,341 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Male Buyers_1.csv
2019-08-15 15:09:12,341 - INFO - , with total : 912414 rows
2019-08-15 15:09:16,701 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Male Buyers_2.csv
2019-08-15 15:09:16,703 - INFO - , with total : 912414 rows
2019-08-15 15:09:21,335 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Male Buyers_3.csv
2019-08-15 15:09:21,336 - INFO - , with total : 912414 rows
2019-08-15 15:09:26,240 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Male Buyers_4.csv
2019-08-15 15:09:26,240 - INFO - , with total : 912414 rows
2019-08-15 15:09:31,522 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Male Buyers_5.csv
2019-08-15 15:09:31,523 - INFO - , with total : 912413 rows
2019-08-15 15:09:34,526 - INFO - Row 2
2019-08-15 15:09:34,529 - INFO - Filename: A30 Female Buyers
2019-08-15 15:09:34,530 - INFO - Last Login: 30
2019-08-15 15:09:34,533 - INFO - Gender: 2,4
2019-08-15 15:09:34,536 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid 
                                    where
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-15 15:09:34,543 - INFO - Start Running query A30 Female Buyers
2019-08-15 15:14:32,138 - INFO - Running A30 Female Buyers Done
2019-08-15 15:14:32,138 - INFO - CSV file path: A30 Female Buyers
2019-08-15 15:14:32,914 - INFO - Starting save the query results
2019-08-15 15:14:32,914 - INFO - Total Rows : 10847470
2019-08-15 15:14:32,914 - INFO - Will split into : 11.0 files
2019-08-15 15:14:37,720 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_1.csv
2019-08-15 15:14:37,721 - INFO - , with total : 986134 rows
2019-08-15 15:14:42,408 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_2.csv
2019-08-15 15:14:42,410 - INFO - , with total : 986134 rows
2019-08-15 15:14:48,078 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_3.csv
2019-08-15 15:14:48,078 - INFO - , with total : 986134 rows
2019-08-15 15:14:53,683 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_4.csv
2019-08-15 15:14:53,684 - INFO - , with total : 986134 rows
2019-08-15 15:14:59,190 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_5.csv
2019-08-15 15:14:59,190 - INFO - , with total : 986134 rows
2019-08-15 15:15:04,575 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_6.csv
2019-08-15 15:15:04,576 - INFO - , with total : 986134 rows
2019-08-15 15:15:10,223 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_7.csv
2019-08-15 15:15:10,224 - INFO - , with total : 986134 rows
2019-08-15 15:15:15,763 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_8.csv
2019-08-15 15:15:15,765 - INFO - , with total : 986133 rows
2019-08-15 15:15:21,575 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_9.csv
2019-08-15 15:15:21,575 - INFO - , with total : 986133 rows
2019-08-15 15:15:27,316 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_10.csv
2019-08-15 15:15:27,318 - INFO - , with total : 986133 rows
2019-08-15 15:15:34,828 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Female Buyers_11.csv
2019-08-15 15:15:34,832 - INFO - , with total : 986133 rows
2019-08-15 15:15:36,622 - INFO - Delete all data in sheet: Case 4
2019-08-15 15:15:38,686 - INFO - No value detected on sheet: Case 5
2019-08-15 15:15:40,013 - INFO - Value detected - use sheet: Case 6
2019-08-15 15:15:40,016 - INFO - Reading Data From Google Sheet...
2019-08-15 15:15:40,647 - INFO - Get custom SQL..
2019-08-15 15:15:40,648 - INFO - USING CASE 6
2019-08-15 15:15:42,779 - INFO - Row 1
2019-08-15 15:15:42,779 - INFO - Filename: A30 Bread & Pastry
2019-08-15 15:15:42,780 - INFO - Sub-category: 'Bread & Pastry'
2019-08-15 15:15:42,782 - INFO - Last Login: 30
2019-08-15 15:15:42,782 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bread & Pastry')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:15:42,783 - INFO - Start Running query A30 Bread & Pastry
2019-08-15 15:16:07,763 - INFO - Running A30 Bread & Pastry Done
2019-08-15 15:16:07,763 - INFO - CSV file path: A30 Bread & Pastry
2019-08-15 15:16:07,782 - INFO - Starting save the query results
2019-08-15 15:16:07,782 - INFO - Total Rows : 213738
2019-08-15 15:16:07,782 - INFO - Will split into : 1.0 files
2019-08-15 15:16:08,859 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Bread & Pastry_1.csv
2019-08-15 15:16:08,861 - INFO - , with total : 213738 rows
2019-08-15 15:16:11,430 - INFO - Row 2
2019-08-15 15:16:11,431 - INFO - Filename: A30 Skin Care Buyers
2019-08-15 15:16:11,434 - INFO - Sub-category: 'Skin Care'
2019-08-15 15:16:11,437 - INFO - Last Login: 30
2019-08-15 15:16:11,441 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Skin Care')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:16:11,447 - INFO - Start Running query A30 Skin Care Buyers
2019-08-15 15:17:20,927 - INFO - Running A30 Skin Care Buyers Done
2019-08-15 15:17:20,928 - INFO - CSV file path: A30 Skin Care Buyers
2019-08-15 15:17:21,052 - INFO - Starting save the query results
2019-08-15 15:17:21,052 - INFO - Total Rows : 1697471
2019-08-15 15:17:21,053 - INFO - Will split into : 2.0 files
2019-08-15 15:17:25,042 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Skin Care Buyers_1.csv
2019-08-15 15:17:25,042 - INFO - , with total : 848736 rows
2019-08-15 15:17:29,068 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Skin Care Buyers_2.csv
2019-08-15 15:17:29,069 - INFO - , with total : 848735 rows
2019-08-15 15:17:31,368 - INFO - Row 3
2019-08-15 15:17:31,369 - INFO - Filename: A30 Facial Care Buyers
2019-08-15 15:17:31,372 - INFO - Sub-category: 'Facial Care'
2019-08-15 15:17:31,375 - INFO - Last Login: 30
2019-08-15 15:17:31,381 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Facial Care')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:17:31,387 - INFO - Start Running query A30 Facial Care Buyers
2019-08-15 15:19:54,608 - INFO - Running A30 Facial Care Buyers Done
2019-08-15 15:19:54,609 - INFO - CSV file path: A30 Facial Care Buyers
2019-08-15 15:19:54,913 - INFO - Starting save the query results
2019-08-15 15:19:54,914 - INFO - Total Rows : 4238979
2019-08-15 15:19:54,914 - INFO - Will split into : 5.0 files
2019-08-15 15:19:58,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Facial Care Buyers_1.csv
2019-08-15 15:19:58,969 - INFO - , with total : 847796 rows
2019-08-15 15:20:03,592 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Facial Care Buyers_2.csv
2019-08-15 15:20:03,594 - INFO - , with total : 847796 rows
2019-08-15 15:20:07,887 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Facial Care Buyers_3.csv
2019-08-15 15:20:07,887 - INFO - , with total : 847796 rows
2019-08-15 15:20:12,539 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Facial Care Buyers_4.csv
2019-08-15 15:20:12,540 - INFO - , with total : 847796 rows
2019-08-15 15:20:17,595 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Facial Care Buyers_5.csv
2019-08-15 15:20:17,601 - INFO - , with total : 847795 rows
2019-08-15 15:20:20,325 - INFO - Row 4
2019-08-15 15:20:20,328 - INFO - Filename: A30 Confectionery Buyers
2019-08-15 15:20:20,331 - INFO - Sub-category: 'Confectionery'
2019-08-15 15:20:20,332 - INFO - Last Login: 30
2019-08-15 15:20:20,336 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Confectionery')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:20:20,342 - INFO - Start Running query A30 Confectionery Buyers
2019-08-15 15:21:14,721 - INFO - Running A30 Confectionery Buyers Done
2019-08-15 15:21:14,723 - INFO - CSV file path: A30 Confectionery Buyers
2019-08-15 15:21:14,759 - INFO - Starting save the query results
2019-08-15 15:21:14,759 - INFO - Total Rows : 469633
2019-08-15 15:21:14,760 - INFO - Will split into : 1.0 files
2019-08-15 15:21:17,000 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Confectionery Buyers_1.csv
2019-08-15 15:21:17,000 - INFO - , with total : 469633 rows
2019-08-15 15:21:30,730 - INFO - Row 5
2019-08-15 15:21:30,733 - INFO - Filename: A30 Body Care Buyers
2019-08-15 15:21:30,736 - INFO - Sub-category: 'Body Care'
2019-08-15 15:21:30,739 - INFO - Last Login: 30
2019-08-15 15:21:30,743 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Body Care')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:21:30,747 - INFO - Start Running query A30 Body Care Buyers
2019-08-15 15:23:44,072 - INFO - Running A30 Body Care Buyers Done
2019-08-15 15:23:44,072 - INFO - CSV file path: A30 Body Care Buyers
2019-08-15 15:23:44,292 - INFO - Starting save the query results
2019-08-15 15:23:44,292 - INFO - Total Rows : 3031404
2019-08-15 15:23:44,292 - INFO - Will split into : 4.0 files
2019-08-15 15:23:48,273 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Body Care Buyers_1.csv
2019-08-15 15:23:48,273 - INFO - , with total : 757851 rows
2019-08-15 15:23:51,915 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Body Care Buyers_2.csv
2019-08-15 15:23:51,917 - INFO - , with total : 757851 rows
2019-08-15 15:23:55,709 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Body Care Buyers_3.csv
2019-08-15 15:23:55,710 - INFO - , with total : 757851 rows
2019-08-15 15:23:59,631 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Body Care Buyers_4.csv
2019-08-15 15:23:59,631 - INFO - , with total : 757851 rows
2019-08-15 15:24:02,680 - INFO - Row 6
2019-08-15 15:24:02,684 - INFO - Filename: A30 Drinks Buyers
2019-08-15 15:24:02,687 - INFO - Sub-category: 'Drinks'
2019-08-15 15:24:02,691 - INFO - Last Login: 30
2019-08-15 15:24:02,693 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Drinks')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:24:02,697 - INFO - Start Running query A30 Drinks Buyers
2019-08-15 15:25:08,273 - INFO - Running A30 Drinks Buyers Done
2019-08-15 15:25:08,276 - INFO - CSV file path: A30 Drinks Buyers
2019-08-15 15:25:08,342 - INFO - Starting save the query results
2019-08-15 15:25:08,344 - INFO - Total Rows : 916561
2019-08-15 15:25:08,345 - INFO - Will split into : 1.0 files
2019-08-15 15:25:12,907 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Drinks Buyers_1.csv
2019-08-15 15:25:12,907 - INFO - , with total : 916561 rows
2019-08-15 15:25:15,813 - INFO - Row 7
2019-08-15 15:25:15,816 - INFO - Filename: A30 Instant Food Buyers
2019-08-15 15:25:15,819 - INFO - Sub-category: 'Instant Food'
2019-08-15 15:25:15,822 - INFO - Last Login: 30
2019-08-15 15:25:15,825 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Instant Food')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:25:15,832 - INFO - Start Running query A30 Instant Food Buyers
2019-08-15 15:25:47,687 - INFO - Running A30 Instant Food Buyers Done
2019-08-15 15:25:47,687 - INFO - CSV file path: A30 Instant Food Buyers
2019-08-15 15:25:47,732 - INFO - Starting save the query results
2019-08-15 15:25:47,733 - INFO - Total Rows : 575449
2019-08-15 15:25:47,733 - INFO - Will split into : 1.0 files
2019-08-15 15:25:50,460 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Instant Food Buyers_1.csv
2019-08-15 15:25:50,461 - INFO - , with total : 575449 rows
2019-08-15 15:25:53,036 - INFO - Row 8
2019-08-15 15:25:53,039 - INFO - Filename: A30 Frozen Food Buyers
2019-08-15 15:25:53,042 - INFO - Sub-category: 'Frozen Food'
2019-08-15 15:25:53,043 - INFO - Last Login: 30
2019-08-15 15:25:53,048 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Frozen Food')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:25:53,055 - INFO - Start Running query A30 Frozen Food Buyers
2019-08-15 15:26:24,286 - INFO - Running A30 Frozen Food Buyers Done
2019-08-15 15:26:24,288 - INFO - CSV file path: A30 Frozen Food Buyers
2019-08-15 15:26:24,315 - INFO - Starting save the query results
2019-08-15 15:26:24,315 - INFO - Total Rows : 348736
2019-08-15 15:26:24,316 - INFO - Will split into : 1.0 files
2019-08-15 15:26:25,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Frozen Food Buyers_1.csv
2019-08-15 15:26:25,967 - INFO - , with total : 348736 rows
2019-08-15 15:26:28,255 - INFO - Row 9
2019-08-15 15:26:28,256 - INFO - Filename: A30 Pre Ready Food Buyers
2019-08-15 15:26:28,259 - INFO - Sub-category: 'Pre Ready Food'
2019-08-15 15:26:28,262 - INFO - Last Login: 30
2019-08-15 15:26:28,266 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Pre Ready Food')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:26:28,270 - INFO - Start Running query A30 Pre Ready Food Buyers
2019-08-15 15:26:46,627 - INFO - Running A30 Pre Ready Food Buyers Done
2019-08-15 15:26:46,628 - INFO - CSV file path: A30 Pre Ready Food Buyers
2019-08-15 15:26:46,644 - INFO - Starting save the query results
2019-08-15 15:26:46,644 - INFO - Total Rows : 203320
2019-08-15 15:26:46,645 - INFO - Will split into : 1.0 files
2019-08-15 15:26:47,674 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Pre Ready Food Buyers_1.csv
2019-08-15 15:26:47,676 - INFO - , with total : 203320 rows
2019-08-15 15:26:50,085 - INFO - Row 10
2019-08-15 15:26:50,086 - INFO - Filename: A30 Dining Room Buyers
2019-08-15 15:26:50,089 - INFO - Sub-category: 'Dining Room'
2019-08-15 15:26:50,092 - INFO - Last Login: 30
2019-08-15 15:26:50,098 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Dining Room')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:26:50,105 - INFO - Start Running query A30 Dining Room Buyers
2019-08-15 15:27:57,494 - INFO - Running A30 Dining Room Buyers Done
2019-08-15 15:27:57,494 - INFO - CSV file path: A30 Dining Room Buyers
2019-08-15 15:27:57,641 - INFO - Starting save the query results
2019-08-15 15:27:57,642 - INFO - Total Rows : 1963117
2019-08-15 15:27:57,644 - INFO - Will split into : 2.0 files
2019-08-15 15:28:02,316 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Dining Room Buyers_1.csv
2019-08-15 15:28:02,318 - INFO - , with total : 981559 rows
2019-08-15 15:28:07,019 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Dining Room Buyers_2.csv
2019-08-15 15:28:07,020 - INFO - , with total : 981558 rows
2019-08-15 15:28:10,161 - INFO - Row 11
2019-08-15 15:28:10,161 - INFO - Filename: A30 Kitchen & Cookware Buyers
2019-08-15 15:28:10,161 - INFO - Sub-category: 'Kitchen & Cookware'
2019-08-15 15:28:10,163 - INFO - Last Login: 30
2019-08-15 15:28:10,164 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Kitchen & Cookware')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 15:28:10,165 - INFO - Start Running query A30 Kitchen & Cookware Buyers
2019-08-15 15:29:36,551 - INFO - Running A30 Kitchen & Cookware Buyers Done
2019-08-15 15:29:36,552 - INFO - CSV file path: A30 Kitchen & Cookware Buyers
2019-08-15 15:29:36,746 - INFO - Starting save the query results
2019-08-15 15:29:36,746 - INFO - Total Rows : 2677643
2019-08-15 15:29:36,747 - INFO - Will split into : 3.0 files
2019-08-15 15:29:40,971 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Kitchen & Cookware Buyers_1.csv
2019-08-15 15:29:40,973 - INFO - , with total : 892548 rows
2019-08-15 15:29:45,214 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Kitchen & Cookware Buyers_2.csv
2019-08-15 15:29:45,216 - INFO - , with total : 892548 rows
2019-08-15 15:29:50,178 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/A30 Kitchen & Cookware Buyers_3.csv
2019-08-15 15:29:50,180 - INFO - , with total : 892547 rows
2019-08-15 15:29:51,019 - INFO - Delete all data in sheet: Case 6
2019-08-15 15:29:53,157 - INFO - No value detected on sheet: Case 7
2019-08-15 15:29:54,267 - INFO - Value detected - use sheet: Case 8
2019-08-15 15:29:54,269 - INFO - Reading Data From Google Sheet...
2019-08-15 15:29:54,959 - INFO - Get custom SQL..
2019-08-15 15:29:54,961 - INFO - USING CASE 8
2019-08-15 15:29:56,405 - INFO - Row 1
2019-08-15 15:29:56,407 - INFO - Filename: Xueweiid OS Followers
2019-08-15 15:29:56,407 - INFO - Shop ID: 9291917
2019-08-15 15:29:56,407 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (9291917) 
                                and status = 1
                                
2019-08-15 15:29:56,408 - INFO - Start Running query Xueweiid OS Followers
2019-08-15 15:30:05,688 - INFO - Running Xueweiid OS Followers Done
2019-08-15 15:30:05,690 - INFO - CSV file path: Xueweiid OS Followers
2019-08-15 15:30:05,697 - INFO - Starting save the query results
2019-08-15 15:30:05,697 - INFO - Total Rows : 60769
2019-08-15 15:30:05,698 - INFO - Will split into : 1.0 files
2019-08-15 15:30:06,013 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/Xueweiid OS Followers_1.csv
2019-08-15 15:30:06,015 - INFO - , with total : 60769 rows
2019-08-15 15:30:07,775 - INFO - Row 2
2019-08-15 15:30:07,776 - INFO - Filename: Louvre OS Followers
2019-08-15 15:30:07,779 - INFO - Shop ID: 28779146
2019-08-15 15:30:07,779 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (28779146) 
                                and status = 1
                                
2019-08-15 15:30:07,789 - INFO - Start Running query Louvre OS Followers
2019-08-15 15:30:16,112 - INFO - Running Louvre OS Followers Done
2019-08-15 15:30:16,114 - INFO - CSV file path: Louvre OS Followers
2019-08-15 15:30:16,117 - INFO - Starting save the query results
2019-08-15 15:30:16,118 - INFO - Total Rows : 15644
2019-08-15 15:30:16,118 - INFO - Will split into : 1.0 files
2019-08-15 15:30:16,229 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190815 14.11/Louvre OS Followers_1.csv
2019-08-15 15:30:16,230 - INFO - , with total : 15644 rows
2019-08-15 15:30:16,644 - INFO - Delete all data in sheet: Case 8
2019-08-15 15:30:18,516 - INFO - No value detected on sheet: Case 9
2019-08-15 15:30:19,992 - INFO - No value detected on sheet: Case 10
2019-08-15 15:30:21,459 - INFO - No value detected on sheet: Case 11
2019-08-15 15:30:22,336 - INFO - No value detected on sheet: Case 12
2019-08-15 15:30:23,773 - INFO - No value detected on sheet: Case 13
2019-08-15 15:30:24,924 - INFO - No value detected on sheet: Case 14
2019-08-15 15:30:25,802 - INFO - No value detected on sheet: Case 15
2019-08-15 17:00:03,990 - INFO - Report date: 20190815 17.00
2019-08-15 17:00:08,734 - INFO - Download sheet..
2019-08-15 17:00:08,734 - INFO - Change directory to script path
2019-08-15 17:00:09,809 - INFO - Spreadsheet downloaded
2019-08-15 17:00:09,811 - INFO - Checking sheet..
2019-08-15 17:00:11,592 - INFO - No value detected on sheet: Case 1
2019-08-15 17:00:12,946 - INFO - No value detected on sheet: Case 2
2019-08-15 17:00:14,302 - INFO - No value detected on sheet: Case 3
2019-08-15 17:00:15,772 - INFO - No value detected on sheet: Case 4
2019-08-15 17:00:17,107 - INFO - No value detected on sheet: Case 5
2019-08-15 17:00:18,450 - INFO - No value detected on sheet: Case 6
2019-08-15 17:00:19,900 - INFO - No value detected on sheet: Case 7
2019-08-15 17:00:21,395 - INFO - No value detected on sheet: Case 8
2019-08-15 17:00:22,750 - INFO - No value detected on sheet: Case 9
2019-08-15 17:00:24,096 - INFO - No value detected on sheet: Case 10
2019-08-15 17:00:25,464 - INFO - No value detected on sheet: Case 11
2019-08-15 17:00:26,552 - INFO - No value detected on sheet: Case 12
2019-08-15 17:00:27,644 - INFO - No value detected on sheet: Case 13
2019-08-15 17:00:28,457 - INFO - No value detected on sheet: Case 14
2019-08-15 17:00:29,269 - INFO - No value detected on sheet: Case 15
2019-08-15 17:16:47,454 - INFO - Report date: 20190815 17.16
2019-08-15 17:16:49,073 - INFO - Download sheet..
2019-08-15 17:16:49,073 - INFO - Change directory to script path
2019-08-15 17:16:51,474 - INFO - Spreadsheet downloaded
2019-08-15 17:16:51,476 - INFO - Opening PN Input.xlsx..
2019-08-15 17:16:52,253 - INFO - Value detected - use sheet: Case 1
2019-08-15 17:16:52,255 - INFO - Reading Data From Excel...
2019-08-15 17:16:52,256 - INFO - Get custom SQL..
2019-08-15 17:16:52,256 - INFO - USING CASE 1
2019-08-15 17:16:52,257 - INFO - Row 1
2019-08-15 17:16:52,257 - INFO - Filename: A1 HL Buyers
2019-08-15 17:16:52,259 - INFO - Category: 'Home & Living'
2019-08-15 17:16:52,259 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'float' objects
2019-08-15 17:16:52,259 - INFO - Start sending...
2019-08-15 17:17:00,579 - INFO - Message sent successfully
2019-08-15 17:17:01,992 - INFO - Delete all data in sheet: Case 1
2019-08-15 17:17:02,730 - INFO - Value detected - use sheet: Case 2
2019-08-15 17:17:02,730 - INFO - Reading Data From Excel...
2019-08-15 17:17:02,733 - INFO - Get custom SQL..
2019-08-15 17:17:02,733 - INFO - USING CASE 2
2019-08-15 17:17:02,734 - INFO - Row 1
2019-08-15 17:17:02,736 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:17:02,736 - INFO - Start sending...
2019-08-15 17:17:10,811 - INFO - Message sent successfully
2019-08-15 17:17:11,459 - INFO - Delete all data in sheet: Case 2
2019-08-15 17:17:12,180 - INFO - Value detected - use sheet: Case 3
2019-08-15 17:17:12,180 - INFO - Reading Data From Excel...
2019-08-15 17:17:12,183 - INFO - Get custom SQL..
2019-08-15 17:17:12,184 - INFO - USING CASE 3
2019-08-15 17:17:12,184 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:17:12,184 - INFO - Start sending...
2019-08-15 17:17:19,944 - INFO - Message sent successfully
2019-08-15 17:17:20,588 - INFO - Delete all data in sheet: Case 3
2019-08-15 17:17:21,313 - INFO - Value detected - use sheet: Case 4
2019-08-15 17:17:21,315 - INFO - Reading Data From Excel...
2019-08-15 17:17:21,315 - INFO - Get custom SQL..
2019-08-15 17:17:21,316 - INFO - USING CASE 4
2019-08-15 17:17:21,318 - INFO - Error in run_custom_sql() -> 'NoneType' object has no attribute 'lower'
2019-08-15 17:17:21,319 - INFO - Start sending...
2019-08-15 17:17:25,714 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:17:25,716 - INFO - Value detected - use sheet: Case 5
2019-08-15 17:17:25,717 - INFO - Reading Data From Excel...
2019-08-15 17:17:25,717 - INFO - Get custom SQL..
2019-08-15 17:17:25,719 - INFO - USING CASE 5
2019-08-15 17:17:25,720 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:17:25,720 - INFO - Start sending...
2019-08-15 17:17:30,075 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:17:30,075 - INFO - Value detected - use sheet: Case 6
2019-08-15 17:17:30,075 - INFO - Reading Data From Excel...
2019-08-15 17:17:30,076 - INFO - Get custom SQL..
2019-08-15 17:17:30,078 - INFO - USING CASE 6
2019-08-15 17:17:30,078 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:17:30,079 - INFO - Start sending...
2019-08-15 17:17:34,415 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:17:34,417 - INFO - Value detected - use sheet: Case 7
2019-08-15 17:17:34,417 - INFO - Reading Data From Excel...
2019-08-15 17:17:34,418 - INFO - Get custom SQL..
2019-08-15 17:17:34,420 - INFO - USING CASE 7
2019-08-15 17:17:34,421 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:17:34,421 - INFO - Start sending...
2019-08-15 17:17:38,528 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:17:38,529 - INFO - Value detected - use sheet: Case 8
2019-08-15 17:17:38,529 - INFO - Reading Data From Excel...
2019-08-15 17:17:38,530 - INFO - Get custom SQL..
2019-08-15 17:17:38,530 - INFO - USING CASE 8
2019-08-15 17:17:38,532 - INFO - Row 1
2019-08-15 17:17:38,532 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:17:38,533 - INFO - Start sending...
2019-08-15 17:17:42,892 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:17:42,894 - INFO - Value detected - use sheet: Case 9
2019-08-15 17:17:42,894 - INFO - Reading Data From Excel...
2019-08-15 17:17:42,895 - INFO - Get custom SQL..
2019-08-15 17:17:42,897 - INFO - USING CASE 9
2019-08-15 17:17:42,898 - INFO - Row 1
2019-08-15 17:17:42,898 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:17:42,898 - INFO - Start sending...
2019-08-15 17:17:47,095 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:17:47,096 - INFO - Value detected - use sheet: Case 10
2019-08-15 17:17:47,098 - INFO - Reading Data From Excel...
2019-08-15 17:17:47,099 - INFO - Get custom SQL..
2019-08-15 17:17:47,101 - INFO - USING CASE 10
2019-08-15 17:17:47,101 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:17:47,101 - INFO - Start sending...
2019-08-15 17:17:51,279 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:17:51,280 - INFO - Value detected - use sheet: Case 11
2019-08-15 17:17:51,280 - INFO - Reading Data From Excel...
2019-08-15 17:17:51,282 - INFO - Get custom SQL..
2019-08-15 17:17:51,282 - INFO - USING CASE 11
2019-08-15 17:17:51,283 - INFO - Row 1
2019-08-15 17:17:51,285 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:17:51,286 - INFO - Start sending...
2019-08-15 17:17:55,724 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:17:55,730 - INFO - Value detected - use sheet: Case 12
2019-08-15 17:17:55,730 - INFO - Reading Data From Excel...
2019-08-15 17:17:55,733 - INFO - Get custom SQL..
2019-08-15 17:17:55,733 - INFO - USING CASE 12
2019-08-15 17:17:55,734 - INFO - Row 1
2019-08-15 17:17:55,736 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:17:55,736 - INFO - Start sending...
2019-08-15 17:18:00,098 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:18:00,099 - INFO - Value detected - use sheet: Case 13
2019-08-15 17:18:00,101 - INFO - Reading Data From Excel...
2019-08-15 17:18:00,101 - INFO - Get custom SQL..
2019-08-15 17:18:00,102 - INFO - USING CASE 13
2019-08-15 17:18:00,105 - INFO - Row 1
2019-08-15 17:18:00,105 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:18:00,105 - INFO - Start sending...
2019-08-15 17:18:04,359 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:18:04,359 - INFO - Value detected - use sheet: Case 14
2019-08-15 17:18:04,361 - INFO - Reading Data From Excel...
2019-08-15 17:18:04,362 - INFO - Get custom SQL..
2019-08-15 17:18:04,362 - INFO - USING CASE 14
2019-08-15 17:18:04,364 - INFO - Row 1
2019-08-15 17:18:04,365 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:18:04,365 - INFO - Start sending...
2019-08-15 17:18:08,763 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:18:08,765 - INFO - Value detected - use sheet: Case 15
2019-08-15 17:18:08,766 - INFO - Reading Data From Excel...
2019-08-15 17:18:08,767 - INFO - Get custom SQL..
2019-08-15 17:18:08,769 - INFO - USING CASE 15
2019-08-15 17:18:08,769 - INFO - Row 1
2019-08-15 17:18:08,770 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:18:08,772 - INFO - Start sending...
2019-08-15 17:18:13,349 - INFO - ('Auth rate limit exceeded', <Response [429]>)
2019-08-15 17:27:49,956 - INFO - Report date: 20190815 17.27
2019-08-15 17:27:49,982 - INFO - Download sheet..
2019-08-15 17:27:49,982 - INFO - Change directory to script path
2019-08-15 17:27:52,193 - INFO - Spreadsheet downloaded
2019-08-15 17:27:52,193 - INFO - Opening PN Input.xlsx..
2019-08-15 17:27:52,832 - INFO - Value detected - use sheet: Case 1
2019-08-15 17:27:52,832 - INFO - Reading Data From Excel...
2019-08-15 17:27:52,832 - INFO - Get custom SQL..
2019-08-15 17:27:52,832 - INFO - USING CASE 1
2019-08-15 17:27:52,834 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:27:52,834 - INFO - Start sending...
2019-08-15 17:32:07,236 - INFO - Report date: 20190815 17.32
2019-08-15 17:32:07,262 - INFO - Download sheet..
2019-08-15 17:32:07,263 - INFO - Change directory to script path
2019-08-15 17:32:09,404 - INFO - Spreadsheet downloaded
2019-08-15 17:32:09,405 - INFO - Opening PN Input.xlsx..
2019-08-15 17:32:09,989 - INFO - Value detected - use sheet: Case 1
2019-08-15 17:32:09,989 - INFO - Reading Data From Excel...
2019-08-15 17:32:09,990 - INFO - Get custom SQL..
2019-08-15 17:32:09,990 - INFO - USING CASE 1
2019-08-15 17:32:09,990 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:32:11,312 - INFO - Delete all data in sheet: Case 1
2019-08-15 17:32:12,005 - INFO - Value detected - use sheet: Case 2
2019-08-15 17:32:12,007 - INFO - Reading Data From Excel...
2019-08-15 17:32:12,013 - INFO - Get custom SQL..
2019-08-15 17:32:12,023 - INFO - USING CASE 2
2019-08-15 17:32:12,028 - INFO - Row 1
2019-08-15 17:32:12,029 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:32:12,759 - INFO - Delete all data in sheet: Case 2
2019-08-15 17:37:57,055 - INFO - Report date: 20190815 17.37
2019-08-15 17:37:57,088 - INFO - Download sheet..
2019-08-15 17:37:57,088 - INFO - Change directory to script path
2019-08-15 17:37:59,404 - INFO - Spreadsheet downloaded
2019-08-15 17:37:59,404 - INFO - Opening PN Input.xlsx..
2019-08-15 17:38:00,203 - INFO - No value detected on sheet: Case 1
2019-08-15 17:38:00,203 - INFO - No value detected on sheet: Case 2
2019-08-15 17:38:00,204 - INFO - No value detected on sheet: Case 3
2019-08-15 17:38:00,206 - INFO - No value detected on sheet: Case 4
2019-08-15 17:38:00,206 - INFO - No value detected on sheet: Case 5
2019-08-15 17:38:00,207 - INFO - No value detected on sheet: Case 6
2019-08-15 17:38:00,207 - INFO - No value detected on sheet: Case 7
2019-08-15 17:38:00,209 - INFO - No value detected on sheet: Case 8
2019-08-15 17:38:00,210 - INFO - No value detected on sheet: Case 9
2019-08-15 17:38:00,210 - INFO - No value detected on sheet: Case 10
2019-08-15 17:38:00,210 - INFO - No value detected on sheet: Case 11
2019-08-15 17:38:00,213 - INFO - No value detected on sheet: Case 12
2019-08-15 17:38:00,213 - INFO - No value detected on sheet: Case 13
2019-08-15 17:38:00,216 - INFO - No value detected on sheet: Case 14
2019-08-15 17:38:00,217 - INFO - No value detected on sheet: Case 15
2019-08-15 17:39:06,638 - INFO - Report date: 20190815 17.39
2019-08-15 17:39:06,661 - INFO - Download sheet..
2019-08-15 17:39:06,661 - INFO - Change directory to script path
2019-08-15 17:39:08,477 - INFO - Spreadsheet downloaded
2019-08-15 17:39:08,479 - INFO - Opening PN Input.xlsx..
2019-08-15 17:39:09,061 - INFO - Value detected - use sheet: Case 1
2019-08-15 17:39:09,062 - INFO - Reading Data From Excel...
2019-08-15 17:39:09,062 - INFO - Get custom SQL..
2019-08-15 17:39:09,062 - INFO - USING CASE 1
2019-08-15 17:39:09,062 - INFO - Row 1
2019-08-15 17:39:09,063 - INFO - Filename: A1 HL Buyers
2019-08-15 17:39:09,063 - INFO - Category: 'Home & Living'
2019-08-15 17:39:09,065 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'float' objects
2019-08-15 17:39:10,434 - INFO - Delete all data in sheet: Case 1
2019-08-15 17:39:11,125 - INFO - No value detected on sheet: Case 2
2019-08-15 17:39:11,125 - INFO - No value detected on sheet: Case 3
2019-08-15 17:39:11,127 - INFO - No value detected on sheet: Case 4
2019-08-15 17:39:11,128 - INFO - No value detected on sheet: Case 5
2019-08-15 17:39:11,128 - INFO - Value detected - use sheet: Case 6
2019-08-15 17:39:11,130 - INFO - Reading Data From Excel...
2019-08-15 17:39:11,131 - INFO - Get custom SQL..
2019-08-15 17:39:11,131 - INFO - USING CASE 6
2019-08-15 17:39:11,134 - INFO - Row 1
2019-08-15 17:39:11,134 - INFO - Filename: A1 Car buyers
2019-08-15 17:39:11,135 - INFO - Sub-category: 'Car'
2019-08-15 17:39:11,137 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'float' objects
2019-08-15 17:39:11,818 - INFO - Delete all data in sheet: Case 6
2019-08-15 17:39:12,516 - INFO - No value detected on sheet: Case 7
2019-08-15 17:39:12,526 - INFO - No value detected on sheet: Case 8
2019-08-15 17:39:12,530 - INFO - No value detected on sheet: Case 9
2019-08-15 17:39:12,533 - INFO - No value detected on sheet: Case 10
2019-08-15 17:39:12,545 - INFO - No value detected on sheet: Case 11
2019-08-15 17:39:12,555 - INFO - No value detected on sheet: Case 12
2019-08-15 17:39:12,559 - INFO - No value detected on sheet: Case 13
2019-08-15 17:39:12,563 - INFO - No value detected on sheet: Case 14
2019-08-15 17:39:12,565 - INFO - No value detected on sheet: Case 15
2019-08-15 17:45:06,489 - INFO - Report date: 20190815 17.45
2019-08-15 17:45:06,517 - INFO - Download sheet..
2019-08-15 17:45:06,517 - INFO - Change directory to script path
2019-08-15 17:45:09,042 - INFO - Spreadsheet downloaded
2019-08-15 17:45:09,043 - INFO - Opening PN Input.xlsx..
2019-08-15 17:45:09,627 - INFO - Value detected - use sheet: Case 1
2019-08-15 17:45:09,628 - INFO - Reading Data From Excel...
2019-08-15 17:45:09,628 - INFO - Get custom SQL..
2019-08-15 17:45:09,628 - INFO - USING CASE 1
2019-08-15 17:45:09,630 - INFO - Row 1
2019-08-15 17:45:09,631 - INFO - Filename: A1 HL buyers
2019-08-15 17:45:09,631 - INFO - Category: 'Home & Living'
2019-08-15 17:45:09,631 - INFO - Last Login: 1.0
2019-08-15 17:45:09,632 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living')
                                    and
                                    last_login >= current_date - interval '1.0' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-15 17:45:09,634 - INFO - Start Running query A1 HL buyers
2019-08-15 17:45:12,154 - INFO - java.sql.SQLException: Query failed (#20190815_104511_23951_zs749): Invalid INTERVAL DAY value: 1.0
2019-08-15 17:45:12,368 - INFO - java.sql.SQLException: Query failed (#20190815_104512_23952_zs749): Invalid INTERVAL DAY value: 1.0
2019-08-15 17:45:12,569 - INFO - java.sql.SQLException: Query failed (#20190815_104512_23953_zs749): Invalid INTERVAL DAY value: 1.0
2019-08-15 17:45:12,795 - INFO - java.sql.SQLException: Query failed (#20190815_104512_23955_zs749): Invalid INTERVAL DAY value: 1.0
2019-08-15 17:45:12,984 - INFO - java.sql.SQLException: Query failed (#20190815_104512_23956_zs749): Invalid INTERVAL DAY value: 1.0
2019-08-15 17:45:12,986 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-08-15 17:45:12,990 - INFO - Start sending...
2019-08-15 17:45:22,401 - INFO - Message sent successfully
2019-08-15 17:45:22,408 - INFO - Error in run_custom_sql() -> cannot concatenate 'str' and 'NoneType' objects
2019-08-15 17:45:23,888 - INFO - Delete all data in sheet: Case 1
2019-08-15 17:45:24,668 - INFO - Value detected - use sheet: Case 2
2019-08-15 17:45:24,670 - INFO - Reading Data From Excel...
2019-08-15 17:45:24,671 - INFO - Get custom SQL..
2019-08-15 17:45:24,673 - INFO - USING CASE 2
2019-08-15 17:45:24,674 - INFO - Row 1
2019-08-15 17:45:24,674 - INFO - Filename: A1 who havent purchased 3 days
2019-08-15 17:45:24,676 - INFO - Last Login: 1.0
2019-08-15 17:45:24,677 - INFO - Date 1: 2019-08-11 00:00:00
2019-08-15 17:45:24,677 - INFO - Date 2: 2019-08-14 00:00:00
2019-08-15 17:45:24,678 - INFO - Query: 
                                with a as(
                                select distinct u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '1.0' day
                                    and
                                    u.status = 1
                                ),

                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-08-11 00:00:00' and date'2019-08-14 00:00:00'
                                )

                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-15 17:45:24,681 - INFO - Start Running query A1 who havent purchased 3 days
2019-08-15 17:45:24,894 - INFO - java.sql.SQLException: Query failed (#20190815_104524_23961_zs749): Invalid INTERVAL DAY value: 1.0
2019-08-15 17:45:25,079 - INFO - java.sql.SQLException: Query failed (#20190815_104524_23962_zs749): Invalid INTERVAL DAY value: 1.0
2019-08-15 17:45:25,305 - INFO - java.sql.SQLException: Query failed (#20190815_104525_23963_zs749): Invalid INTERVAL DAY value: 1.0
2019-08-15 17:45:25,581 - INFO - java.sql.SQLException: Query failed (#20190815_104525_23964_zs749): Invalid INTERVAL DAY value: 1.0
2019-08-15 17:45:25,753 - INFO - java.sql.SQLException: Query failed (#20190815_104525_23966_zs749): Invalid INTERVAL DAY value: 1.0
2019-08-15 17:45:25,755 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-08-15 17:45:25,756 - INFO - Start sending...
2019-08-16 10:00:04,802 - INFO - Report date: 20190816 10.00
2019-08-16 10:00:08,983 - INFO - Download sheet..
2019-08-16 10:00:08,984 - INFO - Change directory to script path
2019-08-16 10:00:10,584 - INFO - Spreadsheet downloaded
2019-08-16 10:00:10,585 - INFO - Checking sheet..
2019-08-16 10:00:12,423 - INFO - No value detected on sheet: Case 1
2019-08-16 10:00:13,775 - INFO - No value detected on sheet: Case 2
2019-08-16 10:00:15,141 - INFO - No value detected on sheet: Case 3
2019-08-16 10:00:16,476 - INFO - No value detected on sheet: Case 4
2019-08-16 10:00:17,796 - INFO - No value detected on sheet: Case 5
2019-08-16 10:00:19,098 - INFO - Value detected - use sheet: Case 6
2019-08-16 10:00:19,098 - INFO - Reading Data From Google Sheet...
2019-08-16 10:00:19,740 - INFO - Get custom SQL..
2019-08-16 10:00:19,740 - INFO - USING CASE 6
2019-08-16 10:00:21,802 - INFO - Row 1
2019-08-16 10:00:21,803 - INFO - Filename: A30 Men Shoes, Bags & FACC buyers
2019-08-16 10:00:21,805 - INFO - Sub-category: 'Men Shoes','Men Bags','Fashion Accessories'
2019-08-16 10:00:21,805 - INFO - Last Login: 30
2019-08-16 10:00:21,805 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Men Shoes','Men Bags','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-16 10:00:21,805 - INFO - Start Running query A30 Men Shoes, Bags & FACC buyers
2019-08-16 10:01:46,871 - INFO - Running A30 Men Shoes, Bags & FACC buyers Done
2019-08-16 10:01:46,871 - INFO - CSV file path: A30 Men Shoes, Bags & FACC buyers
2019-08-16 10:01:46,881 - INFO - Starting save the query results
2019-08-16 10:01:46,884 - INFO - Total Rows : 0
2019-08-16 10:01:46,884 - INFO - Will split into : 0.0 files
2019-08-16 10:01:46,884 - INFO - ERROR -> number sections must be larger than 0.
2019-08-16 10:01:46,884 - INFO - Start sending...
2019-08-16 10:01:56,345 - INFO - Message sent successfully
2019-08-16 10:01:59,451 - INFO - Row 2
2019-08-16 10:01:59,453 - INFO - Filename: A30 Women Shoes, Bags & FACC buyers
2019-08-16 10:01:59,453 - INFO - Sub-category: 'Women Shoes','Women Bags','Fashion Accessories'
2019-08-16 10:01:59,453 - INFO - Last Login: 30
2019-08-16 10:01:59,453 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Women Shoes','Women Bags','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-16 10:01:59,454 - INFO - Start Running query A30 Women Shoes, Bags & FACC buyers
2019-08-16 10:05:07,321 - INFO - Running A30 Women Shoes, Bags & FACC buyers Done
2019-08-16 10:05:07,322 - INFO - CSV file path: A30 Women Shoes, Bags & FACC buyers
2019-08-16 10:05:07,325 - INFO - Starting save the query results
2019-08-16 10:05:07,325 - INFO - Total Rows : 0
2019-08-16 10:05:07,326 - INFO - Will split into : 0.0 files
2019-08-16 10:05:07,326 - INFO - ERROR -> number sections must be larger than 0.
2019-08-16 10:05:07,328 - INFO - Start sending...
2019-08-16 10:05:14,957 - INFO - Message sent successfully
2019-08-16 10:05:17,489 - INFO - Row 3
2019-08-16 10:05:17,489 - INFO - Filename: A30 HE buyers
2019-08-16 10:05:17,490 - INFO - Sub-category: 'Cooling','Electricity','Garment Care','Home','Kitchen','Lighting','Media Player','Outdoor Devices','Speaker & Microphone','Surveillance Camera','Telephone','TV','Vacum Cleaner','Vaporizer'
2019-08-16 10:05:17,490 - INFO - Last Login: 30
2019-08-16 10:05:17,490 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Cooling','Electricity','Garment Care','Home','Kitchen','Lighting','Media Player','Outdoor Devices','Speaker & Microphone','Surveillance Camera','Telephone','TV','Vacum Cleaner','Vaporizer')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-16 10:05:17,492 - INFO - Start Running query A30 HE buyers
2019-08-16 10:26:15,451 - INFO - Running A30 HE buyers Done
2019-08-16 10:26:15,453 - INFO - CSV file path: A30 HE buyers
2019-08-16 10:26:15,621 - INFO - Starting save the query results
2019-08-16 10:26:15,622 - INFO - Total Rows : 4443209
2019-08-16 10:26:15,624 - INFO - Will split into : 5.0 files
2019-08-16 10:26:19,654 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 10.00/A30 HE buyers_1.csv
2019-08-16 10:26:19,654 - INFO - , with total : 888642 rows
2019-08-16 10:26:23,601 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 10.00/A30 HE buyers_2.csv
2019-08-16 10:26:23,602 - INFO - , with total : 888642 rows
2019-08-16 10:26:27,667 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 10.00/A30 HE buyers_3.csv
2019-08-16 10:26:27,668 - INFO - , with total : 888642 rows
2019-08-16 10:26:31,805 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 10.00/A30 HE buyers_4.csv
2019-08-16 10:26:31,806 - INFO - , with total : 888642 rows
2019-08-16 10:26:35,982 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 10.00/A30 HE buyers_5.csv
2019-08-16 10:26:35,983 - INFO - , with total : 888641 rows
2019-08-16 10:26:37,032 - INFO - Delete all data in sheet: Case 6
2019-08-16 10:26:39,130 - INFO - Value detected - use sheet: Case 7
2019-08-16 10:26:39,131 - INFO - Reading Data From Google Sheet...
2019-08-16 10:26:39,772 - INFO - Get custom SQL..
2019-08-16 10:26:39,773 - INFO - USING CASE 7
2019-08-16 10:26:43,121 - INFO - Row 1
2019-08-16 10:26:43,122 - INFO - Filename: Women Clothing & FACC buyers who haven't shopped L30D
2019-08-16 10:26:43,122 - INFO - Sub-category: 'Women Clothes','Fashion Accessories'
2019-08-16 10:26:43,122 - INFO - Last Login: 30
2019-08-16 10:26:43,124 - INFO - Date 1: 2019-07-14
2019-08-16 10:26:43,124 - INFO - Date 2: 2019-08-14
2019-08-16 10:26:43,125 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Women Clothes','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-14' and date'2019-08-14'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-16 10:26:43,125 - INFO - Start Running query Women Clothing & FACC buyers who haven't shopped L30D
2019-08-16 10:38:04,723 - INFO - Running Women Clothing & FACC buyers who haven't shopped L30D Done
2019-08-16 10:38:04,773 - INFO - CSV file path: Women Clothing & FACC buyers who haven't shopped L30D
2019-08-16 10:38:05,006 - INFO - Starting save the query results
2019-08-16 10:38:05,006 - INFO - Total Rows : 0
2019-08-16 10:38:05,007 - INFO - Will split into : 0.0 files
2019-08-16 10:38:05,009 - INFO - ERROR -> number sections must be larger than 0.
2019-08-16 10:38:05,009 - INFO - Start sending...
2019-08-16 10:38:13,486 - INFO - Message sent successfully
2019-08-16 10:38:17,622 - INFO - Row 2
2019-08-16 10:38:17,624 - INFO - Filename: Men Clothing & FACC buyers who haven't shopped L30D
2019-08-16 10:38:17,624 - INFO - Sub-category: 'Men Clothes','Fashion Accessories'
2019-08-16 10:38:17,625 - INFO - Last Login: 30
2019-08-16 10:38:17,630 - INFO - Date 1: 2019-07-14
2019-08-16 10:38:17,630 - INFO - Date 2: 2019-08-14
2019-08-16 10:38:17,631 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Men Clothes','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-14' and date'2019-08-14'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-16 10:38:17,631 - INFO - Start Running query Men Clothing & FACC buyers who haven't shopped L30D
2019-08-16 10:50:58,658 - INFO - Running Men Clothing & FACC buyers who haven't shopped L30D Done
2019-08-16 10:50:58,661 - INFO - CSV file path: Men Clothing & FACC buyers who haven't shopped L30D
2019-08-16 10:50:58,664 - INFO - Starting save the query results
2019-08-16 10:50:58,667 - INFO - Total Rows : 0
2019-08-16 10:50:58,667 - INFO - Will split into : 0.0 files
2019-08-16 10:50:58,667 - INFO - ERROR -> number sections must be larger than 0.
2019-08-16 10:50:58,667 - INFO - Start sending...
2019-08-16 10:51:06,953 - INFO - Message sent successfully
2019-08-16 10:51:11,161 - INFO - Row 3
2019-08-16 10:51:11,163 - INFO - Filename: Baby & Kids Fashion buyers who haven't shopped L30D
2019-08-16 10:51:11,164 - INFO - Sub-category: 'Baby & Kids Fashion'
2019-08-16 10:51:11,164 - INFO - Last Login: 30
2019-08-16 10:51:11,164 - INFO - Date 1: 2019-07-14
2019-08-16 10:51:11,164 - INFO - Date 2: 2019-08-14
2019-08-16 10:51:11,164 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-14' and date'2019-08-14'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-16 10:51:11,165 - INFO - Start Running query Baby & Kids Fashion buyers who haven't shopped L30D
2019-08-16 10:59:55,575 - INFO - Running Baby & Kids Fashion buyers who haven't shopped L30D Done
2019-08-16 10:59:55,576 - INFO - CSV file path: Baby & Kids Fashion buyers who haven't shopped L30D
2019-08-16 10:59:55,581 - INFO - Starting save the query results
2019-08-16 10:59:55,582 - INFO - Total Rows : 0
2019-08-16 10:59:55,582 - INFO - Will split into : 0.0 files
2019-08-16 10:59:55,584 - INFO - ERROR -> number sections must be larger than 0.
2019-08-16 10:59:55,584 - INFO - Start sending...
2019-08-16 11:00:04,114 - INFO - Message sent successfully
2019-08-16 11:00:04,936 - INFO - Delete all data in sheet: Case 7
2019-08-16 11:00:06,987 - INFO - No value detected on sheet: Case 8
2019-08-16 11:00:08,272 - INFO - No value detected on sheet: Case 9
2019-08-16 11:00:09,755 - INFO - No value detected on sheet: Case 10
2019-08-16 11:00:11,065 - INFO - No value detected on sheet: Case 11
2019-08-16 11:00:12,374 - INFO - No value detected on sheet: Case 12
2019-08-16 11:00:13,720 - INFO - No value detected on sheet: Case 13
2019-08-16 11:00:15,012 - INFO - No value detected on sheet: Case 14
2019-08-16 11:00:16,474 - INFO - No value detected on sheet: Case 15
2019-08-16 14:00:04,924 - INFO - Report date: 20190816 14.00
2019-08-16 14:00:09,332 - INFO - Download sheet..
2019-08-16 14:00:09,332 - INFO - Change directory to script path
2019-08-16 14:00:10,523 - INFO - Spreadsheet downloaded
2019-08-16 14:00:10,525 - INFO - Checking sheet..
2019-08-16 14:00:12,358 - INFO - Value detected - use sheet: Case 1
2019-08-16 14:00:12,358 - INFO - Reading Data From Google Sheet...
2019-08-16 14:00:13,010 - INFO - Get custom SQL..
2019-08-16 14:00:13,010 - INFO - USING CASE 1
2019-08-16 14:00:15,253 - INFO - Row 1
2019-08-16 14:00:15,255 - INFO - Filename: A30 Electronics Buyers
2019-08-16 14:00:15,255 - INFO - Category: 'Home'
2019-08-16 14:00:15,256 - INFO - Last Login: 30
2019-08-16 14:00:15,256 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-16 14:00:15,256 - INFO - Start Running query A30 Electronics Buyers
2019-08-16 14:00:16,967 - INFO - java.sql.SQLException: Query failed (#20190816_070035_00032_efmg6): Cluster is still initializing, there are insufficient active worker nodes (0) to run query
2019-08-16 14:00:17,022 - INFO - java.sql.SQLException: Query failed (#20190816_070035_00033_efmg6): Cluster is still initializing, there are insufficient active worker nodes (0) to run query
2019-08-16 14:00:17,076 - INFO - java.sql.SQLException: Query failed (#20190816_070035_00034_efmg6): Cluster is still initializing, there are insufficient active worker nodes (0) to run query
2019-08-16 14:00:17,125 - INFO - java.sql.SQLException: Query failed (#20190816_070035_00035_efmg6): Cluster is still initializing, there are insufficient active worker nodes (0) to run query
2019-08-16 14:00:17,177 - INFO - java.sql.SQLException: Query failed (#20190816_070035_00036_efmg6): Cluster is still initializing, there are insufficient active worker nodes (0) to run query
2019-08-16 14:00:17,178 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-08-16 14:00:17,180 - INFO - Start sending...
2019-08-16 14:00:28,463 - INFO - Message sent successfully
2019-08-16 14:00:31,190 - INFO - Row 2
2019-08-16 14:00:31,190 - INFO - Filename: A30 Home & Living
2019-08-16 14:00:31,191 - INFO - Category: 'Home & Living'
2019-08-16 14:00:31,191 - INFO - Last Login: 30
2019-08-16 14:00:31,191 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-16 14:00:31,193 - INFO - Start Running query A30 Home & Living
2019-08-16 14:03:03,134 - INFO - Running A30 Home & Living Done
2019-08-16 14:03:03,135 - INFO - CSV file path: A30 Home & Living
2019-08-16 14:03:03,380 - INFO - Starting save the query results
2019-08-16 14:03:03,381 - INFO - Total Rows : 6456983
2019-08-16 14:03:03,381 - INFO - Will split into : 7.0 files
2019-08-16 14:03:07,572 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Home & Living_1.csv
2019-08-16 14:03:07,572 - INFO - , with total : 922427 rows
2019-08-16 14:03:11,615 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Home & Living_2.csv
2019-08-16 14:03:11,617 - INFO - , with total : 922426 rows
2019-08-16 14:03:15,750 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Home & Living_3.csv
2019-08-16 14:03:15,750 - INFO - , with total : 922426 rows
2019-08-16 14:03:20,007 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Home & Living_4.csv
2019-08-16 14:03:20,009 - INFO - , with total : 922426 rows
2019-08-16 14:03:24,246 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Home & Living_5.csv
2019-08-16 14:03:24,247 - INFO - , with total : 922426 rows
2019-08-16 14:03:28,473 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Home & Living_6.csv
2019-08-16 14:03:28,473 - INFO - , with total : 922426 rows
2019-08-16 14:03:32,719 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Home & Living_7.csv
2019-08-16 14:03:32,720 - INFO - , with total : 922426 rows
2019-08-16 14:03:35,592 - INFO - Row 3
2019-08-16 14:03:35,592 - INFO - Filename: A30 Lifestyle
2019-08-16 14:03:35,592 - INFO - Category: 'Sports & Outdoor'
2019-08-16 14:03:35,594 - INFO - Last Login: 30
2019-08-16 14:03:35,594 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-16 14:03:35,594 - INFO - Start Running query A30 Lifestyle
2019-08-16 14:05:10,453 - INFO - Running A30 Lifestyle Done
2019-08-16 14:05:10,454 - INFO - CSV file path: A30 Lifestyle
2019-08-16 14:05:10,549 - INFO - Starting save the query results
2019-08-16 14:05:10,551 - INFO - Total Rows : 2701522
2019-08-16 14:05:10,551 - INFO - Will split into : 3.0 files
2019-08-16 14:05:14,516 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Lifestyle_1.csv
2019-08-16 14:05:14,516 - INFO - , with total : 900508 rows
2019-08-16 14:05:18,509 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Lifestyle_2.csv
2019-08-16 14:05:18,510 - INFO - , with total : 900507 rows
2019-08-16 14:05:22,500 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Lifestyle_3.csv
2019-08-16 14:05:22,500 - INFO - , with total : 900507 rows
2019-08-16 14:05:25,336 - INFO - Row 4
2019-08-16 14:05:25,338 - INFO - Filename: A30 Fashion
2019-08-16 14:05:25,338 - INFO - Category: 'Fashion'
2019-08-16 14:05:25,338 - INFO - Last Login: 30
2019-08-16 14:05:25,339 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-16 14:05:25,339 - INFO - Start Running query A30 Fashion
2019-08-16 14:05:50,773 - INFO - Running A30 Fashion Done
2019-08-16 14:05:50,775 - INFO - CSV file path: A30 Fashion
2019-08-16 14:05:50,782 - INFO - Starting save the query results
2019-08-16 14:05:50,783 - INFO - Total Rows : 0
2019-08-16 14:05:50,785 - INFO - Will split into : 0.0 files
2019-08-16 14:05:50,786 - INFO - ERROR -> number sections must be larger than 0.
2019-08-16 14:05:50,786 - INFO - Start sending...
2019-08-16 14:06:01,104 - INFO - Message sent successfully
2019-08-16 14:06:01,772 - INFO - Delete all data in sheet: Case 1
2019-08-16 14:06:03,996 - INFO - No value detected on sheet: Case 2
2019-08-16 14:06:05,309 - INFO - No value detected on sheet: Case 3
2019-08-16 14:06:06,615 - INFO - Value detected - use sheet: Case 4
2019-08-16 14:06:06,615 - INFO - Reading Data From Google Sheet...
2019-08-16 14:06:07,259 - INFO - Get custom SQL..
2019-08-16 14:06:07,260 - INFO - USING CASE 4
2019-08-16 14:06:09,230 - INFO - Row 1
2019-08-16 14:06:09,232 - INFO - Filename: A30 Male Fashion
2019-08-16 14:06:09,232 - INFO - Last Login: 30
2019-08-16 14:06:09,233 - INFO - Gender: 1,3
2019-08-16 14:06:09,233 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid 
                                    where
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-16 14:06:09,233 - INFO - Start Running query A30 Male Fashion
2019-08-16 14:08:19,507 - INFO - Running A30 Male Fashion Done
2019-08-16 14:08:19,509 - INFO - CSV file path: A30 Male Fashion
2019-08-16 14:08:19,680 - INFO - Starting save the query results
2019-08-16 14:08:19,681 - INFO - Total Rows : 4606329
2019-08-16 14:08:19,681 - INFO - Will split into : 5.0 files
2019-08-16 14:08:23,806 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Male Fashion_1.csv
2019-08-16 14:08:23,808 - INFO - , with total : 921266 rows
2019-08-16 14:08:27,901 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Male Fashion_2.csv
2019-08-16 14:08:27,901 - INFO - , with total : 921266 rows
2019-08-16 14:08:32,023 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Male Fashion_3.csv
2019-08-16 14:08:32,023 - INFO - , with total : 921266 rows
2019-08-16 14:08:36,266 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Male Fashion_4.csv
2019-08-16 14:08:36,267 - INFO - , with total : 921266 rows
2019-08-16 14:08:40,984 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 14.00/A30 Male Fashion_5.csv
2019-08-16 14:08:40,986 - INFO - , with total : 921265 rows
2019-08-16 14:08:41,703 - INFO - Delete all data in sheet: Case 4
2019-08-16 14:08:43,874 - INFO - No value detected on sheet: Case 5
2019-08-16 14:08:44,460 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-16 14:08:44,779 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-16 14:08:45,375 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-16 14:08:45,960 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-16 14:08:46,553 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-16 14:08:47,148 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-16 14:08:47,742 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-16 14:08:48,137 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-16 14:08:48,747 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-16 14:08:49,068 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-16 17:00:02,371 - INFO - Report date: 20190816 17.00
2019-08-16 17:00:07,897 - INFO - Download sheet..
2019-08-16 17:00:07,898 - INFO - Change directory to script path
2019-08-16 17:00:09,045 - INFO - Spreadsheet downloaded
2019-08-16 17:00:09,046 - INFO - Checking sheet..
2019-08-16 17:00:11,121 - INFO - Value detected - use sheet: Case 1
2019-08-16 17:00:11,122 - INFO - Reading Data From Google Sheet...
2019-08-16 17:00:11,926 - INFO - Get custom SQL..
2019-08-16 17:00:11,927 - INFO - USING CASE 1
2019-08-16 17:00:14,397 - INFO - Row 1
2019-08-16 17:00:14,398 - INFO - Filename: A30 FACC Buyers 
2019-08-16 17:00:14,398 - INFO - Category: 'Fashion Accessories'
2019-08-16 17:00:14,398 - INFO - Last Login: 30
2019-08-16 17:00:14,400 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-16 17:00:14,401 - INFO - Start Running query A30 FACC Buyers 
2019-08-16 17:02:11,009 - INFO - Running A30 FACC Buyers  Done
2019-08-16 17:02:11,009 - INFO - CSV file path: A30 FACC Buyers 
2019-08-16 17:02:11,178 - INFO - Starting save the query results
2019-08-16 17:02:11,180 - INFO - Total Rows : 4560448
2019-08-16 17:02:11,180 - INFO - Will split into : 5.0 files
2019-08-16 17:02:15,256 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A30 FACC Buyers _1.csv
2019-08-16 17:02:15,257 - INFO - , with total : 912090 rows
2019-08-16 17:02:19,312 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A30 FACC Buyers _2.csv
2019-08-16 17:02:19,313 - INFO - , with total : 912090 rows
2019-08-16 17:02:23,536 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A30 FACC Buyers _3.csv
2019-08-16 17:02:23,536 - INFO - , with total : 912090 rows
2019-08-16 17:02:27,750 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A30 FACC Buyers _4.csv
2019-08-16 17:02:27,752 - INFO - , with total : 912089 rows
2019-08-16 17:02:31,977 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A30 FACC Buyers _5.csv
2019-08-16 17:02:31,979 - INFO - , with total : 912089 rows
2019-08-16 17:02:35,487 - INFO - Row 2
2019-08-16 17:02:35,489 - INFO - Filename: A30 BKF Buyers
2019-08-16 17:02:35,490 - INFO - Category: 'Baby & Kids Fashion'
2019-08-16 17:02:35,490 - INFO - Last Login: 30
2019-08-16 17:02:35,490 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-16 17:02:35,490 - INFO - Start Running query A30 BKF Buyers
2019-08-16 17:04:14,496 - INFO - Running A30 BKF Buyers Done
2019-08-16 17:04:14,496 - INFO - CSV file path: A30 BKF Buyers
2019-08-16 17:04:14,624 - INFO - Starting save the query results
2019-08-16 17:04:14,625 - INFO - Total Rows : 3503096
2019-08-16 17:04:14,625 - INFO - Will split into : 4.0 files
2019-08-16 17:04:18,525 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A30 BKF Buyers_1.csv
2019-08-16 17:04:18,526 - INFO - , with total : 875774 rows
2019-08-16 17:04:22,404 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A30 BKF Buyers_2.csv
2019-08-16 17:04:22,404 - INFO - , with total : 875774 rows
2019-08-16 17:04:26,961 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A30 BKF Buyers_3.csv
2019-08-16 17:04:26,963 - INFO - , with total : 875774 rows
2019-08-16 17:04:30,984 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A30 BKF Buyers_4.csv
2019-08-16 17:04:30,984 - INFO - , with total : 875774 rows
2019-08-16 17:04:31,987 - INFO - Delete all data in sheet: Case 1
2019-08-16 17:04:34,668 - INFO - No value detected on sheet: Case 2
2019-08-16 17:04:35,888 - INFO - No value detected on sheet: Case 3
2019-08-16 17:04:37,108 - INFO - No value detected on sheet: Case 4
2019-08-16 17:04:38,726 - INFO - No value detected on sheet: Case 5
2019-08-16 17:04:39,957 - INFO - Value detected - use sheet: Case 6
2019-08-16 17:04:39,957 - INFO - Reading Data From Google Sheet...
2019-08-16 17:04:40,392 - INFO - Get custom SQL..
2019-08-16 17:04:40,394 - INFO - USING CASE 6
2019-08-16 17:04:42,453 - INFO - Row 1
2019-08-16 17:04:42,453 - INFO - Filename: A30 FMCG Buyers
2019-08-16 17:04:42,454 - INFO - Sub-category: 'Health','Beauty','Mom & Baby'
2019-08-16 17:04:42,454 - INFO - Last Login: 30
2019-08-16 17:04:42,456 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-16 17:04:42,456 - INFO - Start Running query A30 FMCG Buyers
2019-08-16 17:05:22,358 - INFO - Running A30 FMCG Buyers Done
2019-08-16 17:05:22,358 - INFO - CSV file path: A30 FMCG Buyers
2019-08-16 17:05:22,367 - INFO - Starting save the query results
2019-08-16 17:05:22,367 - INFO - Total Rows : 0
2019-08-16 17:05:22,368 - INFO - Will split into : 0.0 files
2019-08-16 17:05:22,368 - INFO - ERROR -> number sections must be larger than 0.
2019-08-16 17:05:22,368 - INFO - Start sending...
2019-08-16 17:05:30,275 - INFO - Message sent successfully
2019-08-16 17:05:31,147 - INFO - Delete all data in sheet: Case 6
2019-08-16 17:05:33,221 - INFO - No value detected on sheet: Case 7
2019-08-16 17:05:34,457 - INFO - No value detected on sheet: Case 8
2019-08-16 17:05:36,071 - INFO - Value detected - use sheet: Case 9
2019-08-16 17:05:36,072 - INFO - Reading Data From Google Sheet...
2019-08-16 17:05:36,875 - INFO - Get custom SQL..
2019-08-16 17:05:36,877 - INFO - USING CASE 9
2019-08-16 17:05:38,132 - INFO - Row 1
2019-08-16 17:05:38,134 - INFO - Filename: A14 DP buyers
2019-08-16 17:05:38,134 - INFO - Last Login: 14
2019-08-16 17:05:38,135 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '14' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-16 17:05:38,135 - INFO - Start Running query A14 DP buyers
2019-08-16 17:06:45,035 - INFO - Running A14 DP buyers Done
2019-08-16 17:06:45,036 - INFO - CSV file path: A14 DP buyers
2019-08-16 17:06:45,118 - INFO - Starting save the query results
2019-08-16 17:06:45,119 - INFO - Total Rows : 2244242
2019-08-16 17:06:45,119 - INFO - Will split into : 3.0 files
2019-08-16 17:06:48,526 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 DP buyers_1.csv
2019-08-16 17:06:48,528 - INFO - , with total : 748081 rows
2019-08-16 17:06:51,914 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 DP buyers_2.csv
2019-08-16 17:06:51,915 - INFO - , with total : 748081 rows
2019-08-16 17:06:55,256 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 DP buyers_3.csv
2019-08-16 17:06:55,257 - INFO - , with total : 748080 rows
2019-08-16 17:06:56,197 - INFO - Delete all data in sheet: Case 9
2019-08-16 17:06:58,312 - INFO - Value detected - use sheet: Case 10
2019-08-16 17:06:58,312 - INFO - Reading Data From Google Sheet...
2019-08-16 17:06:59,101 - INFO - Get custom SQL..
2019-08-16 17:06:59,101 - INFO - USING CASE 10
2019-08-16 17:07:00,763 - INFO - Row 1
2019-08-16 17:07:00,765 - INFO - Filename: A14 who haven't bought DP
2019-08-16 17:07:00,765 - INFO - Last Login: 14
2019-08-16 17:07:00,765 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Automotive','Baby & Kids Fashion','Beauty','Computer & Accessories','Cosmetics','Electronics','Fashion Accessories','Food & Beverages','Health','Health & Beauty','Hobby & Collection','Home & Living','Men','Bags','Men Clothes','Men Shoes','Mobile & Accessories','Mom & Baby','Muslim Fashion','Others','Photography','Souvenir & Party Supplies','Sports & Outdoor','Stationery & Books','Vouchers','Watches','Women Bags','Women Clothes','Women Shoes') 
                                    and
                                    last_login >= current_date - interval '14' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-16 17:07:00,766 - INFO - Start Running query A14 who haven't bought DP
2019-08-16 17:12:35,137 - INFO - Running A14 who haven't bought DP Done
2019-08-16 17:12:35,138 - INFO - CSV file path: A14 who haven't bought DP
2019-08-16 17:12:35,721 - INFO - Starting save the query results
2019-08-16 17:12:35,721 - INFO - Total Rows : 11668690
2019-08-16 17:12:35,723 - INFO - Will split into : 12.0 files
2019-08-16 17:12:40,349 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_1.csv
2019-08-16 17:12:40,351 - INFO - , with total : 972391 rows
2019-08-16 17:12:44,816 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_2.csv
2019-08-16 17:12:44,818 - INFO - , with total : 972391 rows
2019-08-16 17:12:49,341 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_3.csv
2019-08-16 17:12:49,342 - INFO - , with total : 972391 rows
2019-08-16 17:12:53,858 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_4.csv
2019-08-16 17:12:53,858 - INFO - , with total : 972391 rows
2019-08-16 17:12:58,569 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_5.csv
2019-08-16 17:12:58,571 - INFO - , with total : 972391 rows
2019-08-16 17:13:03,267 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_6.csv
2019-08-16 17:13:03,269 - INFO - , with total : 972391 rows
2019-08-16 17:13:08,270 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_7.csv
2019-08-16 17:13:08,273 - INFO - , with total : 972391 rows
2019-08-16 17:13:12,897 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_8.csv
2019-08-16 17:13:12,898 - INFO - , with total : 972391 rows
2019-08-16 17:13:17,444 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_9.csv
2019-08-16 17:13:17,446 - INFO - , with total : 972391 rows
2019-08-16 17:13:22,137 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_10.csv
2019-08-16 17:13:22,138 - INFO - , with total : 972391 rows
2019-08-16 17:13:26,733 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_11.csv
2019-08-16 17:13:26,733 - INFO - , with total : 972390 rows
2019-08-16 17:13:31,250 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190816 17.00/A14 who haven't bought DP_12.csv
2019-08-16 17:13:31,250 - INFO - , with total : 972390 rows
2019-08-16 17:13:32,898 - INFO - Delete all data in sheet: Case 10
2019-08-16 17:13:35,500 - INFO - No value detected on sheet: Case 11
2019-08-16 17:13:37,128 - INFO - No value detected on sheet: Case 12
2019-08-16 17:13:38,858 - INFO - No value detected on sheet: Case 13
2019-08-16 17:13:40,479 - INFO - No value detected on sheet: Case 14
2019-08-16 17:13:42,247 - INFO - No value detected on sheet: Case 15
2019-08-17 10:00:03,088 - INFO - Report date: 20190817 10.00
2019-08-17 10:00:07,420 - INFO - Download sheet..
2019-08-17 10:00:07,421 - INFO - Change directory to script path
2019-08-17 10:00:09,056 - INFO - Spreadsheet downloaded
2019-08-17 10:00:09,058 - INFO - Checking sheet..
2019-08-17 10:00:11,414 - INFO - Value detected - use sheet: Case 1
2019-08-17 10:00:11,414 - INFO - Reading Data From Google Sheet...
2019-08-17 10:00:12,213 - INFO - Get custom SQL..
2019-08-17 10:00:12,213 - INFO - USING CASE 1
2019-08-17 10:00:14,595 - INFO - Row 1
2019-08-17 10:00:14,596 - INFO - Filename: A30 Fashion
2019-08-17 10:00:14,596 - INFO - Category: 'Fashion Accessories'
2019-08-17 10:00:14,598 - INFO - Last Login: 30
2019-08-17 10:00:14,598 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-17 10:00:14,598 - INFO - Start Running query A30 Fashion
2019-08-17 10:02:12,226 - INFO - Running A30 Fashion Done
2019-08-17 10:02:12,226 - INFO - CSV file path: A30 Fashion
2019-08-17 10:02:12,430 - INFO - Starting save the query results
2019-08-17 10:02:12,430 - INFO - Total Rows : 4569282
2019-08-17 10:02:12,430 - INFO - Will split into : 5.0 files
2019-08-17 10:02:16,430 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190817 10.00/A30 Fashion_1.csv
2019-08-17 10:02:16,430 - INFO - , with total : 913857 rows
2019-08-17 10:02:20,401 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190817 10.00/A30 Fashion_2.csv
2019-08-17 10:02:20,404 - INFO - , with total : 913857 rows
2019-08-17 10:02:24,561 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190817 10.00/A30 Fashion_3.csv
2019-08-17 10:02:24,562 - INFO - , with total : 913856 rows
2019-08-17 10:02:28,697 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190817 10.00/A30 Fashion_4.csv
2019-08-17 10:02:28,698 - INFO - , with total : 913856 rows
2019-08-17 10:02:32,934 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190817 10.00/A30 Fashion_5.csv
2019-08-17 10:02:32,936 - INFO - , with total : 913856 rows
2019-08-17 10:02:33,653 - INFO - Delete all data in sheet: Case 1
2019-08-17 10:02:35,414 - INFO - No value detected on sheet: Case 2
2019-08-17 10:02:36,604 - INFO - No value detected on sheet: Case 3
2019-08-17 10:02:38,196 - INFO - No value detected on sheet: Case 4
2019-08-17 10:02:39,783 - INFO - No value detected on sheet: Case 5
2019-08-17 10:02:41,380 - INFO - Value detected - use sheet: Case 6
2019-08-17 10:02:41,381 - INFO - Reading Data From Google Sheet...
2019-08-17 10:02:42,174 - INFO - Get custom SQL..
2019-08-17 10:02:42,174 - INFO - USING CASE 6
2019-08-17 10:02:44,651 - INFO - Row 1
2019-08-17 10:02:44,653 - INFO - Filename: A30 Beauty Tools
2019-08-17 10:02:44,654 - INFO - Sub-category: 'Beauty Tools'
2019-08-17 10:02:44,654 - INFO - Last Login: 30
2019-08-17 10:02:44,655 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Beauty Tools')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-17 10:02:44,657 - INFO - Start Running query A30 Beauty Tools
2019-08-17 10:03:44,641 - INFO - Running A30 Beauty Tools Done
2019-08-17 10:03:44,641 - INFO - CSV file path: A30 Beauty Tools
2019-08-17 10:03:44,729 - INFO - Starting save the query results
2019-08-17 10:03:44,730 - INFO - Total Rows : 2237665
2019-08-17 10:03:44,730 - INFO - Will split into : 3.0 files
2019-08-17 10:03:47,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190817 10.00/A30 Beauty Tools_1.csv
2019-08-17 10:03:47,967 - INFO - , with total : 745889 rows
2019-08-17 10:03:51,289 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190817 10.00/A30 Beauty Tools_2.csv
2019-08-17 10:03:51,305 - INFO - , with total : 745888 rows
2019-08-17 10:03:54,568 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190817 10.00/A30 Beauty Tools_3.csv
2019-08-17 10:03:54,568 - INFO - , with total : 745888 rows
2019-08-17 10:03:55,493 - INFO - Delete all data in sheet: Case 6
2019-08-17 10:03:57,917 - INFO - Value detected - use sheet: Case 7
2019-08-17 10:03:57,918 - INFO - Reading Data From Google Sheet...
2019-08-17 10:03:58,308 - INFO - Get custom SQL..
2019-08-17 10:03:58,308 - INFO - USING CASE 7
2019-08-17 10:04:01,558 - INFO - Row 1
2019-08-17 10:04:01,559 - INFO - Filename: Women Clothing & FACC buyers who haven't shopped L30D
2019-08-17 10:04:01,559 - INFO - Sub-category: 'Women Clothes','Fashion Accessories'
2019-08-17 10:04:01,559 - INFO - Last Login: 30
2019-08-17 10:04:01,561 - INFO - Date 1: 2019-07-15
2019-08-17 10:04:01,562 - INFO - Date 2: 2019-08-15
2019-08-17 10:04:01,562 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Women Clothes','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-15' and date'2019-08-15'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-17 10:04:01,562 - INFO - Start Running query Women Clothing & FACC buyers who haven't shopped L30D
2019-08-17 10:04:22,677 - INFO - Running Women Clothing & FACC buyers who haven't shopped L30D Done
2019-08-17 10:04:22,677 - INFO - CSV file path: Women Clothing & FACC buyers who haven't shopped L30D
2019-08-17 10:04:22,693 - INFO - Starting save the query results
2019-08-17 10:04:22,693 - INFO - Total Rows : 0
2019-08-17 10:04:22,693 - INFO - Will split into : 0.0 files
2019-08-17 10:04:22,693 - INFO - ERROR -> number sections must be larger than 0.
2019-08-17 10:04:22,693 - INFO - Start sending...
2019-08-17 10:04:31,082 - INFO - Message sent successfully
2019-08-17 10:04:34,239 - INFO - Row 2
2019-08-17 10:04:34,239 - INFO - Filename: Men Clothing & FACC buyers who haven't shopped L30D
2019-08-17 10:04:34,239 - INFO - Sub-category: 'Men Clothes','Fashion Accessories'
2019-08-17 10:04:34,239 - INFO - Last Login: 30
2019-08-17 10:04:34,239 - INFO - Date 1: 2019-07-15
2019-08-17 10:04:34,239 - INFO - Date 2: 2019-08-15
2019-08-17 10:04:34,239 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Men Clothes','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-15' and date'2019-08-15'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-17 10:04:34,239 - INFO - Start Running query Men Clothing & FACC buyers who haven't shopped L30D
2019-08-17 10:04:51,821 - INFO - Running Men Clothing & FACC buyers who haven't shopped L30D Done
2019-08-17 10:04:51,822 - INFO - CSV file path: Men Clothing & FACC buyers who haven't shopped L30D
2019-08-17 10:04:51,825 - INFO - Starting save the query results
2019-08-17 10:04:51,825 - INFO - Total Rows : 0
2019-08-17 10:04:51,825 - INFO - Will split into : 0.0 files
2019-08-17 10:04:51,826 - INFO - ERROR -> number sections must be larger than 0.
2019-08-17 10:04:51,826 - INFO - Start sending...
2019-08-17 10:04:59,000 - INFO - Message sent successfully
2019-08-17 10:05:01,802 - INFO - Row 3
2019-08-17 10:05:01,802 - INFO - Filename: Baby & Kids Fashion buyers who haven't shopped L30D
2019-08-17 10:05:01,802 - INFO - Sub-category: 'Baby & Kids Fashion'
2019-08-17 10:05:01,802 - INFO - Last Login: 30
2019-08-17 10:05:01,802 - INFO - Date 1: 2019-07-15
2019-08-17 10:05:01,802 - INFO - Date 2: 2019-08-15
2019-08-17 10:05:01,802 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-15' and date'2019-08-15'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-17 10:05:01,802 - INFO - Start Running query Baby & Kids Fashion buyers who haven't shopped L30D
2019-08-17 10:05:24,173 - INFO - Running Baby & Kids Fashion buyers who haven't shopped L30D Done
2019-08-17 10:05:24,174 - INFO - CSV file path: Baby & Kids Fashion buyers who haven't shopped L30D
2019-08-17 10:05:24,176 - INFO - Starting save the query results
2019-08-17 10:05:24,177 - INFO - Total Rows : 0
2019-08-17 10:05:24,177 - INFO - Will split into : 0.0 files
2019-08-17 10:05:24,177 - INFO - ERROR -> number sections must be larger than 0.
2019-08-17 10:05:24,178 - INFO - Start sending...
2019-08-17 10:05:31,542 - INFO - Message sent successfully
2019-08-17 10:05:31,948 - INFO - Delete all data in sheet: Case 7
2019-08-17 10:05:33,677 - INFO - No value detected on sheet: Case 8
2019-08-17 10:05:34,461 - INFO - No value detected on sheet: Case 9
2019-08-17 10:05:35,680 - INFO - No value detected on sheet: Case 10
2019-08-17 10:05:36,976 - INFO - No value detected on sheet: Case 11
2019-08-17 10:05:38,163 - INFO - No value detected on sheet: Case 12
2019-08-17 10:05:39,361 - INFO - No value detected on sheet: Case 13
2019-08-17 10:05:40,130 - INFO - No value detected on sheet: Case 14
2019-08-17 10:05:41,438 - INFO - No value detected on sheet: Case 15
2019-08-17 14:00:02,042 - INFO - Report date: 20190817 14.00
2019-08-17 14:00:05,569 - INFO - Download sheet..
2019-08-17 14:00:05,569 - INFO - Change directory to script path
2019-08-17 14:00:07,275 - INFO - Spreadsheet downloaded
2019-08-17 14:00:07,275 - INFO - Checking sheet..
2019-08-17 14:00:09,200 - INFO - No value detected on sheet: Case 1
2019-08-17 14:00:10,744 - INFO - No value detected on sheet: Case 2
2019-08-17 14:00:12,296 - INFO - No value detected on sheet: Case 3
2019-08-17 14:00:13,872 - INFO - No value detected on sheet: Case 4
2019-08-17 14:00:15,434 - INFO - No value detected on sheet: Case 5
2019-08-17 14:00:16,990 - INFO - No value detected on sheet: Case 6
2019-08-17 14:00:18,546 - INFO - No value detected on sheet: Case 7
2019-08-17 14:00:20,086 - INFO - No value detected on sheet: Case 8
2019-08-17 14:00:21,697 - INFO - No value detected on sheet: Case 9
2019-08-17 14:00:23,244 - INFO - No value detected on sheet: Case 10
2019-08-17 14:00:24,792 - INFO - No value detected on sheet: Case 11
2019-08-17 14:00:26,338 - INFO - No value detected on sheet: Case 12
2019-08-17 14:00:27,976 - INFO - No value detected on sheet: Case 13
2019-08-17 14:00:28,694 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-17 14:00:29,398 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-17 17:00:01,917 - INFO - Report date: 20190817 17.00
2019-08-17 17:00:06,049 - INFO - Download sheet..
2019-08-17 17:00:06,049 - INFO - Change directory to script path
2019-08-17 17:00:07,519 - INFO - Spreadsheet downloaded
2019-08-17 17:00:07,519 - INFO - Checking sheet..
2019-08-17 17:00:09,581 - INFO - No value detected on sheet: Case 1
2019-08-17 17:00:11,173 - INFO - No value detected on sheet: Case 2
2019-08-17 17:00:12,752 - INFO - No value detected on sheet: Case 3
2019-08-17 17:00:14,358 - INFO - No value detected on sheet: Case 4
2019-08-17 17:00:15,947 - INFO - No value detected on sheet: Case 5
2019-08-17 17:00:17,540 - INFO - No value detected on sheet: Case 6
2019-08-17 17:00:19,132 - INFO - No value detected on sheet: Case 7
2019-08-17 17:00:20,822 - INFO - No value detected on sheet: Case 8
2019-08-17 17:00:22,431 - INFO - No value detected on sheet: Case 9
2019-08-17 17:00:24,009 - INFO - No value detected on sheet: Case 10
2019-08-17 17:00:25,585 - INFO - No value detected on sheet: Case 11
2019-08-17 17:00:27,160 - INFO - No value detected on sheet: Case 12
2019-08-17 17:00:28,736 - INFO - No value detected on sheet: Case 13
2019-08-17 17:00:30,313 - INFO - No value detected on sheet: Case 14
2019-08-17 17:00:31,885 - INFO - No value detected on sheet: Case 15
2019-08-18 10:00:03,928 - INFO - Report date: 20190818 10.00
2019-08-18 10:00:09,530 - INFO - Download sheet..
2019-08-18 10:00:09,532 - INFO - Change directory to script path
2019-08-18 10:00:10,963 - INFO - Spreadsheet downloaded
2019-08-18 10:00:10,964 - INFO - Checking sheet..
2019-08-18 10:00:12,999 - INFO - No value detected on sheet: Case 1
2019-08-18 10:00:14,628 - INFO - No value detected on sheet: Case 2
2019-08-18 10:00:16,253 - INFO - No value detected on sheet: Case 3
2019-08-18 10:00:17,905 - INFO - No value detected on sheet: Case 4
2019-08-18 10:00:19,551 - INFO - No value detected on sheet: Case 5
2019-08-18 10:00:21,165 - INFO - No value detected on sheet: Case 6
2019-08-18 10:00:22,799 - INFO - No value detected on sheet: Case 7
2019-08-18 10:00:24,418 - INFO - No value detected on sheet: Case 8
2019-08-18 10:00:26,052 - INFO - No value detected on sheet: Case 9
2019-08-18 10:00:27,655 - INFO - No value detected on sheet: Case 10
2019-08-18 10:00:29,270 - INFO - No value detected on sheet: Case 11
2019-08-18 10:00:30,973 - INFO - No value detected on sheet: Case 12
2019-08-18 10:00:32,615 - INFO - No value detected on sheet: Case 13
2019-08-18 10:00:34,217 - INFO - No value detected on sheet: Case 14
2019-08-18 10:00:35,940 - INFO - No value detected on sheet: Case 15
2019-08-18 14:00:02,075 - INFO - Report date: 20190818 14.00
2019-08-18 14:00:05,634 - INFO - Download sheet..
2019-08-18 14:00:05,634 - INFO - Change directory to script path
2019-08-18 14:00:06,917 - INFO - Spreadsheet downloaded
2019-08-18 14:00:06,917 - INFO - Checking sheet..
2019-08-18 14:00:08,875 - INFO - No value detected on sheet: Case 1
2019-08-18 14:00:10,467 - INFO - No value detected on sheet: Case 2
2019-08-18 14:00:12,049 - INFO - No value detected on sheet: Case 3
2019-08-18 14:00:13,608 - INFO - No value detected on sheet: Case 4
2019-08-18 14:00:15,211 - INFO - No value detected on sheet: Case 5
2019-08-18 14:00:16,819 - INFO - No value detected on sheet: Case 6
2019-08-18 14:00:18,391 - INFO - No value detected on sheet: Case 7
2019-08-18 14:00:19,974 - INFO - No value detected on sheet: Case 8
2019-08-18 14:00:21,578 - INFO - No value detected on sheet: Case 9
2019-08-18 14:00:23,157 - INFO - No value detected on sheet: Case 10
2019-08-18 14:00:24,737 - INFO - No value detected on sheet: Case 11
2019-08-18 14:00:26,311 - INFO - No value detected on sheet: Case 12
2019-08-18 14:00:27,903 - INFO - No value detected on sheet: Case 13
2019-08-18 14:00:29,499 - INFO - No value detected on sheet: Case 14
2019-08-18 14:00:31,062 - INFO - No value detected on sheet: Case 15
2019-08-18 17:00:01,773 - INFO - Report date: 20190818 17.00
2019-08-18 17:00:05,803 - INFO - Download sheet..
2019-08-18 17:00:05,803 - INFO - Change directory to script path
2019-08-18 17:00:07,229 - INFO - Spreadsheet downloaded
2019-08-18 17:00:07,229 - INFO - Checking sheet..
2019-08-18 17:00:09,201 - INFO - No value detected on sheet: Case 1
2019-08-18 17:00:10,770 - INFO - No value detected on sheet: Case 2
2019-08-18 17:00:12,387 - INFO - No value detected on sheet: Case 3
2019-08-18 17:00:13,987 - INFO - No value detected on sheet: Case 4
2019-08-18 17:00:15,618 - INFO - No value detected on sheet: Case 5
2019-08-18 17:00:17,348 - INFO - No value detected on sheet: Case 6
2019-08-18 17:00:18,928 - INFO - No value detected on sheet: Case 7
2019-08-18 17:00:20,496 - INFO - No value detected on sheet: Case 8
2019-08-18 17:00:22,388 - INFO - No value detected on sheet: Case 9
2019-08-18 17:00:23,960 - INFO - No value detected on sheet: Case 10
2019-08-18 17:00:25,565 - INFO - No value detected on sheet: Case 11
2019-08-18 17:00:27,148 - INFO - No value detected on sheet: Case 12
2019-08-18 17:00:28,713 - INFO - No value detected on sheet: Case 13
2019-08-18 17:00:30,315 - INFO - No value detected on sheet: Case 14
2019-08-18 17:00:31,901 - INFO - No value detected on sheet: Case 15
2019-08-19 10:00:04,153 - INFO - Report date: 20190819 10.00
2019-08-19 10:00:08,443 - INFO - Download sheet..
2019-08-19 10:00:08,443 - INFO - Change directory to script path
2019-08-19 10:00:09,780 - INFO - Spreadsheet downloaded
2019-08-19 10:00:09,782 - INFO - Checking sheet..
2019-08-19 10:00:11,401 - INFO - No value detected on sheet: Case 1
2019-08-19 10:00:12,555 - INFO - No value detected on sheet: Case 2
2019-08-19 10:00:13,733 - INFO - No value detected on sheet: Case 3
2019-08-19 10:00:14,931 - INFO - No value detected on sheet: Case 4
2019-08-19 10:00:16,256 - INFO - No value detected on sheet: Case 5
2019-08-19 10:00:17,434 - INFO - No value detected on sheet: Case 6
2019-08-19 10:00:18,586 - INFO - No value detected on sheet: Case 7
2019-08-19 10:00:19,736 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%208%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-19 10:00:20,869 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%209%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-19 10:00:21,397 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-19 10:00:21,898 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-19 10:00:22,403 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-19 10:00:22,921 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-19 10:00:23,436 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-19 10:00:24,111 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-19 14:00:04,948 - INFO - Report date: 20190819 14.00
2019-08-19 14:00:08,539 - INFO - Download sheet..
2019-08-19 14:00:08,539 - INFO - Change directory to script path
2019-08-19 14:00:10,548 - INFO - Spreadsheet downloaded
2019-08-19 14:00:10,549 - INFO - Checking sheet..
2019-08-19 14:00:12,467 - INFO - Value detected - use sheet: Case 1
2019-08-19 14:00:12,467 - INFO - Reading Data From Google Sheet...
2019-08-19 14:00:13,463 - INFO - Get custom SQL..
2019-08-19 14:00:13,464 - INFO - USING CASE 1
2019-08-19 14:00:15,982 - INFO - Row 1
2019-08-19 14:00:15,983 - INFO - Filename: A30 Baby & Kids Fashion and Mom & Baby buyers
2019-08-19 14:00:15,983 - INFO - Category: 'Baby & Kids Fashion','Mom & Baby'
2019-08-19 14:00:15,983 - INFO - Last Login: 30
2019-08-19 14:00:15,983 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-19 14:00:15,984 - INFO - Start Running query A30 Baby & Kids Fashion and Mom & Baby buyers
2019-08-19 14:08:46,381 - INFO - Running A30 Baby & Kids Fashion and Mom & Baby buyers Done
2019-08-19 14:08:46,381 - INFO - CSV file path: A30 Baby & Kids Fashion and Mom & Baby buyers
2019-08-19 14:08:46,647 - INFO - Starting save the query results
2019-08-19 14:08:46,648 - INFO - Total Rows : 5096281
2019-08-19 14:08:46,648 - INFO - Will split into : 6.0 files
2019-08-19 14:08:50,486 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Baby & Kids Fashion and Mom & Baby buyers_1.csv
2019-08-19 14:08:50,486 - INFO - , with total : 849381 rows
2019-08-19 14:08:54,201 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Baby & Kids Fashion and Mom & Baby buyers_2.csv
2019-08-19 14:08:54,203 - INFO - , with total : 849380 rows
2019-08-19 14:08:58,006 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Baby & Kids Fashion and Mom & Baby buyers_3.csv
2019-08-19 14:08:58,006 - INFO - , with total : 849380 rows
2019-08-19 14:09:01,881 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Baby & Kids Fashion and Mom & Baby buyers_4.csv
2019-08-19 14:09:01,881 - INFO - , with total : 849380 rows
2019-08-19 14:09:05,831 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Baby & Kids Fashion and Mom & Baby buyers_5.csv
2019-08-19 14:09:05,832 - INFO - , with total : 849380 rows
2019-08-19 14:09:09,828 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Baby & Kids Fashion and Mom & Baby buyers_6.csv
2019-08-19 14:09:09,829 - INFO - , with total : 849380 rows
2019-08-19 14:09:12,892 - INFO - Row 2
2019-08-19 14:09:12,892 - INFO - Filename: A30 Beauty + FMCG Health & Beauty buyers
2019-08-19 14:09:12,894 - INFO - Category: 'Beauty','Health & Beauty'
2019-08-19 14:09:12,894 - INFO - Last Login: 30
2019-08-19 14:09:12,894 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty','Health & Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-19 14:09:12,894 - INFO - Start Running query A30 Beauty + FMCG Health & Beauty buyers
2019-08-19 14:14:14,842 - INFO - Running A30 Beauty + FMCG Health & Beauty buyers Done
2019-08-19 14:14:14,842 - INFO - CSV file path: A30 Beauty + FMCG Health & Beauty buyers
2019-08-19 14:14:15,161 - INFO - Starting save the query results
2019-08-19 14:14:15,163 - INFO - Total Rows : 7767502
2019-08-19 14:14:15,164 - INFO - Will split into : 8.0 files
2019-08-19 14:14:19,568 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty + FMCG Health & Beauty buyers_1.csv
2019-08-19 14:14:19,569 - INFO - , with total : 970938 rows
2019-08-19 14:14:23,868 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty + FMCG Health & Beauty buyers_2.csv
2019-08-19 14:14:23,871 - INFO - , with total : 970938 rows
2019-08-19 14:14:28,290 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty + FMCG Health & Beauty buyers_3.csv
2019-08-19 14:14:28,292 - INFO - , with total : 970938 rows
2019-08-19 14:14:33,316 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty + FMCG Health & Beauty buyers_4.csv
2019-08-19 14:14:33,318 - INFO - , with total : 970938 rows
2019-08-19 14:14:37,815 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty + FMCG Health & Beauty buyers_5.csv
2019-08-19 14:14:37,815 - INFO - , with total : 970938 rows
2019-08-19 14:14:42,270 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty + FMCG Health & Beauty buyers_6.csv
2019-08-19 14:14:42,272 - INFO - , with total : 970938 rows
2019-08-19 14:14:46,746 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty + FMCG Health & Beauty buyers_7.csv
2019-08-19 14:14:46,750 - INFO - , with total : 970937 rows
2019-08-19 14:14:51,196 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty + FMCG Health & Beauty buyers_8.csv
2019-08-19 14:14:51,197 - INFO - , with total : 970937 rows
2019-08-19 14:14:54,290 - INFO - Row 3
2019-08-19 14:14:54,292 - INFO - Filename: A30 Beauty & Women Fashion
2019-08-19 14:14:54,292 - INFO - Category: 'Beauty','Women Bags','Women Clothes','Women Shoes'
2019-08-19 14:14:54,292 - INFO - Last Login: 30
2019-08-19 14:14:54,293 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty','Women Bags','Women Clothes','Women Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-19 14:14:54,293 - INFO - Start Running query A30 Beauty & Women Fashion
2019-08-19 14:21:00,951 - INFO - Running A30 Beauty & Women Fashion Done
2019-08-19 14:21:00,953 - INFO - CSV file path: A30 Beauty & Women Fashion
2019-08-19 14:21:01,381 - INFO - Starting save the query results
2019-08-19 14:21:01,381 - INFO - Total Rows : 10832940
2019-08-19 14:21:01,381 - INFO - Will split into : 11.0 files
2019-08-19 14:21:05,898 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_1.csv
2019-08-19 14:21:05,900 - INFO - , with total : 984813 rows
2019-08-19 14:21:10,233 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_2.csv
2019-08-19 14:21:10,233 - INFO - , with total : 984813 rows
2019-08-19 14:21:14,717 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_3.csv
2019-08-19 14:21:14,719 - INFO - , with total : 984813 rows
2019-08-19 14:21:19,269 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_4.csv
2019-08-19 14:21:19,270 - INFO - , with total : 984813 rows
2019-08-19 14:21:23,855 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_5.csv
2019-08-19 14:21:23,858 - INFO - , with total : 984813 rows
2019-08-19 14:21:28,486 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_6.csv
2019-08-19 14:21:28,486 - INFO - , with total : 984813 rows
2019-08-19 14:21:33,255 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_7.csv
2019-08-19 14:21:33,256 - INFO - , with total : 984813 rows
2019-08-19 14:21:38,486 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_8.csv
2019-08-19 14:21:38,489 - INFO - , with total : 984813 rows
2019-08-19 14:21:43,088 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_9.csv
2019-08-19 14:21:43,088 - INFO - , with total : 984812 rows
2019-08-19 14:21:47,596 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_10.csv
2019-08-19 14:21:47,598 - INFO - , with total : 984812 rows
2019-08-19 14:21:52,108 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty & Women Fashion_11.csv
2019-08-19 14:21:52,109 - INFO - , with total : 984812 rows
2019-08-19 14:21:53,483 - INFO - Delete all data in sheet: Case 1
2019-08-19 14:21:55,533 - INFO - No value detected on sheet: Case 2
2019-08-19 14:21:56,732 - INFO - No value detected on sheet: Case 3
2019-08-19 14:21:57,905 - INFO - No value detected on sheet: Case 4
2019-08-19 14:21:59,273 - INFO - Value detected - use sheet: Case 5
2019-08-19 14:21:59,273 - INFO - Reading Data From Google Sheet...
2019-08-19 14:21:59,888 - INFO - Get custom SQL..
2019-08-19 14:21:59,890 - INFO - USING CASE 5
2019-08-19 14:22:02,332 - INFO - Row 1
2019-08-19 14:22:02,334 - INFO - Filename: A30 Men Clothing and Men Muslim Fashion buyers
2019-08-19 14:22:02,335 - INFO - Category: 'Men Clothes','Muslim Fashion'
2019-08-19 14:22:02,335 - INFO - Last Login: 30
2019-08-19 14:22:02,335 - INFO - Gender: 1,3
2019-08-19 14:22:02,335 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Men Clothes','Muslim Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-19 14:22:02,335 - INFO - Start Running query A30 Men Clothing and Men Muslim Fashion buyers
2019-08-19 14:26:09,217 - INFO - Running A30 Men Clothing and Men Muslim Fashion buyers Done
2019-08-19 14:26:09,219 - INFO - CSV file path: A30 Men Clothing and Men Muslim Fashion buyers
2019-08-19 14:26:09,299 - INFO - Starting save the query results
2019-08-19 14:26:09,301 - INFO - Total Rows : 2084417
2019-08-19 14:26:09,301 - INFO - Will split into : 3.0 files
2019-08-19 14:26:12,424 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Men Clothing and Men Muslim Fashion buyers_1.csv
2019-08-19 14:26:12,426 - INFO - , with total : 694806 rows
2019-08-19 14:26:15,559 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Men Clothing and Men Muslim Fashion buyers_2.csv
2019-08-19 14:26:15,559 - INFO - , with total : 694806 rows
2019-08-19 14:26:18,630 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Men Clothing and Men Muslim Fashion buyers_3.csv
2019-08-19 14:26:18,631 - INFO - , with total : 694805 rows
2019-08-19 14:26:21,960 - INFO - Row 2
2019-08-19 14:26:21,961 - INFO - Filename: A30 Men Shoes, Bags & FACC buyers
2019-08-19 14:26:21,961 - INFO - Category: 'Men Shoes','Men Bags','Fashion Accessories'
2019-08-19 14:26:21,963 - INFO - Last Login: 30
2019-08-19 14:26:21,963 - INFO - Gender: 1,3
2019-08-19 14:26:21,963 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Men Shoes','Men Bags','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-19 14:26:21,963 - INFO - Start Running query A30 Men Shoes, Bags & FACC buyers
2019-08-19 14:28:54,632 - INFO - Running A30 Men Shoes, Bags & FACC buyers Done
2019-08-19 14:28:54,634 - INFO - CSV file path: A30 Men Shoes, Bags & FACC buyers
2019-08-19 14:28:54,707 - INFO - Starting save the query results
2019-08-19 14:28:54,709 - INFO - Total Rows : 2085539
2019-08-19 14:28:54,710 - INFO - Will split into : 3.0 files
2019-08-19 14:28:57,818 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Men Shoes, Bags & FACC buyers_1.csv
2019-08-19 14:28:57,819 - INFO - , with total : 695180 rows
2019-08-19 14:29:00,888 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Men Shoes, Bags & FACC buyers_2.csv
2019-08-19 14:29:00,888 - INFO - , with total : 695180 rows
2019-08-19 14:29:03,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Men Shoes, Bags & FACC buyers_3.csv
2019-08-19 14:29:03,967 - INFO - , with total : 695179 rows
2019-08-19 14:29:07,249 - INFO - Row 3
2019-08-19 14:29:07,250 - INFO - Filename: A30 Women Clothing and Women Muslim Fashion buyers
2019-08-19 14:29:07,250 - INFO - Category: 'Women Clothes','Muslim Fashion'
2019-08-19 14:29:07,250 - INFO - Last Login: 30
2019-08-19 14:29:07,252 - INFO - Gender: 2,4
2019-08-19 14:29:07,253 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Clothes','Muslim Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-19 14:29:07,253 - INFO - Start Running query A30 Women Clothing and Women Muslim Fashion buyers
2019-08-19 14:32:53,743 - INFO - Running A30 Women Clothing and Women Muslim Fashion buyers Done
2019-08-19 14:32:53,744 - INFO - CSV file path: A30 Women Clothing and Women Muslim Fashion buyers
2019-08-19 14:32:54,009 - INFO - Starting save the query results
2019-08-19 14:32:54,010 - INFO - Total Rows : 7258416
2019-08-19 14:32:54,010 - INFO - Will split into : 8.0 files
2019-08-19 14:32:58,125 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing and Women Muslim Fashion buyers_1.csv
2019-08-19 14:32:58,125 - INFO - , with total : 907302 rows
2019-08-19 14:33:02,131 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing and Women Muslim Fashion buyers_2.csv
2019-08-19 14:33:02,131 - INFO - , with total : 907302 rows
2019-08-19 14:33:06,365 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing and Women Muslim Fashion buyers_3.csv
2019-08-19 14:33:06,365 - INFO - , with total : 907302 rows
2019-08-19 14:33:10,585 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing and Women Muslim Fashion buyers_4.csv
2019-08-19 14:33:10,586 - INFO - , with total : 907302 rows
2019-08-19 14:33:14,809 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing and Women Muslim Fashion buyers_5.csv
2019-08-19 14:33:14,811 - INFO - , with total : 907302 rows
2019-08-19 14:33:18,913 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing and Women Muslim Fashion buyers_6.csv
2019-08-19 14:33:18,914 - INFO - , with total : 907302 rows
2019-08-19 14:33:23,260 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing and Women Muslim Fashion buyers_7.csv
2019-08-19 14:33:23,262 - INFO - , with total : 907302 rows
2019-08-19 14:33:27,362 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing and Women Muslim Fashion buyers_8.csv
2019-08-19 14:33:27,364 - INFO - , with total : 907302 rows
2019-08-19 14:33:30,971 - INFO - Row 4
2019-08-19 14:33:30,973 - INFO - Filename: A30 Women Shoes, Bags & FACC buyers
2019-08-19 14:33:30,973 - INFO - Category: 'Women Shoes','Women Bags','Fashion Accessories'
2019-08-19 14:33:30,973 - INFO - Last Login: 30
2019-08-19 14:33:30,973 - INFO - Gender: 2,4
2019-08-19 14:33:30,973 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Shoes','Women Bags','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-19 14:33:30,974 - INFO - Start Running query A30 Women Shoes, Bags & FACC buyers
2019-08-19 14:39:55,905 - INFO - Running A30 Women Shoes, Bags & FACC buyers Done
2019-08-19 14:39:55,907 - INFO - CSV file path: A30 Women Shoes, Bags & FACC buyers
2019-08-19 14:39:56,180 - INFO - Starting save the query results
2019-08-19 14:39:56,180 - INFO - Total Rows : 6756934
2019-08-19 14:39:56,181 - INFO - Will split into : 7.0 files
2019-08-19 14:40:00,595 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Shoes, Bags & FACC buyers_1.csv
2019-08-19 14:40:00,596 - INFO - , with total : 965277 rows
2019-08-19 14:40:05,226 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Shoes, Bags & FACC buyers_2.csv
2019-08-19 14:40:05,227 - INFO - , with total : 965277 rows
2019-08-19 14:40:09,680 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Shoes, Bags & FACC buyers_3.csv
2019-08-19 14:40:09,680 - INFO - , with total : 965276 rows
2019-08-19 14:40:14,176 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Shoes, Bags & FACC buyers_4.csv
2019-08-19 14:40:14,177 - INFO - , with total : 965276 rows
2019-08-19 14:40:18,641 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Shoes, Bags & FACC buyers_5.csv
2019-08-19 14:40:18,641 - INFO - , with total : 965276 rows
2019-08-19 14:40:23,167 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Shoes, Bags & FACC buyers_6.csv
2019-08-19 14:40:23,167 - INFO - , with total : 965276 rows
2019-08-19 14:40:27,710 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Shoes, Bags & FACC buyers_7.csv
2019-08-19 14:40:27,711 - INFO - , with total : 965276 rows
2019-08-19 14:40:31,686 - INFO - Row 5
2019-08-19 14:40:31,687 - INFO - Filename: A30 Men Clothing, Shoes, Bags, and Muslim Fashion buyers
2019-08-19 14:40:31,687 - INFO - Category: 'Men Clothes','Men Shoes','Men Bags','Muslim Fashion'
2019-08-19 14:40:31,687 - INFO - Last Login: 30
2019-08-19 14:40:31,688 - INFO - Gender: 1,3
2019-08-19 14:40:31,690 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Men Clothes','Men Shoes','Men Bags','Muslim Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-19 14:40:31,690 - INFO - Start Running query A30 Men Clothing, Shoes, Bags, and Muslim Fashion buyers
2019-08-19 14:42:09,138 - INFO - Running A30 Men Clothing, Shoes, Bags, and Muslim Fashion buyers Done
2019-08-19 14:42:09,140 - INFO - CSV file path: A30 Men Clothing, Shoes, Bags, and Muslim Fashion buyers
2019-08-19 14:42:09,236 - INFO - Starting save the query results
2019-08-19 14:42:09,236 - INFO - Total Rows : 2655023
2019-08-19 14:42:09,236 - INFO - Will split into : 3.0 files
2019-08-19 14:42:13,183 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Men Clothing, Shoes, Bags, and Muslim Fashion buyers_1.csv
2019-08-19 14:42:13,184 - INFO - , with total : 885008 rows
2019-08-19 14:42:17,055 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Men Clothing, Shoes, Bags, and Muslim Fashion buyers_2.csv
2019-08-19 14:42:17,056 - INFO - , with total : 885008 rows
2019-08-19 14:42:21,030 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Men Clothing, Shoes, Bags, and Muslim Fashion buyers_3.csv
2019-08-19 14:42:21,032 - INFO - , with total : 885007 rows
2019-08-19 14:42:23,927 - INFO - Row 6
2019-08-19 14:42:23,928 - INFO - Filename: A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers
2019-08-19 14:42:23,928 - INFO - Category: 'Women Clothes','Women Shoes','Women Bags','Muslim Fashion'
2019-08-19 14:42:23,930 - INFO - Last Login: 30
2019-08-19 14:42:23,930 - INFO - Gender: 2,4
2019-08-19 14:42:23,930 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Clothes','Women Shoes','Women Bags','Muslim Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-19 14:42:23,930 - INFO - Start Running query A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers
2019-08-19 14:47:52,517 - INFO - Running A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers Done
2019-08-19 14:47:52,519 - INFO - CSV file path: A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers
2019-08-19 14:47:52,828 - INFO - Starting save the query results
2019-08-19 14:47:52,829 - INFO - Total Rows : 8289656
2019-08-19 14:47:52,831 - INFO - Will split into : 9.0 files
2019-08-19 14:47:57,568 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers_1.csv
2019-08-19 14:47:57,569 - INFO - , with total : 921073 rows
2019-08-19 14:48:01,644 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers_2.csv
2019-08-19 14:48:01,644 - INFO - , with total : 921073 rows
2019-08-19 14:48:05,815 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers_3.csv
2019-08-19 14:48:05,815 - INFO - , with total : 921073 rows
2019-08-19 14:48:10,029 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers_4.csv
2019-08-19 14:48:10,030 - INFO - , with total : 921073 rows
2019-08-19 14:48:14,278 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers_5.csv
2019-08-19 14:48:14,279 - INFO - , with total : 921073 rows
2019-08-19 14:48:18,578 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers_6.csv
2019-08-19 14:48:18,578 - INFO - , with total : 921073 rows
2019-08-19 14:48:22,997 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers_7.csv
2019-08-19 14:48:22,999 - INFO - , with total : 921073 rows
2019-08-19 14:48:27,286 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers_8.csv
2019-08-19 14:48:27,288 - INFO - , with total : 921073 rows
2019-08-19 14:48:31,565 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Women Clothing, Shoes, Bags, and Muslim Fashion buyers_9.csv
2019-08-19 14:48:31,566 - INFO - , with total : 921072 rows
2019-08-19 14:48:32,821 - INFO - Delete all data in sheet: Case 5
2019-08-19 14:48:34,897 - INFO - Value detected - use sheet: Case 6
2019-08-19 14:48:34,898 - INFO - Reading Data From Google Sheet...
2019-08-19 14:48:35,457 - INFO - Get custom SQL..
2019-08-19 14:48:35,457 - INFO - USING CASE 6
2019-08-19 14:48:37,282 - INFO - Row 1
2019-08-19 14:48:37,282 - INFO - Filename: A30 Bread & Pastry, Confectionary, Drinks buyers
2019-08-19 14:48:37,283 - INFO - Sub-category: 'Bread & Pastry','Confectionery','Drinks'
2019-08-19 14:48:37,285 - INFO - Last Login: 30
2019-08-19 14:48:37,285 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bread & Pastry','Confectionery','Drinks')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-19 14:48:37,286 - INFO - Start Running query A30 Bread & Pastry, Confectionary, Drinks buyers
2019-08-19 14:49:38,144 - INFO - Running A30 Bread & Pastry, Confectionary, Drinks buyers Done
2019-08-19 14:49:38,145 - INFO - CSV file path: A30 Bread & Pastry, Confectionary, Drinks buyers
2019-08-19 14:49:38,196 - INFO - Starting save the query results
2019-08-19 14:49:38,197 - INFO - Total Rows : 1320322
2019-08-19 14:49:38,197 - INFO - Will split into : 2.0 files
2019-08-19 14:49:41,119 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Bread & Pastry, Confectionary, Drinks buyers_1.csv
2019-08-19 14:49:41,121 - INFO - , with total : 660161 rows
2019-08-19 14:49:44,030 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Bread & Pastry, Confectionary, Drinks buyers_2.csv
2019-08-19 14:49:44,032 - INFO - , with total : 660161 rows
2019-08-19 14:49:46,355 - INFO - Row 2
2019-08-19 14:49:46,357 - INFO - Filename: A30 Instant Food, Frozen Food, Pre-Ready Food buyers
2019-08-19 14:49:46,357 - INFO - Sub-category: 'Instant Food','Frozen Food','Pre Ready Food'
2019-08-19 14:49:46,357 - INFO - Last Login: 30
2019-08-19 14:49:46,358 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Instant Food','Frozen Food','Pre Ready Food')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-19 14:49:46,358 - INFO - Start Running query A30 Instant Food, Frozen Food, Pre-Ready Food buyers
2019-08-19 14:51:09,255 - INFO - Running A30 Instant Food, Frozen Food, Pre-Ready Food buyers Done
2019-08-19 14:51:09,256 - INFO - CSV file path: A30 Instant Food, Frozen Food, Pre-Ready Food buyers
2019-08-19 14:51:09,289 - INFO - Starting save the query results
2019-08-19 14:51:09,289 - INFO - Total Rows : 889387
2019-08-19 14:51:09,292 - INFO - Will split into : 1.0 files
2019-08-19 14:51:13,203 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Instant Food, Frozen Food, Pre-Ready Food buyers_1.csv
2019-08-19 14:51:13,206 - INFO - , with total : 889387 rows
2019-08-19 14:51:16,078 - INFO - Row 3
2019-08-19 14:51:16,078 - INFO - Filename: A30 Food & Beverages + HL buyers
2019-08-19 14:51:16,079 - INFO - Sub-category: 'Bread & Pastry','Breakfast Menu','Can Food','Confectionery','Dairy Food','Drinks','Fresh Food','Frozen Food','Instant Food','Others Food & Beverage','Pre Ready Food','Snacks','Staple Food','Dining Room','Kitchen & Cookware'
2019-08-19 14:51:16,079 - INFO - Last Login: 30
2019-08-19 14:51:16,079 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bread & Pastry','Breakfast Menu','Can Food','Confectionery','Dairy Food','Drinks','Fresh Food','Frozen Food','Instant Food','Others Food & Beverage','Pre Ready Food','Snacks','Staple Food','Dining Room','Kitchen & Cookware')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-19 14:51:16,081 - INFO - Start Running query A30 Food & Beverages + HL buyers
2019-08-19 14:54:02,325 - INFO - Running A30 Food & Beverages + HL buyers Done
2019-08-19 14:54:02,326 - INFO - CSV file path: A30 Food & Beverages + HL buyers
2019-08-19 14:54:02,512 - INFO - Starting save the query results
2019-08-19 14:54:02,513 - INFO - Total Rows : 4902819
2019-08-19 14:54:02,513 - INFO - Will split into : 5.0 files
2019-08-19 14:54:06,931 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Food & Beverages + HL buyers_1.csv
2019-08-19 14:54:06,933 - INFO - , with total : 980564 rows
2019-08-19 14:54:11,220 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Food & Beverages + HL buyers_2.csv
2019-08-19 14:54:11,221 - INFO - , with total : 980564 rows
2019-08-19 14:54:15,785 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Food & Beverages + HL buyers_3.csv
2019-08-19 14:54:15,786 - INFO - , with total : 980564 rows
2019-08-19 14:54:20,345 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Food & Beverages + HL buyers_4.csv
2019-08-19 14:54:20,345 - INFO - , with total : 980564 rows
2019-08-19 14:54:24,954 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Food & Beverages + HL buyers_5.csv
2019-08-19 14:54:24,956 - INFO - , with total : 980563 rows
2019-08-19 14:54:27,490 - INFO - Row 4
2019-08-19 14:54:27,490 - INFO - Filename: A30 Beauty Tools + FACC buyers
2019-08-19 14:54:27,490 - INFO - Sub-category: 'Beauty Tools','Accessories & Jewelry Set','Belt','Bracelet','Bros','Contact Lenses','Earring','Glasses','Gloves','Hair Accessories','Hat & Cap','Jewelry Set','Necklace','Others','Precious Metals','Ring','Shawl'
2019-08-19 14:54:27,492 - INFO - Last Login: 30
2019-08-19 14:54:27,492 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Beauty Tools','Accessories & Jewelry Set','Belt','Bracelet','Bros','Contact Lenses','Earring','Glasses','Gloves','Hair Accessories','Hat & Cap','Jewelry Set','Necklace','Others','Precious Metals','Ring','Shawl')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-19 14:54:27,493 - INFO - Start Running query A30 Beauty Tools + FACC buyers
2019-08-19 14:58:21,959 - INFO - Running A30 Beauty Tools + FACC buyers Done
2019-08-19 14:58:21,960 - INFO - CSV file path: A30 Beauty Tools + FACC buyers
2019-08-19 14:58:22,266 - INFO - Starting save the query results
2019-08-19 14:58:22,266 - INFO - Total Rows : 8068210
2019-08-19 14:58:22,267 - INFO - Will split into : 9.0 files
2019-08-19 14:58:26,375 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty Tools + FACC buyers_1.csv
2019-08-19 14:58:26,375 - INFO - , with total : 896468 rows
2019-08-19 14:58:30,348 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty Tools + FACC buyers_2.csv
2019-08-19 14:58:30,349 - INFO - , with total : 896468 rows
2019-08-19 14:58:34,391 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty Tools + FACC buyers_3.csv
2019-08-19 14:58:34,392 - INFO - , with total : 896468 rows
2019-08-19 14:58:38,497 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty Tools + FACC buyers_4.csv
2019-08-19 14:58:38,499 - INFO - , with total : 896468 rows
2019-08-19 14:58:42,648 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty Tools + FACC buyers_5.csv
2019-08-19 14:58:42,650 - INFO - , with total : 896468 rows
2019-08-19 14:58:46,776 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty Tools + FACC buyers_6.csv
2019-08-19 14:58:46,776 - INFO - , with total : 896468 rows
2019-08-19 14:58:51,012 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty Tools + FACC buyers_7.csv
2019-08-19 14:58:51,013 - INFO - , with total : 896468 rows
2019-08-19 14:58:55,204 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty Tools + FACC buyers_8.csv
2019-08-19 14:58:55,206 - INFO - , with total : 896467 rows
2019-08-19 14:58:59,315 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Beauty Tools + FACC buyers_9.csv
2019-08-19 14:58:59,316 - INFO - , with total : 896467 rows
2019-08-19 14:59:02,661 - INFO - Row 5
2019-08-19 14:59:02,661 - INFO - Filename: A30 Skin Care & Facial Care
2019-08-19 14:59:02,661 - INFO - Sub-category: 'Skin Care','Facial care'
2019-08-19 14:59:02,663 - INFO - Last Login: 30
2019-08-19 14:59:02,663 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Skin Care','Facial care')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-19 14:59:02,664 - INFO - Start Running query A30 Skin Care & Facial Care
2019-08-19 15:00:20,628 - INFO - Running A30 Skin Care & Facial Care Done
2019-08-19 15:00:20,631 - INFO - CSV file path: A30 Skin Care & Facial Care
2019-08-19 15:00:20,704 - INFO - Starting save the query results
2019-08-19 15:00:20,706 - INFO - Total Rows : 2065927
2019-08-19 15:00:20,706 - INFO - Will split into : 3.0 files
2019-08-19 15:00:24,263 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Skin Care & Facial Care_1.csv
2019-08-19 15:00:24,265 - INFO - , with total : 688643 rows
2019-08-19 15:00:27,331 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Skin Care & Facial Care_2.csv
2019-08-19 15:00:27,332 - INFO - , with total : 688642 rows
2019-08-19 15:00:30,361 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 Skin Care & Facial Care_3.csv
2019-08-19 15:00:30,361 - INFO - , with total : 688642 rows
2019-08-19 15:00:33,585 - INFO - Row 6
2019-08-19 15:00:33,586 - INFO - Filename: A30 FMCG Health Beauty
2019-08-19 15:00:33,588 - INFO - Sub-category: 'Body Care','Facial care','Hair Care','Others','Supplement & Vitamin','Tools and Kits'
2019-08-19 15:00:33,588 - INFO - Last Login: 30
2019-08-19 15:00:33,588 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Body Care','Facial care','Hair Care','Others','Supplement & Vitamin','Tools and Kits')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-19 15:00:33,588 - INFO - Start Running query A30 FMCG Health Beauty
2019-08-19 15:06:03,315 - INFO - Running A30 FMCG Health Beauty Done
2019-08-19 15:06:03,316 - INFO - CSV file path: A30 FMCG Health Beauty
2019-08-19 15:06:03,625 - INFO - Starting save the query results
2019-08-19 15:06:03,625 - INFO - Total Rows : 7232938
2019-08-19 15:06:03,627 - INFO - Will split into : 8.0 files
2019-08-19 15:06:07,766 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 FMCG Health Beauty_1.csv
2019-08-19 15:06:07,767 - INFO - , with total : 904118 rows
2019-08-19 15:06:11,762 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 FMCG Health Beauty_2.csv
2019-08-19 15:06:11,763 - INFO - , with total : 904118 rows
2019-08-19 15:06:16,630 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 FMCG Health Beauty_3.csv
2019-08-19 15:06:16,631 - INFO - , with total : 904117 rows
2019-08-19 15:06:20,881 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 FMCG Health Beauty_4.csv
2019-08-19 15:06:20,882 - INFO - , with total : 904117 rows
2019-08-19 15:06:25,032 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 FMCG Health Beauty_5.csv
2019-08-19 15:06:25,032 - INFO - , with total : 904117 rows
2019-08-19 15:06:29,197 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 FMCG Health Beauty_6.csv
2019-08-19 15:06:29,198 - INFO - , with total : 904117 rows
2019-08-19 15:06:33,638 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 FMCG Health Beauty_7.csv
2019-08-19 15:06:33,640 - INFO - , with total : 904117 rows
2019-08-19 15:06:38,339 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 14.00/A30 FMCG Health Beauty_8.csv
2019-08-19 15:06:38,341 - INFO - , with total : 904117 rows
2019-08-19 15:06:39,818 - INFO - Delete all data in sheet: Case 6
2019-08-19 15:06:41,934 - INFO - No value detected on sheet: Case 7
2019-08-19 15:06:43,165 - INFO - No value detected on sheet: Case 8
2019-08-19 15:06:44,403 - INFO - No value detected on sheet: Case 9
2019-08-19 15:06:45,694 - INFO - No value detected on sheet: Case 10
2019-08-19 15:06:47,040 - INFO - No value detected on sheet: Case 11
2019-08-19 15:06:48,255 - INFO - No value detected on sheet: Case 12
2019-08-19 15:06:49,641 - INFO - No value detected on sheet: Case 13
2019-08-19 15:06:50,921 - INFO - No value detected on sheet: Case 14
2019-08-19 15:06:52,209 - INFO - No value detected on sheet: Case 15
2019-08-19 17:00:05,776 - INFO - Report date: 20190819 17.00
2019-08-19 17:00:09,335 - INFO - Download sheet..
2019-08-19 17:00:09,335 - INFO - Change directory to script path
2019-08-19 17:00:10,773 - INFO - Spreadsheet downloaded
2019-08-19 17:00:10,773 - INFO - Checking sheet..
2019-08-19 17:00:12,447 - INFO - No value detected on sheet: Case 1
2019-08-19 17:00:13,618 - INFO - No value detected on sheet: Case 2
2019-08-19 17:00:15,306 - INFO - Value detected - use sheet: Case 3
2019-08-19 17:00:15,308 - INFO - Reading Data From Google Sheet...
2019-08-19 17:00:15,884 - INFO - Get custom SQL..
2019-08-19 17:00:15,884 - INFO - USING CASE 3
2019-08-19 17:00:19,045 - INFO - Row 1
2019-08-19 17:00:19,045 - INFO - Filename: Women Clothing & FACC buyers who haven't shopped L30D
2019-08-19 17:00:19,046 - INFO - Category: 'Women Clothes','Fashion Accessories'
2019-08-19 17:00:19,046 - INFO - Last Login: 30
2019-08-19 17:00:19,046 - INFO - Date 1: 2019-07-18
2019-08-19 17:00:19,046 - INFO - Date 2: 2019-08-18
2019-08-19 17:00:19,048 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Clothes','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-18' and date'2019-08-18'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-19 17:00:19,048 - INFO - Start Running query Women Clothing & FACC buyers who haven't shopped L30D
2019-08-19 17:02:09,104 - INFO - Running Women Clothing & FACC buyers who haven't shopped L30D Done
2019-08-19 17:02:09,104 - INFO - CSV file path: Women Clothing & FACC buyers who haven't shopped L30D
2019-08-19 17:02:09,210 - INFO - Starting save the query results
2019-08-19 17:02:09,210 - INFO - Total Rows : 2766621
2019-08-19 17:02:09,211 - INFO - Will split into : 3.0 files
2019-08-19 17:02:13,319 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 17.00/Women Clothing & FACC buyers who haven't shopped L30D_1.csv
2019-08-19 17:02:13,321 - INFO - , with total : 922207 rows
2019-08-19 17:02:17,358 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 17.00/Women Clothing & FACC buyers who haven't shopped L30D_2.csv
2019-08-19 17:02:17,359 - INFO - , with total : 922207 rows
2019-08-19 17:02:21,385 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 17.00/Women Clothing & FACC buyers who haven't shopped L30D_3.csv
2019-08-19 17:02:21,387 - INFO - , with total : 922207 rows
2019-08-19 17:02:25,171 - INFO - Row 2
2019-08-19 17:02:25,171 - INFO - Filename: Men Clothing & FACC buyers who haven't shopped L30D
2019-08-19 17:02:25,173 - INFO - Category: 'Men Clothes','Fashion Accessories'
2019-08-19 17:02:25,173 - INFO - Last Login: 30
2019-08-19 17:02:25,173 - INFO - Date 1: 2019-07-18
2019-08-19 17:02:25,173 - INFO - Date 2: 2019-08-18
2019-08-19 17:02:25,174 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Men Clothes','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-18' and date'2019-08-18'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-19 17:02:25,174 - INFO - Start Running query Men Clothing & FACC buyers who haven't shopped L30D
2019-08-19 17:04:21,301 - INFO - Running Men Clothing & FACC buyers who haven't shopped L30D Done
2019-08-19 17:04:21,302 - INFO - CSV file path: Men Clothing & FACC buyers who haven't shopped L30D
2019-08-19 17:04:21,384 - INFO - Starting save the query results
2019-08-19 17:04:21,384 - INFO - Total Rows : 2216825
2019-08-19 17:04:21,385 - INFO - Will split into : 3.0 files
2019-08-19 17:04:24,723 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 17.00/Men Clothing & FACC buyers who haven't shopped L30D_1.csv
2019-08-19 17:04:24,723 - INFO - , with total : 738942 rows
2019-08-19 17:04:27,971 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 17.00/Men Clothing & FACC buyers who haven't shopped L30D_2.csv
2019-08-19 17:04:27,973 - INFO - , with total : 738942 rows
2019-08-19 17:04:31,233 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 17.00/Men Clothing & FACC buyers who haven't shopped L30D_3.csv
2019-08-19 17:04:31,236 - INFO - , with total : 738941 rows
2019-08-19 17:04:35,082 - INFO - Row 3
2019-08-19 17:04:35,082 - INFO - Filename: Baby & Kids Fashion buyers who haven't shopped L30D
2019-08-19 17:04:35,082 - INFO - Category: 'Baby & Kids Fashion'
2019-08-19 17:04:35,082 - INFO - Last Login: 30
2019-08-19 17:04:35,082 - INFO - Date 1: 2019-07-18
2019-08-19 17:04:35,084 - INFO - Date 2: 2019-08-18
2019-08-19 17:04:35,084 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-07-18' and date'2019-08-18'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-19 17:04:35,085 - INFO - Start Running query Baby & Kids Fashion buyers who haven't shopped L30D
2019-08-19 17:05:36,753 - INFO - Running Baby & Kids Fashion buyers who haven't shopped L30D Done
2019-08-19 17:05:36,755 - INFO - CSV file path: Baby & Kids Fashion buyers who haven't shopped L30D
2019-08-19 17:05:36,788 - INFO - Starting save the query results
2019-08-19 17:05:36,789 - INFO - Total Rows : 906782
2019-08-19 17:05:36,789 - INFO - Will split into : 1.0 files
2019-08-19 17:05:40,776 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190819 17.00/Baby & Kids Fashion buyers who haven't shopped L30D_1.csv
2019-08-19 17:05:40,776 - INFO - , with total : 906782 rows
2019-08-19 17:05:41,438 - INFO - Delete all data in sheet: Case 3
2019-08-19 17:05:43,180 - INFO - No value detected on sheet: Case 4
2019-08-19 17:05:44,385 - INFO - No value detected on sheet: Case 5
2019-08-19 17:05:45,575 - INFO - No value detected on sheet: Case 6
2019-08-19 17:05:46,387 - INFO - No value detected on sheet: Case 7
2019-08-19 17:05:47,563 - INFO - No value detected on sheet: Case 8
2019-08-19 17:05:48,724 - INFO - No value detected on sheet: Case 9
2019-08-19 17:05:49,703 - INFO - No value detected on sheet: Case 10
2019-08-19 17:05:50,900 - INFO - No value detected on sheet: Case 11
2019-08-19 17:05:52,115 - INFO - No value detected on sheet: Case 12
2019-08-19 17:05:53,069 - INFO - No value detected on sheet: Case 13
2019-08-19 17:05:54,378 - INFO - No value detected on sheet: Case 14
2019-08-19 17:05:55,486 - INFO - No value detected on sheet: Case 15
2019-08-20 10:00:08,654 - INFO - Report date: 20190820 10.00
2019-08-20 10:00:12,591 - INFO - Download sheet..
2019-08-20 10:00:12,591 - INFO - Change directory to script path
2019-08-20 10:00:13,572 - INFO - Spreadsheet downloaded
2019-08-20 10:00:13,573 - INFO - Checking sheet..
2019-08-20 10:00:15,217 - INFO - No value detected on sheet: Case 1
2019-08-20 10:00:16,720 - INFO - No value detected on sheet: Case 2
2019-08-20 10:00:17,980 - INFO - No value detected on sheet: Case 3
2019-08-20 10:00:19,342 - INFO - No value detected on sheet: Case 4
2019-08-20 10:00:20,561 - INFO - Value detected - use sheet: Case 5
2019-08-20 10:00:20,561 - INFO - Reading Data From Google Sheet...
2019-08-20 10:00:21,305 - INFO - Get custom SQL..
2019-08-20 10:00:21,305 - INFO - USING CASE 5
2019-08-20 10:00:23,970 - INFO - Row 1
2019-08-20 10:00:23,970 - INFO - Filename: A30 Male Musik + Hobby & Collection buyers
2019-08-20 10:00:23,970 - INFO - Category: 'Agate & Precious Stone','Diecast','Fan Collectible Items','Figure','Handicrafts','Model Kit','Music','Other Hob','Others Hobbies','Pet Care','Puzzle & Board Game','Radio Control','Squishy','Video Games'
2019-08-20 10:00:23,970 - INFO - Last Login: 30
2019-08-20 10:00:23,970 - INFO - Gender: 1,3
2019-08-20 10:00:23,970 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Agate & Precious Stone','Diecast','Fan Collectible Items','Figure','Handicrafts','Model Kit','Music','Other Hob','Others Hobbies','Pet Care','Puzzle & Board Game','Radio Control','Squishy','Video Games')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-20 10:00:23,970 - INFO - Start Running query A30 Male Musik + Hobby & Collection buyers
2019-08-20 10:01:42,413 - INFO - Running A30 Male Musik + Hobby & Collection buyers Done
2019-08-20 10:01:42,413 - INFO - CSV file path: A30 Male Musik + Hobby & Collection buyers
2019-08-20 10:01:42,428 - INFO - Starting save the query results
2019-08-20 10:01:42,428 - INFO - Total Rows : 0
2019-08-20 10:01:42,428 - INFO - Will split into : 0.0 files
2019-08-20 10:01:42,428 - INFO - ERROR -> number sections must be larger than 0.
2019-08-20 10:01:42,428 - INFO - Start sending...
2019-08-20 10:01:50,486 - INFO - Message sent successfully
2019-08-20 10:01:51,392 - INFO - Delete all data in sheet: Case 5
2019-08-20 10:01:53,598 - INFO - Value detected - use sheet: Case 6
2019-08-20 10:01:53,598 - INFO - Reading Data From Google Sheet...
2019-08-20 10:01:53,986 - INFO - Get custom SQL..
2019-08-20 10:01:53,986 - INFO - USING CASE 6
2019-08-20 10:01:55,632 - INFO - Row 1
2019-08-20 10:01:55,632 - INFO - Filename: A30 MA for Joyroom
2019-08-20 10:01:55,632 - INFO - Sub-category: 'Bluetooth & Headset','Cable & Charger','Powerbank & Batteries'
2019-08-20 10:01:55,632 - INFO - Last Login: 30
2019-08-20 10:01:55,632 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bluetooth & Headset','Cable & Charger','Powerbank & Batteries')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-20 10:01:55,632 - INFO - Start Running query A30 MA for Joyroom
2019-08-20 10:04:07,311 - INFO - Running A30 MA for Joyroom Done
2019-08-20 10:04:07,311 - INFO - CSV file path: A30 MA for Joyroom
2019-08-20 10:04:07,436 - INFO - Starting save the query results
2019-08-20 10:04:07,436 - INFO - Total Rows : 3363645
2019-08-20 10:04:07,436 - INFO - Will split into : 4.0 files
2019-08-20 10:04:11,125 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190820 10.00/A30 MA for Joyroom_1.csv
2019-08-20 10:04:11,125 - INFO - , with total : 840912 rows
2019-08-20 10:04:14,848 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190820 10.00/A30 MA for Joyroom_2.csv
2019-08-20 10:04:14,848 - INFO - , with total : 840911 rows
2019-08-20 10:04:18,487 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190820 10.00/A30 MA for Joyroom_3.csv
2019-08-20 10:04:18,487 - INFO - , with total : 840911 rows
2019-08-20 10:04:22,211 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190820 10.00/A30 MA for Joyroom_4.csv
2019-08-20 10:04:22,213 - INFO - , with total : 840911 rows
2019-08-20 10:04:23,282 - INFO - Delete all data in sheet: Case 6
2019-08-20 10:04:24,756 - INFO - No value detected on sheet: Case 7
2019-08-20 10:04:25,798 - INFO - No value detected on sheet: Case 8
2019-08-20 10:04:27,117 - INFO - No value detected on sheet: Case 9
2019-08-20 10:04:28,151 - INFO - No value detected on sheet: Case 10
2019-08-20 10:04:29,298 - INFO - No value detected on sheet: Case 11
2019-08-20 10:04:30,513 - INFO - No value detected on sheet: Case 12
2019-08-20 10:04:31,349 - INFO - No value detected on sheet: Case 13
2019-08-20 10:04:32,102 - INFO - No value detected on sheet: Case 14
2019-08-20 10:04:33,312 - INFO - No value detected on sheet: Case 15
2019-08-20 14:00:03,585 - INFO - Report date: 20190820 14.00
2019-08-20 14:00:07,783 - INFO - Download sheet..
2019-08-20 14:00:07,783 - INFO - Change directory to script path
2019-08-20 14:00:08,753 - INFO - Spreadsheet downloaded
2019-08-20 14:00:08,753 - INFO - Checking sheet..
2019-08-20 14:00:10,724 - INFO - No value detected on sheet: Case 1
2019-08-20 14:00:12,193 - INFO - No value detected on sheet: Case 2
2019-08-20 14:00:13,651 - INFO - No value detected on sheet: Case 3
2019-08-20 14:00:15,114 - INFO - No value detected on sheet: Case 4
2019-08-20 14:00:16,782 - INFO - No value detected on sheet: Case 5
2019-08-20 14:00:18,244 - INFO - No value detected on sheet: Case 6
2019-08-20 14:00:19,683 - INFO - No value detected on sheet: Case 7
2019-08-20 14:00:20,341 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-20 14:00:21,012 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-20 14:00:21,664 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-20 14:00:22,342 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-20 14:00:23,006 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-20 14:00:23,690 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-20 14:00:24,355 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-20 14:00:25,019 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-20 17:00:03,210 - INFO - Report date: 20190820 17.00
2019-08-20 17:00:06,680 - INFO - Download sheet..
2019-08-20 17:00:06,680 - INFO - Change directory to script path
2019-08-20 17:00:08,010 - INFO - Spreadsheet downloaded
2019-08-20 17:00:08,010 - INFO - Checking sheet..
2019-08-20 17:00:09,967 - INFO - No value detected on sheet: Case 1
2019-08-20 17:00:11,434 - INFO - No value detected on sheet: Case 2
2019-08-20 17:00:12,921 - INFO - No value detected on sheet: Case 3
2019-08-20 17:00:14,423 - INFO - No value detected on sheet: Case 4
2019-08-20 17:00:15,891 - INFO - Value detected - use sheet: Case 5
2019-08-20 17:00:15,892 - INFO - Reading Data From Google Sheet...
2019-08-20 17:00:16,604 - INFO - Get custom SQL..
2019-08-20 17:00:16,604 - INFO - USING CASE 5
2019-08-20 17:00:19,680 - INFO - Row 1
2019-08-20 17:00:19,680 - INFO - Filename: A30 Male Musik + Hobby & Collection buyers
2019-08-20 17:00:19,680 - INFO - Category: 'Hobby & Collection'
2019-08-20 17:00:19,680 - INFO - Last Login: 30
2019-08-20 17:00:19,680 - INFO - Gender: 1,3
2019-08-20 17:00:19,681 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-20 17:00:19,681 - INFO - Start Running query A30 Male Musik + Hobby & Collection buyers
2019-08-20 17:00:46,717 - INFO - Running A30 Male Musik + Hobby & Collection buyers Done
2019-08-20 17:00:46,717 - INFO - CSV file path: A30 Male Musik + Hobby & Collection buyers
2019-08-20 17:00:46,733 - INFO - Starting save the query results
2019-08-20 17:00:46,733 - INFO - Total Rows : 593342
2019-08-20 17:00:46,733 - INFO - Will split into : 1.0 files
2019-08-20 17:00:49,345 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190820 17.00/A30 Male Musik + Hobby & Collection buyers_1.csv
2019-08-20 17:00:49,345 - INFO - , with total : 593342 rows
2019-08-20 17:00:50,109 - INFO - Delete all data in sheet: Case 5
2019-08-20 17:00:52,743 - INFO - Value detected - use sheet: Case 6
2019-08-20 17:00:52,743 - INFO - Reading Data From Google Sheet...
2019-08-20 17:00:53,451 - INFO - Get custom SQL..
2019-08-20 17:00:53,451 - INFO - USING CASE 6
2019-08-20 17:00:55,622 - INFO - Row 1
2019-08-20 17:00:55,622 - INFO - Filename: A30 Headset & Speaker Buyers (Soundcore)
2019-08-20 17:00:55,622 - INFO - Sub-category: 'Bluetooth & Headset','Speaker & Microphone'
2019-08-20 17:00:55,622 - INFO - Last Login: 30
2019-08-20 17:00:55,622 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bluetooth & Headset','Speaker & Microphone')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-20 17:00:55,622 - INFO - Start Running query A30 Headset & Speaker Buyers (Soundcore)
2019-08-20 17:02:02,405 - INFO - Running A30 Headset & Speaker Buyers (Soundcore) Done
2019-08-20 17:02:02,405 - INFO - CSV file path: A30 Headset & Speaker Buyers (Soundcore)
2019-08-20 17:02:02,500 - INFO - Starting save the query results
2019-08-20 17:02:02,500 - INFO - Total Rows : 2470570
2019-08-20 17:02:02,500 - INFO - Will split into : 3.0 files
2019-08-20 17:02:06,072 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190820 17.00/A30 Headset & Speaker Buyers (Soundcore)_1.csv
2019-08-20 17:02:06,072 - INFO - , with total : 823524 rows
2019-08-20 17:02:09,644 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190820 17.00/A30 Headset & Speaker Buyers (Soundcore)_2.csv
2019-08-20 17:02:09,644 - INFO - , with total : 823523 rows
2019-08-20 17:02:13,275 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190820 17.00/A30 Headset & Speaker Buyers (Soundcore)_3.csv
2019-08-20 17:02:13,276 - INFO - , with total : 823523 rows
2019-08-20 17:02:14,286 - INFO - Delete all data in sheet: Case 6
2019-08-20 17:02:16,536 - INFO - No value detected on sheet: Case 7
2019-08-20 17:02:17,654 - INFO - No value detected on sheet: Case 8
2019-08-20 17:02:18,431 - INFO - No value detected on sheet: Case 9
2019-08-20 17:02:19,730 - INFO - No value detected on sheet: Case 10
2019-08-20 17:02:21,305 - INFO - No value detected on sheet: Case 11
2019-08-20 17:02:22,448 - INFO - No value detected on sheet: Case 12
2019-08-20 17:02:23,927 - INFO - No value detected on sheet: Case 13
2019-08-20 17:02:25,250 - INFO - No value detected on sheet: Case 14
2019-08-20 17:02:26,033 - INFO - No value detected on sheet: Case 15
2019-08-20 17:02:27,483 - INFO - No value detected on sheet: Case 16
2019-08-21 10:00:10,237 - INFO - Report date: 20190821 10.00
2019-08-21 10:00:14,585 - INFO - Download sheet..
2019-08-21 10:00:14,586 - INFO - Change directory to script path
2019-08-21 10:00:18,653 - INFO - Spreadsheet downloaded
2019-08-21 10:00:18,654 - INFO - Checking sheet..
2019-08-21 10:00:20,647 - INFO - No value detected on sheet: Case 1
2019-08-21 10:00:22,119 - INFO - No value detected on sheet: Case 2
2019-08-21 10:00:23,604 - INFO - No value detected on sheet: Case 3
2019-08-21 10:00:25,084 - INFO - No value detected on sheet: Case 4
2019-08-21 10:00:26,598 - INFO - Value detected - use sheet: Case 5
2019-08-21 10:00:26,599 - INFO - Reading Data From Google Sheet...
2019-08-21 10:00:27,329 - INFO - Get custom SQL..
2019-08-21 10:00:27,329 - INFO - USING CASE 5
2019-08-21 10:00:30,309 - INFO - Error in get_custom_sql -> <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%205%21D2%3AD2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:30,309 - INFO - Start sending...
2019-08-21 10:00:39,502 - INFO - Message sent successfully
2019-08-21 10:00:39,503 - INFO - Delete all data in sheet: Case 5
2019-08-21 10:00:41,844 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%206%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:42,502 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:43,180 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:43,848 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:44,512 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:45,174 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:45,842 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:46,510 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:47,177 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:47,832 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:00:48,506 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 10:26:36,170 - INFO - Report date: 20190821 10.26
2019-08-21 10:26:36,211 - INFO - Download sheet..
2019-08-21 10:26:36,213 - INFO - Change directory to script path
2019-08-21 10:26:38,780 - INFO - Spreadsheet downloaded
2019-08-21 10:26:38,782 - INFO - Checking sheet..
2019-08-21 10:26:41,296 - INFO - No value detected on sheet: Case 1
2019-08-21 10:26:42,872 - INFO - No value detected on sheet: Case 2
2019-08-21 10:26:44,394 - INFO - No value detected on sheet: Case 3
2019-08-21 10:26:45,984 - INFO - No value detected on sheet: Case 4
2019-08-21 10:26:47,528 - INFO - Value detected - use sheet: Case 5
2019-08-21 10:26:47,529 - INFO - Reading Data From Google Sheet...
2019-08-21 10:26:48,292 - INFO - Get custom SQL..
2019-08-21 10:26:48,292 - INFO - USING CASE 5
2019-08-21 10:26:51,463 - INFO - Row 1
2019-08-21 10:26:51,466 - INFO - Filename: Kikido
2019-08-21 10:26:51,470 - INFO - Category: 'Mom & Baby','Baby & Kids Fashion'
2019-08-21 10:26:51,470 - INFO - Last Login: 30
2019-08-21 10:26:51,471 - INFO - Gender: 2,4
2019-08-21 10:26:51,473 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mom & Baby','Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-21 10:26:51,477 - INFO - Start Running query Kikido
2019-08-21 10:26:54,878 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:26:54,915 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:26:55,154 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:26:55,190 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:26:55,230 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:26:55,230 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-08-21 10:26:55,232 - INFO - Start sending...
2019-08-21 10:27:03,951 - INFO - Message sent successfully
2019-08-21 10:27:04,773 - INFO - Delete all data in sheet: Case 5
2019-08-21 10:27:07,634 - INFO - No value detected on sheet: Case 6
2019-08-21 10:27:09,257 - INFO - No value detected on sheet: Case 7
2019-08-21 10:27:10,529 - INFO - No value detected on sheet: Case 8
2019-08-21 10:27:11,815 - INFO - No value detected on sheet: Case 9
2019-08-21 10:27:13,131 - INFO - No value detected on sheet: Case 10
2019-08-21 10:27:14,953 - INFO - No value detected on sheet: Case 11
2019-08-21 10:27:16,816 - INFO - No value detected on sheet: Case 12
2019-08-21 10:27:18,165 - INFO - No value detected on sheet: Case 13
2019-08-21 10:27:19,296 - INFO - No value detected on sheet: Case 14
2019-08-21 10:27:21,164 - INFO - No value detected on sheet: Case 15
2019-08-21 10:27:22,644 - INFO - No value detected on sheet: Case 16
2019-08-21 10:31:33,869 - INFO - Report date: 20190821 10.31
2019-08-21 10:31:33,905 - INFO - Download sheet..
2019-08-21 10:31:33,905 - INFO - Change directory to script path
2019-08-21 10:31:36,482 - INFO - Spreadsheet downloaded
2019-08-21 10:31:36,493 - INFO - Checking sheet..
2019-08-21 10:31:39,546 - INFO - No value detected on sheet: Case 1
2019-08-21 10:31:41,413 - INFO - No value detected on sheet: Case 2
2019-08-21 10:31:43,148 - INFO - No value detected on sheet: Case 3
2019-08-21 10:31:45,032 - INFO - No value detected on sheet: Case 4
2019-08-21 10:31:46,680 - INFO - Value detected - use sheet: Case 5
2019-08-21 10:31:46,681 - INFO - Reading Data From Google Sheet...
2019-08-21 10:31:47,503 - INFO - Get custom SQL..
2019-08-21 10:31:47,505 - INFO - USING CASE 5
2019-08-21 10:31:51,099 - INFO - Row 1
2019-08-21 10:31:51,102 - INFO - Filename: Kikido
2019-08-21 10:31:51,105 - INFO - Category: 'Mom & Baby','Baby & Kids Fashion'
2019-08-21 10:31:51,107 - INFO - Last Login: 30
2019-08-21 10:31:51,109 - INFO - Gender: 2,4
2019-08-21 10:31:51,115 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mom & Baby','Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-21 10:31:51,121 - INFO - Start Running query Kikido
2019-08-21 10:31:54,029 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:31:54,069 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:31:54,107 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:31:54,145 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:31:54,196 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:31:54,198 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-08-21 10:31:54,200 - INFO - Start sending...
2019-08-21 10:32:04,605 - INFO - Message sent successfully
2019-08-21 10:32:05,440 - INFO - Delete all data in sheet: Case 5
2019-08-21 10:32:07,918 - INFO - No value detected on sheet: Case 6
2019-08-21 10:32:09,640 - INFO - No value detected on sheet: Case 7
2019-08-21 10:32:11,378 - INFO - No value detected on sheet: Case 8
2019-08-21 10:32:13,150 - INFO - No value detected on sheet: Case 9
2019-08-21 10:32:15,039 - INFO - No value detected on sheet: Case 10
2019-08-21 10:32:16,678 - INFO - No value detected on sheet: Case 11
2019-08-21 10:32:18,328 - INFO - No value detected on sheet: Case 12
2019-08-21 10:32:19,710 - INFO - No value detected on sheet: Case 13
2019-08-21 10:39:17,773 - INFO - Report date: 20190821 10.39
2019-08-21 10:39:17,812 - INFO - Download sheet..
2019-08-21 10:39:17,813 - INFO - Change directory to script path
2019-08-21 10:39:20,023 - INFO - Spreadsheet downloaded
2019-08-21 10:39:20,026 - INFO - Checking sheet..
2019-08-21 10:39:22,417 - INFO - No value detected on sheet: Case 1
2019-08-21 10:39:24,427 - INFO - No value detected on sheet: Case 2
2019-08-21 10:39:26,209 - INFO - No value detected on sheet: Case 3
2019-08-21 10:39:28,029 - INFO - No value detected on sheet: Case 4
2019-08-21 10:39:29,987 - INFO - Value detected - use sheet: Case 5
2019-08-21 10:39:29,990 - INFO - Reading Data From Google Sheet...
2019-08-21 10:39:30,901 - INFO - Get custom SQL..
2019-08-21 10:39:30,904 - INFO - USING CASE 5
2019-08-21 10:39:35,039 - INFO - Row 1
2019-08-21 10:39:35,042 - INFO - Filename: Kikido
2019-08-21 10:39:35,046 - INFO - Category: 'Mom & Baby','Baby & Kids Fashion'
2019-08-21 10:39:35,048 - INFO - Last Login: 30
2019-08-21 10:39:35,052 - INFO - Gender: 2,4
2019-08-21 10:39:35,055 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mom & Baby','Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-21 10:39:35,066 - INFO - Start Running query Kikido
2019-08-21 10:39:39,306 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:39:39,341 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:39:39,375 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:39:39,410 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:39:39,444 - INFO - java.sql.SQLException: Error executing query
2019-08-21 10:39:39,444 - INFO - ERROR -> 'NoneType' object has no attribute 'getMetaData'
2019-08-21 10:39:39,446 - INFO - Start sending...
2019-08-21 10:39:49,742 - INFO - Message sent successfully
2019-08-21 10:39:50,658 - INFO - Delete all data in sheet: Case 5
2019-08-21 10:39:53,418 - INFO - No value detected on sheet: Case 6
2019-08-21 14:00:02,934 - INFO - Report date: 20190821 14.00
2019-08-21 14:00:06,799 - INFO - Download sheet..
2019-08-21 14:00:06,801 - INFO - Change directory to script path
2019-08-21 14:00:08,140 - INFO - Spreadsheet downloaded
2019-08-21 14:00:08,141 - INFO - Checking sheet..
2019-08-21 14:00:09,940 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%201%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:11,309 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%202%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:12,687 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI/values/Case%203%21A2%3AA2?valueRenderOption=FORMATTED_VALUE&alt=json&majorDimension=ROWS returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:13,345 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:13,996 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:14,670 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:15,322 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:15,990 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:16,648 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:17,311 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:18,055 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:18,720 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:19,042 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:19,701 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:20,029 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 14:00:20,694 - INFO - <HttpError 429 when requesting https://sheets.googleapis.com/v4/spreadsheets/1kFBUvMlpfTJzOzCp0juCcUey-_SeS1Ln02IC6R2QTCI?fields=properties%2Csheets%2Fproperties%2CspreadsheetId%2CnamedRanges&alt=json&includeGridData=false returned "Quota exceeded for quota group 'ReadGroup' and limit 'USER-100s' of service 'sheets.googleapis.com' for consumer 'project_number:362380369340'.">
2019-08-21 15:42:24,516 - INFO - Report date: 20190821 15.42
2019-08-21 15:42:24,563 - INFO - Download sheet..
2019-08-21 15:42:24,565 - INFO - Change directory to script path
2019-08-21 15:42:26,066 - INFO - Error in downloading sheet -> invalid_grant: Bad Request
2019-08-21 15:42:26,066 - INFO - Checking sheet..
2019-08-21 15:42:28,795 - INFO - No value detected on sheet: Case 1
2019-08-21 15:42:30,345 - INFO - No value detected on sheet: Case 2
2019-08-21 15:42:31,884 - INFO - No value detected on sheet: Case 3
2019-08-21 17:37:01,835 - INFO - Report date: 20190821 17.37
2019-08-21 17:37:05,780 - INFO - Download sheet..
2019-08-21 17:37:05,782 - INFO - Change directory to script path
2019-08-21 17:37:06,792 - INFO - Spreadsheet downloaded
2019-08-21 17:37:06,793 - INFO - Checking sheet..
2019-08-21 17:37:08,651 - INFO - No value detected on sheet: Case 1
2019-08-21 17:37:10,108 - INFO - No value detected on sheet: Case 2
2019-08-21 17:37:11,588 - INFO - No value detected on sheet: Case 3
2019-08-21 17:37:13,043 - INFO - No value detected on sheet: Case 4
2019-08-21 17:37:14,482 - INFO - Value detected - use sheet: Case 5
2019-08-21 17:37:14,483 - INFO - Reading Data From Google Sheet...
2019-08-21 17:37:15,190 - INFO - Get custom SQL..
2019-08-21 17:37:15,190 - INFO - USING CASE 5
2019-08-21 17:37:18,319 - INFO - Row 1
2019-08-21 17:37:18,321 - INFO - Filename: A30 Female Hobby Collection
2019-08-21 17:37:18,322 - INFO - Category: 'Hobby & Collection'
2019-08-21 17:37:18,322 - INFO - Last Login: 30
2019-08-21 17:37:18,322 - INFO - Gender: 2,4
2019-08-21 17:37:18,322 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-21 17:37:18,323 - INFO - Start Running query A30 Female Hobby Collection
2019-08-21 17:38:09,403 - INFO - Running A30 Female Hobby Collection Done
2019-08-21 17:38:09,404 - INFO - CSV file path: A30 Female Hobby Collection
2019-08-21 17:38:09,464 - INFO - Starting save the query results
2019-08-21 17:38:09,466 - INFO - Total Rows : 1604773
2019-08-21 17:38:09,467 - INFO - Will split into : 2.0 files
2019-08-21 17:38:13,056 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A30 Female Hobby Collection_1.csv
2019-08-21 17:38:13,058 - INFO - , with total : 802387 rows
2019-08-21 17:38:16,648 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A30 Female Hobby Collection_2.csv
2019-08-21 17:38:16,648 - INFO - , with total : 802386 rows
2019-08-21 17:38:17,130 - INFO - Delete all data in sheet: Case 5
2019-08-21 17:38:19,494 - INFO - No value detected on sheet: Case 6
2019-08-21 17:38:20,322 - INFO - No value detected on sheet: Case 7
2019-08-21 17:38:21,726 - INFO - Value detected - use sheet: Case 8
2019-08-21 17:38:21,726 - INFO - Reading Data From Google Sheet...
2019-08-21 17:38:22,434 - INFO - Get custom SQL..
2019-08-21 17:38:22,436 - INFO - USING CASE 8
2019-08-21 17:38:23,588 - INFO - Row 1
2019-08-21 17:38:23,589 - INFO - Filename: DrKevinshoes Followers
2019-08-21 17:38:23,591 - INFO - Shop ID: 19536311
2019-08-21 17:38:23,591 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (19536311) 
                                and status = 1
                                
2019-08-21 17:38:23,592 - INFO - Start Running query DrKevinshoes Followers
2019-08-21 17:38:28,233 - INFO - Running DrKevinshoes Followers Done
2019-08-21 17:38:28,233 - INFO - CSV file path: DrKevinshoes Followers
2019-08-21 17:38:28,240 - INFO - Starting save the query results
2019-08-21 17:38:28,240 - INFO - Total Rows : 132702
2019-08-21 17:38:28,240 - INFO - Will split into : 1.0 files
2019-08-21 17:38:28,887 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/DrKevinshoes Followers_1.csv
2019-08-21 17:38:28,888 - INFO - , with total : 132702 rows
2019-08-21 17:38:30,073 - INFO - Row 2
2019-08-21 17:38:30,075 - INFO - Filename: Quaker Followers
2019-08-21 17:38:30,075 - INFO - Shop ID: 45512211
2019-08-21 17:38:30,076 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (45512211) 
                                and status = 1
                                
2019-08-21 17:38:30,076 - INFO - Start Running query Quaker Followers
2019-08-21 17:38:38,269 - INFO - Running Quaker Followers Done
2019-08-21 17:38:38,270 - INFO - CSV file path: Quaker Followers
2019-08-21 17:38:38,273 - INFO - Starting save the query results
2019-08-21 17:38:38,273 - INFO - Total Rows : 42886
2019-08-21 17:38:38,275 - INFO - Will split into : 1.0 files
2019-08-21 17:38:38,474 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/Quaker Followers_1.csv
2019-08-21 17:38:38,476 - INFO - , with total : 42886 rows
2019-08-21 17:38:39,681 - INFO - Row 3
2019-08-21 17:38:39,683 - INFO - Filename: Emina Followers
2019-08-21 17:38:39,684 - INFO - Shop ID: 63983008
2019-08-21 17:38:39,684 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (63983008) 
                                and status = 1
                                
2019-08-21 17:38:39,686 - INFO - Start Running query Emina Followers
2019-08-21 17:38:53,612 - INFO - Running Emina Followers Done
2019-08-21 17:38:53,612 - INFO - CSV file path: Emina Followers
2019-08-21 17:38:53,634 - INFO - Starting save the query results
2019-08-21 17:38:53,635 - INFO - Total Rows : 539893
2019-08-21 17:38:53,635 - INFO - Will split into : 1.0 files
2019-08-21 17:38:56,002 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/Emina Followers_1.csv
2019-08-21 17:38:56,003 - INFO - , with total : 539893 rows
2019-08-21 17:38:58,155 - INFO - Row 4
2019-08-21 17:38:58,157 - INFO - Filename: Youmakeups Followers
2019-08-21 17:38:58,157 - INFO - Shop ID: 72375863
2019-08-21 17:38:58,157 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (72375863) 
                                and status = 1
                                
2019-08-21 17:38:58,158 - INFO - Start Running query Youmakeups Followers
2019-08-21 17:39:03,769 - INFO - Running Youmakeups Followers Done
2019-08-21 17:39:03,770 - INFO - CSV file path: Youmakeups Followers
2019-08-21 17:39:03,773 - INFO - Starting save the query results
2019-08-21 17:39:03,775 - INFO - Total Rows : 57226
2019-08-21 17:39:03,775 - INFO - Will split into : 1.0 files
2019-08-21 17:39:04,036 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/Youmakeups Followers_1.csv
2019-08-21 17:39:04,036 - INFO - , with total : 57226 rows
2019-08-21 17:39:05,210 - INFO - Row 5
2019-08-21 17:39:05,213 - INFO - Filename: Kintakun Followers
2019-08-21 17:39:05,213 - INFO - Shop ID: 48708202
2019-08-21 17:39:05,213 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (48708202) 
                                and status = 1
                                
2019-08-21 17:39:05,213 - INFO - Start Running query Kintakun Followers
2019-08-21 17:39:13,181 - INFO - Running Kintakun Followers Done
2019-08-21 17:39:13,183 - INFO - CSV file path: Kintakun Followers
2019-08-21 17:39:13,193 - INFO - Starting save the query results
2019-08-21 17:39:13,193 - INFO - Total Rows : 254805
2019-08-21 17:39:13,194 - INFO - Will split into : 1.0 files
2019-08-21 17:39:14,339 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/Kintakun Followers_1.csv
2019-08-21 17:39:14,341 - INFO - , with total : 254805 rows
2019-08-21 17:39:15,900 - INFO - Row 6
2019-08-21 17:39:15,901 - INFO - Filename: Realme Followers
2019-08-21 17:39:15,901 - INFO - Shop ID: 109598751
2019-08-21 17:39:15,901 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (109598751) 
                                and status = 1
                                
2019-08-21 17:39:15,903 - INFO - Start Running query Realme Followers
2019-08-21 17:39:20,424 - INFO - Running Realme Followers Done
2019-08-21 17:39:20,426 - INFO - CSV file path: Realme Followers
2019-08-21 17:39:20,430 - INFO - Starting save the query results
2019-08-21 17:39:20,430 - INFO - Total Rows : 117515
2019-08-21 17:39:20,431 - INFO - Will split into : 1.0 files
2019-08-21 17:39:20,960 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/Realme Followers_1.csv
2019-08-21 17:39:20,961 - INFO - , with total : 117515 rows
2019-08-21 17:39:22,523 - INFO - Row 7
2019-08-21 17:39:22,525 - INFO - Filename: Procalgold Followers
2019-08-21 17:39:22,526 - INFO - Shop ID: 38018396
2019-08-21 17:39:22,526 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (38018396) 
                                and status = 1
                                
2019-08-21 17:39:22,528 - INFO - Start Running query Procalgold Followers
2019-08-21 17:39:25,733 - INFO - Running Procalgold Followers Done
2019-08-21 17:39:25,734 - INFO - CSV file path: Procalgold Followers
2019-08-21 17:39:25,736 - INFO - Starting save the query results
2019-08-21 17:39:25,737 - INFO - Total Rows : 44356
2019-08-21 17:39:25,739 - INFO - Will split into : 1.0 files
2019-08-21 17:39:25,947 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/Procalgold Followers_1.csv
2019-08-21 17:39:25,948 - INFO - , with total : 44356 rows
2019-08-21 17:39:27,681 - INFO - Row 8
2019-08-21 17:39:27,681 - INFO - Filename: RB Followers
2019-08-21 17:39:27,683 - INFO - Shop ID: 6936785
2019-08-21 17:39:27,683 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (6936785) 
                                and status = 1
                                
2019-08-21 17:39:27,684 - INFO - Start Running query RB Followers
2019-08-21 17:39:32,194 - INFO - Running RB Followers Done
2019-08-21 17:39:32,196 - INFO - CSV file path: RB Followers
2019-08-21 17:39:32,197 - INFO - Starting save the query results
2019-08-21 17:39:32,198 - INFO - Total Rows : 54867
2019-08-21 17:39:32,200 - INFO - Will split into : 1.0 files
2019-08-21 17:39:32,446 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/RB Followers_1.csv
2019-08-21 17:39:32,447 - INFO - , with total : 54867 rows
2019-08-21 17:39:32,871 - INFO - Delete all data in sheet: Case 8
2019-08-21 17:39:34,082 - INFO - Value detected - use sheet: Case 9
2019-08-21 17:39:34,082 - INFO - Reading Data From Google Sheet...
2019-08-21 17:39:34,473 - INFO - Get custom SQL..
2019-08-21 17:39:34,474 - INFO - USING CASE 9
2019-08-21 17:39:35,401 - INFO - Row 1
2019-08-21 17:39:35,401 - INFO - Filename: A7 DP Buyers 
2019-08-21 17:39:35,403 - INFO - Last Login: 7
2019-08-21 17:39:35,403 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-21 17:39:35,404 - INFO - Start Running query A7 DP Buyers 
2019-08-21 17:40:30,836 - INFO - Running A7 DP Buyers  Done
2019-08-21 17:40:30,838 - INFO - CSV file path: A7 DP Buyers 
2019-08-21 17:40:30,920 - INFO - Starting save the query results
2019-08-21 17:40:30,921 - INFO - Total Rows : 2119732
2019-08-21 17:40:30,921 - INFO - Will split into : 3.0 files
2019-08-21 17:40:34,042 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A7 DP Buyers _1.csv
2019-08-21 17:40:34,042 - INFO - , with total : 706578 rows
2019-08-21 17:40:37,165 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A7 DP Buyers _2.csv
2019-08-21 17:40:37,167 - INFO - , with total : 706577 rows
2019-08-21 17:40:40,257 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A7 DP Buyers _3.csv
2019-08-21 17:40:40,259 - INFO - , with total : 706577 rows
2019-08-21 17:40:40,782 - INFO - Delete all data in sheet: Case 9
2019-08-21 17:40:42,153 - INFO - No value detected on sheet: Case 10
2019-08-21 17:40:42,926 - INFO - Value detected - use sheet: Case 11
2019-08-21 17:40:42,927 - INFO - Reading Data From Google Sheet...
2019-08-21 17:40:43,299 - INFO - Get custom SQL..
2019-08-21 17:40:43,301 - INFO - USING CASE 11
2019-08-21 17:40:44,460 - INFO - Row 1
2019-08-21 17:40:44,461 - INFO - Filename: A3 Fashion buyers who haven't shopped DP 
2019-08-21 17:40:44,461 - INFO - Main Category: 'Watches','Women Bags','Women Clothes','Women Shoes','Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion'
2019-08-21 17:40:44,463 - INFO - Last Login: 3
2019-08-21 17:40:44,463 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Watches','Women Bags','Women Clothes','Women Shoes','Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion') 
                                    and
                                    last_login >= current_date - interval '3' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-21 17:40:44,463 - INFO - Start Running query A3 Fashion buyers who haven't shopped DP 
2019-08-21 17:46:43,365 - INFO - Running A3 Fashion buyers who haven't shopped DP  Done
2019-08-21 17:46:43,365 - INFO - CSV file path: A3 Fashion buyers who haven't shopped DP 
2019-08-21 17:46:43,598 - INFO - Starting save the query results
2019-08-21 17:46:43,599 - INFO - Total Rows : 6255745
2019-08-21 17:46:43,601 - INFO - Will split into : 7.0 files
2019-08-21 17:46:47,594 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Fashion buyers who haven't shopped DP _1.csv
2019-08-21 17:46:47,595 - INFO - , with total : 893678 rows
2019-08-21 17:46:51,483 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Fashion buyers who haven't shopped DP _2.csv
2019-08-21 17:46:51,484 - INFO - , with total : 893678 rows
2019-08-21 17:46:55,474 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Fashion buyers who haven't shopped DP _3.csv
2019-08-21 17:46:55,476 - INFO - , with total : 893678 rows
2019-08-21 17:46:59,555 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Fashion buyers who haven't shopped DP _4.csv
2019-08-21 17:46:59,555 - INFO - , with total : 893678 rows
2019-08-21 17:47:03,627 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Fashion buyers who haven't shopped DP _5.csv
2019-08-21 17:47:03,628 - INFO - , with total : 893678 rows
2019-08-21 17:47:07,717 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Fashion buyers who haven't shopped DP _6.csv
2019-08-21 17:47:07,719 - INFO - , with total : 893678 rows
2019-08-21 17:47:11,934 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Fashion buyers who haven't shopped DP _7.csv
2019-08-21 17:47:11,934 - INFO - , with total : 893677 rows
2019-08-21 17:47:15,292 - INFO - Row 2
2019-08-21 17:47:15,292 - INFO - Filename: A3 Handphone & Aksesoris who haven't shopped DP     
2019-08-21 17:47:15,292 - INFO - Main Category: 'Mobile & Accessories'
2019-08-21 17:47:15,293 - INFO - Last Login: 3
2019-08-21 17:47:15,293 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories') 
                                    and
                                    last_login >= current_date - interval '3' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-21 17:47:15,295 - INFO - Start Running query A3 Handphone & Aksesoris who haven't shopped DP     
2019-08-21 17:49:15,536 - INFO - Running A3 Handphone & Aksesoris who haven't shopped DP      Done
2019-08-21 17:49:15,538 - INFO - CSV file path: A3 Handphone & Aksesoris who haven't shopped DP     
2019-08-21 17:49:15,674 - INFO - Starting save the query results
2019-08-21 17:49:15,676 - INFO - Total Rows : 3696833
2019-08-21 17:49:15,677 - INFO - Will split into : 4.0 files
2019-08-21 17:49:19,798 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Handphone & Aksesoris who haven't shopped DP     _1.csv
2019-08-21 17:49:19,799 - INFO - , with total : 924209 rows
2019-08-21 17:49:23,851 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Handphone & Aksesoris who haven't shopped DP     _2.csv
2019-08-21 17:49:23,851 - INFO - , with total : 924208 rows
2019-08-21 17:49:28,029 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Handphone & Aksesoris who haven't shopped DP     _3.csv
2019-08-21 17:49:28,030 - INFO - , with total : 924208 rows
2019-08-21 17:49:32,263 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190821 17.37/A3 Handphone & Aksesoris who haven't shopped DP     _4.csv
2019-08-21 17:49:32,263 - INFO - , with total : 924208 rows
2019-08-21 17:49:33,203 - INFO - Delete all data in sheet: Case 11
2019-08-21 17:49:35,457 - INFO - No value detected on sheet: Case 12
2019-08-21 17:49:37,145 - INFO - No value detected on sheet: Case 13
2019-08-21 17:49:38,275 - INFO - No value detected on sheet: Case 14
2019-08-21 17:49:39,719 - INFO - No value detected on sheet: Case 15
2019-08-21 17:49:41,167 - INFO - No value detected on sheet: Case 16
2019-08-22 10:22:21,766 - INFO - Report date: 20190822 10.22
2019-08-22 10:22:21,812 - INFO - Download sheet..
2019-08-22 10:22:21,813 - INFO - Change directory to script path
2019-08-22 10:22:21,822 - INFO - Error in downloading sheet -> global name 'CLIENT_SECRET_FILE' is not defined
2019-08-22 10:22:21,822 - INFO - Checking sheet..
2019-08-22 10:22:24,848 - INFO - Value detected - use sheet: Case 1
2019-08-22 10:22:24,851 - INFO - Reading Data From Google Sheet...
2019-08-22 10:22:25,421 - INFO - Get custom SQL..
2019-08-22 10:22:25,424 - INFO - USING CASE 1
2019-08-22 10:22:27,486 - INFO - Row 1
2019-08-22 10:22:27,487 - INFO - Filename: A30 Fashion Buyers
2019-08-22 10:22:27,489 - INFO - Category: 'Women Bags','Women Clothes','Women Shoes','Watches','Men Bags','Men Clothes','Men Shoes'
2019-08-22 10:22:27,490 - INFO - Last Login: 30
2019-08-22 10:22:27,492 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Bags','Women Clothes','Women Shoes','Watches','Men Bags','Men Clothes','Men Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 10:22:27,493 - INFO - Start Running query A30 Fashion Buyers
2019-08-22 10:43:28,638 - INFO - Running A30 Fashion Buyers Done
2019-08-22 10:43:28,640 - INFO - CSV file path: A30 Fashion Buyers
2019-08-22 10:43:29,548 - INFO - Starting save the query results
2019-08-22 10:43:29,548 - INFO - Total Rows : 11425625
2019-08-22 10:43:29,549 - INFO - Will split into : 12.0 files
2019-08-22 10:43:35,509 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_1.csv
2019-08-22 10:43:35,509 - INFO - , with total : 952136 rows
2019-08-22 10:43:40,834 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_2.csv
2019-08-22 10:43:40,835 - INFO - , with total : 952136 rows
2019-08-22 10:43:46,295 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_3.csv
2019-08-22 10:43:46,296 - INFO - , with total : 952136 rows
2019-08-22 10:43:51,742 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_4.csv
2019-08-22 10:43:51,743 - INFO - , with total : 952136 rows
2019-08-22 10:43:57,134 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_5.csv
2019-08-22 10:43:57,135 - INFO - , with total : 952136 rows
2019-08-22 10:44:03,012 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_6.csv
2019-08-22 10:44:03,013 - INFO - , with total : 952135 rows
2019-08-22 10:44:08,946 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_7.csv
2019-08-22 10:44:08,947 - INFO - , with total : 952135 rows
2019-08-22 10:44:15,970 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_8.csv
2019-08-22 10:44:15,970 - INFO - , with total : 952135 rows
2019-08-22 10:44:21,940 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_9.csv
2019-08-22 10:44:21,941 - INFO - , with total : 952135 rows
2019-08-22 10:44:27,881 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_10.csv
2019-08-22 10:44:27,884 - INFO - , with total : 952135 rows
2019-08-22 10:44:33,698 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_11.csv
2019-08-22 10:44:33,698 - INFO - , with total : 952135 rows
2019-08-22 10:44:39,801 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.22/A30 Fashion Buyers_12.csv
2019-08-22 10:44:39,802 - INFO - , with total : 952135 rows
2019-08-22 10:44:40,549 - INFO - Error in get_custom_sql -> [Errno 10053] An established connection was aborted by the software in your host machine
2019-08-22 10:44:40,551 - INFO - Start sending...
2019-08-22 10:44:50,401 - INFO - Message sent successfully
2019-08-22 10:44:50,420 - INFO - Delete all data in sheet: Case 1
2019-08-22 10:44:52,963 - INFO - No value detected on sheet: Case 2
2019-08-22 10:44:54,578 - INFO - No value detected on sheet: Case 3
2019-08-22 10:44:55,944 - INFO - No value detected on sheet: Case 4
2019-08-22 10:44:57,463 - INFO - No value detected on sheet: Case 5
2019-08-22 10:44:58,529 - INFO - No value detected on sheet: Case 6
2019-08-22 10:45:00,227 - INFO - No value detected on sheet: Case 7
2019-08-22 10:45:01,512 - INFO - No value detected on sheet: Case 8
2019-08-22 10:45:03,042 - INFO - No value detected on sheet: Case 9
2019-08-22 10:45:04,121 - INFO - No value detected on sheet: Case 10
2019-08-22 10:45:05,405 - INFO - No value detected on sheet: Case 11
2019-08-22 10:45:07,065 - INFO - No value detected on sheet: Case 12
2019-08-22 10:45:08,365 - INFO - No value detected on sheet: Case 13
2019-08-22 10:45:09,851 - INFO - No value detected on sheet: Case 14
2019-08-22 10:45:11,181 - INFO - No value detected on sheet: Case 15
2019-08-22 10:45:13,038 - INFO - No value detected on sheet: Case 16
2019-08-22 10:46:43,426 - INFO - Report date: 20190822 10.46
2019-08-22 10:46:43,450 - INFO - Download sheet..
2019-08-22 10:46:43,451 - INFO - Change directory to script path
2019-08-22 10:47:30,562 - INFO - Report date: 20190822 10.47
2019-08-22 10:47:30,588 - INFO - Download sheet..
2019-08-22 10:47:30,589 - INFO - Change directory to script path
2019-08-22 10:47:32,621 - INFO - Spreadsheet downloaded
2019-08-22 10:47:32,621 - INFO - Checking sheet..
2019-08-22 10:47:34,742 - INFO - Value detected - use sheet: Case 1
2019-08-22 10:47:34,743 - INFO - Reading Data From Google Sheet...
2019-08-22 10:47:35,479 - INFO - Get custom SQL..
2019-08-22 10:47:35,480 - INFO - USING CASE 1
2019-08-22 10:47:37,703 - INFO - Row 1
2019-08-22 10:47:37,706 - INFO - Filename: A30 Fashion Buyers
2019-08-22 10:47:37,707 - INFO - Category: 'Women Bags','Women Clothes','Women Shoes','Watches','Men Bags','Men Clothes','Men Shoes'
2019-08-22 10:47:37,710 - INFO - Last Login: 30
2019-08-22 10:47:37,713 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Bags','Women Clothes','Women Shoes','Watches','Men Bags','Men Clothes','Men Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 10:47:37,721 - INFO - Start Running query A30 Fashion Buyers
2019-08-22 10:55:46,555 - INFO - Running A30 Fashion Buyers Done
2019-08-22 10:55:46,555 - INFO - CSV file path: A30 Fashion Buyers
2019-08-22 10:55:47,433 - INFO - Starting save the query results
2019-08-22 10:55:47,434 - INFO - Total Rows : 11425625
2019-08-22 10:55:47,434 - INFO - Will split into : 12.0 files
2019-08-22 10:55:54,167 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_1.csv
2019-08-22 10:55:54,168 - INFO - , with total : 952136 rows
2019-08-22 10:56:01,069 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_2.csv
2019-08-22 10:56:01,071 - INFO - , with total : 952136 rows
2019-08-22 10:56:07,971 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_3.csv
2019-08-22 10:56:07,973 - INFO - , with total : 952136 rows
2019-08-22 10:56:14,887 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_4.csv
2019-08-22 10:56:14,888 - INFO - , with total : 952136 rows
2019-08-22 10:56:21,940 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_5.csv
2019-08-22 10:56:21,940 - INFO - , with total : 952136 rows
2019-08-22 10:56:27,631 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_6.csv
2019-08-22 10:56:27,631 - INFO - , with total : 952135 rows
2019-08-22 10:56:33,323 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_7.csv
2019-08-22 10:56:33,325 - INFO - , with total : 952135 rows
2019-08-22 10:56:39,272 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_8.csv
2019-08-22 10:56:39,273 - INFO - , with total : 952135 rows
2019-08-22 10:56:48,770 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_9.csv
2019-08-22 10:56:48,773 - INFO - , with total : 952135 rows
2019-08-22 10:57:03,661 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_10.csv
2019-08-22 10:57:03,663 - INFO - , with total : 952135 rows
2019-08-22 10:57:09,368 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_11.csv
2019-08-22 10:57:09,369 - INFO - , with total : 952135 rows
2019-08-22 10:57:16,141 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Buyers_12.csv
2019-08-22 10:57:16,142 - INFO - , with total : 952135 rows
2019-08-22 10:57:20,443 - INFO - Row 2
2019-08-22 10:57:20,444 - INFO - Filename: A30 Fashion Accessories
2019-08-22 10:57:20,444 - INFO - Category: 'Fashion Accessories'
2019-08-22 10:57:20,446 - INFO - Last Login: 30
2019-08-22 10:57:20,447 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 10:57:20,448 - INFO - Start Running query A30 Fashion Accessories
2019-08-22 11:00:33,190 - INFO - Running A30 Fashion Accessories Done
2019-08-22 11:00:33,191 - INFO - CSV file path: A30 Fashion Accessories
2019-08-22 11:00:33,713 - INFO - Starting save the query results
2019-08-22 11:00:33,713 - INFO - Total Rows : 4624231
2019-08-22 11:00:33,714 - INFO - Will split into : 5.0 files
2019-08-22 11:00:41,187 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Accessories_1.csv
2019-08-22 11:00:41,188 - INFO - , with total : 924847 rows
2019-08-22 11:00:48,490 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Accessories_2.csv
2019-08-22 11:00:48,490 - INFO - , with total : 924846 rows
2019-08-22 11:00:55,836 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Accessories_3.csv
2019-08-22 11:00:55,838 - INFO - , with total : 924846 rows
2019-08-22 11:01:04,782 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Accessories_4.csv
2019-08-22 11:01:04,783 - INFO - , with total : 924846 rows
2019-08-22 11:01:13,177 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Fashion Accessories_5.csv
2019-08-22 11:01:13,177 - INFO - , with total : 924846 rows
2019-08-22 11:01:16,680 - INFO - Row 3
2019-08-22 11:01:16,681 - INFO - Filename: A30 Sports & Outdoor
2019-08-22 11:01:16,683 - INFO - Category: 'Sports & Outdoor'
2019-08-22 11:01:16,683 - INFO - Last Login: 30
2019-08-22 11:01:16,684 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Sports & Outdoor')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 11:01:16,686 - INFO - Start Running query A30 Sports & Outdoor
2019-08-22 11:03:29,631 - INFO - Running A30 Sports & Outdoor Done
2019-08-22 11:03:29,631 - INFO - CSV file path: A30 Sports & Outdoor
2019-08-22 11:03:29,858 - INFO - Starting save the query results
2019-08-22 11:03:29,859 - INFO - Total Rows : 2737817
2019-08-22 11:03:29,861 - INFO - Will split into : 3.0 files
2019-08-22 11:03:35,183 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Sports & Outdoor_1.csv
2019-08-22 11:03:35,184 - INFO - , with total : 912606 rows
2019-08-22 11:03:40,934 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Sports & Outdoor_2.csv
2019-08-22 11:03:40,934 - INFO - , with total : 912606 rows
2019-08-22 11:03:48,944 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Sports & Outdoor_3.csv
2019-08-22 11:03:48,948 - INFO - , with total : 912605 rows
2019-08-22 11:03:52,316 - INFO - Row 4
2019-08-22 11:03:52,319 - INFO - Filename: A30 Male Fashion
2019-08-22 11:03:52,321 - INFO - Category: 'Men Bags','Men Clothes','Men Shoes'
2019-08-22 11:03:52,322 - INFO - Last Login: 30
2019-08-22 11:03:52,323 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Men Bags','Men Clothes','Men Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 11:03:52,332 - INFO - Start Running query A30 Male Fashion
2019-08-22 11:08:24,071 - INFO - Running A30 Male Fashion Done
2019-08-22 11:08:24,071 - INFO - CSV file path: A30 Male Fashion
2019-08-22 11:08:24,571 - INFO - Starting save the query results
2019-08-22 11:08:24,571 - INFO - Total Rows : 6420969
2019-08-22 11:08:24,572 - INFO - Will split into : 7.0 files
2019-08-22 11:08:29,946 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Male Fashion_1.csv
2019-08-22 11:08:29,947 - INFO - , with total : 917282 rows
2019-08-22 11:08:36,898 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Male Fashion_2.csv
2019-08-22 11:08:36,900 - INFO - , with total : 917282 rows
2019-08-22 11:08:42,105 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Male Fashion_3.csv
2019-08-22 11:08:42,105 - INFO - , with total : 917281 rows
2019-08-22 11:08:48,033 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Male Fashion_4.csv
2019-08-22 11:08:48,035 - INFO - , with total : 917281 rows
2019-08-22 11:08:53,417 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Male Fashion_5.csv
2019-08-22 11:08:53,417 - INFO - , with total : 917281 rows
2019-08-22 11:08:59,940 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Male Fashion_6.csv
2019-08-22 11:08:59,941 - INFO - , with total : 917281 rows
2019-08-22 11:09:06,513 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 10.47/A30 Male Fashion_7.csv
2019-08-22 11:09:06,515 - INFO - , with total : 917281 rows
2019-08-22 11:09:07,901 - INFO - Delete all data in sheet: Case 1
2019-08-22 11:09:10,431 - INFO - No value detected on sheet: Case 2
2019-08-22 11:09:11,960 - INFO - No value detected on sheet: Case 3
2019-08-22 11:09:13,459 - INFO - No value detected on sheet: Case 4
2019-08-22 11:09:15,038 - INFO - No value detected on sheet: Case 5
2019-08-22 11:09:16,585 - INFO - No value detected on sheet: Case 6
2019-08-22 11:09:18,099 - INFO - No value detected on sheet: Case 7
2019-08-22 11:09:19,615 - INFO - No value detected on sheet: Case 8
2019-08-22 11:09:21,111 - INFO - No value detected on sheet: Case 9
2019-08-22 11:09:22,727 - INFO - No value detected on sheet: Case 10
2019-08-22 11:09:24,247 - INFO - No value detected on sheet: Case 11
2019-08-22 11:09:26,276 - INFO - No value detected on sheet: Case 12
2019-08-22 11:09:27,759 - INFO - No value detected on sheet: Case 13
2019-08-22 11:09:29,305 - INFO - No value detected on sheet: Case 14
2019-08-22 11:09:30,834 - INFO - No value detected on sheet: Case 15
2019-08-22 11:09:32,404 - INFO - No value detected on sheet: Case 16
2019-08-22 14:09:25,279 - INFO - Report date: 20190822 14.09
2019-08-22 14:09:30,953 - INFO - Download sheet..
2019-08-22 14:09:30,953 - INFO - Change directory to script path
2019-08-22 14:09:33,345 - INFO - Spreadsheet downloaded
2019-08-22 14:09:33,345 - INFO - Checking sheet..
2019-08-22 14:09:38,035 - INFO - No value detected on sheet: Case 1
2019-08-22 14:09:41,295 - INFO - No value detected on sheet: Case 2
2019-08-22 14:09:43,470 - INFO - No value detected on sheet: Case 3
2019-08-22 14:09:47,775 - INFO - No value detected on sheet: Case 4
2019-08-22 14:10:10,246 - INFO - No value detected on sheet: Case 5
2019-08-22 14:10:12,403 - INFO - No value detected on sheet: Case 6
2019-08-22 14:10:14,167 - INFO - No value detected on sheet: Case 7
2019-08-22 14:10:15,963 - INFO - No value detected on sheet: Case 8
2019-08-22 14:10:17,540 - INFO - No value detected on sheet: Case 9
2019-08-22 14:10:19,137 - INFO - No value detected on sheet: Case 10
2019-08-22 14:10:23,385 - INFO - No value detected on sheet: Case 11
2019-08-22 14:10:24,947 - INFO - No value detected on sheet: Case 12
2019-08-22 14:10:30,561 - INFO - No value detected on sheet: Case 13
2019-08-22 14:10:38,513 - INFO - No value detected on sheet: Case 14
2019-08-22 14:10:39,881 - INFO - No value detected on sheet: Case 15
2019-08-22 14:10:41,724 - INFO - No value detected on sheet: Case 16
2019-08-22 18:24:13,275 - INFO - Report date: 20190822 18.24
2019-08-22 18:24:13,302 - INFO - Download sheet..
2019-08-22 18:24:13,302 - INFO - Change directory to script path
2019-08-22 18:24:15,559 - INFO - Spreadsheet downloaded
2019-08-22 18:24:15,571 - INFO - Checking sheet..
2019-08-22 18:24:17,427 - INFO - Value detected - use sheet: Case 1
2019-08-22 18:24:17,427 - INFO - Reading Data From Google Sheet...
2019-08-22 18:24:17,908 - INFO - Get custom SQL..
2019-08-22 18:24:17,910 - INFO - USING CASE 1
2019-08-22 18:24:19,461 - INFO - Row 1
2019-08-22 18:24:19,463 - INFO - Filename: A7 Mobile & Accessories
2019-08-22 18:24:19,463 - INFO - Category: 'Mobile & Accessories'
2019-08-22 18:24:19,463 - INFO - Last Login: 7
2019-08-22 18:24:19,463 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 18:24:19,466 - INFO - Start Running query A7 Mobile & Accessories
2019-08-22 18:27:18,572 - INFO - Running A7 Mobile & Accessories Done
2019-08-22 18:27:18,572 - INFO - CSV file path: A7 Mobile & Accessories
2019-08-22 18:27:19,029 - INFO - Starting save the query results
2019-08-22 18:27:19,029 - INFO - Total Rows : 6034891
2019-08-22 18:27:19,029 - INFO - Will split into : 7.0 files
2019-08-22 18:27:23,832 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Mobile & Accessories_1.csv
2019-08-22 18:27:23,834 - INFO - , with total : 862128 rows
2019-08-22 18:27:28,155 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Mobile & Accessories_2.csv
2019-08-22 18:27:28,157 - INFO - , with total : 862128 rows
2019-08-22 18:27:33,714 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Mobile & Accessories_3.csv
2019-08-22 18:27:33,716 - INFO - , with total : 862127 rows
2019-08-22 18:27:40,937 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Mobile & Accessories_4.csv
2019-08-22 18:27:40,937 - INFO - , with total : 862127 rows
2019-08-22 18:27:45,788 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Mobile & Accessories_5.csv
2019-08-22 18:27:45,789 - INFO - , with total : 862127 rows
2019-08-22 18:27:50,657 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Mobile & Accessories_6.csv
2019-08-22 18:27:50,658 - INFO - , with total : 862127 rows
2019-08-22 18:27:55,572 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Mobile & Accessories_7.csv
2019-08-22 18:27:55,572 - INFO - , with total : 862127 rows
2019-08-22 18:27:58,210 - INFO - Row 2
2019-08-22 18:27:58,211 - INFO - Filename: A7 Automotive, HL, MA,EL
2019-08-22 18:27:58,213 - INFO - Category: 'Automotive','Home & Living','Mobile & Accessories','Electronics'
2019-08-22 18:27:58,214 - INFO - Last Login: 7
2019-08-22 18:27:58,216 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Automotive','Home & Living','Mobile & Accessories','Electronics')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 18:27:58,226 - INFO - Start Running query A7 Automotive, HL, MA,EL
2019-08-22 18:32:24,713 - INFO - Running A7 Automotive, HL, MA,EL Done
2019-08-22 18:32:24,714 - INFO - CSV file path: A7 Automotive, HL, MA,EL
2019-08-22 18:32:25,349 - INFO - Starting save the query results
2019-08-22 18:32:25,351 - INFO - Total Rows : 8535923
2019-08-22 18:32:25,351 - INFO - Will split into : 9.0 files
2019-08-22 18:32:30,071 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Automotive, HL, MA,EL_1.csv
2019-08-22 18:32:30,071 - INFO - , with total : 948436 rows
2019-08-22 18:32:34,812 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Automotive, HL, MA,EL_2.csv
2019-08-22 18:32:34,812 - INFO - , with total : 948436 rows
2019-08-22 18:32:40,155 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Automotive, HL, MA,EL_3.csv
2019-08-22 18:32:40,157 - INFO - , with total : 948436 rows
2019-08-22 18:32:45,619 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Automotive, HL, MA,EL_4.csv
2019-08-22 18:32:45,621 - INFO - , with total : 948436 rows
2019-08-22 18:32:51,611 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Automotive, HL, MA,EL_5.csv
2019-08-22 18:32:51,611 - INFO - , with total : 948436 rows
2019-08-22 18:32:57,930 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Automotive, HL, MA,EL_6.csv
2019-08-22 18:32:57,961 - INFO - , with total : 948436 rows
2019-08-22 18:33:06,301 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Automotive, HL, MA,EL_7.csv
2019-08-22 18:33:06,302 - INFO - , with total : 948436 rows
2019-08-22 18:33:12,713 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Automotive, HL, MA,EL_8.csv
2019-08-22 18:33:12,714 - INFO - , with total : 948436 rows
2019-08-22 18:33:18,980 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Automotive, HL, MA,EL_9.csv
2019-08-22 18:33:18,982 - INFO - , with total : 948435 rows
2019-08-22 18:33:22,660 - INFO - Row 3
2019-08-22 18:33:22,661 - INFO - Filename: A3 FMCG Buyers
2019-08-22 18:33:22,663 - INFO - Category: 'Food & Beverages','Health','Beauty','Mom & Baby'
2019-08-22 18:33:22,664 - INFO - Last Login: 3
2019-08-22 18:33:22,664 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Food & Beverages','Health','Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 18:33:22,674 - INFO - Start Running query A3 FMCG Buyers
2019-08-22 18:37:20,938 - INFO - Running A3 FMCG Buyers Done
2019-08-22 18:37:20,940 - INFO - CSV file path: A3 FMCG Buyers
2019-08-22 18:37:21,421 - INFO - Starting save the query results
2019-08-22 18:37:21,421 - INFO - Total Rows : 6341718
2019-08-22 18:37:21,423 - INFO - Will split into : 7.0 files
2019-08-22 18:37:30,565 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 FMCG Buyers_1.csv
2019-08-22 18:37:30,569 - INFO - , with total : 905960 rows
2019-08-22 18:37:41,545 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 FMCG Buyers_2.csv
2019-08-22 18:37:41,548 - INFO - , with total : 905960 rows
2019-08-22 18:37:51,700 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 FMCG Buyers_3.csv
2019-08-22 18:37:51,707 - INFO - , with total : 905960 rows
2019-08-22 18:37:57,789 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 FMCG Buyers_4.csv
2019-08-22 18:37:57,793 - INFO - , with total : 905960 rows
2019-08-22 18:38:03,835 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 FMCG Buyers_5.csv
2019-08-22 18:38:03,838 - INFO - , with total : 905960 rows
2019-08-22 18:38:09,752 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 FMCG Buyers_6.csv
2019-08-22 18:38:09,753 - INFO - , with total : 905959 rows
2019-08-22 18:38:15,654 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 FMCG Buyers_7.csv
2019-08-22 18:38:15,654 - INFO - , with total : 905959 rows
2019-08-22 18:38:18,762 - INFO - Row 4
2019-08-22 18:38:18,763 - INFO - Filename: A3 Handphone Buyers
2019-08-22 18:38:18,763 - INFO - Category: 'Mobile & Accessories'
2019-08-22 18:38:18,765 - INFO - Last Login: 3
2019-08-22 18:38:18,766 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 18:38:18,767 - INFO - Start Running query A3 Handphone Buyers
2019-08-22 18:40:52,966 - INFO - Running A3 Handphone Buyers Done
2019-08-22 18:40:52,966 - INFO - CSV file path: A3 Handphone Buyers
2019-08-22 18:40:53,352 - INFO - Starting save the query results
2019-08-22 18:40:53,354 - INFO - Total Rows : 4947438
2019-08-22 18:40:53,354 - INFO - Will split into : 5.0 files
2019-08-22 18:40:59,144 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 Handphone Buyers_1.csv
2019-08-22 18:40:59,144 - INFO - , with total : 989488 rows
2019-08-22 18:41:13,220 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 Handphone Buyers_2.csv
2019-08-22 18:41:13,223 - INFO - , with total : 989488 rows
2019-08-22 18:41:20,779 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 Handphone Buyers_3.csv
2019-08-22 18:41:20,779 - INFO - , with total : 989488 rows
2019-08-22 18:41:26,940 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 Handphone Buyers_4.csv
2019-08-22 18:41:26,943 - INFO - , with total : 989487 rows
2019-08-22 18:41:35,434 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 Handphone Buyers_5.csv
2019-08-22 18:41:35,436 - INFO - , with total : 989487 rows
2019-08-22 18:41:36,426 - INFO - Delete all data in sheet: Case 1
2019-08-22 18:41:38,071 - INFO - No value detected on sheet: Case 2
2019-08-22 18:41:39,072 - INFO - No value detected on sheet: Case 3
2019-08-22 18:41:40,058 - INFO - No value detected on sheet: Case 4
2019-08-22 18:41:41,043 - INFO - Value detected - use sheet: Case 5
2019-08-22 18:41:41,043 - INFO - Reading Data From Google Sheet...
2019-08-22 18:41:41,530 - INFO - Get custom SQL..
2019-08-22 18:41:41,533 - INFO - USING CASE 5
2019-08-22 18:41:43,555 - INFO - Row 1
2019-08-22 18:41:43,558 - INFO - Filename: A7 Male buyers + Hobby & Toys Buyer
2019-08-22 18:41:43,559 - INFO - Category: 'Hobby & Collection'
2019-08-22 18:41:43,559 - INFO - Last Login: 30
2019-08-22 18:41:43,561 - INFO - Gender: 1,3
2019-08-22 18:41:43,562 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (1,3)
                                
2019-08-22 18:41:43,569 - INFO - Start Running query A7 Male buyers + Hobby & Toys Buyer
2019-08-22 18:42:23,204 - INFO - Running A7 Male buyers + Hobby & Toys Buyer Done
2019-08-22 18:42:23,206 - INFO - CSV file path: A7 Male buyers + Hobby & Toys Buyer
2019-08-22 18:42:23,286 - INFO - Starting save the query results
2019-08-22 18:42:23,286 - INFO - Total Rows : 596804
2019-08-22 18:42:23,286 - INFO - Will split into : 1.0 files
2019-08-22 18:42:30,451 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Male buyers + Hobby & Toys Buyer_1.csv
2019-08-22 18:42:30,453 - INFO - , with total : 596804 rows
2019-08-22 18:42:31,061 - INFO - Delete all data in sheet: Case 5
2019-08-22 18:42:32,572 - INFO - Value detected - use sheet: Case 6
2019-08-22 18:42:32,572 - INFO - Reading Data From Google Sheet...
2019-08-22 18:42:33,119 - INFO - Get custom SQL..
2019-08-22 18:42:33,121 - INFO - USING CASE 6
2019-08-22 18:42:35,171 - INFO - Row 1
2019-08-22 18:42:35,173 - INFO - Filename: A7 Voucher Gaming
2019-08-22 18:42:35,173 - INFO - Sub-category: 'Gaming'
2019-08-22 18:42:35,174 - INFO - Last Login: 7
2019-08-22 18:42:35,177 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Gaming')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 18:42:35,180 - INFO - Start Running query A7 Voucher Gaming
2019-08-22 18:42:52,838 - INFO - Running A7 Voucher Gaming Done
2019-08-22 18:42:52,839 - INFO - CSV file path: A7 Voucher Gaming
2019-08-22 18:42:52,871 - INFO - Starting save the query results
2019-08-22 18:42:52,872 - INFO - Total Rows : 405156
2019-08-22 18:42:52,872 - INFO - Will split into : 1.0 files
2019-08-22 18:42:55,006 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Voucher Gaming_1.csv
2019-08-22 18:42:55,006 - INFO - , with total : 405156 rows
2019-08-22 18:42:57,184 - INFO - Row 2
2019-08-22 18:42:57,184 - INFO - Filename: A7 Laptop Buyers
2019-08-22 18:42:57,186 - INFO - Sub-category: 'Laptop'
2019-08-22 18:42:57,186 - INFO - Last Login: 7
2019-08-22 18:42:57,187 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Laptop')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 18:42:57,188 - INFO - Start Running query A7 Laptop Buyers
2019-08-22 18:43:25,706 - INFO - Running A7 Laptop Buyers Done
2019-08-22 18:43:25,707 - INFO - CSV file path: A7 Laptop Buyers
2019-08-22 18:43:25,759 - INFO - Starting save the query results
2019-08-22 18:43:25,760 - INFO - Total Rows : 656223
2019-08-22 18:43:25,760 - INFO - Will split into : 1.0 files
2019-08-22 18:43:29,198 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 Laptop Buyers_1.csv
2019-08-22 18:43:29,198 - INFO - , with total : 656223 rows
2019-08-22 18:43:31,588 - INFO - Row 3
2019-08-22 18:43:31,588 - INFO - Filename: A7 Mobile Phone Buyers
2019-08-22 18:43:31,589 - INFO - Sub-category: ''
2019-08-22 18:43:31,592 - INFO - Last Login: 7
2019-08-22 18:43:31,592 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 18:43:31,598 - INFO - Start Running query A7 Mobile Phone Buyers
2019-08-22 18:43:34,505 - INFO - Running A7 Mobile Phone Buyers Done
2019-08-22 18:43:34,506 - INFO - CSV file path: A7 Mobile Phone Buyers
2019-08-22 18:43:34,513 - INFO - Starting save the query results
2019-08-22 18:43:34,515 - INFO - Total Rows : 0
2019-08-22 18:43:34,516 - INFO - Will split into : 0.0 files
2019-08-22 18:43:34,519 - INFO - ERROR -> number sections must be larger than 0.
2019-08-22 18:43:34,519 - INFO - Start sending...
2019-08-22 18:43:42,671 - INFO - Message sent successfully
2019-08-22 18:43:44,671 - INFO - Row 4
2019-08-22 18:43:44,674 - INFO - Filename: A30 CA Storage Buyers
2019-08-22 18:43:44,674 - INFO - Sub-category: 'Storage External'
2019-08-22 18:43:44,674 - INFO - Last Login: 30
2019-08-22 18:43:44,676 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Storage External')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 18:43:44,677 - INFO - Start Running query A30 CA Storage Buyers
2019-08-22 18:44:09,036 - INFO - Running A30 CA Storage Buyers Done
2019-08-22 18:44:09,038 - INFO - CSV file path: A30 CA Storage Buyers
2019-08-22 18:44:09,089 - INFO - Starting save the query results
2019-08-22 18:44:09,091 - INFO - Total Rows : 644236
2019-08-22 18:44:09,091 - INFO - Will split into : 1.0 files
2019-08-22 18:44:14,799 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A30 CA Storage Buyers_1.csv
2019-08-22 18:44:14,801 - INFO - , with total : 644236 rows
2019-08-22 18:44:17,426 - INFO - Row 5
2019-08-22 18:44:17,431 - INFO - Filename: A3 Home Care
2019-08-22 18:44:17,437 - INFO - Sub-category: 'Home Care'
2019-08-22 18:44:17,440 - INFO - Last Login: 3
2019-08-22 18:44:17,446 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Home Care')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-22 18:44:17,464 - INFO - Start Running query A3 Home Care
2019-08-22 18:44:48,348 - INFO - Running A3 Home Care Done
2019-08-22 18:44:48,349 - INFO - CSV file path: A3 Home Care
2019-08-22 18:44:48,415 - INFO - Starting save the query results
2019-08-22 18:44:48,417 - INFO - Total Rows : 795130
2019-08-22 18:44:48,417 - INFO - Will split into : 1.0 files
2019-08-22 18:44:52,655 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A3 Home Care_1.csv
2019-08-22 18:44:52,657 - INFO - , with total : 795130 rows
2019-08-22 18:44:53,236 - INFO - Delete all data in sheet: Case 6
2019-08-22 18:44:54,786 - INFO - No value detected on sheet: Case 7
2019-08-22 18:44:55,851 - INFO - Value detected - use sheet: Case 8
2019-08-22 18:44:55,854 - INFO - Reading Data From Google Sheet...
2019-08-22 18:44:56,664 - INFO - Get custom SQL..
2019-08-22 18:44:56,665 - INFO - USING CASE 8
2019-08-22 18:44:57,746 - INFO - Row 1
2019-08-22 18:44:57,749 - INFO - Filename: Abbott OS Followers
2019-08-22 18:44:57,750 - INFO - Shop ID: 27475286
2019-08-22 18:44:57,753 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (27475286) 
                                and status = 1
                                
2019-08-22 18:44:57,762 - INFO - Start Running query Abbott OS Followers
2019-08-22 18:45:02,088 - INFO - Running Abbott OS Followers Done
2019-08-22 18:45:02,092 - INFO - CSV file path: Abbott OS Followers
2019-08-22 18:45:02,098 - INFO - Starting save the query results
2019-08-22 18:45:02,102 - INFO - Total Rows : 10526
2019-08-22 18:45:02,108 - INFO - Will split into : 1.0 files
2019-08-22 18:45:02,209 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/Abbott OS Followers_1.csv
2019-08-22 18:45:02,210 - INFO - , with total : 10526 rows
2019-08-22 18:45:02,576 - INFO - Delete all data in sheet: Case 8
2019-08-22 18:45:04,167 - INFO - Value detected - use sheet: Case 9
2019-08-22 18:45:04,167 - INFO - Reading Data From Google Sheet...
2019-08-22 18:45:05,119 - INFO - Get custom SQL..
2019-08-22 18:45:05,121 - INFO - USING CASE 9
2019-08-22 18:45:05,867 - INFO - Row 1
2019-08-22 18:45:05,869 - INFO - Filename: A1 Digital Product Buyers
2019-08-22 18:45:05,871 - INFO - Last Login: 1
2019-08-22 18:45:05,875 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-22 18:45:05,884 - INFO - Start Running query A1 Digital Product Buyers
2019-08-22 18:45:57,003 - INFO - Running A1 Digital Product Buyers Done
2019-08-22 18:45:57,005 - INFO - CSV file path: A1 Digital Product Buyers
2019-08-22 18:45:57,145 - INFO - Starting save the query results
2019-08-22 18:45:57,147 - INFO - Total Rows : 1451471
2019-08-22 18:45:57,148 - INFO - Will split into : 2.0 files
2019-08-22 18:46:01,138 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A1 Digital Product Buyers_1.csv
2019-08-22 18:46:01,138 - INFO - , with total : 725736 rows
2019-08-22 18:46:05,009 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A1 Digital Product Buyers_2.csv
2019-08-22 18:46:05,012 - INFO - , with total : 725735 rows
2019-08-22 18:46:05,483 - INFO - Delete all data in sheet: Case 9
2019-08-22 18:46:06,969 - INFO - Value detected - use sheet: Case 10
2019-08-22 18:46:06,970 - INFO - Reading Data From Google Sheet...
2019-08-22 18:46:07,352 - INFO - Get custom SQL..
2019-08-22 18:46:07,355 - INFO - USING CASE 10
2019-08-22 18:46:08,085 - INFO - Row 1
2019-08-22 18:46:08,088 - INFO - Filename: A7 who haven't shopped DP
2019-08-22 18:46:08,088 - INFO - Last Login: 7
2019-08-22 18:46:08,091 - INFO - Query:
                                with b as(
                                        select distinct o.user_id as userid
                                        from shopee_digital_product_order_id_db__order_tab AS o
                                    )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    where
                                    last_login >= current_date - interval '7' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-22 18:46:08,101 - INFO - Start Running query A7 who haven't shopped DP
2019-08-22 18:54:30,177 - INFO - Running A7 who haven't shopped DP Done
2019-08-22 18:54:30,177 - INFO - CSV file path: A7 who haven't shopped DP
2019-08-22 18:54:31,322 - INFO - Starting save the query results
2019-08-22 18:54:31,323 - INFO - Total Rows : 12863624
2019-08-22 18:54:31,323 - INFO - Will split into : 13.0 files
2019-08-22 18:54:36,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_1.csv
2019-08-22 18:54:36,969 - INFO - , with total : 989510 rows
2019-08-22 18:54:43,187 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_2.csv
2019-08-22 18:54:43,187 - INFO - , with total : 989510 rows
2019-08-22 18:54:49,354 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_3.csv
2019-08-22 18:54:49,357 - INFO - , with total : 989510 rows
2019-08-22 18:54:59,413 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_4.csv
2019-08-22 18:54:59,417 - INFO - , with total : 989510 rows
2019-08-22 18:55:08,721 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_5.csv
2019-08-22 18:55:08,724 - INFO - , with total : 989510 rows
2019-08-22 18:55:18,141 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_6.csv
2019-08-22 18:55:18,161 - INFO - , with total : 989510 rows
2019-08-22 18:55:26,979 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_7.csv
2019-08-22 18:55:26,980 - INFO - , with total : 989510 rows
2019-08-22 18:55:33,542 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_8.csv
2019-08-22 18:55:33,543 - INFO - , with total : 989509 rows
2019-08-22 18:55:40,680 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_9.csv
2019-08-22 18:55:40,681 - INFO - , with total : 989509 rows
2019-08-22 18:55:47,868 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_10.csv
2019-08-22 18:55:47,869 - INFO - , with total : 989509 rows
2019-08-22 18:55:55,513 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_11.csv
2019-08-22 18:55:55,513 - INFO - , with total : 989509 rows
2019-08-22 18:56:03,862 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_12.csv
2019-08-22 18:56:03,864 - INFO - , with total : 989509 rows
2019-08-22 18:56:23,779 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A7 who haven't shopped DP_13.csv
2019-08-22 18:56:23,779 - INFO - , with total : 989509 rows
2019-08-22 18:56:26,493 - INFO - Row 2
2019-08-22 18:56:26,494 - INFO - Filename: A1 who haven't shopped DP
2019-08-22 18:56:26,496 - INFO - Last Login: 1
2019-08-22 18:56:26,496 - INFO - Query:
                                with b as(
                                        select distinct o.user_id as userid
                                        from shopee_digital_product_order_id_db__order_tab AS o
                                    )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    where
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-22 18:56:26,497 - INFO - Start Running query A1 who haven't shopped DP
2019-08-22 18:59:28,687 - INFO - Running A1 who haven't shopped DP Done
2019-08-22 18:59:28,688 - INFO - CSV file path: A1 who haven't shopped DP
2019-08-22 18:59:29,223 - INFO - Starting save the query results
2019-08-22 18:59:29,223 - INFO - Total Rows : 6035255
2019-08-22 18:59:29,223 - INFO - Will split into : 7.0 files
2019-08-22 18:59:33,765 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A1 who haven't shopped DP_1.csv
2019-08-22 18:59:33,766 - INFO - , with total : 862180 rows
2019-08-22 18:59:38,233 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A1 who haven't shopped DP_2.csv
2019-08-22 18:59:38,234 - INFO - , with total : 862180 rows
2019-08-22 18:59:43,121 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A1 who haven't shopped DP_3.csv
2019-08-22 18:59:43,121 - INFO - , with total : 862179 rows
2019-08-22 18:59:48,108 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A1 who haven't shopped DP_4.csv
2019-08-22 18:59:48,109 - INFO - , with total : 862179 rows
2019-08-22 18:59:53,161 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A1 who haven't shopped DP_5.csv
2019-08-22 18:59:53,161 - INFO - , with total : 862179 rows
2019-08-22 18:59:58,602 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A1 who haven't shopped DP_6.csv
2019-08-22 18:59:58,604 - INFO - , with total : 862179 rows
2019-08-22 19:00:04,581 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190822 18.24/A1 who haven't shopped DP_7.csv
2019-08-22 19:00:04,582 - INFO - , with total : 862179 rows
2019-08-22 19:00:05,632 - INFO - Delete all data in sheet: Case 10
2019-08-22 19:00:08,335 - INFO - No value detected on sheet: Case 11
2019-08-22 19:00:09,549 - INFO - No value detected on sheet: Case 12
2019-08-22 19:00:11,007 - INFO - No value detected on sheet: Case 13
2019-08-22 19:00:12,046 - INFO - No value detected on sheet: Case 14
2019-08-22 19:00:13,130 - INFO - No value detected on sheet: Case 15
2019-08-22 19:00:14,588 - INFO - No value detected on sheet: Case 16
2019-08-23 11:29:36,617 - INFO - Report date: 20190823 11.29
2019-08-23 11:29:40,650 - INFO - Download sheet..
2019-08-23 11:29:40,651 - INFO - Change directory to script path
2019-08-23 11:29:41,861 - INFO - Spreadsheet downloaded
2019-08-23 11:29:41,864 - INFO - Checking sheet..
2019-08-23 11:29:42,983 - INFO - Value detected - use sheet: Case 1
2019-08-23 11:29:42,984 - INFO - Reading Data From Google Sheet...
2019-08-23 11:29:43,326 - INFO - Get custom SQL..
2019-08-23 11:29:43,328 - INFO - USING CASE 1
2019-08-23 11:29:44,397 - INFO - Row 1
2019-08-23 11:29:44,398 - INFO - Filename: A30 MA buyers
2019-08-23 11:29:44,398 - INFO - Category: 'Mobile & Accessories'
2019-08-23 11:29:44,398 - INFO - Last Login: 30
2019-08-23 11:29:44,398 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 11:29:44,398 - INFO - Start Running query A30 MA buyers
2019-08-23 11:35:05,571 - INFO - Running A30 MA buyers Done
2019-08-23 11:35:05,572 - INFO - CSV file path: A30 MA buyers
2019-08-23 11:35:05,849 - INFO - Starting save the query results
2019-08-23 11:35:05,851 - INFO - Total Rows : 7488721
2019-08-23 11:35:05,851 - INFO - Will split into : 8.0 files
2019-08-23 11:35:10,332 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA buyers_1.csv
2019-08-23 11:35:10,334 - INFO - , with total : 936091 rows
2019-08-23 11:35:14,892 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA buyers_2.csv
2019-08-23 11:35:14,894 - INFO - , with total : 936090 rows
2019-08-23 11:35:19,306 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA buyers_3.csv
2019-08-23 11:35:19,308 - INFO - , with total : 936090 rows
2019-08-23 11:35:23,681 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA buyers_4.csv
2019-08-23 11:35:23,683 - INFO - , with total : 936090 rows
2019-08-23 11:35:28,252 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA buyers_5.csv
2019-08-23 11:35:28,253 - INFO - , with total : 936090 rows
2019-08-23 11:35:32,733 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA buyers_6.csv
2019-08-23 11:35:32,734 - INFO - , with total : 936090 rows
2019-08-23 11:35:37,401 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA buyers_7.csv
2019-08-23 11:35:37,403 - INFO - , with total : 936090 rows
2019-08-23 11:35:41,984 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA buyers_8.csv
2019-08-23 11:35:41,986 - INFO - , with total : 936090 rows
2019-08-23 11:35:44,033 - INFO - Row 2
2019-08-23 11:35:44,035 - INFO - Filename: A30 Lifestyle Buyers
2019-08-23 11:35:44,036 - INFO - Category: 'Automotive','Hobby & Collection','Home & Living','Souvenir & Party Supplies
Sports & Outdoor','Stationery & Books'
2019-08-23 11:35:44,036 - INFO - Last Login: 30
2019-08-23 11:35:44,036 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Automotive','Hobby & Collection','Home & Living','Souvenir & Party Supplies
Sports & Outdoor','Stationery & Books')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 11:35:44,038 - INFO - Start Running query A30 Lifestyle Buyers
2019-08-23 11:40:33,819 - INFO - Running A30 Lifestyle Buyers Done
2019-08-23 11:40:33,821 - INFO - CSV file path: A30 Lifestyle Buyers
2019-08-23 11:40:34,167 - INFO - Starting save the query results
2019-08-23 11:40:34,167 - INFO - Total Rows : 8852663
2019-08-23 11:40:34,167 - INFO - Will split into : 9.0 files
2019-08-23 11:40:38,673 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Lifestyle Buyers_1.csv
2019-08-23 11:40:38,674 - INFO - , with total : 983630 rows
2019-08-23 11:40:42,954 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Lifestyle Buyers_2.csv
2019-08-23 11:40:42,956 - INFO - , with total : 983630 rows
2019-08-23 11:40:47,375 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Lifestyle Buyers_3.csv
2019-08-23 11:40:47,375 - INFO - , with total : 983629 rows
2019-08-23 11:40:51,865 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Lifestyle Buyers_4.csv
2019-08-23 11:40:51,865 - INFO - , with total : 983629 rows
2019-08-23 11:40:56,342 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Lifestyle Buyers_5.csv
2019-08-23 11:40:56,344 - INFO - , with total : 983629 rows
2019-08-23 11:41:00,801 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Lifestyle Buyers_6.csv
2019-08-23 11:41:00,802 - INFO - , with total : 983629 rows
2019-08-23 11:41:05,273 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Lifestyle Buyers_7.csv
2019-08-23 11:41:05,273 - INFO - , with total : 983629 rows
2019-08-23 11:41:09,720 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Lifestyle Buyers_8.csv
2019-08-23 11:41:09,721 - INFO - , with total : 983629 rows
2019-08-23 11:41:14,278 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Lifestyle Buyers_9.csv
2019-08-23 11:41:14,279 - INFO - , with total : 983629 rows
2019-08-23 11:41:16,381 - INFO - Row 3
2019-08-23 11:41:16,381 - INFO - Filename: A30 FMCG Buyers
2019-08-23 11:41:16,384 - INFO - Category: 'Beauty','Food & Beverages','Health','Health & Beauty','Mom & Baby'
2019-08-23 11:41:16,385 - INFO - Last Login: 30
2019-08-23 11:41:16,387 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty','Food & Beverages','Health','Health & Beauty','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 11:41:16,391 - INFO - Start Running query A30 FMCG Buyers
2019-08-23 11:47:48,861 - INFO - Running A30 FMCG Buyers Done
2019-08-23 11:47:48,862 - INFO - CSV file path: A30 FMCG Buyers
2019-08-23 11:47:49,217 - INFO - Starting save the query results
2019-08-23 11:47:49,217 - INFO - Total Rows : 9718271
2019-08-23 11:47:49,219 - INFO - Will split into : 10.0 files
2019-08-23 11:47:53,582 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 FMCG Buyers_1.csv
2019-08-23 11:47:53,584 - INFO - , with total : 971828 rows
2019-08-23 11:47:57,839 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 FMCG Buyers_2.csv
2019-08-23 11:47:57,841 - INFO - , with total : 971827 rows
2019-08-23 11:48:02,203 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 FMCG Buyers_3.csv
2019-08-23 11:48:02,206 - INFO - , with total : 971827 rows
2019-08-23 11:48:06,615 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 FMCG Buyers_4.csv
2019-08-23 11:48:06,615 - INFO - , with total : 971827 rows
2019-08-23 11:48:11,028 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 FMCG Buyers_5.csv
2019-08-23 11:48:11,029 - INFO - , with total : 971827 rows
2019-08-23 11:48:15,430 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 FMCG Buyers_6.csv
2019-08-23 11:48:15,430 - INFO - , with total : 971827 rows
2019-08-23 11:48:19,796 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 FMCG Buyers_7.csv
2019-08-23 11:48:19,796 - INFO - , with total : 971827 rows
2019-08-23 11:48:24,210 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 FMCG Buyers_8.csv
2019-08-23 11:48:24,210 - INFO - , with total : 971827 rows
2019-08-23 11:48:28,700 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 FMCG Buyers_9.csv
2019-08-23 11:48:28,700 - INFO - , with total : 971827 rows
2019-08-23 11:48:33,131 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 FMCG Buyers_10.csv
2019-08-23 11:48:33,131 - INFO - , with total : 971827 rows
2019-08-23 11:48:35,395 - INFO - Row 4
2019-08-23 11:48:35,397 - INFO - Filename: A30 EL Buyers
2019-08-23 11:48:35,398 - INFO - Category: 'Computer & Accessories','Electronics','Mobile & Accessories','Photography'
2019-08-23 11:48:35,398 - INFO - Last Login: 30
2019-08-23 11:48:35,398 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Computer & Accessories','Electronics','Mobile & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 11:48:35,398 - INFO - Start Running query A30 EL Buyers
2019-08-23 11:53:12,003 - INFO - Running A30 EL Buyers Done
2019-08-23 11:53:12,003 - INFO - CSV file path: A30 EL Buyers
2019-08-23 11:53:12,335 - INFO - Starting save the query results
2019-08-23 11:53:12,335 - INFO - Total Rows : 9213333
2019-08-23 11:53:12,336 - INFO - Will split into : 10.0 files
2019-08-23 11:53:16,505 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 EL Buyers_1.csv
2019-08-23 11:53:16,506 - INFO - , with total : 921334 rows
2019-08-23 11:53:20,528 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 EL Buyers_2.csv
2019-08-23 11:53:20,529 - INFO - , with total : 921334 rows
2019-08-23 11:53:24,598 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 EL Buyers_3.csv
2019-08-23 11:53:24,598 - INFO - , with total : 921334 rows
2019-08-23 11:53:28,783 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 EL Buyers_4.csv
2019-08-23 11:53:28,783 - INFO - , with total : 921333 rows
2019-08-23 11:53:32,957 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 EL Buyers_5.csv
2019-08-23 11:53:32,957 - INFO - , with total : 921333 rows
2019-08-23 11:53:37,132 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 EL Buyers_6.csv
2019-08-23 11:53:37,134 - INFO - , with total : 921333 rows
2019-08-23 11:53:41,387 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 EL Buyers_7.csv
2019-08-23 11:53:41,388 - INFO - , with total : 921333 rows
2019-08-23 11:53:45,601 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 EL Buyers_8.csv
2019-08-23 11:53:45,601 - INFO - , with total : 921333 rows
2019-08-23 11:53:49,762 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 EL Buyers_9.csv
2019-08-23 11:53:49,763 - INFO - , with total : 921333 rows
2019-08-23 11:53:53,937 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 EL Buyers_10.csv
2019-08-23 11:53:53,937 - INFO - , with total : 921333 rows
2019-08-23 11:53:56,198 - INFO - Row 5
2019-08-23 11:53:56,200 - INFO - Filename: A30 Fashion Buyers
2019-08-23 11:53:56,203 - INFO - Category: 'Watches','Women Bags','Women Clothes','Women Shoes','Muslim Fashion','Men Bags','Men Clothes','Men Shoes','Fashion Accessories','Baby & Kids Fashion'
2019-08-23 11:53:56,203 - INFO - Last Login: 30
2019-08-23 11:53:56,203 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Watches','Women Bags','Women Clothes','Women Shoes','Muslim Fashion','Men Bags','Men Clothes','Men Shoes','Fashion Accessories','Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 11:53:56,204 - INFO - Start Running query A30 Fashion Buyers
2019-08-23 12:05:59,595 - INFO - Running A30 Fashion Buyers Done
2019-08-23 12:05:59,598 - INFO - CSV file path: A30 Fashion Buyers
2019-08-23 12:06:01,203 - INFO - Starting save the query results
2019-08-23 12:06:01,204 - INFO - Total Rows : 12554489
2019-08-23 12:06:01,206 - INFO - Will split into : 13.0 files
2019-08-23 12:06:06,224 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_1.csv
2019-08-23 12:06:06,255 - INFO - , with total : 965730 rows
2019-08-23 12:06:10,898 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_2.csv
2019-08-23 12:06:10,900 - INFO - , with total : 965730 rows
2019-08-23 12:06:15,650 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_3.csv
2019-08-23 12:06:15,651 - INFO - , with total : 965730 rows
2019-08-23 12:06:20,480 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_4.csv
2019-08-23 12:06:20,482 - INFO - , with total : 965730 rows
2019-08-23 12:06:25,246 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_5.csv
2019-08-23 12:06:25,246 - INFO - , with total : 965730 rows
2019-08-23 12:06:30,035 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_6.csv
2019-08-23 12:06:30,036 - INFO - , with total : 965730 rows
2019-08-23 12:06:34,864 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_7.csv
2019-08-23 12:06:34,865 - INFO - , with total : 965730 rows
2019-08-23 12:06:39,668 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_8.csv
2019-08-23 12:06:39,670 - INFO - , with total : 965730 rows
2019-08-23 12:06:44,355 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_9.csv
2019-08-23 12:06:44,355 - INFO - , with total : 965730 rows
2019-08-23 12:06:49,088 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_10.csv
2019-08-23 12:06:49,088 - INFO - , with total : 965730 rows
2019-08-23 12:06:53,673 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_11.csv
2019-08-23 12:06:53,674 - INFO - , with total : 965730 rows
2019-08-23 12:06:58,200 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_12.csv
2019-08-23 12:06:58,200 - INFO - , with total : 965730 rows
2019-08-23 12:07:02,703 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Fashion Buyers_13.csv
2019-08-23 12:07:02,704 - INFO - , with total : 965729 rows
2019-08-23 12:07:04,420 - INFO - Delete all data in sheet: Case 1
2019-08-23 12:07:05,673 - INFO - No value detected on sheet: Case 2
2019-08-23 12:07:06,423 - INFO - No value detected on sheet: Case 3
2019-08-23 12:07:07,151 - INFO - No value detected on sheet: Case 4
2019-08-23 12:07:07,880 - INFO - No value detected on sheet: Case 5
2019-08-23 12:07:08,631 - INFO - Value detected - use sheet: Case 6
2019-08-23 12:07:08,631 - INFO - Reading Data From Google Sheet...
2019-08-23 12:07:08,980 - INFO - Get custom SQL..
2019-08-23 12:07:08,980 - INFO - USING CASE 6
2019-08-23 12:07:10,173 - INFO - Row 1
2019-08-23 12:07:10,174 - INFO - Filename: A30 Skincare Buyers
2019-08-23 12:07:10,174 - INFO - Sub-category: 'Skin Care'
2019-08-23 12:07:10,174 - INFO - Last Login: 30
2019-08-23 12:07:10,174 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Skin Care')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 12:07:10,176 - INFO - Start Running query A30 Skincare Buyers
2019-08-23 12:08:31,563 - INFO - Running A30 Skincare Buyers Done
2019-08-23 12:08:31,565 - INFO - CSV file path: A30 Skincare Buyers
2019-08-23 12:08:31,635 - INFO - Starting save the query results
2019-08-23 12:08:31,637 - INFO - Total Rows : 1693470
2019-08-23 12:08:31,637 - INFO - Will split into : 2.0 files
2019-08-23 12:08:35,346 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Skincare Buyers_1.csv
2019-08-23 12:08:35,348 - INFO - , with total : 846735 rows
2019-08-23 12:08:39,082 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Skincare Buyers_2.csv
2019-08-23 12:08:39,082 - INFO - , with total : 846735 rows
2019-08-23 12:08:40,654 - INFO - Row 2
2019-08-23 12:08:40,655 - INFO - Filename: A30 Dairy Food
2019-08-23 12:08:40,655 - INFO - Sub-category: 'Dairy Food'
2019-08-23 12:08:40,657 - INFO - Last Login: 30
2019-08-23 12:08:40,657 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Dairy Food')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 12:08:40,657 - INFO - Start Running query A30 Dairy Food
2019-08-23 12:09:14,808 - INFO - Running A30 Dairy Food Done
2019-08-23 12:09:14,809 - INFO - CSV file path: A30 Dairy Food
2019-08-23 12:09:14,828 - INFO - Starting save the query results
2019-08-23 12:09:14,828 - INFO - Total Rows : 510742
2019-08-23 12:09:14,828 - INFO - Will split into : 1.0 files
2019-08-23 12:09:17,082 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Dairy Food_1.csv
2019-08-23 12:09:17,082 - INFO - , with total : 510742 rows
2019-08-23 12:09:18,651 - INFO - Row 3
2019-08-23 12:09:18,653 - INFO - Filename: A30 MA Buyers
2019-08-23 12:09:18,654 - INFO - Sub-category: 'Powerbank & Batteries','Cable & Charger','Bluetooth & Headset','Casing & Covers'
2019-08-23 12:09:18,654 - INFO - Last Login: 30
2019-08-23 12:09:18,654 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Powerbank & Batteries','Cable & Charger','Bluetooth & Headset','Casing & Covers')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 12:09:18,655 - INFO - Start Running query A30 MA Buyers
2019-08-23 12:11:48,882 - INFO - Running A30 MA Buyers Done
2019-08-23 12:11:48,884 - INFO - CSV file path: A30 MA Buyers
2019-08-23 12:11:49,578 - INFO - Starting save the query results
2019-08-23 12:11:49,578 - INFO - Total Rows : 5244818
2019-08-23 12:11:49,578 - INFO - Will split into : 6.0 files
2019-08-23 12:11:53,835 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA Buyers_1.csv
2019-08-23 12:11:53,836 - INFO - , with total : 874137 rows
2019-08-23 12:11:57,950 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA Buyers_2.csv
2019-08-23 12:11:57,950 - INFO - , with total : 874137 rows
2019-08-23 12:12:02,204 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA Buyers_3.csv
2019-08-23 12:12:02,204 - INFO - , with total : 874136 rows
2019-08-23 12:12:06,551 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA Buyers_4.csv
2019-08-23 12:12:06,551 - INFO - , with total : 874136 rows
2019-08-23 12:12:10,960 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA Buyers_5.csv
2019-08-23 12:12:10,960 - INFO - , with total : 874136 rows
2019-08-23 12:12:15,135 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 MA Buyers_6.csv
2019-08-23 12:12:15,137 - INFO - , with total : 874136 rows
2019-08-23 12:12:17,177 - INFO - Row 4
2019-08-23 12:12:17,177 - INFO - Filename: A30 Automotive + HL
2019-08-23 12:12:17,177 - INFO - Sub-category: 'Automotive Care','Automotive Tools','Car','Car Exterior Accessories','Car Interior Accessories','Car Spare Parts','Motorcycle','Motorcycle Accessories','Motorcycle Rider Accessories','Motorcycle Spare parts','Oil & Lube','Others','Equipments'
2019-08-23 12:12:17,178 - INFO - Last Login: 30
2019-08-23 12:12:17,180 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Automotive Care','Automotive Tools','Car','Car Exterior Accessories','Car Interior Accessories','Car Spare Parts','Motorcycle','Motorcycle Accessories','Motorcycle Rider Accessories','Motorcycle Spare parts','Oil & Lube','Others','Equipments')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 12:12:17,180 - INFO - Start Running query A30 Automotive + HL
2019-08-23 12:15:41,579 - INFO - Running A30 Automotive + HL Done
2019-08-23 12:15:41,630 - INFO - CSV file path: A30 Automotive + HL
2019-08-23 12:15:44,167 - INFO - Starting save the query results
2019-08-23 12:15:44,201 - INFO - Total Rows : 7055215
2019-08-23 12:15:44,278 - INFO - Will split into : 8.0 files
2019-08-23 12:15:51,303 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Automotive + HL_1.csv
2019-08-23 12:15:51,326 - INFO - , with total : 881902 rows
2019-08-23 12:15:55,611 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Automotive + HL_2.csv
2019-08-23 12:15:55,611 - INFO - , with total : 881902 rows
2019-08-23 12:15:59,947 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Automotive + HL_3.csv
2019-08-23 12:15:59,950 - INFO - , with total : 881902 rows
2019-08-23 12:16:05,221 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Automotive + HL_4.csv
2019-08-23 12:16:05,223 - INFO - , with total : 881902 rows
2019-08-23 12:16:09,944 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Automotive + HL_5.csv
2019-08-23 12:16:09,946 - INFO - , with total : 881902 rows
2019-08-23 12:16:14,444 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Automotive + HL_6.csv
2019-08-23 12:16:14,444 - INFO - , with total : 881902 rows
2019-08-23 12:16:18,844 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Automotive + HL_7.csv
2019-08-23 12:16:18,845 - INFO - , with total : 881902 rows
2019-08-23 12:16:23,221 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 Automotive + HL_8.csv
2019-08-23 12:16:23,223 - INFO - , with total : 881901 rows
2019-08-23 12:16:27,529 - INFO - Row 5
2019-08-23 12:16:27,529 - INFO - Filename: A30 HL Food Storage & Mom Baby
2019-08-23 12:16:27,529 - INFO - Sub-category: 'Dining Room','Kitchen & Cookware','Baby Eating Essentials'
2019-08-23 12:16:27,530 - INFO - Last Login: 30
2019-08-23 12:16:27,530 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Dining Room','Kitchen & Cookware','Baby Eating Essentials')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 12:16:27,540 - INFO - Start Running query A30 HL Food Storage & Mom Baby
2019-08-23 12:18:33,680 - INFO - Running A30 HL Food Storage & Mom Baby Done
2019-08-23 12:18:33,680 - INFO - CSV file path: A30 HL Food Storage & Mom Baby
2019-08-23 12:18:33,825 - INFO - Starting save the query results
2019-08-23 12:18:33,826 - INFO - Total Rows : 3934257
2019-08-23 12:18:33,826 - INFO - Will split into : 4.0 files
2019-08-23 12:18:38,223 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL Food Storage & Mom Baby_1.csv
2019-08-23 12:18:38,223 - INFO - , with total : 983565 rows
2019-08-23 12:18:42,611 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL Food Storage & Mom Baby_2.csv
2019-08-23 12:18:42,612 - INFO - , with total : 983564 rows
2019-08-23 12:18:47,007 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL Food Storage & Mom Baby_3.csv
2019-08-23 12:18:47,009 - INFO - , with total : 983564 rows
2019-08-23 12:18:51,719 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL Food Storage & Mom Baby_4.csv
2019-08-23 12:18:51,720 - INFO - , with total : 983564 rows
2019-08-23 12:18:53,542 - INFO - Row 6
2019-08-23 12:18:53,542 - INFO - Filename: A30 HL & Mom Baby
2019-08-23 12:18:53,543 - INFO - Sub-category: 'Bathroom','Bedroom','Baby & Kids Toys','Baby Accessories','Baby Care','Baby Clothes','Baby Diapers','Baby Eating Essentials','Baby Food
Baby Shower Essentials','Baby Sleeping Essentials','Baby Travel Essentials','Boy Clothes','Girl Clothes','Mother Essentials','Others','Shoes & Socks'
2019-08-23 12:18:53,543 - INFO - Last Login: 30
2019-08-23 12:18:53,545 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Bathroom','Bedroom','Baby & Kids Toys','Baby Accessories','Baby Care','Baby Clothes','Baby Diapers','Baby Eating Essentials','Baby Food
Baby Shower Essentials','Baby Sleeping Essentials','Baby Travel Essentials','Boy Clothes','Girl Clothes','Mother Essentials','Others','Shoes & Socks')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 12:18:53,545 - INFO - Start Running query A30 HL & Mom Baby
2019-08-23 12:27:44,203 - INFO - Running A30 HL & Mom Baby Done
2019-08-23 12:27:45,177 - INFO - CSV file path: A30 HL & Mom Baby
2019-08-23 12:28:33,092 - INFO - Starting save the query results
2019-08-23 12:28:33,125 - INFO - Total Rows : 7942190
2019-08-23 12:28:33,135 - INFO - Will split into : 8.0 files
2019-08-23 12:28:46,430 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL & Mom Baby_1.csv
2019-08-23 12:28:46,436 - INFO - , with total : 992774 rows
2019-08-23 12:28:53,980 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL & Mom Baby_2.csv
2019-08-23 12:28:54,358 - INFO - , with total : 992774 rows
2019-08-23 12:29:01,582 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL & Mom Baby_3.csv
2019-08-23 12:29:01,582 - INFO - , with total : 992774 rows
2019-08-23 12:29:11,368 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL & Mom Baby_4.csv
2019-08-23 12:29:11,368 - INFO - , with total : 992774 rows
2019-08-23 12:29:18,174 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL & Mom Baby_5.csv
2019-08-23 12:29:18,176 - INFO - , with total : 992774 rows
2019-08-23 12:29:27,953 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL & Mom Baby_6.csv
2019-08-23 12:29:27,953 - INFO - , with total : 992774 rows
2019-08-23 12:29:35,316 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL & Mom Baby_7.csv
2019-08-23 12:29:35,348 - INFO - , with total : 992773 rows
2019-08-23 12:29:41,153 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A30 HL & Mom Baby_8.csv
2019-08-23 12:29:41,154 - INFO - , with total : 992773 rows
2019-08-23 12:29:53,618 - INFO - Delete all data in sheet: Case 6
2019-08-23 12:29:56,098 - INFO - No value detected on sheet: Case 7
2019-08-23 12:29:57,309 - INFO - Value detected - use sheet: Case 8
2019-08-23 12:29:57,312 - INFO - Reading Data From Google Sheet...
2019-08-23 12:29:57,875 - INFO - Get custom SQL..
2019-08-23 12:29:57,878 - INFO - USING CASE 8
2019-08-23 12:29:58,753 - INFO - Row 1
2019-08-23 12:29:58,755 - INFO - Filename: Official Shop Followers
2019-08-23 12:29:58,756 - INFO - Shop ID: 12802752
2019-08-23 12:29:58,756 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (12802752) 
                                and status = 1
                                
2019-08-23 12:29:58,756 - INFO - Start Running query Official Shop Followers
2019-08-23 12:30:08,188 - INFO - Running Official Shop Followers Done
2019-08-23 12:30:08,190 - INFO - CSV file path: Official Shop Followers
2019-08-23 12:30:09,019 - INFO - Starting save the query results
2019-08-23 12:30:09,020 - INFO - Total Rows : 13182
2019-08-23 12:30:09,022 - INFO - Will split into : 1.0 files
2019-08-23 12:30:10,230 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/Official Shop Followers_1.csv
2019-08-23 12:30:10,232 - INFO - , with total : 13182 rows
2019-08-23 12:30:10,931 - INFO - Delete all data in sheet: Case 8
2019-08-23 12:30:12,447 - INFO - No value detected on sheet: Case 9
2019-08-23 12:30:13,470 - INFO - Value detected - use sheet: Case 10
2019-08-23 12:30:13,471 - INFO - Reading Data From Google Sheet...
2019-08-23 12:30:14,006 - INFO - Get custom SQL..
2019-08-23 12:30:14,007 - INFO - USING CASE 10
2019-08-23 12:30:15,338 - INFO - Row 1
2019-08-23 12:30:15,339 - INFO - Filename: A1 who haven't shopped DP
2019-08-23 12:30:15,342 - INFO - Last Login: 1
2019-08-23 12:30:15,342 - INFO - Query:
                                with b as(
                                        select distinct o.user_id as userid
                                        from shopee_digital_product_order_id_db__order_tab AS o
                                    )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    where
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-23 12:30:15,345 - INFO - Start Running query A1 who haven't shopped DP
2019-08-23 12:32:50,469 - INFO - Running A1 who haven't shopped DP Done
2019-08-23 12:32:50,470 - INFO - CSV file path: A1 who haven't shopped DP
2019-08-23 12:32:50,693 - INFO - Starting save the query results
2019-08-23 12:32:50,694 - INFO - Total Rows : 6023826
2019-08-23 12:32:50,694 - INFO - Will split into : 7.0 files
2019-08-23 12:32:54,737 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A1 who haven't shopped DP_1.csv
2019-08-23 12:32:54,737 - INFO - , with total : 860547 rows
2019-08-23 12:32:58,596 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A1 who haven't shopped DP_2.csv
2019-08-23 12:32:58,598 - INFO - , with total : 860547 rows
2019-08-23 12:33:02,651 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A1 who haven't shopped DP_3.csv
2019-08-23 12:33:02,653 - INFO - , with total : 860547 rows
2019-08-23 12:33:06,619 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A1 who haven't shopped DP_4.csv
2019-08-23 12:33:06,621 - INFO - , with total : 860547 rows
2019-08-23 12:33:10,568 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A1 who haven't shopped DP_5.csv
2019-08-23 12:33:10,568 - INFO - , with total : 860546 rows
2019-08-23 12:33:16,381 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A1 who haven't shopped DP_6.csv
2019-08-23 12:33:16,381 - INFO - , with total : 860546 rows
2019-08-23 12:33:20,398 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 11.29/A1 who haven't shopped DP_7.csv
2019-08-23 12:33:20,400 - INFO - , with total : 860546 rows
2019-08-23 12:33:21,130 - INFO - Delete all data in sheet: Case 10
2019-08-23 12:33:22,418 - INFO - No value detected on sheet: Case 11
2019-08-23 12:33:23,187 - INFO - No value detected on sheet: Case 12
2019-08-23 12:33:23,960 - INFO - No value detected on sheet: Case 13
2019-08-23 12:33:24,701 - INFO - No value detected on sheet: Case 14
2019-08-23 12:33:25,457 - INFO - No value detected on sheet: Case 15
2019-08-23 12:33:26,240 - INFO - No value detected on sheet: Case 16
2019-08-23 14:37:20,542 - INFO - Report date: 20190823 14.37
2019-08-23 14:37:20,573 - INFO - Download sheet..
2019-08-23 14:37:20,575 - INFO - Change directory to script path
2019-08-23 14:37:23,141 - INFO - Spreadsheet downloaded
2019-08-23 14:37:23,141 - INFO - Checking sheet..
2019-08-23 14:37:24,575 - INFO - No value detected on sheet: Case 1
2019-08-23 14:37:25,301 - INFO - No value detected on sheet: Case 2
2019-08-23 14:37:26,036 - INFO - No value detected on sheet: Case 3
2019-08-23 14:37:26,785 - INFO - No value detected on sheet: Case 4
2019-08-23 14:37:27,512 - INFO - No value detected on sheet: Case 5
2019-08-23 14:37:28,256 - INFO - No value detected on sheet: Case 6
2019-08-23 14:37:29,033 - INFO - No value detected on sheet: Case 7
2019-08-23 14:37:29,831 - INFO - No value detected on sheet: Case 8
2019-08-23 14:37:30,637 - INFO - No value detected on sheet: Case 9
2019-08-23 14:37:31,430 - INFO - No value detected on sheet: Case 10
2019-08-23 14:37:32,278 - INFO - No value detected on sheet: Case 11
2019-08-23 14:37:33,081 - INFO - No value detected on sheet: Case 12
2019-08-23 14:37:33,839 - INFO - No value detected on sheet: Case 13
2019-08-23 14:37:34,608 - INFO - No value detected on sheet: Case 14
2019-08-23 14:37:35,375 - INFO - No value detected on sheet: Case 15
2019-08-23 14:37:36,200 - INFO - No value detected on sheet: Case 16
2019-08-23 17:07:30,947 - INFO - Report date: 20190823 17.07
2019-08-23 17:07:30,996 - INFO - Deleting old directory: G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190818 17.00
2019-08-23 17:07:31,016 - INFO - Delete success
2019-08-23 17:07:31,016 - INFO - Deleting old directory: G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190818 14.00
2019-08-23 17:07:31,026 - INFO - Delete success
2019-08-23 17:07:31,026 - INFO - Deleting old directory: G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190818 10.00
2019-08-23 17:07:31,039 - INFO - Delete success
2019-08-23 17:07:31,039 - INFO - ----------------------------------
2019-08-23 17:07:31,040 - INFO - Download sheet..
2019-08-23 17:07:31,040 - INFO - Change directory to script path
2019-08-23 17:07:33,328 - INFO - Spreadsheet downloaded
2019-08-23 17:07:33,329 - INFO - Opening PN Input.xlsx..
2019-08-23 17:07:33,717 - INFO - Value detected - use sheet: Case 1
2019-08-23 17:07:33,719 - INFO - Reading Data From Excel...
2019-08-23 17:07:33,720 - INFO - ===================================
2019-08-23 17:07:33,720 - INFO - Get custom SQL..
2019-08-23 17:07:33,720 - INFO - USING CASE 1
2019-08-23 17:07:33,721 - INFO - ----------------------------------
2019-08-23 17:07:33,721 - INFO - Row 1
2019-08-23 17:07:33,723 - INFO - Filename: A30 Fashion or Beauty Buyers
2019-08-23 17:07:33,723 - INFO - Category: 'Fashion','Beauty'
2019-08-23 17:07:33,723 - INFO - Last Login: 30
2019-08-23 17:07:33,724 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 17:07:33,726 - INFO - ----------------------------------
2019-08-23 17:07:33,726 - INFO - Start Running query A30 Fashion or Beauty Buyers
2019-08-23 17:10:33,604 - INFO - Report date: 20190823 17.10
2019-08-23 17:10:38,132 - INFO - ----------------------------------
2019-08-23 17:10:38,134 - INFO - Download sheet..
2019-08-23 17:10:38,135 - INFO - Change directory to script path
2019-08-23 17:10:39,308 - INFO - Spreadsheet downloaded
2019-08-23 17:10:39,308 - INFO - Opening PN Input.xlsx..
2019-08-23 17:10:39,522 - INFO - Value detected - use sheet: Case 1
2019-08-23 17:10:39,522 - INFO - Reading Data From Excel...
2019-08-23 17:10:39,523 - INFO - ===================================
2019-08-23 17:10:39,523 - INFO - Get custom SQL..
2019-08-23 17:10:39,523 - INFO - USING CASE 1
2019-08-23 17:10:39,523 - INFO - ----------------------------------
2019-08-23 17:10:39,523 - INFO - Row 1
2019-08-23 17:10:39,523 - INFO - Filename: A30 Fashion or Beauty Buyers
2019-08-23 17:10:39,523 - INFO - Category: 'Fashion','Beauty'
2019-08-23 17:10:39,523 - INFO - Last Login: 30
2019-08-23 17:10:39,525 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-23 17:10:39,525 - INFO - ----------------------------------
2019-08-23 17:10:39,525 - INFO - Start Running query A30 Fashion or Beauty Buyers
2019-08-23 17:17:41,036 - INFO - Running A30 Fashion or Beauty Buyers Done
2019-08-23 17:17:41,038 - INFO - CSV file path: A30 Fashion or Beauty Buyers
2019-08-23 17:17:41,313 - INFO - Starting save the query results
2019-08-23 17:17:41,315 - INFO - Total Rows: 7567841
2019-08-23 17:17:41,315 - INFO - Will split into : 8.0 files
2019-08-23 17:17:45,559 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Fashion or Beauty Buyers_1.csv
2019-08-23 17:17:45,561 - INFO - , with total : 945981 rows
2019-08-23 17:17:49,622 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Fashion or Beauty Buyers_2.csv
2019-08-23 17:17:49,622 - INFO - , with total : 945980 rows
2019-08-23 17:17:53,812 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Fashion or Beauty Buyers_3.csv
2019-08-23 17:17:53,812 - INFO - , with total : 945980 rows
2019-08-23 17:17:58,104 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Fashion or Beauty Buyers_4.csv
2019-08-23 17:17:58,105 - INFO - , with total : 945980 rows
2019-08-23 17:18:02,372 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Fashion or Beauty Buyers_5.csv
2019-08-23 17:18:02,374 - INFO - , with total : 945980 rows
2019-08-23 17:18:06,615 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Fashion or Beauty Buyers_6.csv
2019-08-23 17:18:06,617 - INFO - , with total : 945980 rows
2019-08-23 17:18:10,890 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Fashion or Beauty Buyers_7.csv
2019-08-23 17:18:10,891 - INFO - , with total : 945980 rows
2019-08-23 17:18:15,267 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Fashion or Beauty Buyers_8.csv
2019-08-23 17:18:15,269 - INFO - , with total : 945980 rows
2019-08-23 17:18:16,437 - INFO - ----------------------------------
2019-08-23 17:18:16,438 - INFO - Delete all data in sheet: Case 1
2019-08-23 17:18:16,989 - INFO - No value detected on sheet: Case 2
2019-08-23 17:18:16,990 - INFO - No value detected on sheet: Case 3
2019-08-23 17:18:16,990 - INFO - No value detected on sheet: Case 4
2019-08-23 17:18:16,990 - INFO - Value detected - use sheet: Case 5
2019-08-23 17:18:16,992 - INFO - Reading Data From Excel...
2019-08-23 17:18:16,992 - INFO - ===================================
2019-08-23 17:18:16,993 - INFO - Get custom SQL..
2019-08-23 17:18:16,993 - INFO - USING CASE 5
2019-08-23 17:18:16,993 - INFO - ----------------------------------
2019-08-23 17:18:16,993 - INFO - Row 1
2019-08-23 17:18:16,993 - INFO - Filename: A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics
2019-08-23 17:18:16,993 - INFO - Category: 'Women Bags','Women Clothes','Women Shoes'
2019-08-23 17:18:16,993 - INFO - Last Login: 30
2019-08-23 17:18:16,993 - INFO - Sub-category(Haven't shopped): 'Beauty','Cosmetics'
2019-08-23 17:18:16,994 - INFO - Query:
                                with a as (
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Bags','Women Clothes','Women Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped certain category
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where 
                                sub_category in ('Beauty','Cosmetics')
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-23 17:18:16,994 - INFO - ----------------------------------
2019-08-23 17:18:16,996 - INFO - Start Running query A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics
2019-08-23 17:22:19,483 - INFO - Running A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics Done
2019-08-23 17:22:19,484 - INFO - CSV file path: A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics
2019-08-23 17:22:19,785 - INFO - Starting save the query results
2019-08-23 17:22:19,786 - INFO - Total Rows: 8422876
2019-08-23 17:22:19,786 - INFO - Will split into : 9.0 files
2019-08-23 17:22:23,986 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_1.csv
2019-08-23 17:22:23,987 - INFO - , with total : 935876 rows
2019-08-23 17:22:28,022 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_2.csv
2019-08-23 17:22:28,023 - INFO - , with total : 935875 rows
2019-08-23 17:22:32,176 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_3.csv
2019-08-23 17:22:32,177 - INFO - , with total : 935875 rows
2019-08-23 17:22:36,387 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_4.csv
2019-08-23 17:22:36,388 - INFO - , with total : 935875 rows
2019-08-23 17:22:40,553 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_5.csv
2019-08-23 17:22:40,555 - INFO - , with total : 935875 rows
2019-08-23 17:22:45,048 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_6.csv
2019-08-23 17:22:45,049 - INFO - , with total : 935875 rows
2019-08-23 17:22:49,177 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_7.csv
2019-08-23 17:22:49,178 - INFO - , with total : 935875 rows
2019-08-23 17:22:53,394 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_8.csv
2019-08-23 17:22:53,394 - INFO - , with total : 935875 rows
2019-08-23 17:22:57,713 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_9.csv
2019-08-23 17:22:57,713 - INFO - , with total : 935875 rows
2019-08-23 17:22:58,128 - INFO - ----------------------------------
2019-08-23 17:22:58,130 - INFO - Row 2
2019-08-23 17:22:58,130 - INFO - Filename: A30 Beauty buyers who haven't shopped Fashion
2019-08-23 17:22:58,131 - INFO - Category: 'Beauty'
2019-08-23 17:22:58,131 - INFO - Last Login: 30
2019-08-23 17:22:58,131 - INFO - Sub-category(Haven't shopped): 'Watches','Women Bags','Women Clothes','Women Shoes'
2019-08-23 17:22:58,131 - INFO - Query:
                                with a as (
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped certain category
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where 
                                sub_category in ('Watches','Women Bags','Women Clothes','Women Shoes')
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-23 17:22:58,132 - INFO - ----------------------------------
2019-08-23 17:22:58,132 - INFO - Start Running query A30 Beauty buyers who haven't shopped Fashion
2019-08-23 17:27:01,676 - INFO - Running A30 Beauty buyers who haven't shopped Fashion Done
2019-08-23 17:27:01,677 - INFO - CSV file path: A30 Beauty buyers who haven't shopped Fashion
2019-08-23 17:27:01,950 - INFO - Starting save the query results
2019-08-23 17:27:01,950 - INFO - Total Rows: 7567841
2019-08-23 17:27:01,950 - INFO - Will split into : 8.0 files
2019-08-23 17:27:06,155 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Beauty buyers who haven't shopped Fashion_1.csv
2019-08-23 17:27:06,157 - INFO - , with total : 945981 rows
2019-08-23 17:27:10,240 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Beauty buyers who haven't shopped Fashion_2.csv
2019-08-23 17:27:10,240 - INFO - , with total : 945980 rows
2019-08-23 17:27:14,459 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Beauty buyers who haven't shopped Fashion_3.csv
2019-08-23 17:27:14,460 - INFO - , with total : 945980 rows
2019-08-23 17:27:18,732 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Beauty buyers who haven't shopped Fashion_4.csv
2019-08-23 17:27:18,733 - INFO - , with total : 945980 rows
2019-08-23 17:27:22,990 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Beauty buyers who haven't shopped Fashion_5.csv
2019-08-23 17:27:22,992 - INFO - , with total : 945980 rows
2019-08-23 17:27:27,901 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Beauty buyers who haven't shopped Fashion_6.csv
2019-08-23 17:27:27,901 - INFO - , with total : 945980 rows
2019-08-23 17:27:32,187 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Beauty buyers who haven't shopped Fashion_7.csv
2019-08-23 17:27:32,188 - INFO - , with total : 945980 rows
2019-08-23 17:27:36,463 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 17.10/A30 Beauty buyers who haven't shopped Fashion_8.csv
2019-08-23 17:27:36,463 - INFO - , with total : 945980 rows
2019-08-23 17:27:37,342 - INFO - ----------------------------------
2019-08-23 17:27:37,342 - INFO - Delete all data in sheet: Case 5
2019-08-23 17:27:37,796 - INFO - No value detected on sheet: Case 6
2019-08-23 17:27:37,796 - INFO - No value detected on sheet: Case 7
2019-08-23 17:27:37,796 - INFO - No value detected on sheet: Case 8
2019-08-23 17:27:37,796 - INFO - No value detected on sheet: Case 9
2019-08-23 17:27:37,798 - INFO - No value detected on sheet: Case 10
2019-08-23 17:27:37,798 - INFO - No value detected on sheet: Case 11
2019-08-23 17:27:37,798 - INFO - No value detected on sheet: Case 12
2019-08-23 17:27:37,798 - INFO - No value detected on sheet: Case 13
2019-08-23 17:27:37,799 - INFO - No value detected on sheet: Case 14
2019-08-23 17:27:37,799 - INFO - No value detected on sheet: Case 15
2019-08-23 17:27:37,799 - INFO - No value detected on sheet: Case 16
2019-08-23 17:27:37,799 - INFO - No value detected on sheet: Case 17
2019-08-23 17:27:37,799 - INFO - No value detected on sheet: Case 18
2019-08-23 18:34:23,914 - INFO - Report date: 20190823 18.34
2019-08-23 18:34:23,946 - INFO - ----------------------------------
2019-08-23 18:34:23,946 - INFO - Download sheet..
2019-08-23 18:34:23,947 - INFO - Change directory to script path
2019-08-23 18:34:26,134 - INFO - Spreadsheet downloaded
2019-08-23 18:34:26,137 - INFO - Opening PN Input.xlsx..
2019-08-23 18:34:26,815 - INFO - No value detected on sheet: Case 1
2019-08-23 18:34:26,815 - INFO - No value detected on sheet: Case 2
2019-08-23 18:34:26,815 - INFO - No value detected on sheet: Case 3
2019-08-23 18:34:26,815 - INFO - Value detected - use sheet: Case 4
2019-08-23 18:34:26,816 - INFO - Reading Data From Excel...
2019-08-23 18:34:26,818 - INFO - ===================================
2019-08-23 18:34:26,818 - INFO - Get custom SQL..
2019-08-23 18:34:26,819 - INFO - USING CASE 4
2019-08-23 18:34:26,819 - INFO - ----------------------------------
2019-08-23 18:34:26,821 - INFO - Row 1
2019-08-23 18:34:26,822 - INFO - Filename: A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics
2019-08-23 18:34:26,822 - INFO - Category: 'Women Bags','Women Clothes','Women Shoes'
2019-08-23 18:34:26,823 - INFO - Last Login: 30
2019-08-23 18:34:26,825 - INFO - Category(Haven't shopped): 'Beauty','Cosmetics'
2019-08-23 18:34:26,826 - INFO - Query:
                                with a as (
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Bags','Women Clothes','Women Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped certain category
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where 
                                main_category in ('Beauty','Cosmetics')
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-23 18:34:26,828 - INFO - ----------------------------------
2019-08-23 18:34:26,829 - INFO - Start Running query A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics
2019-08-23 18:37:34,624 - INFO - Running A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics Done
2019-08-23 18:37:34,625 - INFO - CSV file path: A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics
2019-08-23 18:37:35,275 - INFO - Starting save the query results
2019-08-23 18:37:35,276 - INFO - Total Rows: 3220194
2019-08-23 18:37:35,279 - INFO - Will split into : 4.0 files
2019-08-23 18:37:44,946 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 18.34/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_1.csv
2019-08-23 18:37:44,947 - INFO - , with total : 805049 rows
2019-08-23 18:37:53,117 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 18.34/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_2.csv
2019-08-23 18:37:53,119 - INFO - , with total : 805049 rows
2019-08-23 18:38:01,569 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 18.34/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_3.csv
2019-08-23 18:38:01,572 - INFO - , with total : 805048 rows
2019-08-23 18:38:09,276 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 18.34/A30 Women Clothing, Women Shoes, Women Bags who haven't shopped Beauty & Cosmetics_4.csv
2019-08-23 18:38:09,282 - INFO - , with total : 805048 rows
2019-08-23 18:38:09,510 - INFO - ----------------------------------
2019-08-23 18:38:09,512 - INFO - Row 2
2019-08-23 18:38:09,512 - INFO - Filename: A30 Beauty buyers who haven't shopped Fashion
2019-08-23 18:38:09,513 - INFO - Category: 'Beauty'
2019-08-23 18:38:09,513 - INFO - Last Login: 30
2019-08-23 18:38:09,515 - INFO - Category(Haven't shopped): 'Watches','Women Bags','Women Clothes','Women Shoes'
2019-08-23 18:38:09,515 - INFO - Query:
                                with a as (
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped certain category
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where 
                                main_category in ('Watches','Women Bags','Women Clothes','Women Shoes')
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-23 18:38:09,516 - INFO - ----------------------------------
2019-08-23 18:38:09,517 - INFO - Start Running query A30 Beauty buyers who haven't shopped Fashion
2019-08-23 18:39:01,549 - INFO - Running A30 Beauty buyers who haven't shopped Fashion Done
2019-08-23 18:39:01,549 - INFO - CSV file path: A30 Beauty buyers who haven't shopped Fashion
2019-08-23 18:39:01,663 - INFO - Starting save the query results
2019-08-23 18:39:01,664 - INFO - Total Rows: 1524331
2019-08-23 18:39:01,664 - INFO - Will split into : 2.0 files
2019-08-23 18:39:05,367 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 18.34/A30 Beauty buyers who haven't shopped Fashion_1.csv
2019-08-23 18:39:05,368 - INFO - , with total : 762166 rows
2019-08-23 18:39:09,092 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 18.34/A30 Beauty buyers who haven't shopped Fashion_2.csv
2019-08-23 18:39:09,092 - INFO - , with total : 762165 rows
2019-08-23 18:39:11,237 - INFO - ----------------------------------
2019-08-23 18:39:11,240 - INFO - Delete all data in sheet: Case 4
2019-08-23 18:39:11,763 - INFO - No value detected on sheet: Case 5
2019-08-23 18:39:11,766 - INFO - No value detected on sheet: Case 6
2019-08-23 18:39:11,767 - INFO - No value detected on sheet: Case 7
2019-08-23 18:39:11,769 - INFO - No value detected on sheet: Case 8
2019-08-23 18:39:11,769 - INFO - No value detected on sheet: Case 9
2019-08-23 18:39:11,772 - INFO - Value detected - use sheet: Case 10
2019-08-23 18:39:11,773 - INFO - Reading Data From Excel...
2019-08-23 18:39:11,776 - INFO - ===================================
2019-08-23 18:39:11,778 - INFO - Get custom SQL..
2019-08-23 18:39:11,779 - INFO - USING CASE 10
2019-08-23 18:39:11,779 - INFO - ----------------------------------
2019-08-23 18:39:11,780 - INFO - Row 1
2019-08-23 18:39:11,782 - INFO - Filename: L'Oreal Followers
2019-08-23 18:39:11,782 - INFO - Shop ID: 62579622.0
2019-08-23 18:39:11,783 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (62579622.0) 
                                and status = 1
                                
2019-08-23 18:39:11,786 - INFO - ----------------------------------
2019-08-23 18:39:11,786 - INFO - Start Running query L'Oreal Followers
2019-08-23 18:39:18,674 - INFO - Running L'Oreal Followers Done
2019-08-23 18:39:18,676 - INFO - CSV file path: L'Oreal Followers
2019-08-23 18:39:18,697 - INFO - Starting save the query results
2019-08-23 18:39:18,697 - INFO - Total Rows: 214012
2019-08-23 18:39:18,700 - INFO - Will split into : 1.0 files
2019-08-23 18:39:19,823 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 18.34/L'Oreal Followers_1.csv
2019-08-23 18:39:19,825 - INFO - , with total : 214012 rows
2019-08-23 18:39:20,209 - INFO - ----------------------------------
2019-08-23 18:39:20,213 - INFO - Delete all data in sheet: Case 10
2019-08-23 18:39:20,665 - INFO - No value detected on sheet: Case 11
2019-08-23 18:39:20,667 - INFO - No value detected on sheet: Case 12
2019-08-23 18:39:20,670 - INFO - No value detected on sheet: Case 13
2019-08-23 18:39:20,671 - INFO - No value detected on sheet: Case 14
2019-08-23 18:39:20,673 - INFO - No value detected on sheet: Case 15
2019-08-23 18:39:20,680 - INFO - No value detected on sheet: Case 16
2019-08-23 18:39:20,683 - INFO - No value detected on sheet: Case 17
2019-08-23 18:39:20,684 - INFO - No value detected on sheet: Case 18
2019-08-23 18:49:59,196 - INFO - Report date: 20190823 18.49
2019-08-23 18:49:59,224 - INFO - ----------------------------------
2019-08-23 18:49:59,226 - INFO - Download sheet..
2019-08-23 18:49:59,226 - INFO - Change directory to script path
2019-08-23 18:50:01,076 - INFO - Spreadsheet downloaded
2019-08-23 18:50:01,079 - INFO - Opening PN Input.xlsx..
2019-08-23 18:50:01,723 - INFO - No value detected on sheet: Case 1
2019-08-23 18:50:01,723 - INFO - No value detected on sheet: Case 2
2019-08-23 18:50:01,723 - INFO - No value detected on sheet: Case 3
2019-08-23 18:50:01,723 - INFO - No value detected on sheet: Case 4
2019-08-23 18:50:01,724 - INFO - No value detected on sheet: Case 5
2019-08-23 18:50:01,726 - INFO - No value detected on sheet: Case 6
2019-08-23 18:50:01,726 - INFO - No value detected on sheet: Case 7
2019-08-23 18:50:01,726 - INFO - No value detected on sheet: Case 8
2019-08-23 18:50:01,726 - INFO - No value detected on sheet: Case 9
2019-08-23 18:50:01,727 - INFO - Value detected - use sheet: Case 10
2019-08-23 18:50:01,729 - INFO - Reading Data From Excel...
2019-08-23 18:50:01,729 - INFO - ===================================
2019-08-23 18:50:01,730 - INFO - Get custom SQL..
2019-08-23 18:50:01,730 - INFO - USING CASE 10
2019-08-23 18:50:01,730 - INFO - ----------------------------------
2019-08-23 18:50:01,733 - INFO - Row 1
2019-08-23 18:50:01,733 - INFO - Filename: L'Oreal Followers
2019-08-23 18:50:01,736 - INFO - Shop ID: 62579622
2019-08-23 18:50:01,736 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (62579622) 
                                and status = 1
                                
2019-08-23 18:50:01,736 - INFO - ----------------------------------
2019-08-23 18:50:01,737 - INFO - Start Running query L'Oreal Followers
2019-08-23 18:50:12,555 - INFO - Running L'Oreal Followers Done
2019-08-23 18:50:12,556 - INFO - CSV file path: L'Oreal Followers
2019-08-23 18:50:12,575 - INFO - Starting save the query results
2019-08-23 18:50:12,575 - INFO - Total Rows: 214012
2019-08-23 18:50:12,576 - INFO - Will split into : 1.0 files
2019-08-23 18:50:13,997 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190823 18.49/L'Oreal Followers_1.csv
2019-08-23 18:50:13,999 - INFO - , with total : 214012 rows
2019-08-23 18:50:15,025 - INFO - ----------------------------------
2019-08-23 18:50:15,026 - INFO - Delete all data in sheet: Case 10
2019-08-23 18:50:15,502 - INFO - No value detected on sheet: Case 11
2019-08-23 18:50:15,519 - INFO - No value detected on sheet: Case 12
2019-08-23 18:50:15,523 - INFO - No value detected on sheet: Case 13
2019-08-23 18:50:15,526 - INFO - No value detected on sheet: Case 14
2019-08-23 18:50:15,535 - INFO - No value detected on sheet: Case 15
2019-08-23 18:50:15,542 - INFO - No value detected on sheet: Case 16
2019-08-23 18:50:15,549 - INFO - No value detected on sheet: Case 17
2019-08-23 18:50:15,552 - INFO - No value detected on sheet: Case 18
2019-08-26 10:02:02,437 - INFO - Report date: 20190826 10.02
2019-08-26 10:02:07,194 - INFO - ----------------------------------
2019-08-26 10:02:07,194 - INFO - Download sheet..
2019-08-26 10:02:07,194 - INFO - Change directory to script path
2019-08-26 10:02:08,589 - INFO - Spreadsheet downloaded
2019-08-26 10:02:08,594 - INFO - Opening PN Input.xlsx..
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 1
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 2
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 3
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 4
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 5
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 6
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 7
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 8
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 9
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 10
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 11
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 12
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 13
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 14
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 15
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 16
2019-08-26 10:02:10,635 - INFO - No value detected on sheet: Case 17
2019-08-26 10:02:10,635 - INFO - Value detected - use sheet: Case 18
2019-08-26 10:02:10,635 - INFO - Reading Data From Excel...
2019-08-26 10:02:10,635 - INFO - ===================================
2019-08-26 10:02:10,635 - INFO - Get custom SQL..
2019-08-26 10:02:10,651 - INFO - USING CASE 18
2019-08-26 10:02:10,651 - INFO - ----------------------------------
2019-08-26 10:02:10,651 - INFO - Row 1
2019-08-26 10:02:10,651 - INFO - Filename: Shopee Lucky Prize 26 Aug
2019-08-26 10:02:10,651 - INFO - Date 1: 2019-08-02
2019-08-26 10:02:10,651 - INFO - Date 2: 2019-08-24
2019-08-26 10:02:10,651 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(dp.user_id as varchar)) as list_userid
                                from shopee_id_mk_team__daily_prize_vfive as dp
                                left join user_profile as u 
                                on u.userid = cast(dp.user_id as int)
                                where date(date_parse(cast(dp.datte as varchar), '%Y-%m-%d %H:%i:%s')) >= date('2019-08-02')
                                and date(date_parse(cast(dp.datte as varchar), '%Y-%m-%d %H:%i:%s')) <= date('2019-08-24')                                
                                
2019-08-26 10:02:10,651 - INFO - ----------------------------------
2019-08-26 10:02:10,651 - INFO - Start Running query Shopee Lucky Prize 26 Aug
2019-08-26 10:52:17,311 - INFO - Running Shopee Lucky Prize 26 Aug Done
2019-08-26 10:52:17,311 - INFO - CSV file path: Shopee Lucky Prize 26 Aug
2019-08-26 10:52:17,374 - INFO - Starting save the query results
2019-08-26 10:52:17,374 - INFO - Total Rows: 1803877
2019-08-26 10:52:17,374 - INFO - Will split into : 2.0 files
2019-08-26 10:52:21,398 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 10.02/Shopee Lucky Prize 26 Aug_1.csv
2019-08-26 10:52:21,398 - INFO - , with total : 901939 rows
2019-08-26 10:52:25,367 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 10.02/Shopee Lucky Prize 26 Aug_2.csv
2019-08-26 10:52:25,367 - INFO - , with total : 901938 rows
2019-08-26 10:52:26,306 - INFO - ----------------------------------
2019-08-26 10:52:26,306 - INFO - Delete all data in sheet: Case 18
2019-08-26 11:48:06,361 - INFO - Report date: 20190826 11.48
2019-08-26 11:48:06,417 - INFO - ----------------------------------
2019-08-26 11:48:06,417 - INFO - Download sheet..
2019-08-26 11:48:06,418 - INFO - Change directory to script path
2019-08-26 11:48:08,523 - INFO - Spreadsheet downloaded
2019-08-26 11:48:08,523 - INFO - Opening PN Input.xlsx..
2019-08-26 11:48:09,132 - INFO - Value detected - use sheet: Case 1
2019-08-26 11:48:09,132 - INFO - Reading Data From Excel...
2019-08-26 11:48:09,134 - INFO - ===================================
2019-08-26 11:48:09,134 - INFO - Get custom SQL..
2019-08-26 11:48:09,134 - INFO - USING CASE 1
2019-08-26 11:48:09,135 - INFO - ----------------------------------
2019-08-26 11:48:09,137 - INFO - Row 1
2019-08-26 11:48:09,138 - INFO - Filename: A30 Fashion Buyers
2019-08-26 11:48:09,138 - INFO - Category: 'Fashion'
2019-08-26 11:48:09,140 - INFO - Last Login: 30
2019-08-26 11:48:09,140 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-26 11:48:09,142 - INFO - ----------------------------------
2019-08-26 11:48:09,144 - INFO - Start Running query A30 Fashion Buyers
2019-08-26 14:09:34,671 - INFO - Report date: 20190826 14.09
2019-08-26 14:09:34,710 - INFO - ----------------------------------
2019-08-26 14:09:34,710 - INFO - Download sheet..
2019-08-26 14:09:34,710 - INFO - Change directory to script path
2019-08-26 14:09:37,299 - INFO - Spreadsheet downloaded
2019-08-26 14:09:37,302 - INFO - Opening PN Input.xlsx..
2019-08-26 14:09:38,010 - INFO - Value detected - use sheet: Case 1
2019-08-26 14:09:38,010 - INFO - Reading Data From Excel...
2019-08-26 14:09:38,012 - INFO - ===================================
2019-08-26 14:09:38,013 - INFO - Get custom SQL..
2019-08-26 14:09:38,013 - INFO - USING CASE 1
2019-08-26 14:09:38,015 - INFO - ----------------------------------
2019-08-26 14:09:38,015 - INFO - Row 1
2019-08-26 14:09:38,016 - INFO - Filename: A30 Fashion Buyers
2019-08-26 14:09:38,016 - INFO - Category: 'Fashion'
2019-08-26 14:09:38,017 - INFO - Last Login: 30
2019-08-26 14:09:38,019 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-26 14:09:38,019 - INFO - ----------------------------------
2019-08-26 14:09:38,020 - INFO - Start Running query A30 Fashion Buyers
2019-08-26 14:09:41,335 - INFO - java.sql.SQLException: Query failed (#20190826_070940_19452_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:09:41,483 - INFO - java.sql.SQLException: Query failed (#20190826_070941_19453_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:09:41,867 - INFO - java.sql.SQLException: Query failed (#20190826_070941_19454_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:09:41,967 - INFO - java.sql.SQLException: Query failed (#20190826_070941_19455_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:09:42,099 - INFO - java.sql.SQLException: Query failed (#20190826_070941_19456_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:09:51,687 - INFO - Error in run_csv_sql -> 'NoneType' object has no attribute 'getMetaData'
2019-08-26 14:09:51,690 - INFO - Start sending...
2019-08-26 14:10:03,089 - INFO - Notification sent successfully
2019-08-26 14:10:03,092 - INFO - ----------------------------------
2019-08-26 14:10:03,094 - INFO - Row 2
2019-08-26 14:10:03,095 - INFO - Filename: A30 MA buyers
2019-08-26 14:10:03,098 - INFO - Category: 'Mobile & Tablet'
2019-08-26 14:10:03,101 - INFO - Last Login: 30
2019-08-26 14:10:03,102 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Tablet')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-26 14:10:03,108 - INFO - ----------------------------------
2019-08-26 14:10:03,109 - INFO - Start Running query A30 MA buyers
2019-08-26 14:10:03,696 - INFO - java.sql.SQLException: Query failed (#20190826_071003_19469_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:10:03,825 - INFO - java.sql.SQLException: Query failed (#20190826_071003_19474_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:10:03,960 - INFO - java.sql.SQLException: Query failed (#20190826_071003_19475_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:10:04,936 - INFO - java.sql.SQLException: Query failed (#20190826_071003_19476_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:10:05,065 - INFO - java.sql.SQLException: Query failed (#20190826_071004_19477_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:10:05,068 - INFO - Error in run_csv_sql -> 'NoneType' object has no attribute 'getMetaData'
2019-08-26 14:10:05,069 - INFO - Start sending...
2019-08-26 14:10:15,696 - INFO - Notification sent successfully
2019-08-26 14:10:17,108 - INFO - ----------------------------------
2019-08-26 14:10:17,111 - INFO - Delete all data in sheet: Case 1
2019-08-26 14:10:17,897 - INFO - No value detected on sheet: Case 2
2019-08-26 14:10:17,900 - INFO - No value detected on sheet: Case 3
2019-08-26 14:10:17,901 - INFO - No value detected on sheet: Case 4
2019-08-26 14:10:17,904 - INFO - No value detected on sheet: Case 5
2019-08-26 14:10:17,905 - INFO - No value detected on sheet: Case 6
2019-08-26 14:10:17,911 - INFO - No value detected on sheet: Case 7
2019-08-26 14:10:17,914 - INFO - Value detected - use sheet: Case 8
2019-08-26 14:10:17,915 - INFO - Reading Data From Excel...
2019-08-26 14:10:17,917 - INFO - ===================================
2019-08-26 14:10:17,920 - INFO - Get custom SQL..
2019-08-26 14:10:17,924 - INFO - USING CASE 8
2019-08-26 14:10:17,927 - INFO - ----------------------------------
2019-08-26 14:10:17,928 - INFO - Row 1
2019-08-26 14:10:17,930 - INFO - Filename: A30 Beauty Buyers
2019-08-26 14:10:17,934 - INFO - Sub-category: 'Beauty'
2019-08-26 14:10:17,937 - INFO - Last Login: 30
2019-08-26 14:10:17,940 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-26 14:10:17,944 - INFO - ----------------------------------
2019-08-26 14:10:17,951 - INFO - Start Running query A30 Beauty Buyers
2019-08-26 14:10:18,071 - INFO - java.sql.SQLException: Query failed (#20190826_071017_19501_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:13:47,986 - INFO - Report date: 20190826 14.13
2019-08-26 14:13:48,022 - INFO - ----------------------------------
2019-08-26 14:13:48,023 - INFO - Download sheet..
2019-08-26 14:13:48,026 - INFO - Change directory to script path
2019-08-26 14:13:50,323 - INFO - Spreadsheet downloaded
2019-08-26 14:13:50,325 - INFO - Opening PN Input.xlsx..
2019-08-26 14:13:51,259 - INFO - Value detected - use sheet: Case 1
2019-08-26 14:13:51,259 - INFO - Reading Data From Excel...
2019-08-26 14:13:51,259 - INFO - ===================================
2019-08-26 14:13:51,259 - INFO - Get custom SQL..
2019-08-26 14:13:51,259 - INFO - USING CASE 1
2019-08-26 14:13:51,260 - INFO - ----------------------------------
2019-08-26 14:13:51,262 - INFO - Row 1
2019-08-26 14:13:51,262 - INFO - Filename: A30 Fashion Buyers
2019-08-26 14:13:51,263 - INFO - Category: 'Fashion'
2019-08-26 14:13:51,263 - INFO - Last Login: 30
2019-08-26 14:13:51,263 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-26 14:13:51,265 - INFO - ----------------------------------
2019-08-26 14:13:51,266 - INFO - Start Running query A30 Fashion Buyers
2019-08-26 14:13:57,180 - INFO - java.sql.SQLException: Query failed (#20190826_071356_19675_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:13:57,381 - INFO - java.sql.SQLException: Query failed (#20190826_071357_19680_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:13:57,769 - INFO - java.sql.SQLException: Query failed (#20190826_071357_19683_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:13:58,822 - INFO - java.sql.SQLException: Query failed (#20190826_071357_19685_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:13:58,987 - INFO - java.sql.SQLException: Query failed (#20190826_071358_19686_wvjfi): Too many queued queries for "global.jdbc"
2019-08-26 14:13:58,992 - INFO - Error in run_csv_sql -> 'NoneType' object has no attribute 'getMetaData'
2019-08-26 14:13:58,993 - INFO - Start sending...
2019-08-26 14:14:08,678 - INFO - Notification sent successfully
2019-08-26 14:14:08,681 - INFO - ----------------------------------
2019-08-26 14:14:08,687 - INFO - Row 2
2019-08-26 14:14:08,694 - INFO - Filename: A30 Beauty Buyers
2019-08-26 14:14:08,700 - INFO - Category: 'Beauty'
2019-08-26 14:14:08,706 - INFO - Last Login: 30
2019-08-26 14:14:08,710 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-26 14:14:08,713 - INFO - ----------------------------------
2019-08-26 14:14:08,717 - INFO - Start Running query A30 Beauty Buyers
2019-08-26 15:38:26,582 - INFO - Report date: 20190826 15.38
2019-08-26 15:38:26,619 - INFO - ----------------------------------
2019-08-26 15:38:26,619 - INFO - Download sheet..
2019-08-26 15:38:26,621 - INFO - Change directory to script path
2019-08-26 15:38:29,187 - INFO - Spreadsheet downloaded
2019-08-26 15:38:29,190 - INFO - Opening PN Input.xlsx..
2019-08-26 15:38:29,941 - INFO - Value detected - use sheet: Case 1
2019-08-26 15:38:29,943 - INFO - Reading Data From Excel...
2019-08-26 15:38:29,943 - INFO - ===================================
2019-08-26 15:38:29,944 - INFO - Get custom SQL..
2019-08-26 15:38:29,944 - INFO - USING CASE 1
2019-08-26 15:38:29,946 - INFO - ----------------------------------
2019-08-26 15:38:29,946 - INFO - Row 1
2019-08-26 15:38:29,947 - INFO - Filename: A30 Fashion Buyers
2019-08-26 15:38:29,947 - INFO - Category: 'Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes'
2019-08-26 15:38:29,947 - INFO - Last Login: 30
2019-08-26 15:38:29,948 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-26 15:38:29,950 - INFO - ----------------------------------
2019-08-26 15:38:29,950 - INFO - Start Running query A30 Fashion Buyers
2019-08-26 16:15:53,303 - INFO - Running A30 Fashion Buyers Done
2019-08-26 16:15:53,305 - INFO - CSV file path: A30 Fashion Buyers
2019-08-26 16:15:55,542 - INFO - Starting save the query results
2019-08-26 16:15:55,546 - INFO - Total Rows: 12592294
2019-08-26 16:15:55,546 - INFO - Will split into : 13.0 files
2019-08-26 16:16:12,976 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_1.csv
2019-08-26 16:16:12,980 - INFO - , with total : 968638 rows
2019-08-26 16:16:25,411 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_2.csv
2019-08-26 16:16:25,413 - INFO - , with total : 968638 rows
2019-08-26 16:16:36,789 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_3.csv
2019-08-26 16:16:36,790 - INFO - , with total : 968638 rows
2019-08-26 16:16:47,250 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_4.csv
2019-08-26 16:16:47,250 - INFO - , with total : 968638 rows
2019-08-26 16:16:57,834 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_5.csv
2019-08-26 16:16:57,835 - INFO - , with total : 968638 rows
2019-08-26 16:17:07,638 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_6.csv
2019-08-26 16:17:07,638 - INFO - , with total : 968638 rows
2019-08-26 16:17:17,720 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_7.csv
2019-08-26 16:17:17,721 - INFO - , with total : 968638 rows
2019-08-26 16:17:27,851 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_8.csv
2019-08-26 16:17:27,851 - INFO - , with total : 968638 rows
2019-08-26 16:17:39,816 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_9.csv
2019-08-26 16:17:39,818 - INFO - , with total : 968638 rows
2019-08-26 16:17:50,674 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_10.csv
2019-08-26 16:17:50,676 - INFO - , with total : 968638 rows
2019-08-26 16:18:01,733 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_11.csv
2019-08-26 16:18:01,734 - INFO - , with total : 968638 rows
2019-08-26 16:18:11,884 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_12.csv
2019-08-26 16:18:11,884 - INFO - , with total : 968638 rows
2019-08-26 16:18:22,854 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Fashion Buyers_13.csv
2019-08-26 16:18:22,855 - INFO - , with total : 968638 rows
2019-08-26 16:18:24,075 - INFO - ----------------------------------
2019-08-26 16:18:24,075 - INFO - Row 2
2019-08-26 16:18:24,075 - INFO - Filename: A30 Makeup Beauty Buyers
2019-08-26 16:18:24,076 - INFO - Category: 'Beauty','Cosmetics'
2019-08-26 16:18:24,078 - INFO - Last Login: 30
2019-08-26 16:18:24,078 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty','Cosmetics')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-26 16:18:24,081 - INFO - ----------------------------------
2019-08-26 16:18:24,082 - INFO - Start Running query A30 Makeup Beauty Buyers
2019-08-26 16:32:16,226 - INFO - Running A30 Makeup Beauty Buyers Done
2019-08-26 16:32:16,229 - INFO - CSV file path: A30 Makeup Beauty Buyers
2019-08-26 16:32:17,530 - INFO - Starting save the query results
2019-08-26 16:32:17,532 - INFO - Total Rows: 7728321
2019-08-26 16:32:17,532 - INFO - Will split into : 8.0 files
2019-08-26 16:32:30,480 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Makeup Beauty Buyers_1.csv
2019-08-26 16:32:30,483 - INFO - , with total : 966041 rows
2019-08-26 16:32:42,897 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Makeup Beauty Buyers_2.csv
2019-08-26 16:32:42,898 - INFO - , with total : 966040 rows
2019-08-26 16:32:54,051 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Makeup Beauty Buyers_3.csv
2019-08-26 16:32:54,052 - INFO - , with total : 966040 rows
2019-08-26 16:33:05,788 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Makeup Beauty Buyers_4.csv
2019-08-26 16:33:05,789 - INFO - , with total : 966040 rows
2019-08-26 16:33:16,196 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Makeup Beauty Buyers_5.csv
2019-08-26 16:33:16,196 - INFO - , with total : 966040 rows
2019-08-26 16:33:26,361 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Makeup Beauty Buyers_6.csv
2019-08-26 16:33:26,362 - INFO - , with total : 966040 rows
2019-08-26 16:33:37,150 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Makeup Beauty Buyers_7.csv
2019-08-26 16:33:37,151 - INFO - , with total : 966040 rows
2019-08-26 16:33:47,233 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 Makeup Beauty Buyers_8.csv
2019-08-26 16:33:47,233 - INFO - , with total : 966040 rows
2019-08-26 16:33:49,381 - INFO - ----------------------------------
2019-08-26 16:33:49,382 - INFO - Delete all data in sheet: Case 1
2019-08-26 16:33:50,058 - INFO - No value detected on sheet: Case 2
2019-08-26 16:33:50,061 - INFO - No value detected on sheet: Case 3
2019-08-26 16:33:50,065 - INFO - No value detected on sheet: Case 4
2019-08-26 16:33:50,068 - INFO - No value detected on sheet: Case 5
2019-08-26 16:33:50,072 - INFO - No value detected on sheet: Case 6
2019-08-26 16:33:50,078 - INFO - No value detected on sheet: Case 7
2019-08-26 16:33:50,081 - INFO - Value detected - use sheet: Case 8
2019-08-26 16:33:50,082 - INFO - Reading Data From Excel...
2019-08-26 16:33:50,084 - INFO - ===================================
2019-08-26 16:33:50,085 - INFO - Get custom SQL..
2019-08-26 16:33:50,088 - INFO - USING CASE 8
2019-08-26 16:33:50,092 - INFO - ----------------------------------
2019-08-26 16:33:50,094 - INFO - Row 1
2019-08-26 16:33:50,095 - INFO - Filename: A30 MA Buyers
2019-08-26 16:33:50,096 - INFO - Sub-category: 'Mobile & Tablet'
2019-08-26 16:33:50,098 - INFO - Last Login: 30
2019-08-26 16:33:50,099 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Mobile & Tablet')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-26 16:33:50,105 - INFO - ----------------------------------
2019-08-26 16:33:50,107 - INFO - Start Running query A30 MA Buyers
2019-08-26 16:52:36,984 - INFO - Running A30 MA Buyers Done
2019-08-26 16:52:36,986 - INFO - CSV file path: A30 MA Buyers
2019-08-26 16:52:37,466 - INFO - Starting save the query results
2019-08-26 16:52:37,467 - INFO - Total Rows: 3088925
2019-08-26 16:52:37,467 - INFO - Will split into : 4.0 files
2019-08-26 16:52:46,744 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 MA Buyers_1.csv
2019-08-26 16:52:46,746 - INFO - , with total : 772232 rows
2019-08-26 16:52:54,809 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 MA Buyers_2.csv
2019-08-26 16:52:54,809 - INFO - , with total : 772231 rows
2019-08-26 16:53:03,434 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 MA Buyers_3.csv
2019-08-26 16:53:03,436 - INFO - , with total : 772231 rows
2019-08-26 16:53:11,789 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A30 MA Buyers_4.csv
2019-08-26 16:53:11,789 - INFO - , with total : 772231 rows
2019-08-26 16:53:12,905 - INFO - ----------------------------------
2019-08-26 16:53:12,907 - INFO - Delete all data in sheet: Case 8
2019-08-26 16:53:13,611 - INFO - No value detected on sheet: Case 9
2019-08-26 16:53:13,612 - INFO - No value detected on sheet: Case 10
2019-08-26 16:53:13,615 - INFO - No value detected on sheet: Case 11
2019-08-26 16:53:13,617 - INFO - Value detected - use sheet: Case 12
2019-08-26 16:53:13,618 - INFO - Reading Data From Excel...
2019-08-26 16:53:13,618 - INFO - ===================================
2019-08-26 16:53:13,619 - INFO - Get custom SQL..
2019-08-26 16:53:13,621 - INFO - USING CASE 12
2019-08-26 16:53:13,624 - INFO - ----------------------------------
2019-08-26 16:53:13,624 - INFO - Row 1
2019-08-26 16:53:13,625 - INFO - Filename: A1 who haven't shopped DP
2019-08-26 16:53:13,627 - INFO - Last Login: 1
2019-08-26 16:53:13,628 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    where
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-26 16:53:13,630 - INFO - ----------------------------------
2019-08-26 16:53:13,631 - INFO - Start Running query A1 who haven't shopped DP
2019-08-26 17:01:04,197 - INFO - Running A1 who haven't shopped DP Done
2019-08-26 17:01:04,198 - INFO - CSV file path: A1 who haven't shopped DP
2019-08-26 17:01:05,233 - INFO - Starting save the query results
2019-08-26 17:01:05,234 - INFO - Total Rows: 5734730
2019-08-26 17:01:05,236 - INFO - Will split into : 6.0 files
2019-08-26 17:01:16,515 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A1 who haven't shopped DP_1.csv
2019-08-26 17:01:16,516 - INFO - , with total : 955789 rows
2019-08-26 17:01:26,710 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A1 who haven't shopped DP_2.csv
2019-08-26 17:01:26,711 - INFO - , with total : 955789 rows
2019-08-26 17:01:40,262 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A1 who haven't shopped DP_3.csv
2019-08-26 17:01:40,263 - INFO - , with total : 955788 rows
2019-08-26 17:01:49,552 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A1 who haven't shopped DP_4.csv
2019-08-26 17:01:49,552 - INFO - , with total : 955788 rows
2019-08-26 17:01:59,844 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A1 who haven't shopped DP_5.csv
2019-08-26 17:01:59,845 - INFO - , with total : 955788 rows
2019-08-26 17:02:12,460 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190826 15.38/A1 who haven't shopped DP_6.csv
2019-08-26 17:02:12,463 - INFO - , with total : 955788 rows
2019-08-26 17:02:13,729 - INFO - ----------------------------------
2019-08-26 17:02:13,732 - INFO - Delete all data in sheet: Case 12
2019-08-26 17:02:15,259 - INFO - No value detected on sheet: Case 13
2019-08-26 17:02:15,263 - INFO - No value detected on sheet: Case 14
2019-08-26 17:02:15,266 - INFO - No value detected on sheet: Case 15
2019-08-26 17:02:15,269 - INFO - No value detected on sheet: Case 16
2019-08-26 17:02:15,272 - INFO - No value detected on sheet: Case 17
2019-08-26 17:02:15,276 - INFO - No value detected on sheet: Case 18
2019-08-27 11:18:23,944 - INFO - Report date: 20190827 11.18
2019-08-27 11:18:26,963 - INFO - ----------------------------------
2019-08-27 11:18:26,964 - INFO - Download sheet..
2019-08-27 11:18:26,964 - INFO - Change directory to script path
2019-08-27 11:18:28,276 - INFO - Spreadsheet downloaded
2019-08-27 11:18:28,278 - INFO - Opening PN Input.xlsx..
2019-08-27 11:18:28,499 - INFO - No value detected on sheet: Case 1
2019-08-27 11:18:28,499 - INFO - No value detected on sheet: Case 2
2019-08-27 11:18:28,500 - INFO - No value detected on sheet: Case 3
2019-08-27 11:18:28,500 - INFO - No value detected on sheet: Case 4
2019-08-27 11:18:28,500 - INFO - No value detected on sheet: Case 5
2019-08-27 11:18:28,500 - INFO - No value detected on sheet: Case 6
2019-08-27 11:18:28,500 - INFO - No value detected on sheet: Case 7
2019-08-27 11:18:28,500 - INFO - Value detected - use sheet: Case 8
2019-08-27 11:18:28,500 - INFO - Reading Data From Excel...
2019-08-27 11:18:28,503 - INFO - ===================================
2019-08-27 11:18:28,503 - INFO - Get custom SQL..
2019-08-27 11:18:28,503 - INFO - USING CASE 8
2019-08-27 11:18:28,503 - INFO - ----------------------------------
2019-08-27 11:18:28,503 - INFO - Row 1
2019-08-27 11:18:28,505 - INFO - Filename: A30 Music Buyers
2019-08-27 11:18:28,505 - INFO - Sub-category: 'Music'
2019-08-27 11:18:28,505 - INFO - Last Login: 30
2019-08-27 11:18:28,505 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Music')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-27 11:18:28,505 - INFO - ----------------------------------
2019-08-27 11:18:28,506 - INFO - Start Running query A30 Music Buyers
2019-08-27 11:19:47,385 - INFO - Report date: 20190827 11.19
2019-08-27 11:19:50,486 - INFO - ----------------------------------
2019-08-27 11:19:50,486 - INFO - Download sheet..
2019-08-27 11:19:50,486 - INFO - Change directory to script path
2019-08-27 11:19:51,736 - INFO - Spreadsheet downloaded
2019-08-27 11:19:51,736 - INFO - Opening PN Input.xlsx..
2019-08-27 11:19:52,092 - INFO - No value detected on sheet: Case 1
2019-08-27 11:19:52,092 - INFO - No value detected on sheet: Case 2
2019-08-27 11:19:52,094 - INFO - No value detected on sheet: Case 3
2019-08-27 11:19:52,094 - INFO - No value detected on sheet: Case 4
2019-08-27 11:19:52,094 - INFO - No value detected on sheet: Case 5
2019-08-27 11:19:52,094 - INFO - No value detected on sheet: Case 6
2019-08-27 11:19:52,094 - INFO - No value detected on sheet: Case 7
2019-08-27 11:19:52,095 - INFO - Value detected - use sheet: Case 8
2019-08-27 11:19:52,095 - INFO - Reading Data From Excel...
2019-08-27 11:19:52,095 - INFO - ===================================
2019-08-27 11:19:52,095 - INFO - Get custom SQL..
2019-08-27 11:19:52,095 - INFO - USING CASE 8
2019-08-27 11:19:52,095 - INFO - ----------------------------------
2019-08-27 11:19:52,095 - INFO - Row 1
2019-08-27 11:19:52,095 - INFO - Filename: A30 Music Buyers
2019-08-27 11:19:52,095 - INFO - Sub-category: 'Music'
2019-08-27 11:19:52,096 - INFO - Last Login: 30
2019-08-27 11:19:52,096 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Music')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-27 11:19:52,096 - INFO - ----------------------------------
2019-08-27 11:19:52,096 - INFO - Start Running query A30 Music Buyers
2019-08-27 11:25:53,842 - INFO - Running A30 Music Buyers Done
2019-08-27 11:25:53,842 - INFO - CSV file path: A30 Music Buyers
2019-08-27 11:25:53,859 - INFO - Starting save the query results
2019-08-27 11:25:53,859 - INFO - Total Rows: 436292
2019-08-27 11:25:53,861 - INFO - Will split into : 1.0 files
2019-08-27 11:25:55,826 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A30 Music Buyers_1.csv
2019-08-27 11:25:55,828 - INFO - , with total : 436292 rows
2019-08-27 11:25:55,848 - INFO - ----------------------------------
2019-08-27 11:25:55,848 - INFO - Row 2
2019-08-27 11:25:55,849 - INFO - Filename: A30 Photography Buyers
2019-08-27 11:25:55,849 - INFO - Sub-category: 'Accessories','Camera & Video','Camera & Video Accessories','Camera Care','Camera Case & Bags','Drone','Flash Accessories','Lenses & Accessories','Others','Video'
2019-08-27 11:25:55,851 - INFO - Last Login: 30
2019-08-27 11:25:55,851 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Accessories','Camera & Video','Camera & Video Accessories','Camera Care','Camera Case & Bags','Drone','Flash Accessories','Lenses & Accessories','Others','Video')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-27 11:25:55,851 - INFO - ----------------------------------
2019-08-27 11:25:55,851 - INFO - Start Running query A30 Photography Buyers
2019-08-27 11:33:43,112 - INFO - Running A30 Photography Buyers Done
2019-08-27 11:33:43,115 - INFO - CSV file path: A30 Photography Buyers
2019-08-27 11:33:43,338 - INFO - Starting save the query results
2019-08-27 11:33:43,341 - INFO - Total Rows: 6286494
2019-08-27 11:33:43,341 - INFO - Will split into : 7.0 files
2019-08-27 11:33:47,365 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A30 Photography Buyers_1.csv
2019-08-27 11:33:47,367 - INFO - , with total : 898071 rows
2019-08-27 11:33:51,322 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A30 Photography Buyers_2.csv
2019-08-27 11:33:51,322 - INFO - , with total : 898071 rows
2019-08-27 11:33:55,332 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A30 Photography Buyers_3.csv
2019-08-27 11:33:55,332 - INFO - , with total : 898071 rows
2019-08-27 11:33:59,398 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A30 Photography Buyers_4.csv
2019-08-27 11:33:59,398 - INFO - , with total : 898071 rows
2019-08-27 11:34:03,486 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A30 Photography Buyers_5.csv
2019-08-27 11:34:03,486 - INFO - , with total : 898070 rows
2019-08-27 11:34:07,581 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A30 Photography Buyers_6.csv
2019-08-27 11:34:07,582 - INFO - , with total : 898070 rows
2019-08-27 11:34:11,861 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A30 Photography Buyers_7.csv
2019-08-27 11:34:11,861 - INFO - , with total : 898070 rows
2019-08-27 11:34:12,993 - INFO - ----------------------------------
2019-08-27 11:34:12,996 - INFO - Delete all data in sheet: Case 8
2019-08-27 11:34:13,473 - INFO - No value detected on sheet: Case 9
2019-08-27 11:34:13,474 - INFO - Value detected - use sheet: Case 10
2019-08-27 11:34:13,476 - INFO - Reading Data From Excel...
2019-08-27 11:34:13,477 - INFO - ===================================
2019-08-27 11:34:13,479 - INFO - Get custom SQL..
2019-08-27 11:34:13,480 - INFO - USING CASE 10
2019-08-27 11:34:13,480 - INFO - ----------------------------------
2019-08-27 11:34:13,482 - INFO - Row 1
2019-08-27 11:34:13,483 - INFO - Filename: Unilever OS Followers
2019-08-27 11:34:13,484 - INFO - Shop ID: 14318452
2019-08-27 11:34:13,486 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (14318452) 
                                and status = 1
                                
2019-08-27 11:34:13,486 - INFO - ----------------------------------
2019-08-27 11:34:13,487 - INFO - Start Running query Unilever OS Followers
2019-08-27 11:39:28,505 - INFO - Running Unilever OS Followers Done
2019-08-27 11:39:28,506 - INFO - CSV file path: Unilever OS Followers
2019-08-27 11:39:28,523 - INFO - Starting save the query results
2019-08-27 11:39:28,525 - INFO - Total Rows: 471388
2019-08-27 11:39:28,525 - INFO - Will split into : 1.0 files
2019-08-27 11:39:30,598 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/Unilever OS Followers_1.csv
2019-08-27 11:39:30,598 - INFO - , with total : 471388 rows
2019-08-27 11:39:30,621 - INFO - ----------------------------------
2019-08-27 11:39:30,622 - INFO - Row 2
2019-08-27 11:39:30,622 - INFO - Filename: OPPO OS Followers
2019-08-27 11:39:30,624 - INFO - Shop ID: 13140292
2019-08-27 11:39:30,624 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (13140292) 
                                and status = 1
                                
2019-08-27 11:39:30,625 - INFO - ----------------------------------
2019-08-27 11:39:30,625 - INFO - Start Running query OPPO OS Followers
2019-08-27 11:40:19,147 - INFO - Running OPPO OS Followers Done
2019-08-27 11:40:19,148 - INFO - CSV file path: OPPO OS Followers
2019-08-27 11:40:19,173 - INFO - Starting save the query results
2019-08-27 11:40:19,174 - INFO - Total Rows: 364210
2019-08-27 11:40:19,174 - INFO - Will split into : 1.0 files
2019-08-27 11:40:20,779 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/OPPO OS Followers_1.csv
2019-08-27 11:40:20,779 - INFO - , with total : 364210 rows
2019-08-27 11:40:20,796 - INFO - ----------------------------------
2019-08-27 11:40:20,798 - INFO - Row 3
2019-08-27 11:40:20,799 - INFO - Filename: Nutrimart OS Followers
2019-08-27 11:40:20,799 - INFO - Shop ID: 12656836
2019-08-27 11:40:20,799 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (12656836) 
                                and status = 1
                                
2019-08-27 11:40:20,801 - INFO - ----------------------------------
2019-08-27 11:40:20,801 - INFO - Start Running query Nutrimart OS Followers
2019-08-27 11:41:02,023 - INFO - Running Nutrimart OS Followers Done
2019-08-27 11:41:02,026 - INFO - CSV file path: Nutrimart OS Followers
2019-08-27 11:41:02,036 - INFO - Starting save the query results
2019-08-27 11:41:02,039 - INFO - Total Rows: 83541
2019-08-27 11:41:02,040 - INFO - Will split into : 1.0 files
2019-08-27 11:41:02,431 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/Nutrimart OS Followers_1.csv
2019-08-27 11:41:02,433 - INFO - , with total : 83541 rows
2019-08-27 11:41:02,961 - INFO - ----------------------------------
2019-08-27 11:41:02,963 - INFO - Delete all data in sheet: Case 10
2019-08-27 11:41:03,398 - INFO - No value detected on sheet: Case 11
2019-08-27 11:41:03,400 - INFO - Value detected - use sheet: Case 12
2019-08-27 11:41:03,401 - INFO - Reading Data From Excel...
2019-08-27 11:41:03,404 - INFO - ===================================
2019-08-27 11:41:03,404 - INFO - Get custom SQL..
2019-08-27 11:41:03,407 - INFO - USING CASE 12
2019-08-27 11:41:03,407 - INFO - ----------------------------------
2019-08-27 11:41:03,407 - INFO - Row 1
2019-08-27 11:41:03,407 - INFO - Filename: A1 who haven't shopeed DP
2019-08-27 11:41:03,408 - INFO - Last Login: 1
2019-08-27 11:41:03,410 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    where
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-27 11:41:03,410 - INFO - ----------------------------------
2019-08-27 11:41:03,410 - INFO - Start Running query A1 who haven't shopeed DP
2019-08-27 11:44:00,365 - INFO - Running A1 who haven't shopeed DP Done
2019-08-27 11:44:00,367 - INFO - CSV file path: A1 who haven't shopeed DP
2019-08-27 11:44:00,578 - INFO - Starting save the query results
2019-08-27 11:44:00,579 - INFO - Total Rows: 6165866
2019-08-27 11:44:00,581 - INFO - Will split into : 7.0 files
2019-08-27 11:44:04,546 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A1 who haven't shopeed DP_1.csv
2019-08-27 11:44:04,546 - INFO - , with total : 880838 rows
2019-08-27 11:44:08,421 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A1 who haven't shopeed DP_2.csv
2019-08-27 11:44:08,423 - INFO - , with total : 880838 rows
2019-08-27 11:44:12,369 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A1 who haven't shopeed DP_3.csv
2019-08-27 11:44:12,371 - INFO - , with total : 880838 rows
2019-08-27 11:44:16,378 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A1 who haven't shopeed DP_4.csv
2019-08-27 11:44:16,380 - INFO - , with total : 880838 rows
2019-08-27 11:44:20,415 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A1 who haven't shopeed DP_5.csv
2019-08-27 11:44:20,417 - INFO - , with total : 880838 rows
2019-08-27 11:44:24,457 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A1 who haven't shopeed DP_6.csv
2019-08-27 11:44:24,459 - INFO - , with total : 880838 rows
2019-08-27 11:44:28,503 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 11.19/A1 who haven't shopeed DP_7.csv
2019-08-27 11:44:28,505 - INFO - , with total : 880838 rows
2019-08-27 11:44:29,164 - INFO - ----------------------------------
2019-08-27 11:44:29,165 - INFO - Delete all data in sheet: Case 12
2019-08-27 11:44:29,661 - INFO - No value detected on sheet: Case 13
2019-08-27 11:44:29,663 - INFO - No value detected on sheet: Case 14
2019-08-27 11:44:29,664 - INFO - No value detected on sheet: Case 15
2019-08-27 11:44:29,665 - INFO - No value detected on sheet: Case 16
2019-08-27 11:44:29,667 - INFO - No value detected on sheet: Case 17
2019-08-27 11:44:29,670 - INFO - No value detected on sheet: Case 18
2019-08-27 14:00:01,038 - INFO - Report date: 20190827 14.00
2019-08-27 14:00:03,996 - INFO - ----------------------------------
2019-08-27 14:00:03,996 - INFO - Download sheet..
2019-08-27 14:00:03,996 - INFO - Change directory to script path
2019-08-27 14:00:05,232 - INFO - Spreadsheet downloaded
2019-08-27 14:00:05,233 - INFO - Opening PN Input.xlsx..
2019-08-27 14:00:05,451 - INFO - No value detected on sheet: Case 1
2019-08-27 14:00:05,451 - INFO - No value detected on sheet: Case 2
2019-08-27 14:00:05,451 - INFO - No value detected on sheet: Case 3
2019-08-27 14:00:05,453 - INFO - No value detected on sheet: Case 4
2019-08-27 14:00:05,453 - INFO - No value detected on sheet: Case 5
2019-08-27 14:00:05,453 - INFO - No value detected on sheet: Case 6
2019-08-27 14:00:05,453 - INFO - No value detected on sheet: Case 7
2019-08-27 14:00:05,453 - INFO - No value detected on sheet: Case 8
2019-08-27 14:00:05,453 - INFO - No value detected on sheet: Case 9
2019-08-27 14:00:05,453 - INFO - No value detected on sheet: Case 10
2019-08-27 14:00:05,453 - INFO - Value detected - use sheet: Case 11
2019-08-27 14:00:05,453 - INFO - Reading Data From Excel...
2019-08-27 14:00:05,454 - INFO - ===================================
2019-08-27 14:00:05,454 - INFO - Get custom SQL..
2019-08-27 14:00:05,454 - INFO - USING CASE 11
2019-08-27 14:00:05,454 - INFO - ----------------------------------
2019-08-27 14:00:05,456 - INFO - Row 1
2019-08-27 14:00:05,456 - INFO - Filename: A7 DP Buyers
2019-08-27 14:00:05,456 - INFO - Last Login: 7
2019-08-27 14:00:05,456 - INFO - Query:    
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-08-27 14:00:05,456 - INFO - ----------------------------------
2019-08-27 14:00:05,457 - INFO - Start Running query A7 DP Buyers
2019-08-27 14:01:24,661 - INFO - Running A7 DP Buyers Done
2019-08-27 14:01:24,664 - INFO - CSV file path: A7 DP Buyers
2019-08-27 14:01:24,742 - INFO - Starting save the query results
2019-08-27 14:01:24,743 - INFO - Total Rows: 2160919
2019-08-27 14:01:24,743 - INFO - Will split into : 3.0 files
2019-08-27 14:01:27,934 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A7 DP Buyers_1.csv
2019-08-27 14:01:27,936 - INFO - , with total : 720307 rows
2019-08-27 14:01:31,089 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A7 DP Buyers_2.csv
2019-08-27 14:01:31,091 - INFO - , with total : 720306 rows
2019-08-27 14:01:34,265 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A7 DP Buyers_3.csv
2019-08-27 14:01:34,266 - INFO - , with total : 720306 rows
2019-08-27 14:01:35,240 - INFO - ----------------------------------
2019-08-27 14:01:35,240 - INFO - Delete all data in sheet: Case 11
2019-08-27 14:01:35,987 - INFO - No value detected on sheet: Case 12
2019-08-27 14:01:35,989 - INFO - Value detected - use sheet: Case 13
2019-08-27 14:01:35,990 - INFO - Reading Data From Excel...
2019-08-27 14:01:35,990 - INFO - ===================================
2019-08-27 14:01:35,992 - INFO - Get custom SQL..
2019-08-27 14:01:35,992 - INFO - USING CASE 13
2019-08-27 14:01:35,992 - INFO - ----------------------------------
2019-08-27 14:01:35,992 - INFO - Row 1
2019-08-27 14:01:35,993 - INFO - Filename: A3 Fashion buyers who haven't shopped DP
2019-08-27 14:01:35,993 - INFO - Main category: 'Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes'
2019-08-27 14:01:35,993 - INFO - Last Login: 3
2019-08-27 14:01:35,993 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion','Fashion Accessories','Men Bags','Men Clothes','Men Shoes','Muslim Fashion','Watches','Women Bags','Women Clothes','Women Shoes') 
                                    and
                                    last_login >= current_date - interval '3' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-27 14:01:35,993 - INFO - ----------------------------------
2019-08-27 14:01:35,993 - INFO - Start Running query A3 Fashion buyers who haven't shopped DP
2019-08-27 14:05:22,384 - INFO - Running A3 Fashion buyers who haven't shopped DP Done
2019-08-27 14:05:22,384 - INFO - CSV file path: A3 Fashion buyers who haven't shopped DP
2019-08-27 14:05:22,644 - INFO - Starting save the query results
2019-08-27 14:05:22,644 - INFO - Total Rows: 6341616
2019-08-27 14:05:22,644 - INFO - Will split into : 7.0 files
2019-08-27 14:05:26,864 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 Fashion buyers who haven't shopped DP_1.csv
2019-08-27 14:05:26,865 - INFO - , with total : 905946 rows
2019-08-27 14:05:31,183 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 Fashion buyers who haven't shopped DP_2.csv
2019-08-27 14:05:31,184 - INFO - , with total : 905945 rows
2019-08-27 14:05:35,252 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 Fashion buyers who haven't shopped DP_3.csv
2019-08-27 14:05:35,253 - INFO - , with total : 905945 rows
2019-08-27 14:05:39,487 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 Fashion buyers who haven't shopped DP_4.csv
2019-08-27 14:05:39,489 - INFO - , with total : 905945 rows
2019-08-27 14:05:44,164 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 Fashion buyers who haven't shopped DP_5.csv
2019-08-27 14:05:44,165 - INFO - , with total : 905945 rows
2019-08-27 14:05:48,644 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 Fashion buyers who haven't shopped DP_6.csv
2019-08-27 14:05:48,645 - INFO - , with total : 905945 rows
2019-08-27 14:05:52,869 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 Fashion buyers who haven't shopped DP_7.csv
2019-08-27 14:05:52,871 - INFO - , with total : 905945 rows
2019-08-27 14:05:53,184 - INFO - ----------------------------------
2019-08-27 14:05:53,186 - INFO - Row 2
2019-08-27 14:05:53,186 - INFO - Filename: A3 EL MA buyers who haven't shopped DP
2019-08-27 14:05:53,186 - INFO - Main category: 'Mobile & Accessories'
2019-08-27 14:05:53,187 - INFO - Last Login: 3
2019-08-27 14:05:53,187 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    join order_mart__order_item_profile as p 
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Mobile & Accessories') 
                                    and
                                    last_login >= current_date - interval '3' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-27 14:05:53,187 - INFO - ----------------------------------
2019-08-27 14:05:53,187 - INFO - Start Running query A3 EL MA buyers who haven't shopped DP
2019-08-27 14:08:25,378 - INFO - Running A3 EL MA buyers who haven't shopped DP Done
2019-08-27 14:08:25,381 - INFO - CSV file path: A3 EL MA buyers who haven't shopped DP
2019-08-27 14:08:25,519 - INFO - Starting save the query results
2019-08-27 14:08:25,520 - INFO - Total Rows: 3734682
2019-08-27 14:08:25,520 - INFO - Will split into : 4.0 files
2019-08-27 14:08:29,687 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 EL MA buyers who haven't shopped DP_1.csv
2019-08-27 14:08:29,687 - INFO - , with total : 933671 rows
2019-08-27 14:08:33,809 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 EL MA buyers who haven't shopped DP_2.csv
2019-08-27 14:08:33,809 - INFO - , with total : 933671 rows
2019-08-27 14:08:38,049 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 EL MA buyers who haven't shopped DP_3.csv
2019-08-27 14:08:38,051 - INFO - , with total : 933670 rows
2019-08-27 14:08:42,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 14.00/A3 EL MA buyers who haven't shopped DP_4.csv
2019-08-27 14:08:42,969 - INFO - , with total : 933670 rows
2019-08-27 14:08:43,703 - INFO - ----------------------------------
2019-08-27 14:08:43,704 - INFO - Delete all data in sheet: Case 13
2019-08-27 14:08:44,243 - INFO - No value detected on sheet: Case 14
2019-08-27 14:08:44,244 - INFO - No value detected on sheet: Case 15
2019-08-27 14:08:44,246 - INFO - No value detected on sheet: Case 16
2019-08-27 14:08:44,249 - INFO - No value detected on sheet: Case 17
2019-08-27 14:08:44,250 - INFO - No value detected on sheet: Case 18
2019-08-27 17:00:01,045 - INFO - Report date: 20190827 17.00
2019-08-27 17:00:04,855 - INFO - ----------------------------------
2019-08-27 17:00:04,855 - INFO - Download sheet..
2019-08-27 17:00:04,855 - INFO - Change directory to script path
2019-08-27 17:00:06,437 - INFO - Spreadsheet downloaded
2019-08-27 17:00:06,438 - INFO - Opening PN Input.xlsx..
2019-08-27 17:00:06,660 - INFO - Value detected - use sheet: Case 1
2019-08-27 17:00:06,660 - INFO - Reading Data From Excel...
2019-08-27 17:00:06,660 - INFO - ===================================
2019-08-27 17:00:06,660 - INFO - Get custom SQL..
2019-08-27 17:00:06,660 - INFO - USING CASE 1
2019-08-27 17:00:06,661 - INFO - ----------------------------------
2019-08-27 17:00:06,661 - INFO - Row 1
2019-08-27 17:00:06,661 - INFO - Filename: A30 Lifestyle Hobby Buyers
2019-08-27 17:00:06,661 - INFO - Category: 'Hobby & Collection'
2019-08-27 17:00:06,661 - INFO - Last Login: 30
2019-08-27 17:00:06,661 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-27 17:00:06,661 - INFO - ----------------------------------
2019-08-27 17:00:06,661 - INFO - Start Running query A30 Lifestyle Hobby Buyers
2019-08-27 17:01:26,308 - INFO - Running A30 Lifestyle Hobby Buyers Done
2019-08-27 17:01:26,309 - INFO - CSV file path: A30 Lifestyle Hobby Buyers
2019-08-27 17:01:26,392 - INFO - Starting save the query results
2019-08-27 17:01:26,394 - INFO - Total Rows: 2242277
2019-08-27 17:01:26,394 - INFO - Will split into : 3.0 files
2019-08-27 17:01:29,657 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 17.00/A30 Lifestyle Hobby Buyers_1.csv
2019-08-27 17:01:29,658 - INFO - , with total : 747426 rows
2019-08-27 17:01:32,888 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 17.00/A30 Lifestyle Hobby Buyers_2.csv
2019-08-27 17:01:32,890 - INFO - , with total : 747426 rows
2019-08-27 17:01:36,117 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 17.00/A30 Lifestyle Hobby Buyers_3.csv
2019-08-27 17:01:36,118 - INFO - , with total : 747425 rows
2019-08-27 17:01:37,693 - INFO - ----------------------------------
2019-08-27 17:01:37,694 - INFO - Delete all data in sheet: Case 1
2019-08-27 17:01:38,362 - INFO - No value detected on sheet: Case 2
2019-08-27 17:01:38,365 - INFO - No value detected on sheet: Case 3
2019-08-27 17:01:38,368 - INFO - No value detected on sheet: Case 4
2019-08-27 17:01:38,368 - INFO - No value detected on sheet: Case 5
2019-08-27 17:01:38,371 - INFO - No value detected on sheet: Case 6
2019-08-27 17:01:38,372 - INFO - No value detected on sheet: Case 7
2019-08-27 17:01:38,374 - INFO - Value detected - use sheet: Case 8
2019-08-27 17:01:38,377 - INFO - Reading Data From Excel...
2019-08-27 17:01:38,378 - INFO - ===================================
2019-08-27 17:01:38,378 - INFO - Get custom SQL..
2019-08-27 17:01:38,378 - INFO - USING CASE 8
2019-08-27 17:01:38,378 - INFO - ----------------------------------
2019-08-27 17:01:38,378 - INFO - Row 1
2019-08-27 17:01:38,378 - INFO - Filename: A30 Souvenirs Buyers
2019-08-27 17:01:38,378 - INFO - Sub-category: 'Balloon','Doll','Flowers','Gift & Wrapping','Others','Party Accessories','Party Supply','Souvenir'
2019-08-27 17:01:38,380 - INFO - Last Login: 30
2019-08-27 17:01:38,380 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Balloon','Doll','Flowers','Gift & Wrapping','Others','Party Accessories','Party Supply','Souvenir')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-27 17:01:38,380 - INFO - ----------------------------------
2019-08-27 17:01:38,380 - INFO - Start Running query A30 Souvenirs Buyers
2019-08-27 17:08:51,755 - INFO - Running A30 Souvenirs Buyers Done
2019-08-27 17:08:51,756 - INFO - CSV file path: A30 Souvenirs Buyers
2019-08-27 17:08:52,019 - INFO - Starting save the query results
2019-08-27 17:08:52,020 - INFO - Total Rows: 6052797
2019-08-27 17:08:52,022 - INFO - Will split into : 7.0 files
2019-08-27 17:08:55,872 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 17.00/A30 Souvenirs Buyers_1.csv
2019-08-27 17:08:55,874 - INFO - , with total : 864686 rows
2019-08-27 17:08:59,618 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 17.00/A30 Souvenirs Buyers_2.csv
2019-08-27 17:08:59,619 - INFO - , with total : 864686 rows
2019-08-27 17:09:03,444 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 17.00/A30 Souvenirs Buyers_3.csv
2019-08-27 17:09:03,446 - INFO - , with total : 864685 rows
2019-08-27 17:09:07,322 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 17.00/A30 Souvenirs Buyers_4.csv
2019-08-27 17:09:07,322 - INFO - , with total : 864685 rows
2019-08-27 17:09:11,318 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 17.00/A30 Souvenirs Buyers_5.csv
2019-08-27 17:09:11,319 - INFO - , with total : 864685 rows
2019-08-27 17:09:15,339 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 17.00/A30 Souvenirs Buyers_6.csv
2019-08-27 17:09:15,339 - INFO - , with total : 864685 rows
2019-08-27 17:09:19,302 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190827 17.00/A30 Souvenirs Buyers_7.csv
2019-08-27 17:09:19,303 - INFO - , with total : 864685 rows
2019-08-27 17:09:20,130 - INFO - ----------------------------------
2019-08-27 17:09:20,131 - INFO - Delete all data in sheet: Case 8
2019-08-27 17:09:20,599 - INFO - No value detected on sheet: Case 9
2019-08-27 17:09:20,601 - INFO - No value detected on sheet: Case 10
2019-08-27 17:09:20,602 - INFO - No value detected on sheet: Case 11
2019-08-27 17:09:20,605 - INFO - No value detected on sheet: Case 12
2019-08-27 17:09:20,607 - INFO - No value detected on sheet: Case 13
2019-08-27 17:09:20,608 - INFO - No value detected on sheet: Case 14
2019-08-27 17:09:20,609 - INFO - No value detected on sheet: Case 15
2019-08-27 17:09:20,609 - INFO - No value detected on sheet: Case 16
2019-08-27 17:09:20,611 - INFO - No value detected on sheet: Case 17
2019-08-27 17:09:20,611 - INFO - No value detected on sheet: Case 18
2019-08-28 10:00:04,460 - INFO - Report date: 20190828 10.00
2019-08-28 10:00:09,690 - INFO - ----------------------------------
2019-08-28 10:00:09,690 - INFO - Download sheet..
2019-08-28 10:00:09,690 - INFO - Change directory to script path
2019-08-28 10:00:12,885 - INFO - Spreadsheet downloaded
2019-08-28 10:00:12,887 - INFO - Opening PN Input.xlsx..
2019-08-28 10:00:13,115 - INFO - No value detected on sheet: Case 1
2019-08-28 10:00:13,115 - INFO - No value detected on sheet: Case 2
2019-08-28 10:00:13,117 - INFO - No value detected on sheet: Case 3
2019-08-28 10:00:13,117 - INFO - No value detected on sheet: Case 4
2019-08-28 10:00:13,117 - INFO - No value detected on sheet: Case 5
2019-08-28 10:00:13,117 - INFO - No value detected on sheet: Case 6
2019-08-28 10:00:13,118 - INFO - No value detected on sheet: Case 7
2019-08-28 10:00:13,118 - INFO - No value detected on sheet: Case 8
2019-08-28 10:00:13,118 - INFO - No value detected on sheet: Case 9
2019-08-28 10:00:13,118 - INFO - No value detected on sheet: Case 10
2019-08-28 10:00:13,118 - INFO - No value detected on sheet: Case 11
2019-08-28 10:00:13,118 - INFO - No value detected on sheet: Case 12
2019-08-28 10:00:13,118 - INFO - No value detected on sheet: Case 13
2019-08-28 10:00:13,119 - INFO - No value detected on sheet: Case 14
2019-08-28 10:00:13,119 - INFO - No value detected on sheet: Case 15
2019-08-28 10:00:13,119 - INFO - No value detected on sheet: Case 16
2019-08-28 10:00:13,119 - INFO - No value detected on sheet: Case 17
2019-08-28 10:00:13,121 - INFO - No value detected on sheet: Case 18
2019-08-28 14:00:03,494 - INFO - Report date: 20190828 14.00
2019-08-28 14:00:07,000 - INFO - ----------------------------------
2019-08-28 14:00:07,000 - INFO - Download sheet..
2019-08-28 14:00:07,000 - INFO - Change directory to script path
2019-08-28 14:00:08,059 - INFO - Spreadsheet downloaded
2019-08-28 14:00:08,059 - INFO - Opening PN Input.xlsx..
2019-08-28 14:00:08,341 - INFO - Value detected - use sheet: Case 1
2019-08-28 14:00:08,342 - INFO - Reading Data From Excel...
2019-08-28 14:00:08,342 - INFO - ===================================
2019-08-28 14:00:08,342 - INFO - Get custom SQL..
2019-08-28 14:00:08,342 - INFO - USING CASE 1
2019-08-28 14:00:08,342 - INFO - ----------------------------------
2019-08-28 14:00:08,342 - INFO - Row 1
2019-08-28 14:00:08,344 - INFO - Filename: A1 Fashion Shopee Live 
2019-08-28 14:00:08,344 - INFO - Category: 'Watches','Women Bags','Women Clothes','Women Shoes','Fashion Accessories'
2019-08-28 14:00:08,344 - INFO - Last Login: 1
2019-08-28 14:00:08,345 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Watches','Women Bags','Women Clothes','Women Shoes','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-28 14:00:08,345 - INFO - ----------------------------------
2019-08-28 14:00:08,345 - INFO - Start Running query A1 Fashion Shopee Live 
2019-08-28 14:02:18,812 - INFO - Running A1 Fashion Shopee Live  Done
2019-08-28 14:02:18,813 - INFO - CSV file path: A1 Fashion Shopee Live 
2019-08-28 14:02:19,000 - INFO - Starting save the query results
2019-08-28 14:02:19,000 - INFO - Total Rows: 4908501
2019-08-28 14:02:19,002 - INFO - Will split into : 5.0 files
2019-08-28 14:02:23,457 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A1 Fashion Shopee Live _1.csv
2019-08-28 14:02:23,457 - INFO - , with total : 981701 rows
2019-08-28 14:02:27,875 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A1 Fashion Shopee Live _2.csv
2019-08-28 14:02:27,875 - INFO - , with total : 981700 rows
2019-08-28 14:02:32,653 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A1 Fashion Shopee Live _3.csv
2019-08-28 14:02:32,654 - INFO - , with total : 981700 rows
2019-08-28 14:02:37,322 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A1 Fashion Shopee Live _4.csv
2019-08-28 14:02:37,322 - INFO - , with total : 981700 rows
2019-08-28 14:02:42,049 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A1 Fashion Shopee Live _5.csv
2019-08-28 14:02:42,052 - INFO - , with total : 981700 rows
2019-08-28 14:02:43,141 - INFO - ----------------------------------
2019-08-28 14:02:43,142 - INFO - Delete all data in sheet: Case 1
2019-08-28 14:02:43,736 - INFO - No value detected on sheet: Case 2
2019-08-28 14:02:43,737 - INFO - No value detected on sheet: Case 3
2019-08-28 14:02:43,740 - INFO - No value detected on sheet: Case 4
2019-08-28 14:02:43,742 - INFO - No value detected on sheet: Case 5
2019-08-28 14:02:43,743 - INFO - No value detected on sheet: Case 6
2019-08-28 14:02:43,746 - INFO - Value detected - use sheet: Case 7
2019-08-28 14:02:43,747 - INFO - Reading Data From Excel...
2019-08-28 14:02:43,750 - INFO - ===================================
2019-08-28 14:02:43,750 - INFO - Get custom SQL..
2019-08-28 14:02:43,750 - INFO - USING CASE 7
2019-08-28 14:02:43,752 - INFO - ----------------------------------
2019-08-28 14:02:43,752 - INFO - Row 1
2019-08-28 14:02:43,753 - INFO - Filename: A30 female Hobby & Collection
2019-08-28 14:02:43,753 - INFO - Category: 'Hobby & Collection'
2019-08-28 14:02:43,753 - INFO - Last Login: 30
2019-08-28 14:02:43,753 - INFO - Gender: 2,4
2019-08-28 14:02:43,753 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-28 14:02:43,753 - INFO - ----------------------------------
2019-08-28 14:02:43,753 - INFO - Start Running query A30 female Hobby & Collection
2019-08-28 14:03:38,234 - INFO - Running A30 female Hobby & Collection Done
2019-08-28 14:03:38,236 - INFO - CSV file path: A30 female Hobby & Collection
2019-08-28 14:03:38,296 - INFO - Starting save the query results
2019-08-28 14:03:38,298 - INFO - Total Rows: 1636443
2019-08-28 14:03:38,299 - INFO - Will split into : 2.0 files
2019-08-28 14:03:42,009 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female Hobby & Collection_1.csv
2019-08-28 14:03:42,009 - INFO - , with total : 818222 rows
2019-08-28 14:03:45,678 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female Hobby & Collection_2.csv
2019-08-28 14:03:45,680 - INFO - , with total : 818221 rows
2019-08-28 14:03:45,753 - INFO - ----------------------------------
2019-08-28 14:03:45,755 - INFO - Row 2
2019-08-28 14:03:45,756 - INFO - Filename: A30 female HBC
2019-08-28 14:03:45,756 - INFO - Category: 'Body Care','Facial care','Hair Care','Others','Supplement & Vitamin','Tools and Kits'
2019-08-28 14:03:45,756 - INFO - Last Login: 30
2019-08-28 14:03:45,756 - INFO - Gender: 2,4
2019-08-28 14:03:45,757 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Body Care','Facial care','Hair Care','Others','Supplement & Vitamin','Tools and Kits')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-28 14:03:45,757 - INFO - ----------------------------------
2019-08-28 14:03:45,757 - INFO - Start Running query A30 female HBC
2019-08-28 14:08:59,661 - INFO - Running A30 female HBC Done
2019-08-28 14:08:59,661 - INFO - CSV file path: A30 female HBC
2019-08-28 14:08:59,792 - INFO - Starting save the query results
2019-08-28 14:08:59,792 - INFO - Total Rows: 3171206
2019-08-28 14:08:59,792 - INFO - Will split into : 4.0 files
2019-08-28 14:09:03,467 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female HBC_1.csv
2019-08-28 14:09:03,469 - INFO - , with total : 792802 rows
2019-08-28 14:09:07,059 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female HBC_2.csv
2019-08-28 14:09:07,059 - INFO - , with total : 792802 rows
2019-08-28 14:09:10,622 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female HBC_3.csv
2019-08-28 14:09:10,624 - INFO - , with total : 792801 rows
2019-08-28 14:09:14,332 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female HBC_4.csv
2019-08-28 14:09:14,334 - INFO - , with total : 792801 rows
2019-08-28 14:09:14,519 - INFO - ----------------------------------
2019-08-28 14:09:14,519 - INFO - Row 3
2019-08-28 14:09:14,520 - INFO - Filename: A30 female Fashion
2019-08-28 14:09:14,522 - INFO - Category: 'Women Bags','Women Clothes','Women Shoes','Watches Accessories','Women Watches'
2019-08-28 14:09:14,522 - INFO - Last Login: 30
2019-08-28 14:09:14,523 - INFO - Gender: 2,4
2019-08-28 14:09:14,523 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Bags','Women Clothes','Women Shoes','Watches Accessories','Women Watches')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-28 14:09:14,525 - INFO - ----------------------------------
2019-08-28 14:09:14,526 - INFO - Start Running query A30 female Fashion
2019-08-28 14:12:57,767 - INFO - Running A30 female Fashion Done
2019-08-28 14:12:57,769 - INFO - CSV file path: A30 female Fashion
2019-08-28 14:12:58,062 - INFO - Starting save the query results
2019-08-28 14:12:58,062 - INFO - Total Rows: 7789380
2019-08-28 14:12:58,063 - INFO - Will split into : 8.0 files
2019-08-28 14:13:02,654 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female Fashion_1.csv
2019-08-28 14:13:02,654 - INFO - , with total : 973673 rows
2019-08-28 14:13:07,273 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female Fashion_2.csv
2019-08-28 14:13:07,275 - INFO - , with total : 973673 rows
2019-08-28 14:13:11,802 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female Fashion_3.csv
2019-08-28 14:13:11,802 - INFO - , with total : 973673 rows
2019-08-28 14:13:16,361 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female Fashion_4.csv
2019-08-28 14:13:16,361 - INFO - , with total : 973673 rows
2019-08-28 14:13:20,940 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female Fashion_5.csv
2019-08-28 14:13:20,940 - INFO - , with total : 973672 rows
2019-08-28 14:13:25,535 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female Fashion_6.csv
2019-08-28 14:13:25,536 - INFO - , with total : 973672 rows
2019-08-28 14:13:30,095 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female Fashion_7.csv
2019-08-28 14:13:30,095 - INFO - , with total : 973672 rows
2019-08-28 14:13:34,678 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/A30 female Fashion_8.csv
2019-08-28 14:13:34,680 - INFO - , with total : 973672 rows
2019-08-28 14:13:35,634 - INFO - ----------------------------------
2019-08-28 14:13:35,637 - INFO - Delete all data in sheet: Case 7
2019-08-28 14:13:36,091 - INFO - No value detected on sheet: Case 8
2019-08-28 14:13:36,092 - INFO - No value detected on sheet: Case 9
2019-08-28 14:13:36,095 - INFO - No value detected on sheet: Case 10
2019-08-28 14:13:36,095 - INFO - No value detected on sheet: Case 11
2019-08-28 14:13:36,098 - INFO - No value detected on sheet: Case 12
2019-08-28 14:13:36,098 - INFO - No value detected on sheet: Case 13
2019-08-28 14:13:36,101 - INFO - No value detected on sheet: Case 14
2019-08-28 14:13:36,105 - INFO - No value detected on sheet: Case 15
2019-08-28 14:13:36,107 - INFO - No value detected on sheet: Case 16
2019-08-28 14:13:36,108 - INFO - No value detected on sheet: Case 17
2019-08-28 14:13:36,108 - INFO - Value detected - use sheet: Case 18
2019-08-28 14:13:36,109 - INFO - Reading Data From Excel...
2019-08-28 14:13:36,111 - INFO - ===================================
2019-08-28 14:13:36,111 - INFO - Get custom SQL..
2019-08-28 14:13:36,112 - INFO - USING CASE 18
2019-08-28 14:13:36,114 - INFO - ----------------------------------
2019-08-28 14:13:36,114 - INFO - Row 1
2019-08-28 14:13:36,115 - INFO - Filename: Shopee Lucky Prize 29 Aug
2019-08-28 14:13:36,115 - INFO - Date 1: 2019-08-01
2019-08-28 14:13:36,115 - INFO - Date 2: 2019-08-27
2019-08-28 14:13:36,115 - INFO - Query:
                                select distinct
                                concat('user_id=',cast(dp.user_id as varchar)) as list_userid
                                from shopee_id_mk_team__daily_prize_vfive as dp
                                left join user_profile as u 
                                on u.userid = cast(dp.user_id as int)
                                where date(date_parse(cast(dp.datte as varchar), '%Y-%m-%d %H:%i:%s')) >= date('2019-08-01')
                                and date(date_parse(cast(dp.datte as varchar), '%Y-%m-%d %H:%i:%s')) <= date('2019-08-27')                                
                                
2019-08-28 14:13:36,115 - INFO - ----------------------------------
2019-08-28 14:13:36,115 - INFO - Start Running query Shopee Lucky Prize 29 Aug
2019-08-28 14:15:19,141 - INFO - Running Shopee Lucky Prize 29 Aug Done
2019-08-28 14:15:19,142 - INFO - CSV file path: Shopee Lucky Prize 29 Aug
2019-08-28 14:15:19,233 - INFO - Starting save the query results
2019-08-28 14:15:19,236 - INFO - Total Rows: 2540496
2019-08-28 14:15:19,236 - INFO - Will split into : 3.0 files
2019-08-28 14:15:23,164 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/Shopee Lucky Prize 29 Aug_1.csv
2019-08-28 14:15:23,164 - INFO - , with total : 846832 rows
2019-08-28 14:15:27,607 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/Shopee Lucky Prize 29 Aug_2.csv
2019-08-28 14:15:27,608 - INFO - , with total : 846832 rows
2019-08-28 14:15:31,614 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 14.00/Shopee Lucky Prize 29 Aug_3.csv
2019-08-28 14:15:31,615 - INFO - , with total : 846832 rows
2019-08-28 14:15:32,108 - INFO - ----------------------------------
2019-08-28 14:15:32,108 - INFO - Delete all data in sheet: Case 18
2019-08-28 17:00:02,062 - INFO - Report date: 20190828 17.00
2019-08-28 17:00:06,028 - INFO - ----------------------------------
2019-08-28 17:00:06,029 - INFO - Download sheet..
2019-08-28 17:00:06,030 - INFO - Change directory to script path
2019-08-28 17:00:07,358 - INFO - Spreadsheet downloaded
2019-08-28 17:00:07,359 - INFO - Opening PN Input.xlsx..
2019-08-28 17:00:07,578 - INFO - No value detected on sheet: Case 1
2019-08-28 17:00:07,578 - INFO - No value detected on sheet: Case 2
2019-08-28 17:00:07,578 - INFO - No value detected on sheet: Case 3
2019-08-28 17:00:07,578 - INFO - No value detected on sheet: Case 4
2019-08-28 17:00:07,578 - INFO - No value detected on sheet: Case 5
2019-08-28 17:00:07,578 - INFO - No value detected on sheet: Case 6
2019-08-28 17:00:07,579 - INFO - Value detected - use sheet: Case 7
2019-08-28 17:00:07,579 - INFO - Reading Data From Excel...
2019-08-28 17:00:07,579 - INFO - ===================================
2019-08-28 17:00:07,581 - INFO - Get custom SQL..
2019-08-28 17:00:07,581 - INFO - USING CASE 7
2019-08-28 17:00:07,581 - INFO - ----------------------------------
2019-08-28 17:00:07,581 - INFO - Row 1
2019-08-28 17:00:07,582 - INFO - Filename: A30 Women Fashion Buyers
2019-08-28 17:00:07,582 - INFO - Category: 'Women Clothes','Women Shoes','Women Bags'
2019-08-28 17:00:07,582 - INFO - Last Login: 30
2019-08-28 17:00:07,582 - INFO - Gender: 2,4
2019-08-28 17:00:07,582 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Women Clothes','Women Shoes','Women Bags')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.gender in (2,4)
                                
2019-08-28 17:00:07,582 - INFO - ----------------------------------
2019-08-28 17:00:07,582 - INFO - Start Running query A30 Women Fashion Buyers
2019-08-28 17:03:37,898 - INFO - Running A30 Women Fashion Buyers Done
2019-08-28 17:03:37,898 - INFO - CSV file path: A30 Women Fashion Buyers
2019-08-28 17:03:38,209 - INFO - Starting save the query results
2019-08-28 17:03:38,210 - INFO - Total Rows: 7789380
2019-08-28 17:03:38,210 - INFO - Will split into : 8.0 files
2019-08-28 17:03:42,684 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 17.00/A30 Women Fashion Buyers_1.csv
2019-08-28 17:03:42,686 - INFO - , with total : 973673 rows
2019-08-28 17:03:47,036 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 17.00/A30 Women Fashion Buyers_2.csv
2019-08-28 17:03:47,036 - INFO - , with total : 973673 rows
2019-08-28 17:03:51,513 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 17.00/A30 Women Fashion Buyers_3.csv
2019-08-28 17:03:51,515 - INFO - , with total : 973673 rows
2019-08-28 17:03:56,072 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 17.00/A30 Women Fashion Buyers_4.csv
2019-08-28 17:03:56,072 - INFO - , with total : 973673 rows
2019-08-28 17:04:00,601 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 17.00/A30 Women Fashion Buyers_5.csv
2019-08-28 17:04:00,602 - INFO - , with total : 973672 rows
2019-08-28 17:04:05,096 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 17.00/A30 Women Fashion Buyers_6.csv
2019-08-28 17:04:05,096 - INFO - , with total : 973672 rows
2019-08-28 17:04:10,151 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 17.00/A30 Women Fashion Buyers_7.csv
2019-08-28 17:04:10,153 - INFO - , with total : 973672 rows
2019-08-28 17:04:14,641 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190828 17.00/A30 Women Fashion Buyers_8.csv
2019-08-28 17:04:14,641 - INFO - , with total : 973672 rows
2019-08-28 17:04:15,867 - INFO - ----------------------------------
2019-08-28 17:04:15,868 - INFO - Delete all data in sheet: Case 7
2019-08-28 17:04:16,354 - INFO - No value detected on sheet: Case 8
2019-08-28 17:04:16,357 - INFO - No value detected on sheet: Case 9
2019-08-28 17:04:16,358 - INFO - No value detected on sheet: Case 10
2019-08-28 17:04:16,361 - INFO - No value detected on sheet: Case 11
2019-08-28 17:04:16,361 - INFO - No value detected on sheet: Case 12
2019-08-28 17:04:16,361 - INFO - No value detected on sheet: Case 13
2019-08-28 17:04:16,361 - INFO - No value detected on sheet: Case 14
2019-08-28 17:04:16,362 - INFO - No value detected on sheet: Case 15
2019-08-28 17:04:16,364 - INFO - No value detected on sheet: Case 16
2019-08-28 17:04:16,364 - INFO - No value detected on sheet: Case 17
2019-08-28 17:04:16,364 - INFO - No value detected on sheet: Case 18
2019-08-29 10:00:06,214 - INFO - Report date: 20190829 10.00
2019-08-29 10:00:11,624 - INFO - ----------------------------------
2019-08-29 10:00:11,624 - INFO - Download sheet..
2019-08-29 10:00:11,624 - INFO - Change directory to script path
2019-08-29 10:00:12,743 - INFO - Spreadsheet downloaded
2019-08-29 10:00:12,743 - INFO - Opening PN Input.xlsx..
2019-08-29 10:00:12,970 - INFO - Value detected - use sheet: Case 1
2019-08-29 10:00:12,970 - INFO - Reading Data From Excel...
2019-08-29 10:00:12,970 - INFO - ===================================
2019-08-29 10:00:12,970 - INFO - Get custom SQL..
2019-08-29 10:00:12,970 - INFO - USING CASE 1
2019-08-29 10:00:12,970 - INFO - ----------------------------------
2019-08-29 10:00:12,970 - INFO - Row 1
2019-08-29 10:00:12,971 - INFO - Filename: A3 Mom, Baby &Kids
2019-08-29 10:00:12,971 - INFO - Category: 'Baby & Kids Fashion','Mom & Baby'
2019-08-29 10:00:12,971 - INFO - Last Login: 3
2019-08-29 10:00:12,971 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Baby & Kids Fashion','Mom & Baby')
                                    and
                                    last_login >= current_date - interval '3' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-29 10:00:12,973 - INFO - ----------------------------------
2019-08-29 10:00:12,973 - INFO - Start Running query A3 Mom, Baby &Kids
2019-08-29 10:02:29,803 - INFO - Running A3 Mom, Baby &Kids Done
2019-08-29 10:02:29,805 - INFO - CSV file path: A3 Mom, Baby &Kids
2019-08-29 10:02:29,953 - INFO - Starting save the query results
2019-08-29 10:02:29,953 - INFO - Total Rows: 3683997
2019-08-29 10:02:29,954 - INFO - Will split into : 4.0 files
2019-08-29 10:02:34,381 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A3 Mom, Baby &Kids_1.csv
2019-08-29 10:02:34,382 - INFO - , with total : 921000 rows
2019-08-29 10:02:38,655 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A3 Mom, Baby &Kids_2.csv
2019-08-29 10:02:38,655 - INFO - , with total : 920999 rows
2019-08-29 10:02:43,091 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A3 Mom, Baby &Kids_3.csv
2019-08-29 10:02:43,092 - INFO - , with total : 920999 rows
2019-08-29 10:02:47,529 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A3 Mom, Baby &Kids_4.csv
2019-08-29 10:02:47,529 - INFO - , with total : 920999 rows
2019-08-29 10:02:48,677 - INFO - ----------------------------------
2019-08-29 10:02:48,677 - INFO - Delete all data in sheet: Case 1
2019-08-29 10:02:49,535 - INFO - No value detected on sheet: Case 2
2019-08-29 10:02:49,536 - INFO - No value detected on sheet: Case 3
2019-08-29 10:02:49,536 - INFO - No value detected on sheet: Case 4
2019-08-29 10:02:49,536 - INFO - No value detected on sheet: Case 5
2019-08-29 10:02:49,536 - INFO - No value detected on sheet: Case 6
2019-08-29 10:02:49,536 - INFO - No value detected on sheet: Case 7
2019-08-29 10:02:49,538 - INFO - No value detected on sheet: Case 8
2019-08-29 10:02:49,538 - INFO - No value detected on sheet: Case 9
2019-08-29 10:02:49,538 - INFO - No value detected on sheet: Case 10
2019-08-29 10:02:49,539 - INFO - No value detected on sheet: Case 11
2019-08-29 10:02:49,539 - INFO - Value detected - use sheet: Case 12
2019-08-29 10:02:49,539 - INFO - Reading Data From Excel...
2019-08-29 10:02:49,539 - INFO - ===================================
2019-08-29 10:02:49,539 - INFO - Get custom SQL..
2019-08-29 10:02:49,539 - INFO - USING CASE 12
2019-08-29 10:02:49,539 - INFO - ----------------------------------
2019-08-29 10:02:49,539 - INFO - Row 1
2019-08-29 10:02:49,540 - INFO - Filename: A1 who haven't shopped DP
2019-08-29 10:02:49,540 - INFO - Last Login: 1
2019-08-29 10:02:49,540 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    where
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-29 10:02:49,540 - INFO - ----------------------------------
2019-08-29 10:02:49,542 - INFO - Start Running query A1 who haven't shopped DP
2019-08-29 10:06:01,065 - INFO - Running A1 who haven't shopped DP Done
2019-08-29 10:06:01,065 - INFO - CSV file path: A1 who haven't shopped DP
2019-08-29 10:06:01,311 - INFO - Starting save the query results
2019-08-29 10:06:01,311 - INFO - Total Rows: 6151864
2019-08-29 10:06:01,312 - INFO - Will split into : 7.0 files
2019-08-29 10:06:05,477 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A1 who haven't shopped DP_1.csv
2019-08-29 10:06:05,479 - INFO - , with total : 878838 rows
2019-08-29 10:06:09,663 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A1 who haven't shopped DP_2.csv
2019-08-29 10:06:09,664 - INFO - , with total : 878838 rows
2019-08-29 10:06:13,915 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A1 who haven't shopped DP_3.csv
2019-08-29 10:06:13,917 - INFO - , with total : 878838 rows
2019-08-29 10:06:18,196 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A1 who haven't shopped DP_4.csv
2019-08-29 10:06:18,196 - INFO - , with total : 878838 rows
2019-08-29 10:06:22,507 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A1 who haven't shopped DP_5.csv
2019-08-29 10:06:22,509 - INFO - , with total : 878838 rows
2019-08-29 10:06:26,757 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A1 who haven't shopped DP_6.csv
2019-08-29 10:06:26,759 - INFO - , with total : 878837 rows
2019-08-29 10:06:31,038 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 10.00/A1 who haven't shopped DP_7.csv
2019-08-29 10:06:31,038 - INFO - , with total : 878837 rows
2019-08-29 10:06:31,974 - INFO - ----------------------------------
2019-08-29 10:06:31,976 - INFO - Delete all data in sheet: Case 12
2019-08-29 10:06:32,665 - INFO - No value detected on sheet: Case 13
2019-08-29 10:06:32,667 - INFO - No value detected on sheet: Case 14
2019-08-29 10:06:32,667 - INFO - No value detected on sheet: Case 15
2019-08-29 10:06:32,667 - INFO - No value detected on sheet: Case 16
2019-08-29 10:06:32,668 - INFO - No value detected on sheet: Case 17
2019-08-29 10:06:32,668 - INFO - No value detected on sheet: Case 18
2019-08-29 14:00:02,944 - INFO - Report date: 20190829 14.00
2019-08-29 14:00:06,888 - INFO - ----------------------------------
2019-08-29 14:00:06,890 - INFO - Download sheet..
2019-08-29 14:00:06,890 - INFO - Change directory to script path
2019-08-29 14:00:08,124 - INFO - Spreadsheet downloaded
2019-08-29 14:00:08,125 - INFO - Opening PN Input.xlsx..
2019-08-29 14:00:08,354 - INFO - Value detected - use sheet: Case 1
2019-08-29 14:00:08,354 - INFO - Reading Data From Excel...
2019-08-29 14:00:08,354 - INFO - ===================================
2019-08-29 14:00:08,354 - INFO - Get custom SQL..
2019-08-29 14:00:08,355 - INFO - USING CASE 1
2019-08-29 14:00:08,355 - INFO - ----------------------------------
2019-08-29 14:00:08,355 - INFO - Row 1
2019-08-29 14:00:08,355 - INFO - Filename: A30 EL & HE Buyers
2019-08-29 14:00:08,355 - INFO - Category: 'Electronics','Mobile & Accessories'
2019-08-29 14:00:08,355 - INFO - Last Login: 30
2019-08-29 14:00:08,355 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-29 14:00:08,355 - INFO - ----------------------------------
2019-08-29 14:00:08,357 - INFO - Start Running query A30 EL & HE Buyers
2019-08-29 14:04:14,492 - INFO - Running A30 EL & HE Buyers Done
2019-08-29 14:04:14,493 - INFO - CSV file path: A30 EL & HE Buyers
2019-08-29 14:04:14,898 - INFO - Starting save the query results
2019-08-29 14:04:14,898 - INFO - Total Rows: 8831419
2019-08-29 14:04:14,900 - INFO - Will split into : 9.0 files
2019-08-29 14:04:19,578 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 EL & HE Buyers_1.csv
2019-08-29 14:04:19,578 - INFO - , with total : 981269 rows
2019-08-29 14:04:24,089 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 EL & HE Buyers_2.csv
2019-08-29 14:04:24,091 - INFO - , with total : 981269 rows
2019-08-29 14:04:28,582 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 EL & HE Buyers_3.csv
2019-08-29 14:04:28,584 - INFO - , with total : 981269 rows
2019-08-29 14:04:32,983 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 EL & HE Buyers_4.csv
2019-08-29 14:04:32,984 - INFO - , with total : 981269 rows
2019-08-29 14:04:37,384 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 EL & HE Buyers_5.csv
2019-08-29 14:04:37,384 - INFO - , with total : 981269 rows
2019-08-29 14:04:41,821 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 EL & HE Buyers_6.csv
2019-08-29 14:04:41,822 - INFO - , with total : 981269 rows
2019-08-29 14:04:46,282 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 EL & HE Buyers_7.csv
2019-08-29 14:04:46,282 - INFO - , with total : 981269 rows
2019-08-29 14:04:50,713 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 EL & HE Buyers_8.csv
2019-08-29 14:04:50,713 - INFO - , with total : 981268 rows
2019-08-29 14:04:55,164 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 EL & HE Buyers_9.csv
2019-08-29 14:04:55,165 - INFO - , with total : 981268 rows
2019-08-29 14:04:55,638 - INFO - ----------------------------------
2019-08-29 14:04:55,638 - INFO - Row 2
2019-08-29 14:04:55,638 - INFO - Filename: A30 Fashion & FACC Buyers
2019-08-29 14:04:55,638 - INFO - Category: 'Fashion Accessories','Fashion'
2019-08-29 14:04:55,640 - INFO - Last Login: 30
2019-08-29 14:04:55,640 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion Accessories','Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-29 14:04:55,641 - INFO - ----------------------------------
2019-08-29 14:04:55,641 - INFO - Start Running query A30 Fashion & FACC Buyers
2019-08-29 14:08:51,966 - INFO - Running A30 Fashion & FACC Buyers Done
2019-08-29 14:08:51,967 - INFO - CSV file path: A30 Fashion & FACC Buyers
2019-08-29 14:08:52,140 - INFO - Starting save the query results
2019-08-29 14:08:52,141 - INFO - Total Rows: 4691581
2019-08-29 14:08:52,141 - INFO - Will split into : 5.0 files
2019-08-29 14:08:56,450 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 Fashion & FACC Buyers_1.csv
2019-08-29 14:08:56,453 - INFO - , with total : 938317 rows
2019-08-29 14:09:00,681 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 Fashion & FACC Buyers_2.csv
2019-08-29 14:09:00,683 - INFO - , with total : 938316 rows
2019-08-29 14:09:04,907 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 Fashion & FACC Buyers_3.csv
2019-08-29 14:09:04,908 - INFO - , with total : 938316 rows
2019-08-29 14:09:09,098 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 Fashion & FACC Buyers_4.csv
2019-08-29 14:09:09,098 - INFO - , with total : 938316 rows
2019-08-29 14:09:13,328 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 Fashion & FACC Buyers_5.csv
2019-08-29 14:09:13,328 - INFO - , with total : 938316 rows
2019-08-29 14:09:14,542 - INFO - ----------------------------------
2019-08-29 14:09:14,542 - INFO - Delete all data in sheet: Case 1
2019-08-29 14:09:15,209 - INFO - No value detected on sheet: Case 2
2019-08-29 14:09:15,210 - INFO - No value detected on sheet: Case 3
2019-08-29 14:09:15,210 - INFO - No value detected on sheet: Case 4
2019-08-29 14:09:15,211 - INFO - No value detected on sheet: Case 5
2019-08-29 14:09:15,211 - INFO - No value detected on sheet: Case 6
2019-08-29 14:09:15,213 - INFO - No value detected on sheet: Case 7
2019-08-29 14:09:15,213 - INFO - Value detected - use sheet: Case 8
2019-08-29 14:09:15,213 - INFO - Reading Data From Excel...
2019-08-29 14:09:15,213 - INFO - ===================================
2019-08-29 14:09:15,213 - INFO - Get custom SQL..
2019-08-29 14:09:15,213 - INFO - USING CASE 8
2019-08-29 14:09:15,213 - INFO - ----------------------------------
2019-08-29 14:09:15,214 - INFO - Row 1
2019-08-29 14:09:15,214 - INFO - Filename: A30 Pet Care Buyers
2019-08-29 14:09:15,214 - INFO - Sub-category: 'Pet Care'
2019-08-29 14:09:15,214 - INFO - Last Login: 30
2019-08-29 14:09:15,216 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Pet Care')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-29 14:09:15,216 - INFO - ----------------------------------
2019-08-29 14:09:15,216 - INFO - Start Running query A30 Pet Care Buyers
2019-08-29 14:09:56,552 - INFO - Running A30 Pet Care Buyers Done
2019-08-29 14:09:56,552 - INFO - CSV file path: A30 Pet Care Buyers
2019-08-29 14:09:56,576 - INFO - Starting save the query results
2019-08-29 14:09:56,578 - INFO - Total Rows: 622334
2019-08-29 14:09:56,578 - INFO - Will split into : 1.0 files
2019-08-29 14:09:59,759 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/A30 Pet Care Buyers_1.csv
2019-08-29 14:09:59,760 - INFO - , with total : 622334 rows
2019-08-29 14:10:00,368 - INFO - ----------------------------------
2019-08-29 14:10:00,369 - INFO - Delete all data in sheet: Case 8
2019-08-29 14:10:01,010 - INFO - No value detected on sheet: Case 9
2019-08-29 14:10:01,012 - INFO - Value detected - use sheet: Case 10
2019-08-29 14:10:01,012 - INFO - Reading Data From Excel...
2019-08-29 14:10:01,013 - INFO - ===================================
2019-08-29 14:10:01,013 - INFO - Get custom SQL..
2019-08-29 14:10:01,013 - INFO - USING CASE 10
2019-08-29 14:10:01,013 - INFO - ----------------------------------
2019-08-29 14:10:01,013 - INFO - Row 1
2019-08-29 14:10:01,013 - INFO - Filename: caesarjaco OS Followers
2019-08-29 14:10:01,015 - INFO - Shop ID: 17979533
2019-08-29 14:10:01,015 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (17979533) 
                                and status = 1
                                
2019-08-29 14:10:01,015 - INFO - ----------------------------------
2019-08-29 14:10:01,015 - INFO - Start Running query caesarjaco OS Followers
2019-08-29 14:10:29,618 - INFO - Running caesarjaco OS Followers Done
2019-08-29 14:10:29,619 - INFO - CSV file path: caesarjaco OS Followers
2019-08-29 14:10:29,621 - INFO - Starting save the query results
2019-08-29 14:10:29,621 - INFO - Total Rows: 7515
2019-08-29 14:10:29,621 - INFO - Will split into : 1.0 files
2019-08-29 14:10:29,684 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/caesarjaco OS Followers_1.csv
2019-08-29 14:10:29,684 - INFO - , with total : 7515 rows
2019-08-29 14:10:29,696 - INFO - ----------------------------------
2019-08-29 14:10:29,697 - INFO - Row 2
2019-08-29 14:10:29,697 - INFO - Filename: ciciliagoenshop OS Followers
2019-08-29 14:10:29,697 - INFO - Shop ID: 13369203
2019-08-29 14:10:29,697 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (13369203) 
                                and status = 1
                                
2019-08-29 14:10:29,697 - INFO - ----------------------------------
2019-08-29 14:10:29,697 - INFO - Start Running query ciciliagoenshop OS Followers
2019-08-29 14:10:48,644 - INFO - Running ciciliagoenshop OS Followers Done
2019-08-29 14:10:48,644 - INFO - CSV file path: ciciliagoenshop OS Followers
2019-08-29 14:10:48,647 - INFO - Starting save the query results
2019-08-29 14:10:48,647 - INFO - Total Rows: 11231
2019-08-29 14:10:48,648 - INFO - Will split into : 1.0 files
2019-08-29 14:10:48,730 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/ciciliagoenshop OS Followers_1.csv
2019-08-29 14:10:48,730 - INFO - , with total : 11231 rows
2019-08-29 14:10:48,733 - INFO - ----------------------------------
2019-08-29 14:10:48,733 - INFO - Row 3
2019-08-29 14:10:48,733 - INFO - Filename: casperpetshop OS Followers
2019-08-29 14:10:48,733 - INFO - Shop ID: 90470305
2019-08-29 14:10:48,733 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (90470305) 
                                and status = 1
                                
2019-08-29 14:10:48,733 - INFO - ----------------------------------
2019-08-29 14:10:48,734 - INFO - Start Running query casperpetshop OS Followers
2019-08-29 14:11:02,023 - INFO - Running casperpetshop OS Followers Done
2019-08-29 14:11:02,025 - INFO - CSV file path: casperpetshop OS Followers
2019-08-29 14:11:02,026 - INFO - Starting save the query results
2019-08-29 14:11:02,028 - INFO - Total Rows: 295
2019-08-29 14:11:02,028 - INFO - Will split into : 1.0 files
2019-08-29 14:11:02,069 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/casperpetshop OS Followers_1.csv
2019-08-29 14:11:02,069 - INFO - , with total : 295 rows
2019-08-29 14:11:02,072 - INFO - ----------------------------------
2019-08-29 14:11:02,072 - INFO - Row 4
2019-08-29 14:11:02,072 - INFO - Filename: honeypet88 OS Followers
2019-08-29 14:11:02,073 - INFO - Shop ID: 32646142
2019-08-29 14:11:02,073 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (32646142) 
                                and status = 1
                                
2019-08-29 14:11:02,073 - INFO - ----------------------------------
2019-08-29 14:11:02,073 - INFO - Start Running query honeypet88 OS Followers
2019-08-29 14:11:19,914 - INFO - Running honeypet88 OS Followers Done
2019-08-29 14:11:19,915 - INFO - CSV file path: honeypet88 OS Followers
2019-08-29 14:11:19,917 - INFO - Starting save the query results
2019-08-29 14:11:19,918 - INFO - Total Rows: 2080
2019-08-29 14:11:19,918 - INFO - Will split into : 1.0 files
2019-08-29 14:11:19,947 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/honeypet88 OS Followers_1.csv
2019-08-29 14:11:19,948 - INFO - , with total : 2080 rows
2019-08-29 14:11:19,953 - INFO - ----------------------------------
2019-08-29 14:11:19,953 - INFO - Row 5
2019-08-29 14:11:19,953 - INFO - Filename: petshopid OS Followers
2019-08-29 14:11:19,954 - INFO - Shop ID: 819856
2019-08-29 14:11:19,954 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (819856) 
                                and status = 1
                                
2019-08-29 14:11:19,956 - INFO - ----------------------------------
2019-08-29 14:11:19,957 - INFO - Start Running query petshopid OS Followers
2019-08-29 14:11:39,602 - INFO - Running petshopid OS Followers Done
2019-08-29 14:11:39,605 - INFO - CSV file path: petshopid OS Followers
2019-08-29 14:11:39,605 - INFO - Starting save the query results
2019-08-29 14:11:39,607 - INFO - Total Rows: 3018
2019-08-29 14:11:39,607 - INFO - Will split into : 1.0 files
2019-08-29 14:11:39,647 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/petshopid OS Followers_1.csv
2019-08-29 14:11:39,648 - INFO - , with total : 3018 rows
2019-08-29 14:11:39,665 - INFO - ----------------------------------
2019-08-29 14:11:39,667 - INFO - Row 6
2019-08-29 14:11:39,667 - INFO - Filename: ffblackmoscow OS Followers
2019-08-29 14:11:39,668 - INFO - Shop ID: 3537610
2019-08-29 14:11:39,668 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (3537610) 
                                and status = 1
                                
2019-08-29 14:11:39,668 - INFO - ----------------------------------
2019-08-29 14:11:39,668 - INFO - Start Running query ffblackmoscow OS Followers
2019-08-29 14:12:03,599 - INFO - Running ffblackmoscow OS Followers Done
2019-08-29 14:12:03,601 - INFO - CSV file path: ffblackmoscow OS Followers
2019-08-29 14:12:03,602 - INFO - Starting save the query results
2019-08-29 14:12:03,604 - INFO - Total Rows: 11432
2019-08-29 14:12:03,605 - INFO - Will split into : 1.0 files
2019-08-29 14:12:03,680 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/ffblackmoscow OS Followers_1.csv
2019-08-29 14:12:03,681 - INFO - , with total : 11432 rows
2019-08-29 14:12:03,684 - INFO - ----------------------------------
2019-08-29 14:12:03,684 - INFO - Row 7
2019-08-29 14:12:03,684 - INFO - Filename: kiosbadrakirana OS Followers
2019-08-29 14:12:03,684 - INFO - Shop ID: 90671227
2019-08-29 14:12:03,684 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (90671227) 
                                and status = 1
                                
2019-08-29 14:12:03,684 - INFO - ----------------------------------
2019-08-29 14:12:03,684 - INFO - Start Running query kiosbadrakirana OS Followers
2019-08-29 14:12:17,923 - INFO - Running kiosbadrakirana OS Followers Done
2019-08-29 14:12:17,924 - INFO - CSV file path: kiosbadrakirana OS Followers
2019-08-29 14:12:17,926 - INFO - Starting save the query results
2019-08-29 14:12:17,927 - INFO - Total Rows: 199
2019-08-29 14:12:17,927 - INFO - Will split into : 1.0 files
2019-08-29 14:12:17,967 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/kiosbadrakirana OS Followers_1.csv
2019-08-29 14:12:17,967 - INFO - , with total : 199 rows
2019-08-29 14:12:17,982 - INFO - ----------------------------------
2019-08-29 14:12:17,983 - INFO - Row 8
2019-08-29 14:12:17,983 - INFO - Filename: dennyaquarium OS Followers
2019-08-29 14:12:17,983 - INFO - Shop ID: 37259010
2019-08-29 14:12:17,984 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (37259010) 
                                and status = 1
                                
2019-08-29 14:12:17,984 - INFO - ----------------------------------
2019-08-29 14:12:17,986 - INFO - Start Running query dennyaquarium OS Followers
2019-08-29 14:12:32,496 - INFO - Running dennyaquarium OS Followers Done
2019-08-29 14:12:32,497 - INFO - CSV file path: dennyaquarium OS Followers
2019-08-29 14:12:32,500 - INFO - Starting save the query results
2019-08-29 14:12:32,500 - INFO - Total Rows: 1641
2019-08-29 14:12:32,500 - INFO - Will split into : 1.0 files
2019-08-29 14:12:32,523 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/dennyaquarium OS Followers_1.csv
2019-08-29 14:12:32,523 - INFO - , with total : 1641 rows
2019-08-29 14:12:32,528 - INFO - ----------------------------------
2019-08-29 14:12:32,529 - INFO - Row 9
2019-08-29 14:12:32,529 - INFO - Filename: pedigree.id OS Followers
2019-08-29 14:12:32,529 - INFO - Shop ID: 76616442
2019-08-29 14:12:32,530 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (76616442) 
                                and status = 1
                                
2019-08-29 14:12:32,530 - INFO - ----------------------------------
2019-08-29 14:12:32,532 - INFO - Start Running query pedigree.id OS Followers
2019-08-29 14:12:47,236 - INFO - Running pedigree.id OS Followers Done
2019-08-29 14:12:47,237 - INFO - CSV file path: pedigree.id OS Followers
2019-08-29 14:12:47,240 - INFO - Starting save the query results
2019-08-29 14:12:47,240 - INFO - Total Rows: 2428
2019-08-29 14:12:47,240 - INFO - Will split into : 1.0 files
2019-08-29 14:12:47,272 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/pedigree.id OS Followers_1.csv
2019-08-29 14:12:47,272 - INFO - , with total : 2428 rows
2019-08-29 14:12:47,276 - INFO - ----------------------------------
2019-08-29 14:12:47,278 - INFO - Row 10
2019-08-29 14:12:47,279 - INFO - Filename: royalcanin.id OS Followers
2019-08-29 14:12:47,279 - INFO - Shop ID: 91681758
2019-08-29 14:12:47,279 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (91681758) 
                                and status = 1
                                
2019-08-29 14:12:47,282 - INFO - ----------------------------------
2019-08-29 14:12:47,282 - INFO - Start Running query royalcanin.id OS Followers
2019-08-29 14:13:04,221 - INFO - Running royalcanin.id OS Followers Done
2019-08-29 14:13:04,223 - INFO - CSV file path: royalcanin.id OS Followers
2019-08-29 14:13:04,226 - INFO - Starting save the query results
2019-08-29 14:13:04,226 - INFO - Total Rows: 7276
2019-08-29 14:13:04,226 - INFO - Will split into : 1.0 files
2019-08-29 14:13:04,292 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 14.00/royalcanin.id OS Followers_1.csv
2019-08-29 14:13:04,292 - INFO - , with total : 7276 rows
2019-08-29 14:13:04,887 - INFO - ----------------------------------
2019-08-29 14:13:04,888 - INFO - Delete all data in sheet: Case 10
2019-08-29 14:13:05,747 - INFO - No value detected on sheet: Case 11
2019-08-29 14:13:05,749 - INFO - No value detected on sheet: Case 12
2019-08-29 14:13:05,750 - INFO - No value detected on sheet: Case 13
2019-08-29 14:13:05,750 - INFO - No value detected on sheet: Case 14
2019-08-29 14:13:05,752 - INFO - No value detected on sheet: Case 15
2019-08-29 14:13:05,752 - INFO - No value detected on sheet: Case 16
2019-08-29 14:13:05,753 - INFO - No value detected on sheet: Case 17
2019-08-29 14:13:05,753 - INFO - No value detected on sheet: Case 18
2019-08-29 17:02:55,092 - INFO - Report date: 20190829 17.02
2019-08-29 17:02:58,858 - INFO - ----------------------------------
2019-08-29 17:02:58,859 - INFO - Download sheet..
2019-08-29 17:02:58,859 - INFO - Change directory to script path
2019-08-29 17:03:00,203 - INFO - Spreadsheet downloaded
2019-08-29 17:03:00,203 - INFO - Opening PN Input.xlsx..
2019-08-29 17:03:00,441 - INFO - Value detected - use sheet: Case 1
2019-08-29 17:03:00,441 - INFO - Reading Data From Excel...
2019-08-29 17:03:00,441 - INFO - ===================================
2019-08-29 17:03:00,443 - INFO - Get custom SQL..
2019-08-29 17:03:00,443 - INFO - USING CASE 1
2019-08-29 17:03:00,443 - INFO - ----------------------------------
2019-08-29 17:03:00,444 - INFO - Row 1
2019-08-29 17:03:00,444 - INFO - Filename: A7 Electronics Buyers
2019-08-29 17:03:00,444 - INFO - Category: 'Electronics'
2019-08-29 17:03:00,444 - INFO - Last Login: 7
2019-08-29 17:03:00,444 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics')
                                    and
                                    last_login >= current_date - interval '7' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-29 17:03:00,444 - INFO - ----------------------------------
2019-08-29 17:03:00,446 - INFO - Start Running query A7 Electronics Buyers
2019-08-29 17:05:08,003 - INFO - Running A7 Electronics Buyers Done
2019-08-29 17:05:08,005 - INFO - CSV file path: A7 Electronics Buyers
2019-08-29 17:05:08,157 - INFO - Starting save the query results
2019-08-29 17:05:08,158 - INFO - Total Rows: 4015570
2019-08-29 17:05:08,158 - INFO - Will split into : 5.0 files
2019-08-29 17:05:12,108 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A7 Electronics Buyers_1.csv
2019-08-29 17:05:12,109 - INFO - , with total : 803114 rows
2019-08-29 17:05:16,293 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A7 Electronics Buyers_2.csv
2019-08-29 17:05:16,295 - INFO - , with total : 803114 rows
2019-08-29 17:05:20,144 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A7 Electronics Buyers_3.csv
2019-08-29 17:05:20,144 - INFO - , with total : 803114 rows
2019-08-29 17:05:23,875 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A7 Electronics Buyers_4.csv
2019-08-29 17:05:23,877 - INFO - , with total : 803114 rows
2019-08-29 17:05:27,523 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A7 Electronics Buyers_5.csv
2019-08-29 17:05:27,523 - INFO - , with total : 803114 rows
2019-08-29 17:05:27,713 - INFO - ----------------------------------
2019-08-29 17:05:27,713 - INFO - Row 2
2019-08-29 17:05:27,713 - INFO - Filename: A30 HL Buyers
2019-08-29 17:05:27,714 - INFO - Category: 'Home & Living'
2019-08-29 17:05:27,714 - INFO - Last Login: 30
2019-08-29 17:05:27,714 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-08-29 17:05:27,716 - INFO - ----------------------------------
2019-08-29 17:05:27,716 - INFO - Start Running query A30 HL Buyers
2019-08-29 17:13:58,407 - INFO - Running A30 HL Buyers Done
2019-08-29 17:13:58,408 - INFO - CSV file path: A30 HL Buyers
2019-08-29 17:13:58,654 - INFO - Starting save the query results
2019-08-29 17:13:58,655 - INFO - Total Rows: 6607666
2019-08-29 17:13:58,657 - INFO - Will split into : 7.0 files
2019-08-29 17:14:03,052 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A30 HL Buyers_1.csv
2019-08-29 17:14:03,052 - INFO - , with total : 943953 rows
2019-08-29 17:14:07,319 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A30 HL Buyers_2.csv
2019-08-29 17:14:07,321 - INFO - , with total : 943953 rows
2019-08-29 17:14:11,598 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A30 HL Buyers_3.csv
2019-08-29 17:14:11,599 - INFO - , with total : 943952 rows
2019-08-29 17:14:15,881 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A30 HL Buyers_4.csv
2019-08-29 17:14:15,881 - INFO - , with total : 943952 rows
2019-08-29 17:14:20,134 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A30 HL Buyers_5.csv
2019-08-29 17:14:20,134 - INFO - , with total : 943952 rows
2019-08-29 17:14:24,400 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A30 HL Buyers_6.csv
2019-08-29 17:14:24,401 - INFO - , with total : 943952 rows
2019-08-29 17:14:28,650 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/A30 HL Buyers_7.csv
2019-08-29 17:14:28,651 - INFO - , with total : 943952 rows
2019-08-29 17:14:30,079 - INFO - ----------------------------------
2019-08-29 17:14:30,082 - INFO - Delete all data in sheet: Case 1
2019-08-29 17:14:30,832 - INFO - No value detected on sheet: Case 2
2019-08-29 17:14:30,834 - INFO - No value detected on sheet: Case 3
2019-08-29 17:14:30,835 - INFO - No value detected on sheet: Case 4
2019-08-29 17:14:30,835 - INFO - No value detected on sheet: Case 5
2019-08-29 17:14:30,835 - INFO - No value detected on sheet: Case 6
2019-08-29 17:14:30,835 - INFO - No value detected on sheet: Case 7
2019-08-29 17:14:30,835 - INFO - No value detected on sheet: Case 8
2019-08-29 17:14:30,835 - INFO - No value detected on sheet: Case 9
2019-08-29 17:14:30,835 - INFO - Value detected - use sheet: Case 10
2019-08-29 17:14:30,835 - INFO - Reading Data From Excel...
2019-08-29 17:14:30,836 - INFO - ===================================
2019-08-29 17:14:30,836 - INFO - Get custom SQL..
2019-08-29 17:14:30,836 - INFO - USING CASE 10
2019-08-29 17:14:30,836 - INFO - ----------------------------------
2019-08-29 17:14:30,838 - INFO - Row 1
2019-08-29 17:14:30,838 - INFO - Filename: OPPO OS Followers
2019-08-29 17:14:30,838 - INFO - Shop ID: 13140292
2019-08-29 17:14:30,838 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (13140292) 
                                and status = 1
                                
2019-08-29 17:14:30,838 - INFO - ----------------------------------
2019-08-29 17:14:30,838 - INFO - Start Running query OPPO OS Followers
2019-08-29 17:14:58,890 - INFO - Running OPPO OS Followers Done
2019-08-29 17:14:58,891 - INFO - CSV file path: OPPO OS Followers
2019-08-29 17:14:58,904 - INFO - Starting save the query results
2019-08-29 17:14:58,905 - INFO - Total Rows: 365317
2019-08-29 17:14:58,905 - INFO - Will split into : 1.0 files
2019-08-29 17:15:00,559 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190829 17.02/OPPO OS Followers_1.csv
2019-08-29 17:15:00,559 - INFO - , with total : 365317 rows
2019-08-29 17:15:01,144 - INFO - ----------------------------------
2019-08-29 17:15:01,145 - INFO - Delete all data in sheet: Case 10
2019-08-29 17:15:01,789 - INFO - No value detected on sheet: Case 11
2019-08-29 17:15:01,790 - INFO - No value detected on sheet: Case 12
2019-08-29 17:15:01,793 - INFO - No value detected on sheet: Case 13
2019-08-29 17:15:01,795 - INFO - No value detected on sheet: Case 14
2019-08-29 17:15:01,796 - INFO - No value detected on sheet: Case 15
2019-08-29 17:15:01,796 - INFO - No value detected on sheet: Case 16
2019-08-29 17:15:01,796 - INFO - No value detected on sheet: Case 17
2019-08-29 17:15:01,798 - INFO - No value detected on sheet: Case 18
2019-08-30 10:00:19,359 - INFO - Report date: 20190830 10.00
2019-08-30 10:00:23,015 - INFO - ----------------------------------
2019-08-30 10:00:23,016 - INFO - Download sheet..
2019-08-30 10:00:23,016 - INFO - Change directory to script path
2019-08-30 10:00:24,244 - INFO - Spreadsheet downloaded
2019-08-30 10:00:24,244 - INFO - Opening PN Input.xlsx..
2019-08-30 10:00:24,671 - INFO - No value detected on sheet: Case 1
2019-08-30 10:00:24,671 - INFO - No value detected on sheet: Case 2
2019-08-30 10:00:24,671 - INFO - No value detected on sheet: Case 3
2019-08-30 10:00:24,674 - INFO - No value detected on sheet: Case 4
2019-08-30 10:00:24,674 - INFO - No value detected on sheet: Case 5
2019-08-30 10:00:24,674 - INFO - No value detected on sheet: Case 6
2019-08-30 10:00:24,674 - INFO - No value detected on sheet: Case 7
2019-08-30 10:00:24,676 - INFO - No value detected on sheet: Case 8
2019-08-30 10:00:24,676 - INFO - No value detected on sheet: Case 9
2019-08-30 10:00:24,681 - INFO - Value detected - use sheet: Case 10
2019-08-30 10:00:24,691 - INFO - Reading Data From Excel...
2019-08-30 10:00:24,691 - INFO - ===================================
2019-08-30 10:00:24,693 - INFO - Get custom SQL..
2019-08-30 10:00:24,693 - INFO - USING CASE 10
2019-08-30 10:00:24,693 - INFO - ----------------------------------
2019-08-30 10:00:24,694 - INFO - Row 1
2019-08-30 10:00:24,696 - INFO - Filename: purinastore OS Followers
2019-08-30 10:00:24,696 - INFO - Shop ID: 30432952
2019-08-30 10:00:24,696 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (30432952) 
                                and status = 1
                                
2019-08-30 10:00:24,697 - INFO - ----------------------------------
2019-08-30 10:00:24,697 - INFO - Start Running query purinastore OS Followers
2019-08-30 10:01:03,223 - INFO - Running purinastore OS Followers Done
2019-08-30 10:01:03,224 - INFO - CSV file path: purinastore OS Followers
2019-08-30 10:01:03,263 - INFO - Starting save the query results
2019-08-30 10:01:03,265 - INFO - Total Rows: 6509
2019-08-30 10:01:03,266 - INFO - Will split into : 1.0 files
2019-08-30 10:01:04,381 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/purinastore OS Followers_1.csv
2019-08-30 10:01:04,384 - INFO - , with total : 6509 rows
2019-08-30 10:01:04,387 - INFO - ----------------------------------
2019-08-30 10:01:04,388 - INFO - Row 2
2019-08-30 10:01:04,388 - INFO - Filename: sandika.petshop OS Followers
2019-08-30 10:01:04,388 - INFO - Shop ID: 24968126
2019-08-30 10:01:04,388 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (24968126) 
                                and status = 1
                                
2019-08-30 10:01:04,388 - INFO - ----------------------------------
2019-08-30 10:01:04,388 - INFO - Start Running query sandika.petshop OS Followers
2019-08-30 10:01:37,312 - INFO - Running sandika.petshop OS Followers Done
2019-08-30 10:01:37,315 - INFO - CSV file path: sandika.petshop OS Followers
2019-08-30 10:01:37,319 - INFO - Starting save the query results
2019-08-30 10:01:37,322 - INFO - Total Rows: 14100
2019-08-30 10:01:37,323 - INFO - Will split into : 1.0 files
2019-08-30 10:01:37,441 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/sandika.petshop OS Followers_1.csv
2019-08-30 10:01:37,441 - INFO - , with total : 14100 rows
2019-08-30 10:01:37,444 - INFO - ----------------------------------
2019-08-30 10:01:37,444 - INFO - Row 3
2019-08-30 10:01:37,444 - INFO - Filename: rrpetshop OS Followers
2019-08-30 10:01:37,444 - INFO - Shop ID: 5554543
2019-08-30 10:01:37,444 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (5554543) 
                                and status = 1
                                
2019-08-30 10:01:37,444 - INFO - ----------------------------------
2019-08-30 10:01:37,444 - INFO - Start Running query rrpetshop OS Followers
2019-08-30 10:02:20,983 - INFO - Running rrpetshop OS Followers Done
2019-08-30 10:02:20,983 - INFO - CSV file path: rrpetshop OS Followers
2019-08-30 10:02:20,984 - INFO - Starting save the query results
2019-08-30 10:02:20,986 - INFO - Total Rows: 13078
2019-08-30 10:02:20,986 - INFO - Will split into : 1.0 files
2019-08-30 10:02:21,096 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/rrpetshop OS Followers_1.csv
2019-08-30 10:02:21,098 - INFO - , with total : 13078 rows
2019-08-30 10:02:21,115 - INFO - ----------------------------------
2019-08-30 10:02:21,117 - INFO - Row 4
2019-08-30 10:02:21,117 - INFO - Filename: ciwo_catshop OS Followers
2019-08-30 10:02:21,117 - INFO - Shop ID: 6060440
2019-08-30 10:02:21,118 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (6060440) 
                                and status = 1
                                
2019-08-30 10:02:21,118 - INFO - ----------------------------------
2019-08-30 10:02:21,118 - INFO - Start Running query ciwo_catshop OS Followers
2019-08-30 10:03:15,900 - INFO - Running ciwo_catshop OS Followers Done
2019-08-30 10:03:15,901 - INFO - CSV file path: ciwo_catshop OS Followers
2019-08-30 10:03:15,903 - INFO - Starting save the query results
2019-08-30 10:03:15,903 - INFO - Total Rows: 8753
2019-08-30 10:03:15,907 - INFO - Will split into : 1.0 files
2019-08-30 10:03:16,065 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/ciwo_catshop OS Followers_1.csv
2019-08-30 10:03:16,066 - INFO - , with total : 8753 rows
2019-08-30 10:03:16,069 - INFO - ----------------------------------
2019-08-30 10:03:16,069 - INFO - Row 5
2019-08-30 10:03:16,069 - INFO - Filename: rum1234 OS Followers
2019-08-30 10:03:16,069 - INFO - Shop ID: 7099532
2019-08-30 10:03:16,069 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (7099532) 
                                and status = 1
                                
2019-08-30 10:03:16,082 - INFO - ----------------------------------
2019-08-30 10:03:16,082 - INFO - Start Running query rum1234 OS Followers
2019-08-30 10:04:19,052 - INFO - Running rum1234 OS Followers Done
2019-08-30 10:04:19,053 - INFO - CSV file path: rum1234 OS Followers
2019-08-30 10:04:19,095 - INFO - Starting save the query results
2019-08-30 10:04:19,096 - INFO - Total Rows: 7067
2019-08-30 10:04:19,098 - INFO - Will split into : 1.0 files
2019-08-30 10:04:19,242 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/rum1234 OS Followers_1.csv
2019-08-30 10:04:19,286 - INFO - , with total : 7067 rows
2019-08-30 10:04:19,292 - INFO - ----------------------------------
2019-08-30 10:04:19,293 - INFO - Row 6
2019-08-30 10:04:19,296 - INFO - Filename: cppetfood.id OS Followers
2019-08-30 10:04:19,298 - INFO - Shop ID: 25592536
2019-08-30 10:04:19,299 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (25592536) 
                                and status = 1
                                
2019-08-30 10:04:19,301 - INFO - ----------------------------------
2019-08-30 10:04:19,302 - INFO - Start Running query cppetfood.id OS Followers
2019-08-30 10:05:54,260 - INFO - Running cppetfood.id OS Followers Done
2019-08-30 10:05:54,263 - INFO - CSV file path: cppetfood.id OS Followers
2019-08-30 10:05:54,282 - INFO - Starting save the query results
2019-08-30 10:05:54,283 - INFO - Total Rows: 2383
2019-08-30 10:05:54,286 - INFO - Will split into : 1.0 files
2019-08-30 10:05:54,352 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/cppetfood.id OS Followers_1.csv
2019-08-30 10:05:54,354 - INFO - , with total : 2383 rows
2019-08-30 10:05:54,357 - INFO - ----------------------------------
2019-08-30 10:05:54,357 - INFO - Row 7
2019-08-30 10:05:54,358 - INFO - Filename: petonlineid OS Followers
2019-08-30 10:05:54,358 - INFO - Shop ID: 83528662
2019-08-30 10:05:54,358 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (83528662) 
                                and status = 1
                                
2019-08-30 10:05:54,358 - INFO - ----------------------------------
2019-08-30 10:05:54,359 - INFO - Start Running query petonlineid OS Followers
2019-08-30 10:06:53,447 - INFO - Running petonlineid OS Followers Done
2019-08-30 10:06:53,450 - INFO - CSV file path: petonlineid OS Followers
2019-08-30 10:06:53,453 - INFO - Starting save the query results
2019-08-30 10:06:53,454 - INFO - Total Rows: 728
2019-08-30 10:06:53,457 - INFO - Will split into : 1.0 files
2019-08-30 10:06:53,516 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/petonlineid OS Followers_1.csv
2019-08-30 10:06:53,516 - INFO - , with total : 728 rows
2019-08-30 10:06:53,519 - INFO - ----------------------------------
2019-08-30 10:06:53,519 - INFO - Row 8
2019-08-30 10:06:53,519 - INFO - Filename: lydiaelizabeth87 OS Followers
2019-08-30 10:06:53,519 - INFO - Shop ID: 24244860
2019-08-30 10:06:53,519 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (24244860) 
                                and status = 1
                                
2019-08-30 10:06:53,520 - INFO - ----------------------------------
2019-08-30 10:06:53,520 - INFO - Start Running query lydiaelizabeth87 OS Followers
2019-08-30 10:07:43,213 - INFO - Running lydiaelizabeth87 OS Followers Done
2019-08-30 10:07:43,214 - INFO - CSV file path: lydiaelizabeth87 OS Followers
2019-08-30 10:07:43,216 - INFO - Starting save the query results
2019-08-30 10:07:43,217 - INFO - Total Rows: 8214
2019-08-30 10:07:43,217 - INFO - Will split into : 1.0 files
2019-08-30 10:07:43,311 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/lydiaelizabeth87 OS Followers_1.csv
2019-08-30 10:07:43,312 - INFO - , with total : 8214 rows
2019-08-30 10:07:43,313 - INFO - ----------------------------------
2019-08-30 10:07:43,315 - INFO - Row 9
2019-08-30 10:07:43,315 - INFO - Filename: rcpetshop OS Followers
2019-08-30 10:07:43,316 - INFO - Shop ID: 21963285
2019-08-30 10:07:43,318 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (21963285) 
                                and status = 1
                                
2019-08-30 10:07:43,319 - INFO - ----------------------------------
2019-08-30 10:07:43,319 - INFO - Start Running query rcpetshop OS Followers
2019-08-30 10:09:35,569 - INFO - Running rcpetshop OS Followers Done
2019-08-30 10:09:35,571 - INFO - CSV file path: rcpetshop OS Followers
2019-08-30 10:09:35,575 - INFO - Starting save the query results
2019-08-30 10:09:35,576 - INFO - Total Rows: 8093
2019-08-30 10:09:35,578 - INFO - Will split into : 1.0 files
2019-08-30 10:09:35,661 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/rcpetshop OS Followers_1.csv
2019-08-30 10:09:35,663 - INFO - , with total : 8093 rows
2019-08-30 10:09:36,792 - INFO - ----------------------------------
2019-08-30 10:09:36,792 - INFO - Delete all data in sheet: Case 10
2019-08-30 10:09:37,464 - INFO - No value detected on sheet: Case 11
2019-08-30 10:09:37,466 - INFO - Value detected - use sheet: Case 12
2019-08-30 10:09:37,469 - INFO - Reading Data From Excel...
2019-08-30 10:09:37,470 - INFO - ===================================
2019-08-30 10:09:37,470 - INFO - Get custom SQL..
2019-08-30 10:09:37,470 - INFO - USING CASE 12
2019-08-30 10:09:37,470 - INFO - ----------------------------------
2019-08-30 10:09:37,470 - INFO - Row 1
2019-08-30 10:09:37,470 - INFO - Filename: A1 Users Who Haven't Buy DP
2019-08-30 10:09:37,470 - INFO - Last Login: 1
2019-08-30 10:09:37,470 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    where
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-08-30 10:09:37,471 - INFO - ----------------------------------
2019-08-30 10:09:37,471 - INFO - Start Running query A1 Users Who Haven't Buy DP
2019-08-30 10:14:26,522 - INFO - Running A1 Users Who Haven't Buy DP Done
2019-08-30 10:14:26,522 - INFO - CSV file path: A1 Users Who Haven't Buy DP
2019-08-30 10:14:26,757 - INFO - Starting save the query results
2019-08-30 10:14:26,759 - INFO - Total Rows: 6196091
2019-08-30 10:14:26,759 - INFO - Will split into : 7.0 files
2019-08-30 10:14:30,904 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/A1 Users Who Haven't Buy DP_1.csv
2019-08-30 10:14:30,905 - INFO - , with total : 885156 rows
2019-08-30 10:14:34,950 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/A1 Users Who Haven't Buy DP_2.csv
2019-08-30 10:14:34,951 - INFO - , with total : 885156 rows
2019-08-30 10:14:38,959 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/A1 Users Who Haven't Buy DP_3.csv
2019-08-30 10:14:38,960 - INFO - , with total : 885156 rows
2019-08-30 10:14:43,151 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/A1 Users Who Haven't Buy DP_4.csv
2019-08-30 10:14:43,153 - INFO - , with total : 885156 rows
2019-08-30 10:14:47,499 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/A1 Users Who Haven't Buy DP_5.csv
2019-08-30 10:14:47,500 - INFO - , with total : 885156 rows
2019-08-30 10:14:52,743 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/A1 Users Who Haven't Buy DP_6.csv
2019-08-30 10:14:52,772 - INFO - , with total : 885156 rows
2019-08-30 10:14:56,970 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 10.00/A1 Users Who Haven't Buy DP_7.csv
2019-08-30 10:14:56,970 - INFO - , with total : 885155 rows
2019-08-30 10:14:57,881 - INFO - ----------------------------------
2019-08-30 10:14:57,881 - INFO - Delete all data in sheet: Case 12
2019-08-30 10:14:58,388 - INFO - No value detected on sheet: Case 13
2019-08-30 10:14:58,390 - INFO - No value detected on sheet: Case 14
2019-08-30 10:14:58,391 - INFO - No value detected on sheet: Case 15
2019-08-30 10:14:58,391 - INFO - No value detected on sheet: Case 16
2019-08-30 10:14:58,392 - INFO - No value detected on sheet: Case 17
2019-08-30 10:14:58,392 - INFO - No value detected on sheet: Case 18
2019-08-30 14:00:02,746 - INFO - Report date: 20190830 14.00
2019-08-30 14:00:06,450 - INFO - ----------------------------------
2019-08-30 14:00:06,450 - INFO - Download sheet..
2019-08-30 14:00:06,450 - INFO - Change directory to script path
2019-08-30 14:00:07,690 - INFO - Spreadsheet downloaded
2019-08-30 14:00:07,691 - INFO - Opening PN Input.xlsx..
2019-08-30 14:00:07,921 - INFO - No value detected on sheet: Case 1
2019-08-30 14:00:07,921 - INFO - No value detected on sheet: Case 2
2019-08-30 14:00:07,921 - INFO - Value detected - use sheet: Case 3
2019-08-30 14:00:07,921 - INFO - Reading Data From Excel...
2019-08-30 14:00:07,921 - INFO - ===================================
2019-08-30 14:00:07,921 - INFO - Get custom SQL..
2019-08-30 14:00:07,921 - INFO - USING CASE 3
2019-08-30 14:00:07,921 - INFO - ----------------------------------
2019-08-30 14:00:07,921 - INFO - Row 1
2019-08-30 14:00:07,923 - INFO - Filename: A30 EL haven't purchased in past 30 days
2019-08-30 14:00:07,923 - INFO - Category: 'Electronics','Mobile & Accessories','Computer & Accessories','Photography'
2019-08-30 14:00:07,923 - INFO - Last Login: 30
2019-08-30 14:00:07,923 - INFO - Date 1: 2019-06-09
2019-08-30 14:00:07,924 - INFO - Date 2: 2019-08-25
2019-08-30 14:00:07,924 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-06-09' and date'2019-08-25'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-30 14:00:07,924 - INFO - ----------------------------------
2019-08-30 14:00:07,924 - INFO - Start Running query A30 EL haven't purchased in past 30 days
2019-08-30 14:01:28,308 - INFO - Running A30 EL haven't purchased in past 30 days Done
2019-08-30 14:01:28,309 - INFO - CSV file path: A30 EL haven't purchased in past 30 days
2019-08-30 14:01:28,368 - INFO - Starting save the query results
2019-08-30 14:01:28,368 - INFO - Total Rows: 1639335
2019-08-30 14:01:28,369 - INFO - Will split into : 2.0 files
2019-08-30 14:01:32,128 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 14.00/A30 EL haven't purchased in past 30 days_1.csv
2019-08-30 14:01:32,130 - INFO - , with total : 819668 rows
2019-08-30 14:01:35,865 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 14.00/A30 EL haven't purchased in past 30 days_2.csv
2019-08-30 14:01:35,865 - INFO - , with total : 819667 rows
2019-08-30 14:01:36,785 - INFO - ----------------------------------
2019-08-30 14:01:36,786 - INFO - Delete all data in sheet: Case 3
2019-08-30 14:01:37,397 - INFO - No value detected on sheet: Case 4
2019-08-30 14:01:37,398 - INFO - No value detected on sheet: Case 5
2019-08-30 14:01:37,401 - INFO - No value detected on sheet: Case 6
2019-08-30 14:01:37,401 - INFO - No value detected on sheet: Case 7
2019-08-30 14:01:37,401 - INFO - No value detected on sheet: Case 8
2019-08-30 14:01:37,401 - INFO - No value detected on sheet: Case 9
2019-08-30 14:01:37,403 - INFO - Value detected - use sheet: Case 10
2019-08-30 14:01:37,403 - INFO - Reading Data From Excel...
2019-08-30 14:01:37,404 - INFO - ===================================
2019-08-30 14:01:37,404 - INFO - Get custom SQL..
2019-08-30 14:01:37,404 - INFO - USING CASE 10
2019-08-30 14:01:37,404 - INFO - ----------------------------------
2019-08-30 14:01:37,404 - INFO - Row 1
2019-08-30 14:01:37,404 - INFO - Filename: Nivea OS Followers
2019-08-30 14:01:37,404 - INFO - Shop ID: 39283823
2019-08-30 14:01:37,404 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (39283823) 
                                and status = 1
                                
2019-08-30 14:01:37,405 - INFO - ----------------------------------
2019-08-30 14:01:37,405 - INFO - Start Running query Nivea OS Followers
2019-08-30 14:01:59,431 - INFO - Running Nivea OS Followers Done
2019-08-30 14:01:59,434 - INFO - CSV file path: Nivea OS Followers
2019-08-30 14:01:59,441 - INFO - Starting save the query results
2019-08-30 14:01:59,443 - INFO - Total Rows: 210696
2019-08-30 14:01:59,444 - INFO - Will split into : 1.0 files
2019-08-30 14:02:00,421 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190830 14.00/Nivea OS Followers_1.csv
2019-08-30 14:02:00,421 - INFO - , with total : 210696 rows
2019-08-30 14:02:00,855 - INFO - ----------------------------------
2019-08-30 14:02:00,855 - INFO - Delete all data in sheet: Case 10
2019-08-30 14:02:01,354 - INFO - No value detected on sheet: Case 11
2019-08-30 14:02:01,355 - INFO - No value detected on sheet: Case 12
2019-08-30 14:02:01,358 - INFO - No value detected on sheet: Case 13
2019-08-30 14:02:01,358 - INFO - No value detected on sheet: Case 14
2019-08-30 14:02:01,361 - INFO - No value detected on sheet: Case 15
2019-08-30 14:02:01,361 - INFO - No value detected on sheet: Case 16
2019-08-30 14:02:01,362 - INFO - No value detected on sheet: Case 17
2019-08-30 14:02:01,364 - INFO - No value detected on sheet: Case 18
2019-08-30 17:00:02,298 - INFO - Report date: 20190830 17.00
2019-08-30 17:00:06,243 - INFO - ----------------------------------
2019-08-30 17:00:06,243 - INFO - Download sheet..
2019-08-30 17:00:06,243 - INFO - Change directory to script path
2019-08-30 17:00:08,490 - INFO - Spreadsheet downloaded
2019-08-30 17:00:08,493 - INFO - Opening PN Input.xlsx..
2019-08-30 17:00:08,713 - INFO - No value detected on sheet: Case 1
2019-08-30 17:00:08,713 - INFO - No value detected on sheet: Case 2
2019-08-30 17:00:08,713 - INFO - No value detected on sheet: Case 3
2019-08-30 17:00:08,713 - INFO - No value detected on sheet: Case 4
2019-08-30 17:00:08,713 - INFO - No value detected on sheet: Case 5
2019-08-30 17:00:08,713 - INFO - No value detected on sheet: Case 6
2019-08-30 17:00:08,714 - INFO - No value detected on sheet: Case 7
2019-08-30 17:00:08,714 - INFO - No value detected on sheet: Case 8
2019-08-30 17:00:08,714 - INFO - No value detected on sheet: Case 9
2019-08-30 17:00:08,714 - INFO - No value detected on sheet: Case 10
2019-08-30 17:00:08,716 - INFO - No value detected on sheet: Case 11
2019-08-30 17:00:08,716 - INFO - No value detected on sheet: Case 12
2019-08-30 17:00:08,716 - INFO - No value detected on sheet: Case 13
2019-08-30 17:00:08,716 - INFO - No value detected on sheet: Case 14
2019-08-30 17:00:08,717 - INFO - No value detected on sheet: Case 15
2019-08-30 17:00:08,717 - INFO - No value detected on sheet: Case 16
2019-08-30 17:00:08,717 - INFO - No value detected on sheet: Case 17
2019-08-30 17:00:08,717 - INFO - No value detected on sheet: Case 18
2019-08-31 10:00:53,408 - INFO - Report date: 20190831 10.00
2019-08-31 10:01:01,638 - INFO - ----------------------------------
2019-08-31 10:01:01,638 - INFO - Download sheet..
2019-08-31 10:01:01,640 - INFO - Change directory to script path
2019-08-31 10:01:03,332 - INFO - Spreadsheet downloaded
2019-08-31 10:01:03,332 - INFO - Opening PN Input.xlsx..
2019-08-31 10:01:03,808 - INFO - No value detected on sheet: Case 1
2019-08-31 10:01:03,808 - INFO - No value detected on sheet: Case 2
2019-08-31 10:01:03,808 - INFO - Value detected - use sheet: Case 3
2019-08-31 10:01:03,808 - INFO - Reading Data From Excel...
2019-08-31 10:01:03,809 - INFO - ===================================
2019-08-31 10:01:03,809 - INFO - Get custom SQL..
2019-08-31 10:01:03,809 - INFO - USING CASE 3
2019-08-31 10:01:03,809 - INFO - ----------------------------------
2019-08-31 10:01:03,809 - INFO - Row 1
2019-08-31 10:01:03,809 - INFO - Filename: A30 EL haven't purchased in past 30 days
2019-08-31 10:01:03,809 - INFO - Category: 'Electronics','Mobile & Accessories','Computer & Accessories','Photography'
2019-08-31 10:01:03,809 - INFO - Last Login: 30
2019-08-31 10:01:03,811 - INFO - Date 1: 2019-05-02
2019-08-31 10:01:03,811 - INFO - Date 2: 2019-08-25
2019-08-31 10:01:03,811 - INFO - Query:
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics','Mobile & Accessories','Computer & Accessories','Photography')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped for the last 30 days
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where grass_date between date'2019-05-02' and date'2019-08-25'
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-08-31 10:01:03,812 - INFO - ----------------------------------
2019-08-31 10:01:03,812 - INFO - Start Running query A30 EL haven't purchased in past 30 days
2019-08-31 10:03:15,805 - INFO - Running A30 EL haven't purchased in past 30 days Done
2019-08-31 10:03:15,805 - INFO - CSV file path: A30 EL haven't purchased in past 30 days
2019-08-31 10:03:15,848 - INFO - Starting save the query results
2019-08-31 10:03:15,848 - INFO - Total Rows: 1065678
2019-08-31 10:03:15,848 - INFO - Will split into : 2.0 files
2019-08-31 10:03:18,411 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190831 10.00/A30 EL haven't purchased in past 30 days_1.csv
2019-08-31 10:03:18,413 - INFO - , with total : 532839 rows
2019-08-31 10:03:21,017 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190831 10.00/A30 EL haven't purchased in past 30 days_2.csv
2019-08-31 10:03:21,019 - INFO - , with total : 532839 rows
2019-08-31 10:03:22,108 - INFO - ----------------------------------
2019-08-31 10:03:22,108 - INFO - Delete all data in sheet: Case 3
2019-08-31 10:03:22,609 - INFO - No value detected on sheet: Case 4
2019-08-31 10:03:22,611 - INFO - No value detected on sheet: Case 5
2019-08-31 10:03:22,611 - INFO - No value detected on sheet: Case 6
2019-08-31 10:03:22,611 - INFO - No value detected on sheet: Case 7
2019-08-31 10:03:22,611 - INFO - No value detected on sheet: Case 8
2019-08-31 10:03:22,611 - INFO - No value detected on sheet: Case 9
2019-08-31 10:03:22,612 - INFO - No value detected on sheet: Case 10
2019-08-31 10:03:22,612 - INFO - No value detected on sheet: Case 11
2019-08-31 10:03:22,614 - INFO - No value detected on sheet: Case 12
2019-08-31 10:03:22,614 - INFO - No value detected on sheet: Case 13
2019-08-31 10:03:22,614 - INFO - No value detected on sheet: Case 14
2019-08-31 10:03:22,615 - INFO - No value detected on sheet: Case 15
2019-08-31 10:03:22,615 - INFO - No value detected on sheet: Case 16
2019-08-31 10:03:22,615 - INFO - No value detected on sheet: Case 17
2019-08-31 10:03:22,615 - INFO - No value detected on sheet: Case 18
2019-08-31 14:00:02,201 - INFO - Report date: 20190831 14.00
2019-08-31 14:00:06,601 - INFO - ----------------------------------
2019-08-31 14:00:06,602 - INFO - Download sheet..
2019-08-31 14:00:06,602 - INFO - Change directory to script path
2019-08-31 14:00:08,895 - INFO - Spreadsheet downloaded
2019-08-31 14:00:08,897 - INFO - Opening PN Input.xlsx..
2019-08-31 14:00:09,131 - INFO - No value detected on sheet: Case 1
2019-08-31 14:00:09,131 - INFO - No value detected on sheet: Case 2
2019-08-31 14:00:09,131 - INFO - No value detected on sheet: Case 3
2019-08-31 14:00:09,131 - INFO - No value detected on sheet: Case 4
2019-08-31 14:00:09,132 - INFO - No value detected on sheet: Case 5
2019-08-31 14:00:09,132 - INFO - No value detected on sheet: Case 6
2019-08-31 14:00:09,132 - INFO - No value detected on sheet: Case 7
2019-08-31 14:00:09,134 - INFO - No value detected on sheet: Case 8
2019-08-31 14:00:09,134 - INFO - No value detected on sheet: Case 9
2019-08-31 14:00:09,134 - INFO - No value detected on sheet: Case 10
2019-08-31 14:00:09,134 - INFO - No value detected on sheet: Case 11
2019-08-31 14:00:09,134 - INFO - No value detected on sheet: Case 12
2019-08-31 14:00:09,134 - INFO - No value detected on sheet: Case 13
2019-08-31 14:00:09,134 - INFO - No value detected on sheet: Case 14
2019-08-31 14:00:09,135 - INFO - No value detected on sheet: Case 15
2019-08-31 14:00:09,135 - INFO - No value detected on sheet: Case 16
2019-08-31 14:00:09,135 - INFO - No value detected on sheet: Case 17
2019-08-31 14:00:09,135 - INFO - No value detected on sheet: Case 18
2019-08-31 17:00:02,397 - INFO - Report date: 20190831 17.00
2019-08-31 17:00:06,296 - INFO - ----------------------------------
2019-08-31 17:00:06,296 - INFO - Download sheet..
2019-08-31 17:00:06,298 - INFO - Change directory to script path
2019-08-31 17:00:08,871 - INFO - Spreadsheet downloaded
2019-08-31 17:00:08,874 - INFO - Opening PN Input.xlsx..
2019-08-31 17:00:09,112 - INFO - No value detected on sheet: Case 1
2019-08-31 17:00:09,114 - INFO - No value detected on sheet: Case 2
2019-08-31 17:00:09,114 - INFO - No value detected on sheet: Case 3
2019-08-31 17:00:09,114 - INFO - No value detected on sheet: Case 4
2019-08-31 17:00:09,114 - INFO - No value detected on sheet: Case 5
2019-08-31 17:00:09,115 - INFO - No value detected on sheet: Case 6
2019-08-31 17:00:09,115 - INFO - No value detected on sheet: Case 7
2019-08-31 17:00:09,115 - INFO - No value detected on sheet: Case 8
2019-08-31 17:00:09,115 - INFO - No value detected on sheet: Case 9
2019-08-31 17:00:09,115 - INFO - No value detected on sheet: Case 10
2019-08-31 17:00:09,115 - INFO - No value detected on sheet: Case 11
2019-08-31 17:00:09,115 - INFO - No value detected on sheet: Case 12
2019-08-31 17:00:09,115 - INFO - No value detected on sheet: Case 13
2019-08-31 17:00:09,115 - INFO - No value detected on sheet: Case 14
2019-08-31 17:00:09,117 - INFO - No value detected on sheet: Case 15
2019-08-31 17:00:09,117 - INFO - No value detected on sheet: Case 16
2019-08-31 17:00:09,117 - INFO - No value detected on sheet: Case 17
2019-08-31 17:00:09,117 - INFO - No value detected on sheet: Case 18
2019-09-01 10:00:03,776 - INFO - Report date: 20190901 10.00
2019-09-01 14:00:02,292 - INFO - Report date: 20190901 14.00
2019-09-01 17:00:02,329 - INFO - Report date: 20190901 17.00
2019-09-02 10:00:08,213 - INFO - Report date: 20190902 10.00
2019-09-02 11:54:22,621 - INFO - Report date: 20190902 11.54
2019-09-02 11:54:23,667 - INFO - Connect to Google Drive successful
2019-09-02 11:54:23,753 - INFO - Download gsheet failed
2019-09-02 11:54:23,756 - INFO - Error in downloading sheet -> global name 'drive' is not defined
2019-09-02 11:54:23,759 - INFO - Start sending...
2019-09-02 11:54:32,163 - INFO - Notification sent successfully
2019-09-02 11:54:32,164 - INFO - Opening PN Input 20190902 11.54.xlsx..
2019-09-02 11:55:57,391 - INFO - Report date: 20190902 11.55
2019-09-02 11:55:58,595 - INFO - Connect to Google Drive successful
2019-09-02 11:55:58,618 - INFO - Download gsheet failed
2019-09-02 11:55:58,618 - INFO - Error in downloading sheet -> global name 'drive' is not defined
2019-09-02 11:55:58,618 - INFO - Start sending...
2019-09-02 11:56:06,956 - INFO - Notification sent successfully
2019-09-02 11:56:06,957 - INFO - Opening PN Input 20190902 11.55.xlsx..
2019-09-02 11:58:23,413 - INFO - Report date: 20190902 11.58
2019-09-02 11:58:24,549 - INFO - Connect to Google Drive successful
2019-09-02 11:58:24,743 - INFO - Connect to Google Drive successful
2019-09-02 11:58:26,546 - INFO - Connect to Google Drive successful
2019-09-02 11:58:27,039 - INFO - ----------------------------------
2019-09-02 11:58:27,039 - INFO - Download sheet..
2019-09-02 11:58:27,040 - INFO - Change directory to script path
2019-09-02 11:58:27,201 - INFO - Download gsheet failed
2019-09-02 11:58:27,203 - INFO - Error in downloading sheet -> [Errno 2] No such file or directory: '\\PN Input 20190902 11.58.xlsx'
2019-09-02 11:58:27,203 - INFO - Start sending...
2019-09-02 11:58:36,848 - INFO - Notification sent successfully
2019-09-02 11:58:36,848 - INFO - Opening PN Input 20190902 11.58.xlsx..
2019-09-02 12:00:42,865 - INFO - Report date: 20190902 12.00
2019-09-02 12:00:43,786 - INFO - Connect to Google Drive successful
2019-09-02 12:00:43,974 - INFO - Connect to Google Drive successful
2019-09-02 12:00:45,700 - INFO - Connect to Google Drive successful
2019-09-02 12:00:46,500 - INFO - ----------------------------------
2019-09-02 12:00:46,500 - INFO - Download sheet..
2019-09-02 12:00:46,502 - INFO - Change directory to script path
2019-09-02 12:00:47,657 - INFO - Spreadsheet downloaded
2019-09-02 12:00:47,793 - INFO - Connect to Google Drive successful
2019-09-02 12:00:47,796 - INFO - Download gsheet failed
2019-09-02 12:00:47,798 - INFO - Error in downloading sheet -> global name 'parent_folder' is not defined
2019-09-02 12:00:47,808 - INFO - Start sending...
2019-09-02 12:00:56,332 - INFO - Notification sent successfully
2019-09-02 12:00:56,332 - INFO - Opening PN Input 20190902 12.00.xlsx..
2019-09-02 12:00:57,180 - INFO - Value detected - use sheet: Case 1
2019-09-02 12:00:57,181 - INFO - Reading Data From Excel...
2019-09-02 12:00:57,183 - INFO - ===================================
2019-09-02 12:00:57,184 - INFO - Get custom SQL..
2019-09-02 12:00:57,184 - INFO - USING CASE 1
2019-09-02 12:00:57,186 - INFO - ----------------------------------
2019-09-02 12:00:57,187 - INFO - Row 1
2019-09-02 12:00:57,188 - INFO - Filename: A1 lele buyers
2019-09-02 12:00:57,190 - INFO - Category: 'Electronics'
2019-09-02 12:00:57,191 - INFO - Last Login: 1
2019-09-02 12:00:57,193 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-09-02 12:00:57,197 - INFO - ----------------------------------
2019-09-02 12:00:57,200 - INFO - Start Running query A1 lele buyers
2019-09-02 12:07:25,444 - INFO - Report date: 20190902 12.07
2019-09-02 12:07:26,640 - INFO - Connect to Google Drive successful
2019-09-02 12:07:26,823 - INFO - Connect to Google Drive successful
2019-09-02 12:07:29,352 - INFO - Connect to Google Drive successful
2019-09-02 12:07:30,188 - INFO - ----------------------------------
2019-09-02 12:07:30,190 - INFO - Download sheet..
2019-09-02 12:07:30,190 - INFO - Change directory to script path
2019-09-02 12:07:31,365 - INFO - Spreadsheet downloaded
2019-09-02 12:07:31,519 - INFO - Connect to Google Drive successful
2019-09-02 12:07:31,522 - INFO - Download gsheet failed
2019-09-02 12:07:31,525 - INFO - Error in downloading sheet -> global name 'list_parent_folder' is not defined
2019-09-02 12:07:31,526 - INFO - Start sending...
2019-09-02 12:07:40,408 - INFO - Notification sent successfully
2019-09-02 12:07:40,438 - INFO - Opening PN Input 20190902 12.07.xlsx..
2019-09-02 12:07:41,319 - INFO - Value detected - use sheet: Case 1
2019-09-02 12:07:41,319 - INFO - Reading Data From Excel...
2019-09-02 12:07:41,319 - INFO - ===================================
2019-09-02 12:07:41,321 - INFO - Get custom SQL..
2019-09-02 12:07:41,322 - INFO - USING CASE 1
2019-09-02 12:07:41,322 - INFO - ----------------------------------
2019-09-02 12:07:41,323 - INFO - Row 1
2019-09-02 12:07:41,325 - INFO - Filename: A1 lele buyers
2019-09-02 12:07:41,325 - INFO - Category: 'Electronics'
2019-09-02 12:07:41,325 - INFO - Last Login: 1
2019-09-02 12:07:41,326 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Electronics')
                                    and
                                    last_login >= current_date - interval '1' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-09-02 12:07:41,328 - INFO - ----------------------------------
2019-09-02 12:07:41,332 - INFO - Start Running query A1 lele buyers
2019-09-02 12:09:15,279 - INFO - Running A1 lele buyers Done
2019-09-02 12:09:15,279 - INFO - CSV file path: A1 lele buyers
2019-09-02 12:09:15,482 - INFO - Starting save the query results
2019-09-02 12:09:15,483 - INFO - Total Rows: 2479208
2019-09-02 12:09:15,483 - INFO - Will split into : 3.0 files
2019-09-02 12:09:15,484 - INFO - Error in run_csv_sql -> global name 'list_parent_folder' is not defined
2019-09-02 12:09:15,484 - INFO - Start sending...
2019-09-02 12:09:23,009 - INFO - Notification sent successfully
2019-09-02 12:09:24,382 - INFO - ----------------------------------
2019-09-02 12:09:24,384 - INFO - Delete all data in sheet: Case 1
2019-09-02 12:09:24,809 - INFO - No value detected on sheet: Case 2
2019-09-02 12:09:24,811 - INFO - No value detected on sheet: Case 3
2019-09-02 12:09:24,812 - INFO - No value detected on sheet: Case 4
2019-09-02 12:09:24,812 - INFO - No value detected on sheet: Case 5
2019-09-02 12:09:24,812 - INFO - No value detected on sheet: Case 6
2019-09-02 12:09:24,813 - INFO - No value detected on sheet: Case 7
2019-09-02 12:09:24,815 - INFO - No value detected on sheet: Case 8
2019-09-02 12:09:24,815 - INFO - No value detected on sheet: Case 9
2019-09-02 12:09:24,815 - INFO - No value detected on sheet: Case 10
2019-09-02 12:09:24,816 - INFO - No value detected on sheet: Case 11
2019-09-02 12:09:24,818 - INFO - No value detected on sheet: Case 12
2019-09-02 12:09:24,818 - INFO - No value detected on sheet: Case 13
2019-09-02 12:09:24,819 - INFO - No value detected on sheet: Case 14
2019-09-02 12:09:24,821 - INFO - No value detected on sheet: Case 15
2019-09-02 12:09:24,822 - INFO - No value detected on sheet: Case 16
2019-09-02 14:00:04,693 - INFO - Report date: 20190902 14.00
2019-09-02 14:38:15,112 - INFO - Report date: 20190902 14.38
2019-09-02 14:42:46,654 - INFO - Report date: 20190902 14.42
2019-09-02 14:35:10,815 - INFO - Report date: 20190902 14.35
2019-09-02 14:35:12,483 - INFO - ----------------------------------
2019-09-02 14:35:12,483 - INFO - Download sheet..
2019-09-02 14:35:12,483 - INFO - Change directory to script path
2019-09-02 14:35:14,707 - INFO - Spreadsheet downloaded
2019-09-02 14:35:14,709 - INFO - Opening PN Input.xlsx..
2019-09-02 14:35:15,522 - INFO - Value detected - use sheet: Case 1
2019-09-02 14:35:15,523 - INFO - Reading Data From Excel...
2019-09-02 14:35:15,523 - INFO - ===================================
2019-09-02 14:35:15,523 - INFO - Get custom SQL..
2019-09-02 14:35:15,523 - INFO - USING CASE 1
2019-09-02 14:35:15,525 - INFO - ----------------------------------
2019-09-02 14:35:15,525 - INFO - Row 1
2019-09-02 14:35:15,526 - INFO - Filename: A30 HL, Hobby & Collection Buyers
2019-09-02 14:35:15,526 - INFO - Category: 'Home & Living','Hobby & Collection'
2019-09-02 14:35:15,526 - INFO - Last Login: 30
2019-09-02 14:35:15,528 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living','Hobby & Collection')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-09-02 14:35:15,529 - INFO - ----------------------------------
2019-09-02 14:35:15,529 - INFO - Start Running query A30 HL, Hobby & Collection Buyers
2019-09-02 14:40:03,736 - INFO - Running A30 HL, Hobby & Collection Buyers Done
2019-09-02 14:40:03,740 - INFO - CSV file path: A30 HL, Hobby & Collection Buyers
2019-09-02 14:40:04,357 - INFO - Starting save the query results
2019-09-02 14:40:04,358 - INFO - Total Rows: 7320729
2019-09-02 14:40:04,358 - INFO - Will split into : 8.0 files
2019-09-02 14:40:09,601 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 HL, Hobby & Collection Buyers_1.csv
2019-09-02 14:40:09,602 - INFO - , with total : 915092 rows
2019-09-02 14:40:14,711 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 HL, Hobby & Collection Buyers_2.csv
2019-09-02 14:40:14,713 - INFO - , with total : 915091 rows
2019-09-02 14:40:20,203 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 HL, Hobby & Collection Buyers_3.csv
2019-09-02 14:40:20,204 - INFO - , with total : 915091 rows
2019-09-02 14:40:26,045 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 HL, Hobby & Collection Buyers_4.csv
2019-09-02 14:40:26,046 - INFO - , with total : 915091 rows
2019-09-02 14:40:32,628 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 HL, Hobby & Collection Buyers_5.csv
2019-09-02 14:40:32,631 - INFO - , with total : 915091 rows
2019-09-02 14:40:38,819 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 HL, Hobby & Collection Buyers_6.csv
2019-09-02 14:40:38,821 - INFO - , with total : 915091 rows
2019-09-02 14:40:44,565 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 HL, Hobby & Collection Buyers_7.csv
2019-09-02 14:40:44,565 - INFO - , with total : 915091 rows
2019-09-02 14:40:52,480 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 HL, Hobby & Collection Buyers_8.csv
2019-09-02 14:40:52,480 - INFO - , with total : 915091 rows
2019-09-02 14:40:52,937 - INFO - ----------------------------------
2019-09-02 14:40:52,937 - INFO - Row 2
2019-09-02 14:40:52,938 - INFO - Filename: A30 Fashion & FACC Buyers
2019-09-02 14:40:52,940 - INFO - Category: 'Fashion','Fashion Accessories'
2019-09-02 14:40:52,940 - INFO - Last Login: 30
2019-09-02 14:40:52,941 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Fashion','Fashion Accessories')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-09-02 14:40:52,944 - INFO - ----------------------------------
2019-09-02 14:40:52,944 - INFO - Start Running query A30 Fashion & FACC Buyers
2019-09-02 14:44:02,716 - INFO - Running A30 Fashion & FACC Buyers Done
2019-09-02 14:44:02,717 - INFO - CSV file path: A30 Fashion & FACC Buyers
2019-09-02 14:44:03,078 - INFO - Starting save the query results
2019-09-02 14:44:03,079 - INFO - Total Rows: 4728654
2019-09-02 14:44:03,081 - INFO - Will split into : 5.0 files
2019-09-02 14:44:08,203 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Fashion & FACC Buyers_1.csv
2019-09-02 14:44:08,203 - INFO - , with total : 945731 rows
2019-09-02 14:44:13,348 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Fashion & FACC Buyers_2.csv
2019-09-02 14:44:13,348 - INFO - , with total : 945731 rows
2019-09-02 14:44:18,392 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Fashion & FACC Buyers_3.csv
2019-09-02 14:44:18,394 - INFO - , with total : 945731 rows
2019-09-02 14:44:23,848 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Fashion & FACC Buyers_4.csv
2019-09-02 14:44:23,848 - INFO - , with total : 945731 rows
2019-09-02 14:44:30,171 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Fashion & FACC Buyers_5.csv
2019-09-02 14:44:30,173 - INFO - , with total : 945730 rows
2019-09-02 14:44:30,444 - INFO - Error in run_custom_sql() -> invalid literal for int() with base 10: 'All time'
2019-09-02 14:44:30,444 - INFO - Start sending...
2019-09-02 14:44:39,305 - INFO - Notification sent successfully
2019-09-02 14:44:41,161 - INFO - ----------------------------------
2019-09-02 14:44:41,161 - INFO - Delete all data in sheet: Case 1
2019-09-02 14:44:41,915 - INFO - No value detected on sheet: Case 2
2019-09-02 14:44:41,917 - INFO - No value detected on sheet: Case 3
2019-09-02 14:44:41,917 - INFO - Value detected - use sheet: Case 4
2019-09-02 14:44:41,918 - INFO - Reading Data From Excel...
2019-09-02 14:44:41,921 - INFO - ===================================
2019-09-02 14:44:41,921 - INFO - Get custom SQL..
2019-09-02 14:44:41,923 - INFO - USING CASE 4
2019-09-02 14:44:41,927 - INFO - ----------------------------------
2019-09-02 14:44:41,927 - INFO - Row 1
2019-09-02 14:44:41,928 - INFO - Filename: A30 Beauty buyers who haven't shopped F&B
2019-09-02 14:44:41,930 - INFO - Category: 'Beauty'
2019-09-02 14:44:41,930 - INFO - Last Login: 30
2019-09-02 14:44:41,930 - INFO - Category(Haven't shopped): 'Food & Beverages'
2019-09-02 14:44:41,931 - INFO - Query:
                                with a as (
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Beauty')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped certain category
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where 
                                main_category in ('Food & Beverages')
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-09-02 14:44:41,934 - INFO - ----------------------------------
2019-09-02 14:44:41,934 - INFO - Start Running query A30 Beauty buyers who haven't shopped F&B
2019-09-02 14:47:44,428 - INFO - Running A30 Beauty buyers who haven't shopped F&B Done
2019-09-02 14:47:44,430 - INFO - CSV file path: A30 Beauty buyers who haven't shopped F&B
2019-09-02 14:47:44,871 - INFO - Starting save the query results
2019-09-02 14:47:44,871 - INFO - Total Rows: 5281083
2019-09-02 14:47:44,871 - INFO - Will split into : 6.0 files
2019-09-02 14:47:49,783 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Beauty buyers who haven't shopped F&B_1.csv
2019-09-02 14:47:49,785 - INFO - , with total : 880181 rows
2019-09-02 14:47:54,592 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Beauty buyers who haven't shopped F&B_2.csv
2019-09-02 14:47:54,594 - INFO - , with total : 880181 rows
2019-09-02 14:47:59,811 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Beauty buyers who haven't shopped F&B_3.csv
2019-09-02 14:47:59,812 - INFO - , with total : 880181 rows
2019-09-02 14:48:05,292 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Beauty buyers who haven't shopped F&B_4.csv
2019-09-02 14:48:05,292 - INFO - , with total : 880180 rows
2019-09-02 14:48:10,937 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Beauty buyers who haven't shopped F&B_5.csv
2019-09-02 14:48:10,937 - INFO - , with total : 880180 rows
2019-09-02 14:48:16,198 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Beauty buyers who haven't shopped F&B_6.csv
2019-09-02 14:48:16,200 - INFO - , with total : 880180 rows
2019-09-02 14:48:16,499 - INFO - ----------------------------------
2019-09-02 14:48:16,500 - INFO - Row 2
2019-09-02 14:48:16,500 - INFO - Filename: A30 Home & Living buyers who haven't shopped F&B
2019-09-02 14:48:16,500 - INFO - Category: 'Home & Living'
2019-09-02 14:48:16,503 - INFO - Last Login: 30
2019-09-02 14:48:16,503 - INFO - Category(Haven't shopped): 'Food & Beverages'
2019-09-02 14:48:16,503 - INFO - Query:
                                with a as (
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.main_category in ('Home & Living')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    is_buyer = 1
                                ),

                                --shopped certain category
                                b as
                                (
                                select distinct
                                userid
                                from order_mart__order_item_profile
                                where 
                                main_category in ('Food & Beverages')
                                )

                                --final
                                select distinct
                                concat('user_id=',cast(a.userid as varchar)) list_userid
                                from a
                                left join b
                                on a.userid = b.userid
                                where b.userid is null
                                
2019-09-02 14:48:16,506 - INFO - ----------------------------------
2019-09-02 14:48:16,506 - INFO - Start Running query A30 Home & Living buyers who haven't shopped F&B
2019-09-02 14:51:15,335 - INFO - Running A30 Home & Living buyers who haven't shopped F&B Done
2019-09-02 14:51:15,336 - INFO - CSV file path: A30 Home & Living buyers who haven't shopped F&B
2019-09-02 14:51:15,660 - INFO - Starting save the query results
2019-09-02 14:51:15,661 - INFO - Total Rows: 4323731
2019-09-02 14:51:15,661 - INFO - Will split into : 5.0 files
2019-09-02 14:51:20,736 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Home & Living buyers who haven't shopped F&B_1.csv
2019-09-02 14:51:20,736 - INFO - , with total : 864747 rows
2019-09-02 14:51:25,943 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Home & Living buyers who haven't shopped F&B_2.csv
2019-09-02 14:51:25,944 - INFO - , with total : 864746 rows
2019-09-02 14:51:31,242 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Home & Living buyers who haven't shopped F&B_3.csv
2019-09-02 14:51:31,242 - INFO - , with total : 864746 rows
2019-09-02 14:51:37,936 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Home & Living buyers who haven't shopped F&B_4.csv
2019-09-02 14:51:37,937 - INFO - , with total : 864746 rows
2019-09-02 14:51:43,299 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 Home & Living buyers who haven't shopped F&B_5.csv
2019-09-02 14:51:43,301 - INFO - , with total : 864746 rows
2019-09-02 14:51:45,082 - INFO - ----------------------------------
2019-09-02 14:51:45,084 - INFO - Delete all data in sheet: Case 4
2019-09-02 14:51:45,911 - INFO - No value detected on sheet: Case 5
2019-09-02 14:51:45,913 - INFO - No value detected on sheet: Case 6
2019-09-02 14:51:45,914 - INFO - No value detected on sheet: Case 7
2019-09-02 14:51:45,915 - INFO - Value detected - use sheet: Case 8
2019-09-02 14:51:45,917 - INFO - Reading Data From Excel...
2019-09-02 14:51:45,917 - INFO - ===================================
2019-09-02 14:51:45,917 - INFO - Get custom SQL..
2019-09-02 14:51:45,920 - INFO - USING CASE 8
2019-09-02 14:51:45,921 - INFO - ----------------------------------
2019-09-02 14:51:45,924 - INFO - Row 1
2019-09-02 14:51:45,926 - INFO - Filename: Brand Festival 4 Sep
2019-09-02 14:51:45,927 - INFO - Sub-category: 'Women Bags','Women Clothes','Women Shoes','Baby & Kids Fashion'
2019-09-02 14:51:45,928 - INFO - Last Login: 30
2019-09-02 14:51:45,930 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Women Bags','Women Clothes','Women Shoes','Baby & Kids Fashion')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-09-02 14:51:45,931 - INFO - ----------------------------------
2019-09-02 14:51:45,933 - INFO - Start Running query Brand Festival 4 Sep
2019-09-02 14:52:13,576 - INFO - Running Brand Festival 4 Sep Done
2019-09-02 14:52:13,578 - INFO - CSV file path: Brand Festival 4 Sep
2019-09-02 14:52:13,614 - INFO - Starting save the query results
2019-09-02 14:52:13,615 - INFO - Total Rows: 0
2019-09-02 14:52:13,618 - INFO - Will split into : 0.0 files
2019-09-02 14:52:13,628 - INFO - Mismatched Input! - Write to txt file successful
2019-09-02 14:52:13,630 - INFO - Error in run_csv_sql -> number sections must be larger than 0.
2019-09-02 14:52:13,631 - INFO - Start sending...
2019-09-02 14:52:21,832 - INFO - Notification sent successfully
2019-09-02 14:52:22,260 - INFO - ----------------------------------
2019-09-02 14:52:22,262 - INFO - Delete all data in sheet: Case 8
2019-09-02 14:52:22,734 - INFO - No value detected on sheet: Case 9
2019-09-02 14:52:22,736 - INFO - No value detected on sheet: Case 10
2019-09-02 14:52:22,736 - INFO - Value detected - use sheet: Case 11
2019-09-02 14:52:22,737 - INFO - Reading Data From Excel...
2019-09-02 14:52:22,739 - INFO - ===================================
2019-09-02 14:52:22,740 - INFO - Get custom SQL..
2019-09-02 14:52:22,740 - INFO - USING CASE 11
2019-09-02 14:52:22,740 - INFO - ----------------------------------
2019-09-02 14:52:22,742 - INFO - Row 1
2019-09-02 14:52:22,743 - INFO - Filename: A30 DP buyers
2019-09-02 14:52:22,743 - INFO - Last Login: 30
2019-09-02 14:52:22,746 - INFO - Query:    
                                with a as(
                                select distinct
                                    u.userid
                                    from user_profile as u
                                    where
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and 
                                    u.is_buyer=1
                                ),

                                --DP Buyers
                                b as(
                                select distinct o.user_id as userid
                                from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                concat('user_id=',cast(a.userid as varchar)) as list_userid
                                from a
                                join b 
                                on a.userid = b.userid
                                
2019-09-02 14:52:22,749 - INFO - ----------------------------------
2019-09-02 14:52:22,750 - INFO - Start Running query A30 DP buyers
2019-09-02 14:53:44,174 - INFO - Running A30 DP buyers Done
2019-09-02 14:53:44,174 - INFO - CSV file path: A30 DP buyers
2019-09-02 14:53:44,371 - INFO - Starting save the query results
2019-09-02 14:53:44,372 - INFO - Total Rows: 2570060
2019-09-02 14:53:44,374 - INFO - Will split into : 3.0 files
2019-09-02 14:53:48,971 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 DP buyers_1.csv
2019-09-02 14:53:48,973 - INFO - , with total : 856687 rows
2019-09-02 14:53:53,634 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 DP buyers_2.csv
2019-09-02 14:53:53,635 - INFO - , with total : 856687 rows
2019-09-02 14:53:58,773 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A30 DP buyers_3.csv
2019-09-02 14:53:58,773 - INFO - , with total : 856686 rows
2019-09-02 14:53:59,318 - INFO - ----------------------------------
2019-09-02 14:53:59,319 - INFO - Delete all data in sheet: Case 11
2019-09-02 14:53:59,831 - INFO - Value detected - use sheet: Case 12
2019-09-02 14:53:59,832 - INFO - Reading Data From Excel...
2019-09-02 14:53:59,832 - INFO - ===================================
2019-09-02 14:53:59,834 - INFO - Get custom SQL..
2019-09-02 14:53:59,835 - INFO - USING CASE 12
2019-09-02 14:53:59,836 - INFO - ----------------------------------
2019-09-02 14:53:59,838 - INFO - Row 1
2019-09-02 14:53:59,838 - INFO - Filename: A1 Users who haven't shopped DP
2019-09-02 14:53:59,838 - INFO - Last Login: 1
2019-09-02 14:53:59,839 - INFO - Query:
                                with b as(
                                    select distinct o.user_id as userid
                                    from shopee_digital_product_order_id_db__order_tab AS o
                                )

                                select distinct 
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u 
                                    where
                                    last_login >= current_date - interval '1' day
                                    and 
                                    u.userid not in (select distinct userid from b)
                                    and 
                                    u.status = 1
                                
2019-09-02 14:53:59,841 - INFO - ----------------------------------
2019-09-02 14:53:59,844 - INFO - Start Running query A1 Users who haven't shopped DP
2019-09-02 14:57:16,127 - INFO - Running A1 Users who haven't shopped DP Done
2019-09-02 14:57:16,128 - INFO - CSV file path: A1 Users who haven't shopped DP
2019-09-02 14:57:16,592 - INFO - Starting save the query results
2019-09-02 14:57:16,594 - INFO - Total Rows: 6179522
2019-09-02 14:57:16,594 - INFO - Will split into : 7.0 files
2019-09-02 14:57:21,914 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A1 Users who haven't shopped DP_1.csv
2019-09-02 14:57:21,915 - INFO - , with total : 882789 rows
2019-09-02 14:57:27,401 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A1 Users who haven't shopped DP_2.csv
2019-09-02 14:57:27,404 - INFO - , with total : 882789 rows
2019-09-02 14:57:32,805 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A1 Users who haven't shopped DP_3.csv
2019-09-02 14:57:32,809 - INFO - , with total : 882789 rows
2019-09-02 14:57:38,607 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A1 Users who haven't shopped DP_4.csv
2019-09-02 14:57:38,608 - INFO - , with total : 882789 rows
2019-09-02 14:57:45,561 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A1 Users who haven't shopped DP_5.csv
2019-09-02 14:57:45,562 - INFO - , with total : 882789 rows
2019-09-02 14:57:51,312 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A1 Users who haven't shopped DP_6.csv
2019-09-02 14:57:51,312 - INFO - , with total : 882789 rows
2019-09-02 14:57:57,092 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 14.35/A1 Users who haven't shopped DP_7.csv
2019-09-02 14:57:57,095 - INFO - , with total : 882788 rows
2019-09-02 14:57:58,069 - INFO - ----------------------------------
2019-09-02 14:57:58,073 - INFO - Delete all data in sheet: Case 12
2019-09-02 14:57:58,562 - INFO - No value detected on sheet: Case 13
2019-09-02 14:57:58,566 - INFO - No value detected on sheet: Case 14
2019-09-02 14:57:58,569 - INFO - No value detected on sheet: Case 15
2019-09-02 14:57:58,569 - INFO - No value detected on sheet: Case 16
2019-09-02 14:57:58,572 - INFO - No value detected on sheet: Case 17
2019-09-02 14:57:58,572 - INFO - No value detected on sheet: Case 18
2019-09-02 17:00:02,898 - INFO - Report date: 20190902 17.00
2019-09-02 17:00:07,572 - INFO - ----------------------------------
2019-09-02 17:00:07,572 - INFO - Download sheet..
2019-09-02 17:00:07,572 - INFO - Change directory to script path
2019-09-02 17:00:09,229 - INFO - Spreadsheet downloaded
2019-09-02 17:00:09,230 - INFO - Opening PN Input.xlsx..
2019-09-02 17:00:09,490 - INFO - No value detected on sheet: Case 1
2019-09-02 17:00:09,492 - INFO - No value detected on sheet: Case 2
2019-09-02 17:00:09,492 - INFO - No value detected on sheet: Case 3
2019-09-02 17:00:09,492 - INFO - No value detected on sheet: Case 4
2019-09-02 17:00:09,492 - INFO - No value detected on sheet: Case 5
2019-09-02 17:00:09,493 - INFO - No value detected on sheet: Case 6
2019-09-02 17:00:09,493 - INFO - No value detected on sheet: Case 7
2019-09-02 17:00:09,493 - INFO - Value detected - use sheet: Case 8
2019-09-02 17:00:09,493 - INFO - Reading Data From Excel...
2019-09-02 17:00:09,493 - INFO - ===================================
2019-09-02 17:00:09,494 - INFO - Get custom SQL..
2019-09-02 17:00:09,494 - INFO - USING CASE 8
2019-09-02 17:00:09,496 - INFO - ----------------------------------
2019-09-02 17:00:09,496 - INFO - Row 1
2019-09-02 17:00:09,496 - INFO - Filename: Brand Festival 4 Sep
2019-09-02 17:00:09,496 - INFO - Sub-category: 'Baby & Kids Head Accessories','Baby & Kids Jewelry','Baby & Kids Shoes Accessories','Baby Clothes','Baby Shoes','Boy Bags','Boy Clothes','Boy Shoes','Girl Bags','Girl Clothes','Girl Shoes','Kids Watches','Backpack','Bag Accessories','Clutches','Hand Bag','Laptop Bag','Pouch & Cases','Shoulder Bag','Sling Bag','Sports Bag','Tote Bag','Travel & Luggage','Waist Bag','Wallet','Batik & Kebaya','Dress','Jeans','Jumpsuit & Overall','Maternity wear','Outerwear','Pants','Set','Skirt','Sleepwear & Pajama','Top','UnderwearAccessories & Shoe Care','Boots & Ankle Boots','Flat Shoes','Flip Flop & Sandals','Heels','Slip On','Sneakers','Wedges'
2019-09-02 17:00:09,496 - INFO - Last Login: 30
2019-09-02 17:00:09,496 - INFO - Query:
                                select distinct
                                    concat('user_id=',cast(u.userid as varchar)) list_userid
                                    from user_profile as u
                                    join order_mart__order_item_profile as p
                                    on u.userid = p.userid
                                    where
                                    p.sub_category in ('Baby & Kids Head Accessories','Baby & Kids Jewelry','Baby & Kids Shoes Accessories','Baby Clothes','Baby Shoes','Boy Bags','Boy Clothes','Boy Shoes','Girl Bags','Girl Clothes','Girl Shoes','Kids Watches','Backpack','Bag Accessories','Clutches','Hand Bag','Laptop Bag','Pouch & Cases','Shoulder Bag','Sling Bag','Sports Bag','Tote Bag','Travel & Luggage','Waist Bag','Wallet','Batik & Kebaya','Dress','Jeans','Jumpsuit & Overall','Maternity wear','Outerwear','Pants','Set','Skirt','Sleepwear & Pajama','Top','UnderwearAccessories & Shoe Care','Boots & Ankle Boots','Flat Shoes','Flip Flop & Sandals','Heels','Slip On','Sneakers','Wedges')
                                    and
                                    last_login >= current_date - interval '30' day
                                    and
                                    u.status = 1
                                    and
                                    u.is_buyer = 1
                                
2019-09-02 17:00:09,497 - INFO - ----------------------------------
2019-09-02 17:00:09,497 - INFO - Start Running query Brand Festival 4 Sep
2019-09-02 17:04:52,085 - INFO - Running Brand Festival 4 Sep Done
2019-09-02 17:04:52,086 - INFO - CSV file path: Brand Festival 4 Sep
2019-09-02 17:04:52,592 - INFO - Starting save the query results
2019-09-02 17:04:52,594 - INFO - Total Rows: 11015946
2019-09-02 17:04:52,595 - INFO - Will split into : 12.0 files
2019-09-02 17:04:56,890 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_1.csv
2019-09-02 17:04:56,891 - INFO - , with total : 917996 rows
2019-09-02 17:05:01,532 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_2.csv
2019-09-02 17:05:01,533 - INFO - , with total : 917996 rows
2019-09-02 17:05:06,325 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_3.csv
2019-09-02 17:05:06,325 - INFO - , with total : 917996 rows
2019-09-02 17:05:11,197 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_4.csv
2019-09-02 17:05:11,197 - INFO - , with total : 917996 rows
2019-09-02 17:05:16,140 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_5.csv
2019-09-02 17:05:16,141 - INFO - , with total : 917996 rows
2019-09-02 17:05:20,990 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_6.csv
2019-09-02 17:05:20,990 - INFO - , with total : 917996 rows
2019-09-02 17:05:26,009 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_7.csv
2019-09-02 17:05:26,009 - INFO - , with total : 917995 rows
2019-09-02 17:05:30,926 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_8.csv
2019-09-02 17:05:30,927 - INFO - , with total : 917995 rows
2019-09-02 17:05:35,819 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_9.csv
2019-09-02 17:05:35,821 - INFO - , with total : 917995 rows
2019-09-02 17:05:40,631 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_10.csv
2019-09-02 17:05:40,632 - INFO - , with total : 917995 rows
2019-09-02 17:05:45,451 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_11.csv
2019-09-02 17:05:45,453 - INFO - , with total : 917995 rows
2019-09-02 17:05:50,273 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Brand Festival 4 Sep_12.csv
2019-09-02 17:05:50,275 - INFO - , with total : 917995 rows
2019-09-02 17:05:52,476 - INFO - ----------------------------------
2019-09-02 17:05:52,479 - INFO - Delete all data in sheet: Case 8
2019-09-02 17:05:53,058 - INFO - No value detected on sheet: Case 9
2019-09-02 17:05:53,059 - INFO - Value detected - use sheet: Case 10
2019-09-02 17:05:53,059 - INFO - Reading Data From Excel...
2019-09-02 17:05:53,059 - INFO - ===================================
2019-09-02 17:05:53,061 - INFO - Get custom SQL..
2019-09-02 17:05:53,062 - INFO - USING CASE 10
2019-09-02 17:05:53,062 - INFO - ----------------------------------
2019-09-02 17:05:53,062 - INFO - Row 1
2019-09-02 17:05:53,063 - INFO - Filename: Samsung OS Followers
2019-09-02 17:05:53,063 - INFO - Shop ID: 52635036
2019-09-02 17:05:53,063 - INFO - Query:
                                select
                                'user_id='||cast(userid as varchar) as list_userid
                                from shopee_follower_id_db__shop_follow_tab
                                where shopid in (52635036) 
                                and status = 1
                                
2019-09-02 17:05:53,065 - INFO - ----------------------------------
2019-09-02 17:05:53,065 - INFO - Start Running query Samsung OS Followers
2019-09-02 17:06:02,266 - INFO - Running Samsung OS Followers Done
2019-09-02 17:06:02,266 - INFO - CSV file path: Samsung OS Followers
2019-09-02 17:06:02,279 - INFO - Starting save the query results
2019-09-02 17:06:02,280 - INFO - Total Rows: 315400
2019-09-02 17:06:02,282 - INFO - Will split into : 1.0 files
2019-09-02 17:06:03,746 - INFO - Save query results as G:/My Drive/AUTOMATED_REPORTS/PN - Comm Results/20190902 17.00/Samsung OS Followers_1.csv
2019-09-02 17:06:03,746 - INFO - , with total : 315400 rows
2019-09-02 17:06:04,391 - INFO - ----------------------------------
2019-09-02 17:06:04,391 - INFO - Delete all data in sheet: Case 10
2019-09-02 17:06:04,811 - INFO - No value detected on sheet: Case 11
2019-09-02 17:06:04,812 - INFO - No value detected on sheet: Case 12
2019-09-02 17:06:04,815 - INFO - No value detected on sheet: Case 13
2019-09-02 17:06:04,815 - INFO - No value detected on sheet: Case 14
2019-09-02 17:06:04,818 - INFO - No value detected on sheet: Case 15
2019-09-02 17:06:04,819 - INFO - No value detected on sheet: Case 16
2019-09-02 17:06:04,819 - INFO - No value detected on sheet: Case 17
2019-09-02 17:06:04,819 - INFO - No value detected on sheet: Case 18
